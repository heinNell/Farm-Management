import{r as T,a as jl,b as Rl,c as Cr,d as kl,R as Ll}from"./vendor-CKV-ivK8.js";import{c as Bl,Q as Pl,a as Fl}from"./data-F_giidh4.js";import{m as tt,L as qi,S as Qr,C as li,a as Ul,U as ci,b as zl,c as Hl,P as Ht,B as Vl,W as ar,d as Zl,e as dn,F as Kr,f as Xa,A as qa,X as On,M as Wl,g as Ps,h as $i,i as qs,T as ui,j as Gl,k as ls,l as Hn,n as Jr,D as Yl,o as Vn,p as $a,q as Er,r as Vt,R as Xl,s as ql,t as _n,u as $s,v as $l,w as Ql,x as Qa,y as Kl,z as Jl,E as ec,G as Ka,H as tc,I as nc,J as rc,K as sc,N as ic,O as ac,Q as oc}from"./ui-DGWhA6bQ.js";function lc(n,s){for(var o=0;o<s.length;o++){const u=s[o];if(typeof u!="string"&&!Array.isArray(u)){for(const h in u)if(h!=="default"&&!(h in n)){const f=Object.getOwnPropertyDescriptor(u,h);f&&Object.defineProperty(n,h,f.get?f:{enumerable:!0,get:()=>u[h]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))u(h);new MutationObserver(h=>{for(const f of h)if(f.type==="childList")for(const m of f.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function o(h){const f={};return h.integrity&&(f.integrity=h.integrity),h.referrerPolicy&&(f.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?f.credentials="include":h.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function u(h){if(h.ep)return;h.ep=!0;const f=o(h);fetch(h.href,f)}})();var Ja={exports:{}},cs={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cc=T,uc=Symbol.for("react.element"),dc=Symbol.for("react.fragment"),hc=Object.prototype.hasOwnProperty,fc=cc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gc={key:!0,ref:!0,__self:!0,__source:!0};function eo(n,s,o){var u,h={},f=null,m=null;o!==void 0&&(f=""+o),s.key!==void 0&&(f=""+s.key),s.ref!==void 0&&(m=s.ref);for(u in s)hc.call(s,u)&&!gc.hasOwnProperty(u)&&(h[u]=s[u]);if(n&&n.defaultProps)for(u in s=n.defaultProps,s)h[u]===void 0&&(h[u]=s[u]);return{$$typeof:uc,type:n,key:f,ref:m,props:h,_owner:fc.current}}cs.Fragment=dc;cs.jsx=eo;cs.jsxs=eo;Ja.exports=cs;var c=Ja.exports,Qs={},Qi=jl;Qs.createRoot=Qi.createRoot,Qs.hydrateRoot=Qi.hydrateRoot;let xc={data:""},mc=n=>{if(typeof window=="object"){let s=(n?n.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(n||document.head).appendChild(s),s.firstChild}return n||xc},pc=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,yc=/\/\*[^]*?\*\/|  +/g,Ki=/\n+/g,En=(n,s)=>{let o="",u="",h="";for(let f in n){let m=n[f];f[0]=="@"?f[1]=="i"?o=f+" "+m+";":u+=f[1]=="f"?En(m,f):f+"{"+En(m,f[1]=="k"?"":s)+"}":typeof m=="object"?u+=En(m,s?s.replace(/([^,])+/g,w=>f.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,E=>/&/.test(E)?E.replace(/&/g,w):w?w+" "+E:E)):f):m!=null&&(f=/^--/.test(f)?f:f.replace(/[A-Z]/g,"-$&").toLowerCase(),h+=En.p?En.p(f,m):f+":"+m+";")}return o+(s&&h?s+"{"+h+"}":h)+u},cn={},to=n=>{if(typeof n=="object"){let s="";for(let o in n)s+=o+to(n[o]);return s}return n},wc=(n,s,o,u,h)=>{let f=to(n),m=cn[f]||(cn[f]=(E=>{let p=0,A=11;for(;p<E.length;)A=101*A+E.charCodeAt(p++)>>>0;return"go"+A})(f));if(!cn[m]){let E=f!==n?n:(p=>{let A,N,I=[{}];for(;A=pc.exec(p.replace(yc,""));)A[4]?I.shift():A[3]?(N=A[3].replace(Ki," ").trim(),I.unshift(I[0][N]=I[0][N]||{})):I[0][A[1]]=A[2].replace(Ki," ").trim();return I[0]})(n);cn[m]=En(h?{["@keyframes "+m]:E}:E,o?"":"."+m)}let w=o&&cn.g?cn.g:null;return o&&(cn.g=cn[m]),((E,p,A,N)=>{N?p.data=p.data.replace(N,E):p.data.indexOf(E)===-1&&(p.data=A?E+p.data:p.data+E)})(cn[m],s,u,w),m},bc=(n,s,o)=>n.reduce((u,h,f)=>{let m=s[f];if(m&&m.call){let w=m(o),E=w&&w.props&&w.props.className||/^go/.test(w)&&w;m=E?"."+E:w&&typeof w=="object"?w.props?"":En(w,""):w===!1?"":w}return u+h+(m??"")},"");function us(n){let s=this||{},o=n.call?n(s.p):n;return wc(o.unshift?o.raw?bc(o,[].slice.call(arguments,1),s.p):o.reduce((u,h)=>Object.assign(u,h&&h.call?h(s.p):h),{}):o,mc(s.target),s.g,s.o,s.k)}let no,Ks,Js;us.bind({g:1});let hn=us.bind({k:1});function Cc(n,s,o,u){En.p=s,no=n,Ks=o,Js=u}function Mn(n,s){let o=this||{};return function(){let u=arguments;function h(f,m){let w=Object.assign({},f),E=w.className||h.className;o.p=Object.assign({theme:Ks&&Ks()},w),o.o=/ *go\d+/.test(E),w.className=us.apply(o,u)+(E?" "+E:"");let p=n;return n[0]&&(p=w.as||n,delete w.as),Js&&p[0]&&Js(w),no(p,w)}return h}}var Ac=n=>typeof n=="function",es=(n,s)=>Ac(n)?n(s):n,Nc=(()=>{let n=0;return()=>(++n).toString()})(),ro=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");n=!s||s.matches}return n}})(),Ec=20,di="default",so=(n,s)=>{let{toastLimit:o}=n.settings;switch(s.type){case 0:return{...n,toasts:[s.toast,...n.toasts].slice(0,o)};case 1:return{...n,toasts:n.toasts.map(m=>m.id===s.toast.id?{...m,...s.toast}:m)};case 2:let{toast:u}=s;return so(n,{type:n.toasts.find(m=>m.id===u.id)?1:0,toast:u});case 3:let{toastId:h}=s;return{...n,toasts:n.toasts.map(m=>m.id===h||h===void 0?{...m,dismissed:!0,visible:!1}:m)};case 4:return s.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(m=>m.id!==s.toastId)};case 5:return{...n,pausedAt:s.time};case 6:let f=s.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(m=>({...m,pauseDuration:m.pauseDuration+f}))}}},$r=[],io={toasts:[],pausedAt:void 0,settings:{toastLimit:Ec}},sn={},ao=(n,s=di)=>{sn[s]=so(sn[s]||io,n),$r.forEach(([o,u])=>{o===s&&u(sn[s])})},oo=n=>Object.keys(sn).forEach(s=>ao(n,s)),vc=n=>Object.keys(sn).find(s=>sn[s].toasts.some(o=>o.id===n)),ds=(n=di)=>s=>{ao(s,n)},_c={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Sc=(n={},s=di)=>{let[o,u]=T.useState(sn[s]||io),h=T.useRef(sn[s]);T.useEffect(()=>(h.current!==sn[s]&&u(sn[s]),$r.push([s,u]),()=>{let m=$r.findIndex(([w])=>w===s);m>-1&&$r.splice(m,1)}),[s]);let f=o.toasts.map(m=>{var w,E,p;return{...n,...n[m.type],...m,removeDelay:m.removeDelay||((w=n[m.type])==null?void 0:w.removeDelay)||n?.removeDelay,duration:m.duration||((E=n[m.type])==null?void 0:E.duration)||n?.duration||_c[m.type],style:{...n.style,...(p=n[m.type])==null?void 0:p.style,...m.style}}});return{...o,toasts:f}},Ic=(n,s="blank",o)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...o,id:o?.id||Nc()}),Tr=n=>(s,o)=>{let u=Ic(s,n,o);return ds(u.toasterId||vc(u.id))({type:2,toast:u}),u.id},ct=(n,s)=>Tr("blank")(n,s);ct.error=Tr("error");ct.success=Tr("success");ct.loading=Tr("loading");ct.custom=Tr("custom");ct.dismiss=(n,s)=>{let o={type:3,toastId:n};s?ds(s)(o):oo(o)};ct.dismissAll=n=>ct.dismiss(void 0,n);ct.remove=(n,s)=>{let o={type:4,toastId:n};s?ds(s)(o):oo(o)};ct.removeAll=n=>ct.remove(void 0,n);ct.promise=(n,s,o)=>{let u=ct.loading(s.loading,{...o,...o?.loading});return typeof n=="function"&&(n=n()),n.then(h=>{let f=s.success?es(s.success,h):void 0;return f?ct.success(f,{id:u,...o,...o?.success}):ct.dismiss(u),h}).catch(h=>{let f=s.error?es(s.error,h):void 0;f?ct.error(f,{id:u,...o,...o?.error}):ct.dismiss(u)}),n};var Tc=1e3,Oc=(n,s="default")=>{let{toasts:o,pausedAt:u}=Sc(n,s),h=T.useRef(new Map).current,f=T.useCallback((N,I=Tc)=>{if(h.has(N))return;let M=setTimeout(()=>{h.delete(N),m({type:4,toastId:N})},I);h.set(N,M)},[]);T.useEffect(()=>{if(u)return;let N=Date.now(),I=o.map(M=>{if(M.duration===1/0)return;let H=(M.duration||0)+M.pauseDuration-(N-M.createdAt);if(H<0){M.visible&&ct.dismiss(M.id);return}return setTimeout(()=>ct.dismiss(M.id,s),H)});return()=>{I.forEach(M=>M&&clearTimeout(M))}},[o,u,s]);let m=T.useCallback(ds(s),[s]),w=T.useCallback(()=>{m({type:5,time:Date.now()})},[m]),E=T.useCallback((N,I)=>{m({type:1,toast:{id:N,height:I}})},[m]),p=T.useCallback(()=>{u&&m({type:6,time:Date.now()})},[u,m]),A=T.useCallback((N,I)=>{let{reverseOrder:M=!1,gutter:H=8,defaultPosition:k}=I||{},j=o.filter(B=>(B.position||k)===(N.position||k)&&B.height),W=j.findIndex(B=>B.id===N.id),G=j.filter((B,K)=>K<W&&B.visible).length;return j.filter(B=>B.visible).slice(...M?[G+1]:[0,G]).reduce((B,K)=>B+(K.height||0)+H,0)},[o]);return T.useEffect(()=>{o.forEach(N=>{if(N.dismissed)f(N.id,N.removeDelay);else{let I=h.get(N.id);I&&(clearTimeout(I),h.delete(N.id))}})},[o,f]),{toasts:o,handlers:{updateHeight:E,startPause:w,endPause:p,calculateOffset:A}}},Mc=hn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Dc=hn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,jc=hn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Rc=Mn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Mc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Dc} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${jc} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,kc=hn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Lc=Mn("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${kc} 1s linear infinite;
`,Bc=hn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Pc=hn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Fc=Mn("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Bc} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Pc} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Uc=Mn("div")`
  position: absolute;
`,zc=Mn("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Hc=hn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Vc=Mn("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Hc} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Zc=({toast:n})=>{let{icon:s,type:o,iconTheme:u}=n;return s!==void 0?typeof s=="string"?T.createElement(Vc,null,s):s:o==="blank"?null:T.createElement(zc,null,T.createElement(Lc,{...u}),o!=="loading"&&T.createElement(Uc,null,o==="error"?T.createElement(Rc,{...u}):T.createElement(Fc,{...u})))},Wc=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Gc=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,Yc="0%{opacity:0;} 100%{opacity:1;}",Xc="0%{opacity:1;} 100%{opacity:0;}",qc=Mn("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,$c=Mn("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Qc=(n,s)=>{let o=n.includes("top")?1:-1,[u,h]=ro()?[Yc,Xc]:[Wc(o),Gc(o)];return{animation:s?`${hn(u)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${hn(h)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},Kc=T.memo(({toast:n,position:s,style:o,children:u})=>{let h=n.height?Qc(n.position||s||"top-center",n.visible):{opacity:0},f=T.createElement(Zc,{toast:n}),m=T.createElement($c,{...n.ariaProps},es(n.message,n));return T.createElement(qc,{className:n.className,style:{...h,...o,...n.style}},typeof u=="function"?u({icon:f,message:m}):T.createElement(T.Fragment,null,f,m))});Cc(T.createElement);var Jc=({id:n,className:s,style:o,onHeightUpdate:u,children:h})=>{let f=T.useCallback(m=>{if(m){let w=()=>{let E=m.getBoundingClientRect().height;u(n,E)};w(),new MutationObserver(w).observe(m,{subtree:!0,childList:!0,characterData:!0})}},[n,u]);return T.createElement("div",{ref:f,className:s,style:o},h)},eu=(n,s)=>{let o=n.includes("top"),u=o?{top:0}:{bottom:0},h=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:ro()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(o?1:-1)}px)`,...u,...h}},tu=us`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Wr=16,nu=({reverseOrder:n,position:s="top-center",toastOptions:o,gutter:u,children:h,toasterId:f,containerStyle:m,containerClassName:w})=>{let{toasts:E,handlers:p}=Oc(o,f);return T.createElement("div",{"data-rht-toaster":f||"",style:{position:"fixed",zIndex:9999,top:Wr,left:Wr,right:Wr,bottom:Wr,pointerEvents:"none",...m},className:w,onMouseEnter:p.startPause,onMouseLeave:p.endPause},E.map(A=>{let N=A.position||s,I=p.calculateOffset(A,{reverseOrder:n,gutter:u,defaultPosition:s}),M=eu(N,I);return T.createElement(Jc,{id:A.id,key:A.id,onHeightUpdate:p.updateHeight,className:A.visible?tu:"",style:M},A.type==="custom"?es(A.message,A):h?h(A):T.createElement(Kc,{toast:A,position:N}))}))},et=ct;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vr(){return vr=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(n[u]=o[u])}return n},vr.apply(this,arguments)}var vn;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(vn||(vn={}));const Ji="popstate";function ru(n){n===void 0&&(n={});function s(u,h){let{pathname:f,search:m,hash:w}=u.location;return ei("",{pathname:f,search:m,hash:w},h.state&&h.state.usr||null,h.state&&h.state.key||"default")}function o(u,h){return typeof h=="string"?h:ts(h)}return iu(s,o,null,n)}function nt(n,s){if(n===!1||n===null||typeof n>"u")throw new Error(s)}function lo(n,s){if(!n){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function su(){return Math.random().toString(36).substr(2,8)}function ea(n,s){return{usr:n.state,key:n.key,idx:s}}function ei(n,s,o,u){return o===void 0&&(o=null),vr({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof s=="string"?lr(s):s,{state:o,key:s&&s.key||u||su()})}function ts(n){let{pathname:s="/",search:o="",hash:u=""}=n;return o&&o!=="?"&&(s+=o.charAt(0)==="?"?o:"?"+o),u&&u!=="#"&&(s+=u.charAt(0)==="#"?u:"#"+u),s}function lr(n){let s={};if(n){let o=n.indexOf("#");o>=0&&(s.hash=n.substr(o),n=n.substr(0,o));let u=n.indexOf("?");u>=0&&(s.search=n.substr(u),n=n.substr(0,u)),n&&(s.pathname=n)}return s}function iu(n,s,o,u){u===void 0&&(u={});let{window:h=document.defaultView,v5Compat:f=!1}=u,m=h.history,w=vn.Pop,E=null,p=A();p==null&&(p=0,m.replaceState(vr({},m.state,{idx:p}),""));function A(){return(m.state||{idx:null}).idx}function N(){w=vn.Pop;let j=A(),W=j==null?null:j-p;p=j,E&&E({action:w,location:k.location,delta:W})}function I(j,W){w=vn.Push;let G=ei(k.location,j,W);p=A()+1;let B=ea(G,p),K=k.createHref(G);try{m.pushState(B,"",K)}catch(we){if(we instanceof DOMException&&we.name==="DataCloneError")throw we;h.location.assign(K)}f&&E&&E({action:w,location:k.location,delta:1})}function M(j,W){w=vn.Replace;let G=ei(k.location,j,W);p=A();let B=ea(G,p),K=k.createHref(G);m.replaceState(B,"",K),f&&E&&E({action:w,location:k.location,delta:0})}function H(j){let W=h.location.origin!=="null"?h.location.origin:h.location.href,G=typeof j=="string"?j:ts(j);return G=G.replace(/ $/,"%20"),nt(W,"No window.location.(origin|href) available to create URL for href: "+G),new URL(G,W)}let k={get action(){return w},get location(){return n(h,m)},listen(j){if(E)throw new Error("A history only accepts one active listener");return h.addEventListener(Ji,N),E=j,()=>{h.removeEventListener(Ji,N),E=null}},createHref(j){return s(h,j)},createURL:H,encodeLocation(j){let W=H(j);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:I,replace:M,go(j){return m.go(j)}};return k}var ta;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(ta||(ta={}));function au(n,s,o){return o===void 0&&(o="/"),ou(n,s,o)}function ou(n,s,o,u){let h=typeof s=="string"?lr(s):s,f=hi(h.pathname||"/",o);if(f==null)return null;let m=co(n);lu(m);let w=null;for(let E=0;w==null&&E<m.length;++E){let p=bu(f);w=pu(m[E],p)}return w}function co(n,s,o,u){s===void 0&&(s=[]),o===void 0&&(o=[]),u===void 0&&(u="");let h=(f,m,w)=>{let E={relativePath:w===void 0?f.path||"":w,caseSensitive:f.caseSensitive===!0,childrenIndex:m,route:f};E.relativePath.startsWith("/")&&(nt(E.relativePath.startsWith(u),'Absolute route path "'+E.relativePath+'" nested under path '+('"'+u+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),E.relativePath=E.relativePath.slice(u.length));let p=Sn([u,E.relativePath]),A=o.concat(E);f.children&&f.children.length>0&&(nt(f.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),co(f.children,s,A,p)),!(f.path==null&&!f.index)&&s.push({path:p,score:xu(p,f.index),routesMeta:A})};return n.forEach((f,m)=>{var w;if(f.path===""||!((w=f.path)!=null&&w.includes("?")))h(f,m);else for(let E of uo(f.path))h(f,m,E)}),s}function uo(n){let s=n.split("/");if(s.length===0)return[];let[o,...u]=s,h=o.endsWith("?"),f=o.replace(/\?$/,"");if(u.length===0)return h?[f,""]:[f];let m=uo(u.join("/")),w=[];return w.push(...m.map(E=>E===""?f:[f,E].join("/"))),h&&w.push(...m),w.map(E=>n.startsWith("/")&&E===""?"/":E)}function lu(n){n.sort((s,o)=>s.score!==o.score?o.score-s.score:mu(s.routesMeta.map(u=>u.childrenIndex),o.routesMeta.map(u=>u.childrenIndex)))}const cu=/^:[\w-]+$/,uu=3,du=2,hu=1,fu=10,gu=-2,na=n=>n==="*";function xu(n,s){let o=n.split("/"),u=o.length;return o.some(na)&&(u+=gu),s&&(u+=du),o.filter(h=>!na(h)).reduce((h,f)=>h+(cu.test(f)?uu:f===""?hu:fu),u)}function mu(n,s){return n.length===s.length&&n.slice(0,-1).every((u,h)=>u===s[h])?n[n.length-1]-s[s.length-1]:0}function pu(n,s,o){let{routesMeta:u}=n,h={},f="/",m=[];for(let w=0;w<u.length;++w){let E=u[w],p=w===u.length-1,A=f==="/"?s:s.slice(f.length)||"/",N=yu({path:E.relativePath,caseSensitive:E.caseSensitive,end:p},A),I=E.route;if(!N)return null;Object.assign(h,N.params),m.push({params:h,pathname:Sn([f,N.pathname]),pathnameBase:Eu(Sn([f,N.pathnameBase])),route:I}),N.pathnameBase!=="/"&&(f=Sn([f,N.pathnameBase]))}return m}function yu(n,s){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[o,u]=wu(n.path,n.caseSensitive,n.end),h=s.match(o);if(!h)return null;let f=h[0],m=f.replace(/(.)\/+$/,"$1"),w=h.slice(1);return{params:u.reduce((p,A,N)=>{let{paramName:I,isOptional:M}=A;if(I==="*"){let k=w[N]||"";m=f.slice(0,f.length-k.length).replace(/(.)\/+$/,"$1")}const H=w[N];return M&&!H?p[I]=void 0:p[I]=(H||"").replace(/%2F/g,"/"),p},{}),pathname:f,pathnameBase:m,pattern:n}}function wu(n,s,o){s===void 0&&(s=!1),o===void 0&&(o=!0),lo(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let u=[],h="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,w,E)=>(u.push({paramName:w,isOptional:E!=null}),E?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(u.push({paramName:"*"}),h+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):o?h+="\\/*$":n!==""&&n!=="/"&&(h+="(?:(?=\\/|$))"),[new RegExp(h,s?void 0:"i"),u]}function bu(n){try{return n.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return lo(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),n}}function hi(n,s){if(s==="/")return n;if(!n.toLowerCase().startsWith(s.toLowerCase()))return null;let o=s.endsWith("/")?s.length-1:s.length,u=n.charAt(o);return u&&u!=="/"?null:n.slice(o)||"/"}function Cu(n,s){s===void 0&&(s="/");let{pathname:o,search:u="",hash:h=""}=typeof n=="string"?lr(n):n;return{pathname:o?o.startsWith("/")?o:Au(o,s):s,search:vu(u),hash:_u(h)}}function Au(n,s){let o=s.replace(/\/+$/,"").split("/");return n.split("/").forEach(h=>{h===".."?o.length>1&&o.pop():h!=="."&&o.push(h)}),o.length>1?o.join("/"):"/"}function Fs(n,s,o,u){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(u)+"].  Please separate it out to the ")+("`to."+o+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Nu(n){return n.filter((s,o)=>o===0||s.route.path&&s.route.path.length>0)}function fi(n,s){let o=Nu(n);return s?o.map((u,h)=>h===o.length-1?u.pathname:u.pathnameBase):o.map(u=>u.pathnameBase)}function gi(n,s,o,u){u===void 0&&(u=!1);let h;typeof n=="string"?h=lr(n):(h=vr({},n),nt(!h.pathname||!h.pathname.includes("?"),Fs("?","pathname","search",h)),nt(!h.pathname||!h.pathname.includes("#"),Fs("#","pathname","hash",h)),nt(!h.search||!h.search.includes("#"),Fs("#","search","hash",h)));let f=n===""||h.pathname==="",m=f?"/":h.pathname,w;if(m==null)w=o;else{let N=s.length-1;if(!u&&m.startsWith("..")){let I=m.split("/");for(;I[0]==="..";)I.shift(),N-=1;h.pathname=I.join("/")}w=N>=0?s[N]:"/"}let E=Cu(h,w),p=m&&m!=="/"&&m.endsWith("/"),A=(f||m===".")&&o.endsWith("/");return!E.pathname.endsWith("/")&&(p||A)&&(E.pathname+="/"),E}const Sn=n=>n.join("/").replace(/\/\/+/g,"/"),Eu=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),vu=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,_u=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Su(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const ho=["post","put","patch","delete"];new Set(ho);const Iu=["get",...ho];new Set(Iu);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _r(){return _r=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(n[u]=o[u])}return n},_r.apply(this,arguments)}const xi=T.createContext(null),Tu=T.createContext(null),Dn=T.createContext(null),hs=T.createContext(null),fn=T.createContext({outlet:null,matches:[],isDataRoute:!1}),fo=T.createContext(null);function Ou(n,s){let{relative:o}=s===void 0?{}:s;cr()||nt(!1);let{basename:u,navigator:h}=T.useContext(Dn),{hash:f,pathname:m,search:w}=mo(n,{relative:o}),E=m;return u!=="/"&&(E=m==="/"?u:Sn([u,m])),h.createHref({pathname:E,search:w,hash:f})}function cr(){return T.useContext(hs)!=null}function ur(){return cr()||nt(!1),T.useContext(hs).location}function go(n){T.useContext(Dn).static||T.useLayoutEffect(n)}function xo(){let{isDataRoute:n}=T.useContext(fn);return n?Wu():Mu()}function Mu(){cr()||nt(!1);let n=T.useContext(xi),{basename:s,future:o,navigator:u}=T.useContext(Dn),{matches:h}=T.useContext(fn),{pathname:f}=ur(),m=JSON.stringify(fi(h,o.v7_relativeSplatPath)),w=T.useRef(!1);return go(()=>{w.current=!0}),T.useCallback(function(p,A){if(A===void 0&&(A={}),!w.current)return;if(typeof p=="number"){u.go(p);return}let N=gi(p,JSON.parse(m),f,A.relative==="path");n==null&&s!=="/"&&(N.pathname=N.pathname==="/"?s:Sn([s,N.pathname])),(A.replace?u.replace:u.push)(N,A.state,A)},[s,u,m,f,n])}const Du=T.createContext(null);function ju(n){let s=T.useContext(fn).outlet;return s&&T.createElement(Du.Provider,{value:n},s)}function mo(n,s){let{relative:o}=s===void 0?{}:s,{future:u}=T.useContext(Dn),{matches:h}=T.useContext(fn),{pathname:f}=ur(),m=JSON.stringify(fi(h,u.v7_relativeSplatPath));return T.useMemo(()=>gi(n,JSON.parse(m),f,o==="path"),[n,m,f,o])}function Ru(n,s){return ku(n,s)}function ku(n,s,o,u){cr()||nt(!1);let{navigator:h}=T.useContext(Dn),{matches:f}=T.useContext(fn),m=f[f.length-1],w=m?m.params:{};m&&m.pathname;let E=m?m.pathnameBase:"/";m&&m.route;let p=ur(),A;if(s){var N;let j=typeof s=="string"?lr(s):s;E==="/"||(N=j.pathname)!=null&&N.startsWith(E)||nt(!1),A=j}else A=p;let I=A.pathname||"/",M=I;if(E!=="/"){let j=E.replace(/^\//,"").split("/");M="/"+I.replace(/^\//,"").split("/").slice(j.length).join("/")}let H=au(n,{pathname:M}),k=Uu(H&&H.map(j=>Object.assign({},j,{params:Object.assign({},w,j.params),pathname:Sn([E,h.encodeLocation?h.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?E:Sn([E,h.encodeLocation?h.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),f,o,u);return s&&k?T.createElement(hs.Provider,{value:{location:_r({pathname:"/",search:"",hash:"",state:null,key:"default"},A),navigationType:vn.Pop}},k):k}function Lu(){let n=Zu(),s=Su(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),o=n instanceof Error?n.stack:null,h={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return T.createElement(T.Fragment,null,T.createElement("h2",null,"Unexpected Application Error!"),T.createElement("h3",{style:{fontStyle:"italic"}},s),o?T.createElement("pre",{style:h},o):null,null)}const Bu=T.createElement(Lu,null);class Pu extends T.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,o){return o.location!==s.location||o.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:o.error,location:o.location,revalidation:s.revalidation||o.revalidation}}componentDidCatch(s,o){console.error("React Router caught the following error during render",s,o)}render(){return this.state.error!==void 0?T.createElement(fn.Provider,{value:this.props.routeContext},T.createElement(fo.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Fu(n){let{routeContext:s,match:o,children:u}=n,h=T.useContext(xi);return h&&h.static&&h.staticContext&&(o.route.errorElement||o.route.ErrorBoundary)&&(h.staticContext._deepestRenderedBoundaryId=o.route.id),T.createElement(fn.Provider,{value:s},u)}function Uu(n,s,o,u){var h;if(s===void 0&&(s=[]),o===void 0&&(o=null),u===void 0&&(u=null),n==null){var f;if(!o)return null;if(o.errors)n=o.matches;else if((f=u)!=null&&f.v7_partialHydration&&s.length===0&&!o.initialized&&o.matches.length>0)n=o.matches;else return null}let m=n,w=(h=o)==null?void 0:h.errors;if(w!=null){let A=m.findIndex(N=>N.route.id&&w?.[N.route.id]!==void 0);A>=0||nt(!1),m=m.slice(0,Math.min(m.length,A+1))}let E=!1,p=-1;if(o&&u&&u.v7_partialHydration)for(let A=0;A<m.length;A++){let N=m[A];if((N.route.HydrateFallback||N.route.hydrateFallbackElement)&&(p=A),N.route.id){let{loaderData:I,errors:M}=o,H=N.route.loader&&I[N.route.id]===void 0&&(!M||M[N.route.id]===void 0);if(N.route.lazy||H){E=!0,p>=0?m=m.slice(0,p+1):m=[m[0]];break}}}return m.reduceRight((A,N,I)=>{let M,H=!1,k=null,j=null;o&&(M=w&&N.route.id?w[N.route.id]:void 0,k=N.route.errorElement||Bu,E&&(p<0&&I===0?(Gu("route-fallback"),H=!0,j=null):p===I&&(H=!0,j=N.route.hydrateFallbackElement||null)));let W=s.concat(m.slice(0,I+1)),G=()=>{let B;return M?B=k:H?B=j:N.route.Component?B=T.createElement(N.route.Component,null):N.route.element?B=N.route.element:B=A,T.createElement(Fu,{match:N,routeContext:{outlet:A,matches:W,isDataRoute:o!=null},children:B})};return o&&(N.route.ErrorBoundary||N.route.errorElement||I===0)?T.createElement(Pu,{location:o.location,revalidation:o.revalidation,component:k,error:M,children:G(),routeContext:{outlet:null,matches:W,isDataRoute:!0}}):G()},null)}var po=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(po||{}),yo=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(yo||{});function zu(n){let s=T.useContext(xi);return s||nt(!1),s}function Hu(n){let s=T.useContext(Tu);return s||nt(!1),s}function Vu(n){let s=T.useContext(fn);return s||nt(!1),s}function wo(n){let s=Vu(),o=s.matches[s.matches.length-1];return o.route.id||nt(!1),o.route.id}function Zu(){var n;let s=T.useContext(fo),o=Hu(),u=wo();return s!==void 0?s:(n=o.errors)==null?void 0:n[u]}function Wu(){let{router:n}=zu(po.UseNavigateStable),s=wo(yo.UseNavigateStable),o=T.useRef(!1);return go(()=>{o.current=!0}),T.useCallback(function(h,f){f===void 0&&(f={}),o.current&&(typeof h=="number"?n.navigate(h):n.navigate(h,_r({fromRouteId:s},f)))},[n,s])}const ra={};function Gu(n,s,o){ra[n]||(ra[n]=!0)}function Yu(n,s){n?.v7_startTransition,n?.v7_relativeSplatPath}function Xu(n){let{to:s,replace:o,state:u,relative:h}=n;cr()||nt(!1);let{future:f,static:m}=T.useContext(Dn),{matches:w}=T.useContext(fn),{pathname:E}=ur(),p=xo(),A=gi(s,fi(w,f.v7_relativeSplatPath),E,h==="path"),N=JSON.stringify(A);return T.useEffect(()=>p(JSON.parse(N),{replace:o,state:u,relative:h}),[p,N,h,o,u]),null}function qu(n){return ju(n.context)}function zt(n){nt(!1)}function $u(n){let{basename:s="/",children:o=null,location:u,navigationType:h=vn.Pop,navigator:f,static:m=!1,future:w}=n;cr()&&nt(!1);let E=s.replace(/^\/*/,"/"),p=T.useMemo(()=>({basename:E,navigator:f,static:m,future:_r({v7_relativeSplatPath:!1},w)}),[E,w,f,m]);typeof u=="string"&&(u=lr(u));let{pathname:A="/",search:N="",hash:I="",state:M=null,key:H="default"}=u,k=T.useMemo(()=>{let j=hi(A,E);return j==null?null:{location:{pathname:j,search:N,hash:I,state:M,key:H},navigationType:h}},[E,A,N,I,M,H,h]);return k==null?null:T.createElement(Dn.Provider,{value:p},T.createElement(hs.Provider,{children:o,value:k}))}function Qu(n){let{children:s,location:o}=n;return Ru(ti(s),o)}new Promise(()=>{});function ti(n,s){s===void 0&&(s=[]);let o=[];return T.Children.forEach(n,(u,h)=>{if(!T.isValidElement(u))return;let f=[...s,h];if(u.type===T.Fragment){o.push.apply(o,ti(u.props.children,f));return}u.type!==zt&&nt(!1),!u.props.index||!u.props.children||nt(!1);let m={id:u.props.id||f.join("-"),caseSensitive:u.props.caseSensitive,element:u.props.element,Component:u.props.Component,index:u.props.index,path:u.props.path,loader:u.props.loader,action:u.props.action,errorElement:u.props.errorElement,ErrorBoundary:u.props.ErrorBoundary,hasErrorBoundary:u.props.ErrorBoundary!=null||u.props.errorElement!=null,shouldRevalidate:u.props.shouldRevalidate,handle:u.props.handle,lazy:u.props.lazy};u.props.children&&(m.children=ti(u.props.children,f)),o.push(m)}),o}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ni(){return ni=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var o=arguments[s];for(var u in o)Object.prototype.hasOwnProperty.call(o,u)&&(n[u]=o[u])}return n},ni.apply(this,arguments)}function Ku(n,s){if(n==null)return{};var o={},u=Object.keys(n),h,f;for(f=0;f<u.length;f++)h=u[f],!(s.indexOf(h)>=0)&&(o[h]=n[h]);return o}function Ju(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function ed(n,s){return n.button===0&&(!s||s==="_self")&&!Ju(n)}const td=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],nd="6";try{window.__reactRouterVersion=nd}catch{}const rd="startTransition",sa=Rl[rd];function sd(n){let{basename:s,children:o,future:u,window:h}=n,f=T.useRef();f.current==null&&(f.current=ru({window:h,v5Compat:!0}));let m=f.current,[w,E]=T.useState({action:m.action,location:m.location}),{v7_startTransition:p}=u||{},A=T.useCallback(N=>{p&&sa?sa(()=>E(N)):E(N)},[E,p]);return T.useLayoutEffect(()=>m.listen(A),[m,A]),T.useEffect(()=>Yu(u),[u]),T.createElement($u,{basename:s,children:o,location:w.location,navigationType:w.action,navigator:m,future:u})}const id=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ad=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,od=T.forwardRef(function(s,o){let{onClick:u,relative:h,reloadDocument:f,replace:m,state:w,target:E,to:p,preventScrollReset:A,viewTransition:N}=s,I=Ku(s,td),{basename:M}=T.useContext(Dn),H,k=!1;if(typeof p=="string"&&ad.test(p)&&(H=p,id))try{let B=new URL(window.location.href),K=p.startsWith("//")?new URL(B.protocol+p):new URL(p),we=hi(K.pathname,M);K.origin===B.origin&&we!=null?p=we+K.search+K.hash:k=!0}catch{}let j=Ou(p,{relative:h}),W=ld(p,{replace:m,state:w,target:E,preventScrollReset:A,relative:h,viewTransition:N});function G(B){u&&u(B),B.defaultPrevented||W(B)}return T.createElement("a",ni({},I,{href:H||j,onClick:k||f?u:G,ref:o,target:E}))});var ia;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(ia||(ia={}));var aa;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(aa||(aa={}));function ld(n,s){let{target:o,replace:u,state:h,preventScrollReset:f,relative:m,viewTransition:w}=s===void 0?{}:s,E=xo(),p=ur(),A=mo(n,{relative:m});return T.useCallback(N=>{if(ed(N,o)){N.preventDefault();let I=u!==void 0?u:ts(p)===ts(A);E(n,{replace:I,state:h,preventScrollReset:f,relative:m,viewTransition:w})}},[p,E,A,u,h,o,n,f,m,w])}const cd="https://xcaoevypackelcstdieu.supabase.co",ud="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhjYW9ldnlwYWNrZWxjc3RkaWV1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDU5NTcsImV4cCI6MjA3NTQ4MTk1N30.gVJxR1-DXXmXyZ7_2bqr-R_JP7P2CpnLFMkS1ExFB5w";let Us=null;function dd(){return Us||(console.log("Initializing Supabase client..."),Us=Bl(cd,ud,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"sb-auth-token"},realtime:{params:{eventsPerSecond:10}}})),Us}const He=dd(),Nt={INVENTORY_ITEMS:"inventory_items",REPAIR_ITEMS:"repair_items",JOB_CARDS:"job_cards",INSPECTIONS:"inspections",MAINTENANCE_SCHEDULES:"maintenance_schedules",STOCK_ITEMS:"stock_items",ASSETS:"assets",FUEL_RECORDS:"fuel_records",FUEL_PRICES:"fuel_prices",OPERATING_SESSIONS:"operating_sessions"};async function zs(n){try{console.log(`Fetching role for user: ${n}`);const{data:s,error:o}=await He.from("user_roles").select("role").eq("user_id",n).maybeSingle();if(o)return console.error("Role Fetch Error:",o),"USER";const u=s?.role;if(console.log(`Role fetched: ${u||"USER (default)"}`),!s){console.log("No role found - creating default USER role");const{error:h}=await He.from("user_roles").insert({user_id:n,role:"USER"});return h&&console.error("Error creating default role:",h),"USER"}return u??"USER"}catch(s){return console.error("Role Fetch Error:",s),s instanceof Error&&console.error("Error details:",s.message),"USER"}}function hd(){const[n,s]=T.useState(null),[o,u]=T.useState(null),[h,f]=T.useState(!0),[m,w]=T.useState(null);T.useEffect(()=>{let A=!0,N;(async()=>{try{console.log("Fetching initial session...");const H=new Promise((G,B)=>{N=setTimeout(()=>{B(new Error("Session fetch timeout - defaulting to logged out"))},1e4)}),k=He.auth.getSession(),{data:{session:j},error:W}=await Promise.race([k,H]);if(clearTimeout(N),W)throw console.error("Session Fetch Error:",W),W;if(!A)return;if(console.log("Initial Session:",j?"Found":"Not Found"),j?.user){s(j.user);const G=await zs(j.user.id);A&&u(G)}else s(null),u(null)}catch(H){clearTimeout(N),console.error("Initial Session Fetch Error:",H),A&&(s(null),u(null),H instanceof Error&&!H.message.includes("timeout")&&w(H.message||"Failed to fetch initial session"))}finally{A&&(console.log("Setting loading to false"),f(!1))}})();const{data:{subscription:M}}=He.auth.onAuthStateChange(async(H,k)=>{if(console.log("Auth State Change Event:",H),!!A)if(s(k?.user??null),k?.user){const j=await zs(k.user.id);A&&u(j)}else u(null)});return()=>{A=!1,clearTimeout(N),M.unsubscribe()}},[]);const E=T.useCallback(async(A,N)=>{try{f(!0),w(null),console.log("Starting sign-in process...");const{data:I,error:M}=await He.auth.signInWithPassword({email:A,password:N});if(M)throw console.error("Sign-in error:",M),M;if(console.log("Sign-in successful, setting user..."),s(I.user),I.user){console.log("Fetching user role...");try{const H=zs(I.user.id),k=new Promise(W=>{setTimeout(()=>{console.log("Role fetch timeout - using default"),W("USER")},5e3)}),j=await Promise.race([H,k]);u(j),console.log("Sign-in process complete")}catch(H){console.error("Role fetch failed, using default:",H),u("USER")}}}catch(I){console.error("Sign-in Error:",I);const M=I.message||"Sign-in failed";throw w(M),s(null),u(null),I}finally{f(!1)}},[]),p=T.useCallback(async()=>{try{await He.auth.signOut(),s(null),u(null)}catch(A){console.error("Sign-out Error:",A),w(A.message||"Sign-out failed")}},[]);return{user:n,isAuthenticated:!!n,userRole:o,loading:h,error:m,signIn:E,signOut:p}}const bo=T.createContext(null);function Co(){const n=T.useContext(bo);if(!n)throw new Error("useAuthContext must be used within AuthProvider");return n}function fd({children:n}){const s=hd(),{user:o,isAuthenticated:u,userRole:h,loading:f,signIn:m,signOut:w}=s,[E,p]=T.useState(""),[A,N]=T.useState(""),[I,M]=T.useState(null),[H,k]=T.useState(!1),j=async G=>{G.preventDefault(),M(null),k(!0);try{await m(E,A)}catch(B){M("Invalid login credentials. Please try again."),console.error("Sign in error:",B)}finally{k(!1)}};if(f)return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:c.jsxs(tt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[c.jsx(qi,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Initializing secure session..."})]})});if(!u)return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:c.jsx(Qr,{className:"h-8 w-8 text-blue-600"})}),c.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Farm Management System"}),c.jsx("p",{className:"text-gray-600",children:"Secure access required to continue"})]}),c.jsxs("form",{onSubmit:G=>{j(G)},className:"space-y-4",children:[I&&c.jsxs("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 p-3 rounded-lg",children:[c.jsx(li,{className:"h-4 w-4"}),c.jsx("p",{className:"text-sm",children:I})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),c.jsx("input",{id:"email",type:"email",value:E,onChange:G=>p(G.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{id:"password",type:"password",value:A,onChange:G=>N(G.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsx(tt.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:H,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50",children:H?c.jsx(qi,{className:"h-5 w-5 animate-spin"}):c.jsxs(c.Fragment,{children:[c.jsx(Ul,{className:"h-5 w-5"}),c.jsx("span",{children:"Sign In"})]})})]}),c.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:c.jsx("p",{children:"Secure authentication powered by Supabase"})})]})});const W=async()=>{try{await w()}catch(G){console.error("Sign out error:",G)}};return c.jsx(bo.Provider,{value:s,children:c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center h-16",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(Qr,{className:"h-6 w-6 text-blue-600"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Farm Management System"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[c.jsx(ci,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-gray-700",children:o?.email?.split("@")[0]??"User"}),c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h==="ADMIN"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:h??"USER"})]}),c.jsx("button",{onClick:()=>{W()},className:"text-gray-500 hover:text-gray-700 p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Sign Out",children:c.jsx(zl,{className:"h-4 w-4"})})]})]})})}),c.jsx("div",{className:"pt-0",children:n})]})})}function gd(){const{isAuthenticated:n,userRole:s}=Co(),o=m=>n&&s===m,u=m=>n&&s&&m.includes(s),h=()=>o("ADMIN"),f=()=>o("USER");return{isAuthenticated:n,userRole:s,hasRole:o,hasAnyRole:u,isAdmin:h,isUser:f,canDelete:h(),canModifyUsers:h(),canAccessReports:h()||f(),canModifySettings:h(),canViewAuditLog:h()}}const xd=[{name:"Dashboard",href:"/dashboard",icon:Hl,requiredRole:null},{name:"Inventory",href:"/inventory",icon:Ht,requiredRole:null},{name:"Stock Items",href:"/stock-items",icon:Vl,requiredRole:null},{name:"Repairs",href:"/repairs",icon:ar,requiredRole:null},{name:"Jobs",href:"/jobs",icon:Zl,requiredRole:null},{name:"Inspections",href:"/inspections",icon:dn,requiredRole:null},{name:"Maintenance",href:"/maintenance",icon:dn,requiredRole:null},{name:"Fuel Management",href:"/fuel-management",icon:Kr,requiredRole:null},{name:"Settings",href:"/settings",icon:Xa,requiredRole:"ADMIN"}];function md(){const[n,s]=T.useState(!1),o=ur(),{user:u,userRole:h}=Co(),m=gd().isAdmin(),w=xd.filter(A=>A.requiredRole?A.requiredRole===h:!0),E=({item:A})=>{const N=o.pathname===A.href,I=A.icon;return c.jsxs(od,{to:A.href,onClick:()=>s(!1),className:`group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 ${N?"bg-blue-100 text-blue-700 shadow-sm":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"}`,children:[c.jsx(I,{className:`mr-3 h-5 w-5 transition-colors ${N?"text-blue-500":"text-gray-500 group-hover:text-gray-700"}`}),A.name,A.requiredRole==="ADMIN"&&c.jsx(Ps,{className:"ml-auto h-4 w-4 text-red-500"})]})},p=()=>c.jsxs("div",{className:"flex flex-col h-full",children:[c.jsxs("div",{className:"flex items-center px-4 py-6 border-b border-gray-200",children:[c.jsx(Qr,{className:"h-8 w-8 text-blue-600 mr-3"}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Farm Management"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Secure System"})]})]}),c.jsx("div",{className:"px-4 py-4 bg-gray-50 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${m?"bg-red-100":"bg-blue-100"}`,children:m?c.jsx(Ps,{className:"h-5 w-5 text-red-600"}):c.jsx($i,{className:"h-5 w-5 text-blue-600"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:u?.email?.split("@")[0]??"Guest"}),c.jsxs("p",{className:`text-xs truncate ${m?"text-red-600":"text-blue-600"}`,children:[h??"USER"," Access"]})]})]})}),c.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto",children:w.map(A=>c.jsx(E,{item:A},A.name))}),c.jsx("div",{className:"px-4 py-4 border-t border-gray-200",children:c.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[c.jsx("p",{children:"Secured by Supabase"}),c.jsx("p",{className:"mt-1",children:"Â© 2024 Farm Management System"})]})})]});return c.jsxs("div",{className:"flex h-screen bg-gray-50",children:[c.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:c.jsx("div",{className:"bg-white shadow-sm border-r border-gray-200",children:c.jsx(p,{})})}),c.jsx(qa,{children:n&&c.jsxs(c.Fragment,{children:[c.jsx(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 lg:hidden",onClick:()=>s(!1),children:c.jsx("div",{className:"absolute inset-0 bg-gray-600 opacity-75"})}),c.jsxs(tt.div,{initial:{x:-320},animate:{x:0},exit:{x:-320},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl lg:hidden",children:[c.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:c.jsx("button",{onClick:()=>s(!1),className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",children:c.jsx(On,{className:"h-6 w-6 text-white"})})}),c.jsx(p,{})]})]})}),c.jsxs("div",{className:"lg:pl-64 flex flex-col flex-1 min-h-0",children:[c.jsx("div",{className:"lg:hidden bg-white shadow-sm border-b border-gray-200 px-4 py-3",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("button",{onClick:()=>s(!0),className:"p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",children:c.jsx(Wl,{className:"h-6 w-6"})}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:u?.email?.split("@")[0]??"Guest"}),c.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${m?"bg-red-100":"bg-blue-100"}`,children:m?c.jsx(Ps,{className:"h-3 w-3 text-red-600"}):c.jsx($i,{className:"h-3 w-3 text-blue-600"})})]})]})}),c.jsx("main",{className:"flex-1 overflow-y-auto focus:outline-none",children:c.jsx("div",{className:"py-6",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx(qu,{})})})})]})]})}function pd(){const[n,s]=T.useState(!navigator.onLine);return T.useEffect(()=>{const o=()=>s(!1),u=()=>s(!0);return window.addEventListener("online",o),window.addEventListener("offline",u),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",u)}},[]),n}const yd=()=>{const[n,s]=T.useState([]),o=T.useCallback(E=>{const p=Math.random().toString(36).substr(2,9);s(A=>[...A,{...E,id:p}])},[]),u=T.useCallback(E=>{s(p=>p.filter(A=>A.id!==E))},[]),h=T.useCallback((E,p="")=>{o({type:"success",title:E,message:p})},[o]),f=T.useCallback((E,p="")=>{o({type:"error",title:E,message:p})},[o]),m=T.useCallback((E,p="")=>{o({type:"warning",title:E,message:p})},[o]),w=T.useCallback((E,p="")=>{o({type:"info",title:E,message:p})},[o]);return{toasts:n,addToast:o,removeToast:u,success:h,error:f,warning:m,info:w}};function an(n,s=!0){const[o,u]=T.useState({items:[],loading:!0,error:null,creating:!1,updating:!1,deleting:!1}),{success:h,error:f}=yd(),m=Nt[n.toUpperCase()]||n,w=T.useCallback(async()=>{try{u(W=>({...W,loading:!0,error:null}));const{data:k,error:j}=await He.from(m).select("*").order("created_at",{ascending:!1});if(j)throw j;u(W=>({...W,items:k||[],loading:!1}))}catch(k){const j=k instanceof Error?k.message:"Failed to fetch items";u(W=>({...W,error:j,loading:!1})),f("Error",j)}},[m,f]),E=T.useCallback(async k=>{try{u(G=>({...G,creating:!0,error:null}));const{data:j,error:W}=await He.from(m).insert([k]).select().single();if(W)throw W;return u(G=>({...G,items:[j,...G.items],creating:!1})),h("Success","Item created successfully"),j}catch(j){const W=j instanceof Error?j.message:"Failed to create item";return u(G=>({...G,error:W,creating:!1})),f("Error",W),null}},[m,h,f]),p=T.useCallback(async(k,j)=>{try{u(B=>({...B,updating:!0,error:null}));const{data:W,error:G}=await He.from(m).update({...j,updated_at:new Date().toISOString()}).eq("id",k).select().single();if(G)throw G;return u(B=>({...B,items:B.items.map(K=>K.id===k?W:K),updating:!1})),h("Success","Item updated successfully"),W}catch(W){const G=W instanceof Error?W.message:"Failed to update item";return u(B=>({...B,error:G,updating:!1})),f("Error",G),null}},[m,h,f]),A=T.useCallback(async k=>{try{u(W=>({...W,deleting:!0,error:null}));const{error:j}=await He.from(m).delete().eq("id",k);if(j)throw j;return u(W=>({...W,items:W.items.filter(G=>G.id!==k),deleting:!1})),h("Success","Item deleted successfully"),!0}catch(j){const W=j instanceof Error?j.message:"Failed to delete item";return u(G=>({...G,error:W,deleting:!1})),f("Error",W),!1}},[m,h,f]),N=T.useCallback(k=>o.items.find(j=>j.id===k),[o.items]),I=T.useCallback((k,j)=>{if(!k.trim())return o.items;const W=k.toLowerCase();return o.items.filter(G=>j.some(B=>{const K=G[B];return K&&String(K).toLowerCase().includes(W)}))},[o.items]),M=T.useCallback(k=>o.items.filter(k),[o.items]),H=T.useCallback(async()=>{await w()},[w]);return T.useEffect(()=>{if(w(),s){const k=He.channel(`${m}_changes`).on("postgres_changes",{event:"*",schema:"public",table:m},j=>{switch(j.eventType){case"INSERT":u(W=>({...W,items:[j.new,...W.items]}));break;case"UPDATE":u(W=>({...W,items:W.items.map(G=>G.id===j.new.id?j.new:G)}));break;case"DELETE":u(W=>({...W,items:W.items.filter(G=>G.id!==j.old.id)}));break}}).subscribe();return()=>{k.unsubscribe()}}},[w,m,s]),{...o,create:E,update:p,delete:A,refresh:H,getById:N,search:I,filter:M}}function wd(){const{items:n,loading:s}=an("inventory_items"),{items:o,loading:u}=an("repair_items"),{items:h,loading:f}=an("job_cards"),{items:m,loading:w}=an("maintenance_schedules"),[E,p]=T.useState([{name:"Total Inventory Items",value:"0",change:"+0%",changeType:"increase",icon:Ht},{name:"Active Repairs",value:"0",change:"+0%",changeType:"increase",icon:ar},{name:"Pending Jobs",value:"0",change:"+0%",changeType:"increase",icon:dn},{name:"Scheduled Maintenance",value:"0",change:"+0%",changeType:"increase",icon:qs}]),[A,N]=T.useState([]),I=s||u||f||w;T.useEffect(()=>{if(!I){const H=n.length,k=o.filter(re=>re.status==="in_progress"||re.status==="pending").length,j=h.filter(re=>re.status==="todo"||re.status==="in_progress").length,W=m.filter(re=>re.status==="scheduled"||re.status==="in_progress").length;p([{name:"Total Inventory Items",value:H.toString(),change:"+0%",changeType:"increase",icon:Ht},{name:"Active Repairs",value:k.toString(),change:"+0%",changeType:"increase",icon:ar},{name:"Pending Jobs",value:j.toString(),change:"+0%",changeType:"increase",icon:dn},{name:"Scheduled Maintenance",value:W.toString(),change:"+0%",changeType:"increase",icon:qs}]);const G=[];n.filter(re=>re.status==="low_stock"||re.status==="out_of_stock").slice(0,2).forEach(re=>{G.push({id:`inv-${re.id}`,type:"inventory",message:`${re.status==="out_of_stock"?"Out of stock":"Low stock"}: ${re.name}`,time:M(re.updated_at),status:(re.status==="out_of_stock","warning")})}),o.filter(re=>re.status==="completed").sort((re,$)=>new Date($.updated_at).getTime()-new Date(re.updated_at).getTime()).slice(0,2).forEach(re=>{G.push({id:`rep-${re.id}`,type:"repair",message:`Repair completed: ${re.equipment_name}`,time:M(re.updated_at),status:"success"})}),m.filter(re=>re.status==="scheduled").sort((re,$)=>new Date(re.next_due_date).getTime()-new Date($.next_due_date).getTime()).slice(0,2).forEach(re=>{const $=Math.ceil((new Date(re.next_due_date).getTime()-Date.now())/864e5);G.push({id:`mnt-${re.id}`,type:"maintenance",message:`${re.maintenance_type} scheduled for ${re.equipment_name} in ${$} days`,time:M(re.updated_at),status:"info"})}),N(G.slice(0,6))}},[n,o,h,m,I]);const M=H=>{const k=new Date(H),W=new Date().getTime()-k.getTime(),G=Math.floor(W/(1e3*60*60)),B=Math.floor(G/24);return G<1?"Just now":G<24?`${G} hour${G>1?"s":""} ago`:B===1?"1 day ago":B<7?`${B} days ago`:k.toLocaleDateString()};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:[c.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome to Farm Management"}),c.jsx("p",{className:"text-green-100",children:"Monitor your farm operations, track equipment, and manage resources efficiently."})]}),I?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading dashboard data..."})]})}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:E.map((H,k)=>{const j=H.icon;return c.jsx(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.1},className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(j,{className:"h-8 w-8 text-green-600"})}),c.jsx("div",{className:"ml-5 w-0 flex-1",children:c.jsxs("dl",{children:[c.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:H.name}),c.jsxs("dd",{className:"flex items-baseline",children:[c.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:H.value}),c.jsxs("div",{className:`
                        ml-2 flex items-baseline text-sm font-semibold
                        ${H.changeType==="increase"?"text-green-600":"text-red-600"}
                      `,children:[H.changeType==="increase"?c.jsx(ui,{className:"h-4 w-4 flex-shrink-0"}):c.jsx(Gl,{className:"h-4 w-4 flex-shrink-0"}),c.jsx("span",{className:"ml-1",children:H.change})]})]})]})})]})},H.name)})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsx(tt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-white rounded-lg shadow",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Activities"}),A.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx("p",{children:"No recent activities"}),c.jsx("p",{className:"text-sm mt-2",children:"Activity will appear here as you use the system"})]}):c.jsx("div",{className:"flow-root",children:c.jsx("ul",{className:"-mb-8",children:A.map((H,k)=>c.jsx("li",{children:c.jsxs("div",{className:"relative pb-8",children:[k!==A.length-1?c.jsx("span",{className:"absolute top-5 left-5 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"}):null,c.jsxs("div",{className:"relative flex items-start space-x-3",children:[c.jsx("div",{children:c.jsx("div",{className:`
                            relative px-1 py-1 rounded-full flex items-center justify-center
                            ${H.status==="success"?"bg-green-500":H.status==="warning"?"bg-yellow-500":"bg-blue-500"}
                          `,children:H.status==="success"?c.jsx(ls,{className:"h-5 w-5 text-white"}):H.status==="warning"?c.jsx(Hn,{className:"h-5 w-5 text-white"}):c.jsx(Jr,{className:"h-5 w-5 text-white"})})}),c.jsx("div",{className:"min-w-0 flex-1",children:c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-900",children:H.message}),c.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:H.time})]})})]})]})},H.id))})})]})}),c.jsx(tt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-white rounded-lg shadow",children:c.jsxs("div",{className:"p-6",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[c.jsx(Ht,{className:"h-8 w-8 text-green-600 mb-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Add Inventory"})]}),c.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[c.jsx(ar,{className:"h-8 w-8 text-blue-600 mb-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Create Repair"})]}),c.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[c.jsx(dn,{className:"h-8 w-8 text-purple-600 mb-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Schedule Job"})]}),c.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[c.jsx(Jr,{className:"h-8 w-8 text-orange-600 mb-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-900",children:"View Reports"})]})]})]})})]})]})]})}class bd{assets;fuelRecords;operatingSessions;constructor(s,o,u){this.assets=s,this.fuelRecords=o,this.operatingSessions=u}calculateFuelConsumptionRate(s){const o=s?this.operatingSessions.filter(f=>f.asset_id===s):this.operatingSessions,u=o.reduce((f,m)=>f+(m.fuel_consumed??0),0),h=o.reduce((f,m)=>f+(m.operating_hours??0),0);return h>0?u/h:0}calculateAverageFleetConsumption(){return this.calculateFuelConsumptionRate()}calculateEquipmentTypeAverages(){const s={};return[...new Set(this.assets.map(u=>u.type))].forEach(u=>{const f=this.assets.filter(p=>p.type===u).map(p=>p.id),m=this.operatingSessions.filter(p=>f.includes(p.asset_id)),w=m.reduce((p,A)=>p+(A.fuel_consumed??0),0),E=m.reduce((p,A)=>p+(A.operating_hours??0),0);s[u]=E>0?w/E:0}),s}calculateFuelCostPerHour(s){const o=this.calculateFuelConsumptionRate(s),u=this.getAverageFuelPrice();return o*u}calculateTotalEquipmentFuelCost(s){return(s?this.fuelRecords.filter(u=>u.asset_id===s):this.fuelRecords).reduce((u,h)=>u+h.cost,0)}calculateFuelCostPercentage(s){const o=this.calculateTotalEquipmentFuelCost();return s>0?o/s*100:0}calculateTaskSpecificConsumption(){const s=new Map;this.operatingSessions.forEach(u=>{const h=u.operator_notes?.split("-")[0]?.trim().toLowerCase()||"general operations",f=s.get(h)??{fuel:0,hours:0};s.set(h,{fuel:f.fuel+(u.fuel_consumed??0),hours:f.hours+(u.operating_hours??0)})});const o={};return s.forEach((u,h)=>{o[h]=u.hours>0?u.fuel/u.hours:0}),o}calculateOperatorEfficiency(){const s=new Map;this.operatingSessions.forEach(u=>{const h=this.assets.find(w=>w.id===u.asset_id),f=h?h.name:"Unknown Asset",m=s.get(f)??{fuel:0,hours:0};s.set(f,{fuel:m.fuel+(u.fuel_consumed??0),hours:m.hours+(u.operating_hours??0)})});const o={};return s.forEach((u,h)=>{o[h]=u.hours>0?u.fuel/u.hours:0}),o}calculateMonthlyTrends(){const s={};return this.operatingSessions.forEach(o=>{const u=new Date(o.session_start??o.created_at).toISOString().substring(0,7);s[u]||(s[u]={fuel:0,hours:0,cost:0}),s[u].fuel+=o.fuel_consumed??0,s[u].hours+=o.operating_hours??0}),this.fuelRecords.forEach(o=>{const u=new Date(o.created_at).toISOString().substring(0,7);s[u]&&(s[u].cost+=o.cost)}),Object.entries(s).map(([o,u])=>({month:o,consumption:u.hours>0?u.fuel/u.hours:0,cost:u.cost})).sort((o,u)=>o.month.localeCompare(u.month))}getAverageFuelPrice(){if(this.fuelRecords.length===0)return 0;const s=this.fuelRecords.reduce((u,h)=>u+h.cost,0),o=this.fuelRecords.reduce((u,h)=>u+h.quantity,0);return o>0?s/o:0}calculateAllKPIs(s=1e6){const o=this.operatingSessions.reduce((f,m)=>f+(m.operating_hours??0),0),u=this.operatingSessions.reduce((f,m)=>f+(m.fuel_consumed??0),0),h=this.calculateTotalEquipmentFuelCost();return{consumption:{fuelConsumptionRate:this.calculateFuelConsumptionRate(),averageFleetConsumption:this.calculateAverageFleetConsumption(),equipmentTypeAverages:this.calculateEquipmentTypeAverages()},cost:{fuelCostPerHour:this.calculateFuelCostPerHour(),totalEquipmentFuelCost:h,fuelCostPercentage:this.calculateFuelCostPercentage(s)},performance:{taskSpecificConsumption:this.calculateTaskSpecificConsumption(),operatorEfficiency:this.calculateOperatorEfficiency(),monthlyTrends:this.calculateMonthlyTrends()},totalOperatingHours:o,totalFuelConsumed:u,totalFuelCost:h}}}const Ar=n=>`${n.toFixed(2)} L/H`,Hs=n=>`$${n.toFixed(2)}`,Cd=n=>`${n.toFixed(1)}%`,Ad=n=>`${n.toFixed(1)} hrs`,Nr=n=>{if(n==null)return 0;if(typeof n=="number")return n;const s=Number(n);return Number.isNaN(s)?0:s},zn=n=>n==null?null:Nr(n),Ce=n=>n??null,Vs=n=>({id:n.id,name:n.name,type:n.type,model:Ce(n.model),serial_number:Ce(n.serial_number),purchase_date:Ce(n.purchase_date),status:n.status,location:Ce(n.location),current_hours:Ce(n.current_hours),fuel_capacity:zn(n.fuel_capacity),fuel_type:Ce(n.fuel_type),barcode:Ce(n.barcode),qr_code:Ce(n.qr_code),notes:Ce(n.notes),created_at:n.created_at,updated_at:n.updated_at}),Zs=n=>({id:n.id,asset_id:n.asset_id,date:n.date,quantity:Nr(n.quantity),price_per_liter:Nr(n.price_per_liter),cost:Nr(n.cost),fuel_type:n.fuel_type,location:n.location,odometer_reading:Ce(n.odometer_reading),receipt_number:Ce(n.receipt_number),fuel_grade:Ce(n.fuel_grade),notes:Ce(n.notes),weather_conditions:Ce(n.weather_conditions),operator_id:Ce(n.operator_id),created_at:n.created_at,updated_at:n.updated_at}),Ws=n=>({id:n.id,asset_id:n.asset_id,session_start:n.session_start,session_end:Ce(n.session_end),initial_fuel_level:zn(n.initial_fuel_level),final_fuel_level:zn(n.final_fuel_level),fuel_consumed:zn(n.fuel_consumed),distance_traveled:zn(n.distance_traveled),operating_hours:zn(n.operating_hours),efficiency_rating:zn(n.efficiency_rating),operator_notes:Ce(n.operator_notes),created_at:n.created_at,updated_at:n.updated_at}),oa=n=>({id:n.id,fuel_type:n.fuel_type,price_per_liter:Nr(n.price_per_liter),effective_date:n.effective_date,location:Ce(n.location),supplier:Ce(n.supplier),created_at:n.created_at,updated_at:n.updated_at}),la=n=>({name:n.name,type:n.type,model:Ce(n.model),serial_number:Ce(n.serial_number),purchase_date:Ce(n.purchase_date),status:n.status,location:Ce(n.location),current_hours:n.current_hours??null,fuel_capacity:n.fuel_capacity??null,fuel_type:Ce(n.fuel_type),barcode:Ce(n.barcode),qr_code:Ce(n.qr_code),notes:Ce(n.notes)}),ca=n=>({asset_id:n.asset_id,date:n.date,quantity:n.quantity,price_per_liter:n.price_per_liter,fuel_type:n.fuel_type,location:n.location,odometer_reading:n.odometer_reading??null,receipt_number:Ce(n.receipt_number),fuel_grade:Ce(n.fuel_grade),notes:Ce(n.notes),weather_conditions:Ce(n.weather_conditions),operator_id:Ce(n.operator_id)}),ua=n=>({asset_id:n.asset_id,session_start:n.session_start,session_end:Ce(n.session_end),initial_fuel_level:n.initial_fuel_level??null,final_fuel_level:n.final_fuel_level??null,fuel_consumed:n.fuel_consumed??null,distance_traveled:n.distance_traveled??null,operating_hours:n.operating_hours??null,efficiency_rating:n.efficiency_rating??null,operator_notes:Ce(n.operator_notes)}),Nd=n=>({fuel_type:n.fuel_type,price_per_liter:n.price_per_liter,effective_date:n.effective_date,location:Ce(n.location),supplier:Ce(n.supplier)}),Ao=()=>{const[n,s]=T.useState([]),[o,u]=T.useState([]),[h,f]=T.useState([]),[m,w]=T.useState([]),[E,p]=T.useState(!0),[A,N]=T.useState(null),I=T.useCallback(async()=>{p(!0);try{const[X,te,ce,z]=await Promise.all([He.from(Nt.ASSETS).select("*").order("created_at",{ascending:!1}),He.from(Nt.FUEL_RECORDS).select("*").order("date",{ascending:!1}),He.from(Nt.OPERATING_SESSIONS).select("*").order("session_start",{ascending:!1}),He.from(Nt.FUEL_PRICES).select("*").order("effective_date",{ascending:!1})]);if(X.error)throw X.error;if(te.error)throw te.error;if(ce.error)throw ce.error;if(z.error)throw z.error;const Me=X.data??[],de=te.data??[],on=ce.data??[],Lt=z.data??[],Et=Me.map(Vs),gn=de.map(Zs),Ke=on.map(Ws),Wt=Lt.map(oa);if(s(Et),u(gn),f(Ke),w(Wt),Et.length||gn.length||Ke.length){const it=new bd(Et,gn,Ke);N(it.calculateAllKPIs())}else N(null)}catch(X){console.error("Failed to fetch fuel data:",X),et.error("Failed to load fuel data")}finally{p(!1)}},[]);T.useEffect(()=>{I()},[I]);const M=T.useCallback(async X=>{const te=await He.from(Nt.ASSETS).insert([la(X)]).select("*").single();if(te.error)throw console.error("Failed to create asset:",te.error),et.error("Failed to create asset"),te.error;const ce=Vs(te.data);return s(z=>[ce,...z]),et.success("Asset created successfully"),ce},[]),H=T.useCallback(async(X,te)=>{const ce=await He.from(Nt.ASSETS).update({...la(te),updated_at:new Date().toISOString()}).eq("id",X).select("*").single();if(ce.error)throw console.error("Failed to update asset:",ce.error),et.error("Failed to update asset"),ce.error;const z=Vs(ce.data);return s(Me=>Me.map(de=>de.id===X?z:de)),et.success("Asset updated successfully"),z},[]),k=T.useCallback(async X=>{const{error:te}=await He.from(Nt.ASSETS).delete().eq("id",X);if(te)throw console.error("Failed to delete asset:",te),et.error("Failed to delete asset"),te;s(ce=>ce.filter(z=>z.id!==X)),et.success("Asset deleted successfully")},[]),j=T.useCallback(async X=>{const te=await He.from(Nt.FUEL_RECORDS).insert([ca(X)]).select("*").single();if(te.error)throw console.error("Failed to create fuel record:",te.error),et.error("Failed to create fuel record"),te.error;const ce=Zs(te.data);return u(z=>[ce,...z]),et.success("Fuel record created successfully"),await I(),ce},[I]),W=T.useCallback(async(X,te)=>{const ce=await He.from(Nt.FUEL_RECORDS).update({...ca(te),updated_at:new Date().toISOString()}).eq("id",X).select("*").single();if(ce.error)throw console.error("Failed to update fuel record:",ce.error),et.error("Failed to update fuel record"),ce.error;const z=Zs(ce.data);return u(Me=>Me.map(de=>de.id===X?z:de)),et.success("Fuel record updated successfully"),await I(),z},[I]),G=T.useCallback(async X=>{const{error:te}=await He.from(Nt.FUEL_RECORDS).delete().eq("id",X);if(te)throw console.error("Failed to delete fuel record:",te),et.error("Failed to delete fuel record"),te;u(ce=>ce.filter(z=>z.id!==X)),et.success("Fuel record deleted successfully"),await I()},[I]),B=T.useCallback(async X=>{const te=await He.from(Nt.OPERATING_SESSIONS).insert([ua(X)]).select("*").single();if(te.error)throw console.error("Failed to create operating session:",te.error),et.error("Failed to create operating session"),te.error;const ce=Ws(te.data);return f(z=>[ce,...z]),et.success("Operating session created successfully"),await I(),ce},[I]),K=T.useCallback(async(X,te)=>{const ce=await He.from(Nt.OPERATING_SESSIONS).update({...ua(te),updated_at:new Date().toISOString()}).eq("id",X).select("*").single();if(ce.error)throw console.error("Failed to update operating session:",ce.error),et.error("Failed to update operating session"),ce.error;const z=Ws(ce.data);return f(Me=>Me.map(de=>de.id===X?z:de)),et.success("Operating session updated successfully"),await I(),z},[I]),we=T.useCallback(async X=>{const{error:te}=await He.from(Nt.OPERATING_SESSIONS).delete().eq("id",X);if(te)throw console.error("Failed to delete operating session:",te),et.error("Failed to delete operating session"),te;f(ce=>ce.filter(z=>z.id!==X)),et.success("Operating session deleted successfully"),await I()},[I]),re=T.useCallback(async X=>{const te=await He.from(Nt.FUEL_PRICES).insert([Nd(X)]).select("*").single();if(te.error)throw console.error("Failed to create fuel price:",te.error),et.error("Failed to create fuel price"),te.error;const ce=oa(te.data);return w(z=>[ce,...z]),et.success("Fuel price record created successfully"),ce},[]),$=T.useCallback(X=>n.filter(te=>te.type===X),[n]),U=T.useCallback(()=>n.filter(X=>X.status==="active"),[n]),L=T.useCallback(X=>o.filter(te=>te.asset_id===X),[o]),Oe=T.useCallback(X=>h.filter(te=>te.asset_id===X),[h]),R=T.useMemo(()=>({assetCount:n.length,fuelRecordCount:o.length,sessionCount:h.length,fuelPriceCount:m.length}),[n.length,m.length,o.length,h.length]);return{assets:n,fuelRecords:o,operatingSessions:h,fuelPrices:m,kpis:A,loading:E,stats:R,fetchAllData:I,createAsset:M,updateAsset:H,deleteAsset:k,createFuelRecord:j,updateFuelRecord:W,deleteFuelRecord:G,createOperatingSession:B,updateOperatingSession:K,deleteOperatingSession:we,createFuelPrice:re,getAssetsByType:$,getActiveAssets:U,getFuelRecordsByAsset:L,getSessionsByAsset:Oe}},Ed=()=>{const{kpis:n,assets:s,loading:o}=Ao();if(o)return c.jsxs("div",{className:"flex items-center justify-center h-64",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),c.jsx("span",{className:"ml-3 text-gray-600",children:"Loading fuel analytics..."})]});if(!n)return c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Kr,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No fuel data available"}),c.jsx("p",{className:"text-gray-500",children:"Add assets and fuel records to see analytics."})]});const u=s.reduce((h,f)=>(h[f.type]=(h[f.type]||0)+1,h),{});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fuel Management Dashboard"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive fuel consumption and cost analytics"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Kr,{className:"h-8 w-8 text-blue-600"}),c.jsxs("div",{className:"ml-4",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Fleet Fuel Consumption"}),c.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Ar(n.consumption.averageFleetConsumption)})]})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Yl,{className:"h-8 w-8 text-green-600"}),c.jsxs("div",{className:"ml-4",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Fuel Cost per Hour"}),c.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Hs(n.cost.fuelCostPerHour)})]})]})}),c.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(ui,{className:"h-8 w-8 text-purple-600"}),c.jsxs("div",{className:"ml-4",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Fuel Cost"}),c.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Hs(n.totalFuelCost)})]})]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[c.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Vn,{className:"h-6 w-6 text-orange-600"}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Operating Hours"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:Ad(n.totalOperatingHours)})]})]})}),c.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(qs,{className:"h-6 w-6 text-red-600"}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Fuel Consumed"}),c.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[n.totalFuelConsumed.toFixed(1)," L"]})]})]})}),c.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Jr,{className:"h-6 w-6 text-indigo-600"}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Fuel Cost %"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:Cd(n.cost.fuelCostPercentage)})]})]})}),c.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx($a,{className:"h-6 w-6 text-cyan-600"}),c.jsxs("div",{className:"ml-3",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Active Assets"}),c.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.filter(h=>h.status==="active").length})]})]})})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Equipment Type Fuel Efficiency"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(n.consumption.equipmentTypeAverages).map(([h,f])=>c.jsx("div",{className:"border rounded-lg p-4",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"text-sm font-medium text-gray-600 capitalize",children:[h,"s"]}),c.jsx("p",{className:"text-xl font-bold text-gray-900",children:Ar(f)})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-xs text-gray-500",children:"Count"}),c.jsx("p",{className:"text-lg font-semibold text-blue-600",children:u[h]||0})]})]})},h))})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Task-Specific Fuel Consumption"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:Object.entries(n.performance.taskSpecificConsumption).map(([h,f])=>c.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize mb-2",children:h}),c.jsx("p",{className:"text-lg font-bold text-gray-900",children:Ar(f)}),c.jsx("div",{className:"mt-2 bg-blue-100 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(f/Math.max(...Object.values(n.performance.taskSpecificConsumption))*100,100)}%`}})})]},h))})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Operator Fuel Efficiency"}),c.jsx("div",{className:"space-y-3",children:Object.entries(n.performance.operatorEfficiency).sort(([,h],[,f])=>h-f).map(([h,f])=>c.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:h.charAt(0).toUpperCase()}),c.jsx("span",{className:"ml-3 font-medium text-gray-900",children:h})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("span",{className:"text-lg font-semibold text-gray-900",children:Ar(f)}),c.jsx("div",{className:"text-xs text-gray-500",children:f<=Math.min(...Object.values(n.performance.operatorEfficiency))*1.1?"Most Efficient":"Needs Improvement"})]})]},h))})]}),c.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Fuel Trends"}),n.performance.monthlyTrends.length>0?c.jsx("div",{className:"space-y-4",children:n.performance.monthlyTrends.map(h=>c.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(dn,{className:"h-5 w-5 text-gray-400 mr-3"}),c.jsx("span",{className:"font-medium text-gray-900",children:new Date(h.month+"-01").toLocaleDateString("en-US",{year:"numeric",month:"long"})})]}),c.jsxs("div",{className:"flex space-x-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Consumption"}),c.jsx("p",{className:"text-lg font-semibold text-blue-600",children:Ar(h.consumption)})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Cost"}),c.jsx("p",{className:"text-lg font-semibold text-green-600",children:Hs(h.cost)})]})]})]},h.month))}):c.jsx("p",{className:"text-gray-500 text-center py-8",children:"No monthly trend data available yet."})]})]})},vd=({isOpen:n,onClose:s,onSave:o,asset:u})=>{const[h,f]=T.useState({name:u?.name||"",type:u?.type||"tractor",fuel_type:u?.fuel_type||"diesel",fuel_capacity:u?.fuel_capacity||0,model:u?.model||"",serial_number:u?.serial_number||"",purchase_date:u?.purchase_date||"",status:u?.status||"active",location:u?.location||"",current_hours:u?.current_hours||0,barcode:u?.barcode||"",qr_code:u?.qr_code||"",notes:u?.notes||""}),[m,w]=T.useState(!1),E=A=>{A.preventDefault(),w(!0),(async()=>{try{await o({...h,id:u?.id||"",created_at:u?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}),s()}catch(N){console.error("Failed to save asset:",N)}finally{w(!1)}})()},p=A=>{const{name:N,value:I}=A.target;f(M=>({...M,[N]:N==="fuel_capacity"||N==="current_hours"?Number(I):I}))};return n?c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:s}),c.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[u?c.jsx(Er,{className:"h-6 w-6 text-blue-600 mr-2"}):c.jsx(Vt,{className:"h-6 w-6 text-green-600 mr-2"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:u?"Edit Asset":"Add New Asset"})]}),c.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:c.jsx(On,{className:"h-6 w-6"})})]}),c.jsxs("form",{onSubmit:E,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset Name *"}),c.jsx("input",{type:"text",name:"name",value:h.name,onChange:p,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., John Deere 6120M"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Equipment Type *"}),c.jsxs("select",{name:"type",value:h.type,onChange:p,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"tractor",children:"Tractor"}),c.jsx("option",{value:"forklift",children:"Forklift"}),c.jsx("option",{value:"motorbike",children:"Motorbike"}),c.jsx("option",{value:"generator",children:"Generator"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Type *"}),c.jsxs("select",{name:"fuel_type",value:h.fuel_type,onChange:p,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"diesel",children:"Diesel"}),c.jsx("option",{value:"petrol",children:"Petrol"}),c.jsx("option",{value:"electric",children:"Electric"}),c.jsx("option",{value:"hybrid",children:"Hybrid"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Capacity (Liters)"}),c.jsx("input",{type:"number",name:"fuel_capacity",value:h.fuel_capacity??"",onChange:p,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"280"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Serial Number"}),c.jsx("input",{type:"text",name:"serial_number",value:h.serial_number??"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"SN-123456"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),c.jsx("input",{type:"text",name:"model",value:h.model??"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"6120M"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Date"}),c.jsx("input",{type:"date",name:"purchase_date",value:h.purchase_date??"",onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),c.jsxs("select",{name:"status",value:h.status,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"active",children:"Active"}),c.jsx("option",{value:"maintenance",children:"Maintenance"}),c.jsx("option",{value:"retired",children:"Retired"}),c.jsx("option",{value:"out_of_service",children:"Out of Service"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),c.jsx("input",{type:"text",name:"location",value:h.location,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Field A"})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"submit",disabled:m,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:m?"Saving...":u?"Update Asset":"Create Asset"}),c.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]})}):null},_d=({isOpen:n,onClose:s,onSave:o,assets:u,record:h})=>{const[f,m]=T.useState({asset_id:h?.asset_id||"",quantity:h?.quantity||0,cost:h?.cost||0,price_per_liter:h?.price_per_liter||0,fuel_type:h?.fuel_type||"diesel",location:h?.location||"",receipt_number:h?.receipt_number||"",odometer_reading:h?.odometer_reading||0,notes:h?.notes||"",fuel_grade:h?.fuel_grade||"",weather_conditions:h?.weather_conditions||"",operator_id:h?.operator_id||""}),[w,E]=T.useState(!1),p=I=>{I.preventDefault(),E(!0),(async()=>{try{await o({...f,id:h?.id||"",date:h?.date||new Date().toISOString(),created_at:h?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}),s()}catch(M){console.error("Failed to save fuel record:",M)}finally{E(!1)}})()},A=I=>{const{name:M,value:H}=I.target;let k=H;["quantity","cost","price_per_liter","odometer_reading"].includes(M)&&(k=Number(H)||0),m(j=>{const W={...j,[M]:k};return M==="quantity"||M==="price_per_liter"?W.cost=W.quantity*W.price_per_liter:M==="cost"&&W.quantity>0&&(W.price_per_liter=W.cost/W.quantity),W})},N=u.find(I=>I.id===f.asset_id);return n?c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:s}),c.jsxs("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[h?c.jsx(Er,{className:"h-6 w-6 text-blue-600 mr-2"}):c.jsx(Vt,{className:"h-6 w-6 text-green-600 mr-2"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:h?"Edit Fuel Record":"Add Fuel Record"})]}),c.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:c.jsx(On,{className:"h-6 w-6"})})]}),c.jsxs("form",{onSubmit:p,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset *"}),c.jsxs("select",{name:"asset_id",value:f.asset_id,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select Asset"}),u.map(I=>c.jsxs("option",{value:I.id,children:[I.name," (",I.type,")"]},I.id))]}),N&&c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[N.type," â¢ ",N.fuel_type," â¢ Tank: ",N.fuel_capacity??"N/A","L"]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Type *"}),c.jsxs("select",{name:"fuel_type",value:f.fuel_type,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"diesel",children:"Diesel"}),c.jsx("option",{value:"petrol",children:"Petrol"}),c.jsx("option",{value:"lpg",children:"LPG"}),c.jsx("option",{value:"electric",children:"Electric"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity (L) *"}),c.jsx("input",{type:"number",name:"quantity",value:f.quantity,onChange:A,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"50.0"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price per Liter *"}),c.jsx("input",{type:"number",name:"price_per_liter",value:f.price_per_liter,onChange:A,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"1.50"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Cost *"}),c.jsx("input",{type:"number",name:"cost",value:f.cost,onChange:A,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"75.00"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Auto-calculated: ",(f.quantity*f.price_per_liter).toFixed(2)]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),c.jsx("input",{type:"text",name:"location",value:f.location,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Shell Station"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operating Hours"}),c.jsx("input",{type:"number",name:"odometer_reading",value:f.odometer_reading,onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"1250.5"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Number"}),c.jsxs("div",{className:"relative",children:[c.jsx(Xl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",name:"receipt_number",value:f.receipt_number,onChange:A,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"SH-20240115-001"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),c.jsx("textarea",{name:"notes",value:f.notes,onChange:A,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Additional notes..."})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"submit",disabled:w,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:w?"Saving...":h?"Update Record":"Create Record"}),c.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]})}):null},Sd=({isOpen:n,onClose:s,onSave:o,assets:u,session:h})=>{const[f,m]=T.useState({asset_id:h?.asset_id||"",session_start:h?.session_start?h.session_start.slice(0,16):"",session_end:h?.session_end?h.session_end.slice(0,16):"",operating_hours:h?.operating_hours||null,fuel_consumed:h?.fuel_consumed||null,initial_fuel_level:h?.initial_fuel_level||null,final_fuel_level:h?.final_fuel_level||null,distance_traveled:h?.distance_traveled||null,efficiency_rating:h?.efficiency_rating||null,operator_notes:h?.operator_notes||""}),[w,E]=T.useState(!1),p=async I=>{I.preventDefault(),E(!0);try{await o({...f,session_start:new Date(f.session_start).toISOString(),session_end:f.session_end?new Date(f.session_end).toISOString():null,created_at:h?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}),s()}catch(M){console.error("Failed to save operating session:",M)}finally{E(!1)}},A=I=>{const{name:M,value:H}=I.target;let k=H;["operating_hours","fuel_consumed","initial_fuel_level","final_fuel_level","distance_traveled","efficiency_rating"].includes(M)&&(k=H?Number(H):null),m(j=>{const W={...j,[M]:k};if((M==="session_start"||M==="session_end")&&W.session_start&&W.session_end){const G=new Date(W.session_start),B=new Date(W.session_end);B>G&&(W.operating_hours=(B.getTime()-G.getTime())/(1e3*60*60))}return W})},N=u.find(I=>I.id===f.asset_id);return n?c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:s}),c.jsxs("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[h?c.jsx(Er,{className:"h-6 w-6 text-blue-600 mr-2"}):c.jsx(Vt,{className:"h-6 w-6 text-green-600 mr-2"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:h?"Edit Operating Session":"Add Operating Session"})]}),c.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:c.jsx(On,{className:"h-6 w-6"})})]}),c.jsxs("form",{onSubmit:I=>{I.preventDefault(),p(I)},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset *"}),c.jsxs("select",{name:"asset_id",value:f.asset_id,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select Asset"}),u.map(I=>c.jsxs("option",{value:I.id,children:[I.name," (",I.id,")"]},I.id))]}),N&&c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[N.type," â¢ ",N.fuel_type]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time *"}),c.jsx("input",{type:"datetime-local",name:"session_start",value:f.session_start,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time *"}),c.jsx("input",{type:"datetime-local",name:"session_end",value:f.session_end,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operating Hours"}),c.jsxs("div",{className:"relative",children:[c.jsx(Vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"number",name:"operating_hours",value:f.operating_hours||"",onChange:A,min:"0",step:"0.1",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"8.0"})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Auto-calculated from start/end times"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Consumed (L)"}),c.jsx("input",{type:"number",name:"fuel_consumed",value:f.fuel_consumed||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"45.2"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Distance Traveled (km)"}),c.jsx("input",{type:"number",name:"distance_traveled",value:f.distance_traveled||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"25.5"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Initial Fuel Level (L)"}),c.jsx("input",{type:"number",name:"initial_fuel_level",value:f.initial_fuel_level||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"100.0"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Final Fuel Level (L)"}),c.jsx("input",{type:"number",name:"final_fuel_level",value:f.final_fuel_level||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"54.8"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Efficiency Rating (1-5)"}),c.jsxs("select",{name:"efficiency_rating",value:f.efficiency_rating||"",onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Not Rated"}),c.jsx("option",{value:1,children:"1 - Poor"}),c.jsx("option",{value:2,children:"2 - Below Average"}),c.jsx("option",{value:3,children:"3 - Average"}),c.jsx("option",{value:4,children:"4 - Good"}),c.jsx("option",{value:5,children:"5 - Excellent"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operator Notes"}),c.jsx("textarea",{name:"operator_notes",value:f.operator_notes,onChange:A,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Session notes..."})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"submit",disabled:w,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:w?"Saving...":h?"Update Session":"Create Session"}),c.jsx("button",{type:"button",onClick:s,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]})}):null},Id=()=>{const{assets:n,fuelRecords:s,operatingSessions:o,loading:u,createAsset:h,updateAsset:f,deleteAsset:m,createFuelRecord:w,updateFuelRecord:E,deleteFuelRecord:p,createOperatingSession:A,updateOperatingSession:N,deleteOperatingSession:I}=Ao(),[M,H]=T.useState("dashboard"),[k,j]=T.useState(!1),[W,G]=T.useState(!1),[B,K]=T.useState(!1),[we,re]=T.useState(null),[$,U]=T.useState(null),[L,Oe]=T.useState(null),[R,X]=T.useState(""),[te,ce]=T.useState("all"),z=[{id:"dashboard",label:"Dashboard",icon:Jr},{id:"assets",label:"Assets",icon:ql},{id:"fuel-records",label:"Fuel Records",icon:Kr},{id:"sessions",label:"Operating Sessions",icon:Vn}],Me=ne=>{re(ne),j(!0)},de=ne=>{U(ne),G(!0)},on=ne=>{Oe(ne),K(!0)},Lt=async(ne,oe)=>{confirm(`Are you sure you want to delete ${oe}?`)&&await m(ne)},Et=async ne=>{confirm("Are you sure you want to delete this fuel record?")&&await p(ne)},gn=async ne=>{confirm("Are you sure you want to delete this operating session?")&&await I(ne)},Ke=n.filter(ne=>{const oe=ne.name.toLowerCase().includes(R.toLowerCase())||ne.id.toLowerCase().includes(R.toLowerCase()),Mt=te==="all"||ne.type===te;return oe&&Mt}),Wt=s.filter(ne=>n.find(Fe=>Fe.id===ne.asset_id)?.name.toLowerCase().includes(R.toLowerCase())||ne.location?.toLowerCase().includes(R.toLowerCase())),it=o.filter(ne=>n.find(Fe=>Fe.id===ne.asset_id)?.name.toLowerCase().includes(R.toLowerCase())||ne.operator_notes?.toLowerCase().includes(R.toLowerCase()));return u?c.jsxs("div",{className:"flex items-center justify-center h-64",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),c.jsx("span",{className:"ml-3 text-gray-600",children:"Loading fuel management system..."})]}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fuel Management System"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive fuel tracking and analytics for farm equipment"})]})}),c.jsx("div",{className:"border-b border-gray-200",children:c.jsx("nav",{className:"-mb-px flex space-x-8",children:z.map(ne=>{const oe=ne.icon;return c.jsxs("button",{onClick:()=>H(ne.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm transition-colors ${M===ne.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[c.jsx(oe,{className:"h-5 w-5 mr-2"}),ne.label]},ne.id)})})}),M==="dashboard"&&c.jsx(Ed,{}),M==="assets"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search assets...",value:R,onChange:ne=>X(ne.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("select",{value:te,onChange:ne=>ce(ne.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Types"}),c.jsx("option",{value:"tractor",children:"Tractors"}),c.jsx("option",{value:"forklift",children:"Forklifts"}),c.jsx("option",{value:"motorbike",children:"Motorbikes"}),c.jsx("option",{value:"generator",children:"Generators"})]}),c.jsxs("button",{onClick:()=>{re(null),j(!0)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Add Asset"]})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Ke.map(ne=>c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ne.name}),c.jsx("p",{className:"text-sm text-gray-500",children:ne.id})]}),c.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ne.status==="active"?"bg-green-100 text-green-800":ne.status==="maintenance"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ne.status})]}),c.jsxs("div",{className:"space-y-2 mb-4",children:[c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Type:"}),c.jsx("span",{className:"font-medium capitalize",children:ne.type})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Fuel Type:"}),c.jsx("span",{className:"font-medium capitalize",children:ne.fuel_type})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Tank Capacity:"}),c.jsxs("span",{className:"font-medium",children:[ne.fuel_capacity??"N/A","L"]})]}),c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Location:"}),c.jsx("span",{className:"font-medium",children:ne.location})]})]}),"                ",c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>Me(ne),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition-colors",children:[c.jsx(Er,{className:"h-4 w-4 inline mr-1"}),"Edit"]}),c.jsxs("button",{onClick:()=>void Lt(ne.id,ne.name),className:"flex-1 bg-red-600 text-white py-2 px-3 rounded text-sm hover:bg-red-700 transition-colors",children:[c.jsx($s,{className:"h-4 w-4 inline mr-1"}),"Delete"]})]})]},ne.id))})]}),M==="fuel-records"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search fuel records...",value:R,onChange:ne=>X(ne.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("button",{onClick:()=>{U(null),G(!0)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Add Record"]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asset"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fuel Type"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Wt.map(ne=>{const oe=n.find(Mt=>Mt.id===ne.asset_id);return c.jsxs("tr",{children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-gray-900",children:oe?.name}),c.jsx("div",{className:"text-sm text-gray-500",children:ne.asset_id})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full capitalize",children:ne.fuel_type})}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[ne.quantity.toFixed(1),"L"]}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",ne.cost.toFixed(2)]}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ne.location||"N/A"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ne.date).toLocaleDateString()}),c.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[c.jsx("button",{onClick:()=>de(ne),className:"text-blue-600 hover:text-blue-900",children:"Edit"}),c.jsx("button",{onClick:()=>void Et(ne.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},ne.id)})})]})})})]}),M==="sessions"&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search sessions...",value:R,onChange:ne=>X(ne.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("button",{onClick:()=>{Oe(null),K(!0)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Add Session"]})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:it.map(ne=>{const oe=n.find(xn=>xn.id===ne.asset_id),Mt=ne.operating_hours??0,Fe=ne.fuel_consumed??0,Rn=Mt>0?Fe/Mt:0;return c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:oe?.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Session ID: ",ne.id.slice(0,8)]})]}),c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Operating"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Operating Hours"}),c.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Mt.toFixed(1),"h"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Fuel Consumed"}),c.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Fe.toFixed(1),"L"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Efficiency Rating"}),c.jsxs("div",{className:"flex items-center",children:[c.jsxs("span",{className:"text-lg font-semibold text-gray-900 mr-2",children:[ne.efficiency_rating??0,"/5"]}),c.jsx("div",{className:"flex",children:Array.from({length:5}).map((xn,ft)=>c.jsx("div",{className:`w-3 h-3 rounded-full mr-1 ${ft<(ne.efficiency_rating??0)?"bg-yellow-400":"bg-gray-200"}`},ft))})]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Consumption Rate"}),c.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Rn.toFixed(2)," L/H"]})]})]}),c.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[c.jsxs("p",{children:[new Date(ne.session_start).toLocaleString()," - ",ne.session_end?new Date(ne.session_end).toLocaleString():"Ongoing"]}),ne.operator_notes&&c.jsxs("p",{children:["Notes: ",ne.operator_notes]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>on(ne),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition-colors",children:[c.jsx(Er,{className:"h-4 w-4 inline mr-1"}),"Edit"]}),c.jsxs("button",{onClick:()=>void gn(ne.id),className:"flex-1 bg-red-600 text-white py-2 px-3 rounded text-sm hover:bg-red-700 transition-colors",children:[c.jsx($s,{className:"h-4 w-4 inline mr-1"}),"Delete"]})]})]},ne.id)})})]}),c.jsx(vd,{isOpen:k,onClose:()=>{j(!1),re(null)},onSave:async ne=>{we?await f(we.id,ne):await h(ne)},asset:we}),c.jsx(_d,{isOpen:W,onClose:()=>{G(!1),U(null)},onSave:async ne=>{$?await E($.id,ne):await w(ne)},assets:n,record:$}),c.jsx(Sd,{isOpen:B,onClose:()=>{K(!1),Oe(null)},onSave:async ne=>{L?await N(L.id,ne):await A(ne)},assets:n,session:L})]})};function Or({isOpen:n,onClose:s,title:o,size:u="md",children:h,showCloseButton:f=!0,closeOnOverlayClick:m=!0}){T.useEffect(()=>{const E=p=>{p.key==="Escape"&&n&&s()};return n&&(document.addEventListener("keydown",E),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",E),document.body.style.overflow="unset"}},[n,s]);const w={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return c.jsx(qa,{children:n&&c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx(tt.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:m?s:void 0}),c.jsxs(tt.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:`inline-block w-full ${w[u]} p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl relative`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 pr-8",children:o}),f&&c.jsx("button",{onClick:s,className:"absolute top-6 right-6 text-gray-400 hover:text-gray-500 transition-colors","aria-label":"Close modal",children:c.jsx(On,{className:"h-6 w-6"})})]}),c.jsx("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:h})]})]})})})}function Td({isOpen:n,onClose:s,onSave:o,inspection:u}){const[h,f]=T.useState({title:"",type:"safety",inspector:"",scheduled_date:"",description:""}),[m,w]=T.useState(!1),[E,p]=T.useState("");T.useEffect(()=>{f(u?{title:u.title,type:u.type,inspector:u.inspector,scheduled_date:u.scheduled_date.slice(0,16),description:u.checklist_items?.[0]?.description||""}:{title:"",type:"safety",inspector:"",scheduled_date:"",description:""}),p("")},[u,n]);const A=M=>{M.preventDefault(),N()},N=async()=>{p(""),w(!0);try{if(!h.title||!h.inspector||!h.scheduled_date){p("Please fill in all required fields"),w(!1);return}const M={title:h.title,type:h.type,inspector:h.inspector,scheduled_date:new Date(h.scheduled_date).toISOString(),status:u?.status||"scheduled",progress:u?.progress||0,score:u?.score||0,checklist_items:h.description?[{id:"1",description:h.description,completed:!1}]:[]};await o(M),s()}catch(M){p(M instanceof Error?M.message:"Failed to save inspection")}finally{w(!1)}},I=M=>{const{name:H,value:k}=M.target;f(j=>({...j,[H]:k}))};return c.jsx(Or,{isOpen:n,onClose:s,title:u?"Edit Inspection":"Create New Inspection",size:"lg",children:c.jsxs("form",{onSubmit:A,className:"space-y-6",children:[E&&c.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:E}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspection Title ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",id:"title",name:"title",value:h.title,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Monthly Safety Check",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspection Type ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{id:"type",name:"type",value:h.type,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[c.jsx("option",{value:"safety",children:"Safety"}),c.jsx("option",{value:"pre_season",children:"Pre-Season"}),c.jsx("option",{value:"compliance",children:"Compliance"}),c.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"inspector",className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspector ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",id:"inspector",name:"inspector",value:h.inspector,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., John Doe",required:!0})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsxs("label",{htmlFor:"scheduled_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Scheduled Date & Time ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"datetime-local",id:"scheduled_date",name:"scheduled_date",value:h.scheduled_date,onChange:I,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description / Notes"}),c.jsx("textarea",{id:"description",name:"description",value:h.description,onChange:I,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add any additional notes or checklist items..."})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[c.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:m,children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:m,children:m?"Saving...":u?"Update Inspection":"Create Inspection"})]})]})})}const Od=[{id:"safety-monthly",name:"Monthly Safety Inspection",frequency:"Monthly"},{id:"pre-season",name:"Pre-Season Equipment Check",frequency:"Seasonal"},{id:"compliance-annual",name:"Annual Compliance Audit",frequency:"Annual"},{id:"maintenance-weekly",name:"Weekly Maintenance Check",frequency:"Weekly"}];function Md(){const[n,s]=T.useState(""),[o,u]=T.useState("all"),[h,f]=T.useState("all"),[m,w]=T.useState(!1),[E,p]=T.useState(null),{items:A,loading:N,create:I,update:M,delete:H,refresh:k}=an("inspections");T.useEffect(()=>{k()},[k]);const j=A.filter(U=>{const L=U.title.toLowerCase().includes(n.toLowerCase())||U.inspector.toLowerCase().includes(n.toLowerCase()),Oe=o==="all"||U.status===o,R=h==="all"||U.type===h;return L&&Oe&&R}),W=async U=>{if(E)await M(E.id,U);else{const L={title:U.title,type:U.type,inspector:U.inspector,status:U.status||"scheduled",progress:U.progress||0,score:U.score||0,scheduled_date:U.scheduled_date,checklist_items:U.checklist_items||[]};await I(L)}await k()},G=async U=>{confirm("Are you sure you want to delete this inspection?")&&await H(U)},B=async(U,L)=>{await M(U,{status:L})},K=U=>{p(U),w(!0)},we=()=>{w(!1),p(null)},re=U=>{switch(U){case"scheduled":return"text-blue-600 bg-blue-100";case"in_progress":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"overdue":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},$=U=>U?U>=90?"text-green-600":U>=70?"text-yellow-600":"text-red-600":"text-gray-500";return N?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading inspections..."})]})}):c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search inspections...",value:n,onChange:U=>s(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("button",{onClick:()=>w(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Schedule Inspection"]})]}),c.jsxs("div",{className:"flex gap-4 flex-wrap",children:[c.jsxs("select",{value:o,onChange:U=>u(U.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Statuses"}),c.jsx("option",{value:"scheduled",children:"Scheduled"}),c.jsx("option",{value:"in_progress",children:"In Progress"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"overdue",children:"Overdue"})]}),c.jsxs("select",{value:h,onChange:U=>f(U.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Types"}),c.jsx("option",{value:"safety",children:"Safety"}),c.jsx("option",{value:"pre_season",children:"Pre-Season"}),c.jsx("option",{value:"compliance",children:"Compliance"}),c.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:j.length===0?c.jsxs("div",{className:"col-span-full text-center py-12",children:[c.jsx("p",{className:"text-gray-500 text-lg",children:"No inspections found"}),c.jsx("p",{className:"text-gray-400 text-sm mt-2",children:n||o!=="all"?"Try adjusting your filters":"Schedule your first inspection to get started"})]}):j.map((U,L)=>c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:L*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:U.title}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Type: ",U.type]})]}),c.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${re(U.status)}`,children:U.status==="in_progress"?"In Progress":U.status.charAt(0).toUpperCase()+U.status.slice(1)})]}),c.jsxs("div",{className:"space-y-3 mb-4",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Inspector:"}),c.jsx("span",{className:"text-sm font-medium",children:U.inspector})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Scheduled:"}),c.jsxs("span",{className:"text-sm font-medium",children:[new Date(U.scheduled_date).toLocaleDateString()," at ",new Date(U.scheduled_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),U.completed_date&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Completed:"}),c.jsx("span",{className:"text-sm font-medium",children:new Date(U.completed_date).toLocaleDateString()})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Progress:"}),c.jsxs("span",{className:"text-sm font-medium",children:[U.progress,"%"]})]}),U.score>0&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Score:"}),c.jsxs("span",{className:`text-sm font-bold ${$(U.score)}`,children:[U.score,"%"]})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:c.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${U.status==="completed"?"bg-green-500":"bg-blue-500"}`,style:{width:`${U.progress}%`}})}),c.jsx("div",{className:"flex gap-2",children:U.status==="completed"?c.jsxs(c.Fragment,{children:[c.jsxs("button",{className:"flex items-center px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[c.jsx($l,{className:"h-4 w-4 mr-1"}),"Download PDF"]}),c.jsxs("button",{className:"flex items-center px-3 py-2 text-sm text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[c.jsx(Ql,{className:"h-4 w-4 mr-1"}),"View Report"]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("button",{onClick:()=>{B(U.id,"in_progress")},className:"flex items-center px-3 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(ls,{className:"h-4 w-4 mr-1"}),"Start Inspection"]}),c.jsxs("button",{onClick:()=>K(U),className:"flex items-center px-3 py-2 text-sm text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[c.jsx(dn,{className:"h-4 w-4 mr-1"}),"Edit"]}),c.jsx("button",{onClick:()=>{G(U.id)},className:"flex items-center px-3 py-2 text-sm text-red-600 border border-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"Delete"})]})})]},U.id))}),c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Inspection Templates"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Od.map(U=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-green-300 transition-colors cursor-pointer",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:U.name}),c.jsx("p",{className:"text-sm text-gray-500",children:U.frequency})]},U.id))})]}),c.jsx(Td,{isOpen:m,onClose:we,onSave:W,inspection:E})]})}var ae;(function(n){n[n.QR_CODE=0]="QR_CODE",n[n.AZTEC=1]="AZTEC",n[n.CODABAR=2]="CODABAR",n[n.CODE_39=3]="CODE_39",n[n.CODE_93=4]="CODE_93",n[n.CODE_128=5]="CODE_128",n[n.DATA_MATRIX=6]="DATA_MATRIX",n[n.MAXICODE=7]="MAXICODE",n[n.ITF=8]="ITF",n[n.EAN_13=9]="EAN_13",n[n.EAN_8=10]="EAN_8",n[n.PDF_417=11]="PDF_417",n[n.RSS_14=12]="RSS_14",n[n.RSS_EXPANDED=13]="RSS_EXPANDED",n[n.UPC_A=14]="UPC_A",n[n.UPC_E=15]="UPC_E",n[n.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ae||(ae={}));var da=new Map([[ae.QR_CODE,"QR_CODE"],[ae.AZTEC,"AZTEC"],[ae.CODABAR,"CODABAR"],[ae.CODE_39,"CODE_39"],[ae.CODE_93,"CODE_93"],[ae.CODE_128,"CODE_128"],[ae.DATA_MATRIX,"DATA_MATRIX"],[ae.MAXICODE,"MAXICODE"],[ae.ITF,"ITF"],[ae.EAN_13,"EAN_13"],[ae.EAN_8,"EAN_8"],[ae.PDF_417,"PDF_417"],[ae.RSS_14,"RSS_14"],[ae.RSS_EXPANDED,"RSS_EXPANDED"],[ae.UPC_A,"UPC_A"],[ae.UPC_E,"UPC_E"],[ae.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),ha;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.URL=1]="URL"})(ha||(ha={}));function Dd(n){return Object.values(ae).includes(n)}var Tn;(function(n){n[n.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",n[n.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Tn||(Tn={}));var qt=function(){function n(){}return n.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",n.SCAN_DEFAULT_FPS=2,n.DEFAULT_DISABLE_FLIP=!1,n.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,n.DEFAULT_SUPPORTED_SCAN_TYPE=[Tn.SCAN_TYPE_CAMERA,Tn.SCAN_TYPE_FILE],n}(),No=function(){function n(s,o){this.format=s,this.formatName=o}return n.prototype.toString=function(){return this.formatName},n.create=function(s){if(!da.has(s))throw"".concat(s," not in html5QrcodeSupportedFormatsTextMap");return new n(s,da.get(s))},n}(),fa=function(){function n(){}return n.createFromText=function(s){var o={text:s};return{decodedText:s,result:o}},n.createFromQrcodeResult=function(s){return{decodedText:s.text,result:s}},n}(),ri;(function(n){n[n.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",n[n.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",n[n.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(ri||(ri={}));var Eo=function(){function n(){}return n.createFrom=function(s){return{errorMessage:s,type:ri.UNKWOWN_ERROR}},n}(),vo=function(){function n(s){this.verbose=s}return n.prototype.log=function(s){this.verbose&&console.log(s)},n.prototype.warn=function(s){this.verbose&&console.warn(s)},n.prototype.logError=function(s,o){(this.verbose||o===!0)&&console.error(s)},n.prototype.logErrors=function(s){if(s.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(s)},n}();function rn(n){return typeof n>"u"||n===null}function jd(n,s,o){return n>o?o:n<s?s:n}var sr=function(){function n(){}return n.codeParseError=function(s){return"QR code parse error, error = ".concat(s)},n.errorGettingUserMedia=function(s){return"Error getting userMedia, error = ".concat(s)},n.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},n.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},n.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},n.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},n.scannerPaused=function(){return"Scanner paused"},n}(),Te=function(){function n(){}return n.scanningStatus=function(){return"Scanning"},n.idleStatus=function(){return"Idle"},n.errorStatus=function(){return"Error"},n.permissionStatus=function(){return"Permission"},n.noCameraFoundErrorStatus=function(){return"No Cameras"},n.lastMatch=function(s){return"Last Match: ".concat(s)},n.codeScannerTitle=function(){return"Code Scanner"},n.cameraPermissionTitle=function(){return"Request Camera Permissions"},n.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},n.noCameraFound=function(){return"No camera found"},n.scanButtonStopScanningText=function(){return"Stop Scanning"},n.scanButtonStartScanningText=function(){return"Start Scanning"},n.torchOnButton=function(){return"Switch On Torch"},n.torchOffButton=function(){return"Switch Off Torch"},n.torchOnFailedMessage=function(){return"Failed to turn on torch"},n.torchOffFailedMessage=function(){return"Failed to turn off torch"},n.scanButtonScanningStarting=function(){return"Launching Camera..."},n.textIfCameraScanSelected=function(){return"Scan an Image File"},n.textIfFileScanSelected=function(){return"Scan using camera directly"},n.selectCamera=function(){return"Select Camera"},n.fileSelectionChooseImage=function(){return"Choose Image"},n.fileSelectionChooseAnother=function(){return"Choose Another"},n.fileSelectionNoImageSelected=function(){return"No image choosen"},n.anonymousCameraPrefix=function(){return"Anonymous Camera"},n.dragAndDropMessage=function(){return"Or drop an image to scan"},n.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},n.zoom=function(){return"zoom"},n.loadingImage=function(){return"Loading image..."},n.cameraScanAltText=function(){return"Camera based scan"},n.fileScanAltText=function(){return"Fule based scan"},n}(),ga=function(){function n(){}return n.poweredBy=function(){return"Powered by "},n.reportIssues=function(){return"Report issues"},n}(),_o=function(){function n(){}return n.isMediaStreamConstraintsValid=function(s,o){if(typeof s!="object"){var u=typeof s;return o.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(u,"."),!0),!1}for(var h=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],f=new Set(h),m=Object.keys(s),w=0,E=m;w<E.length;w++){var p=E[w];if(f.has(p))return o.logError("".concat(p," is not supported videoConstaints."),!0),!1}return!0},n}(),si={exports:{}};(function(n,s){(function(o,u){u(s)})(Cr,function(o){function u(b){return b==null}var h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,e){b.__proto__=e}||function(b,e){for(var t in e)e.hasOwnProperty(t)&&(b[t]=e[t])};function f(b,e){h(b,e);function t(){this.constructor=b}b.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function m(b,e){var t=Object.setPrototypeOf;t?t(b,e):b.__proto__=e}function w(b,e){e===void 0&&(e=b.constructor);var t=Error.captureStackTrace;t&&t(b,e)}var E=function(b){f(e,b);function e(t){var r=this.constructor,i=b.call(this,t)||this;return Object.defineProperty(i,"name",{value:r.name,enumerable:!1}),m(i,r.prototype),w(i),i}return e}(Error);class p extends E{constructor(e=void 0){super(e),this.message=e}getKind(){return this.constructor.kind}}p.kind="Exception";class A extends p{}A.kind="ArgumentException";class N extends p{}N.kind="IllegalArgumentException";class I{constructor(e){if(this.binarizer=e,e===null)throw new N("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(e,t){return this.binarizer.getBlackRow(e,t)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(e,t,r,i){const a=this.binarizer.getLuminanceSource().crop(e,t,r,i);return new I(this.binarizer.createBinarizer(a))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new I(this.binarizer.createBinarizer(e))}rotateCounterClockwise45(){const e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new I(this.binarizer.createBinarizer(e))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class M extends p{static getChecksumInstance(){return new M}}M.kind="ChecksumException";class H{constructor(e){this.source=e}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class k{static arraycopy(e,t,r,i,a){for(;a--;)r[i++]=e[t++]}static currentTimeMillis(){return Date.now()}}class j extends p{}j.kind="IndexOutOfBoundsException";class W extends j{constructor(e=void 0,t=void 0){super(t),this.index=e,this.message=t}}W.kind="ArrayIndexOutOfBoundsException";class G{static fill(e,t){for(let r=0,i=e.length;r<i;r++)e[r]=t}static fillWithin(e,t,r,i){G.rangeCheck(e.length,t,r);for(let a=t;a<r;a++)e[a]=i}static rangeCheck(e,t,r){if(t>r)throw new N("fromIndex("+t+") > toIndex("+r+")");if(t<0)throw new W(t);if(r>e)throw new W(r)}static asList(...e){return e}static create(e,t,r){return Array.from({length:e}).map(a=>Array.from({length:t}).fill(r))}static createInt32Array(e,t,r){return Array.from({length:e}).map(a=>Int32Array.from({length:t}).fill(r))}static equals(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}static hashCode(e){if(e===null)return 0;let t=1;for(const r of e)t=31*t+r;return t}static fillUint8Array(e,t){for(let r=0;r!==e.length;r++)e[r]=t}static copyOf(e,t){return e.slice(0,t)}static copyOfUint8Array(e,t){if(e.length<=t){const r=new Uint8Array(t);return r.set(e),r}return e.slice(0,t)}static copyOfRange(e,t,r){const i=r-t,a=new Int32Array(i);return k.arraycopy(e,t,a,0,i),a}static binarySearch(e,t,r){r===void 0&&(r=G.numberComparator);let i=0,a=e.length-1;for(;i<=a;){const l=a+i>>1,d=r(t,e[l]);if(d>0)i=l+1;else if(d<0)a=l-1;else return l}return-i-1}static numberComparator(e,t){return e-t}}class B{static numberOfTrailingZeros(e){let t;if(e===0)return 32;let r=31;return t=e<<16,t!==0&&(r-=16,e=t),t=e<<8,t!==0&&(r-=8,e=t),t=e<<4,t!==0&&(r-=4,e=t),t=e<<2,t!==0&&(r-=2,e=t),r-(e<<1>>>31)}static numberOfLeadingZeros(e){if(e===0)return 32;let t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t}static toHexString(e){return e.toString(16)}static toBinaryString(e){return String(parseInt(String(e),2))}static bitCount(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63}static truncDivision(e,t){return Math.trunc(e/t)}static parseInt(e,t=void 0){return parseInt(e,t)}}B.MIN_VALUE_32_BITS=-2147483648,B.MAX_VALUE=Number.MAX_SAFE_INTEGER;class K{constructor(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=K.makeArray(e):this.bits=t)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(e){if(e>this.bits.length*32){const t=K.makeArray(e);k.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}}get(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0}set(e){this.bits[Math.floor(e/32)]|=1<<(e&31)}flip(e){this.bits[Math.floor(e/32)]^=1<<(e&31)}getNextSet(e){const t=this.size;if(e>=t)return t;const r=this.bits;let i=Math.floor(e/32),a=r[i];a&=~((1<<(e&31))-1);const l=r.length;for(;a===0;){if(++i===l)return t;a=r[i]}const d=i*32+B.numberOfTrailingZeros(a);return d>t?t:d}getNextUnset(e){const t=this.size;if(e>=t)return t;const r=this.bits;let i=Math.floor(e/32),a=~r[i];a&=~((1<<(e&31))-1);const l=r.length;for(;a===0;){if(++i===l)return t;a=~r[i]}const d=i*32+B.numberOfTrailingZeros(a);return d>t?t:d}setBulk(e,t){this.bits[Math.floor(e/32)]=t}setRange(e,t){if(t<e||e<0||t>this.size)throw new N;if(t===e)return;t--;const r=Math.floor(e/32),i=Math.floor(t/32),a=this.bits;for(let l=r;l<=i;l++){const d=l>r?0:e&31,x=(2<<(l<i?31:t&31))-(1<<d);a[l]|=x}}clear(){const e=this.bits.length,t=this.bits;for(let r=0;r<e;r++)t[r]=0}isRange(e,t,r){if(t<e||e<0||t>this.size)throw new N;if(t===e)return!0;t--;const i=Math.floor(e/32),a=Math.floor(t/32),l=this.bits;for(let d=i;d<=a;d++){const g=d>i?0:e&31,y=(2<<(d<a?31:t&31))-(1<<g)&4294967295;if((l[d]&y)!==(r?y:0))return!1}return!0}appendBit(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(e,t){if(t<0||t>32)throw new N("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(let r=t;r>0;r--)this.appendBit((e>>r-1&1)===1)}appendBitArray(e){const t=e.size;this.ensureCapacity(this.size+t);for(let r=0;r<t;r++)this.appendBit(e.get(r))}xor(e){if(this.size!==e.size)throw new N("Sizes don't match");const t=this.bits;for(let r=0,i=t.length;r<i;r++)t[r]^=e.bits[r]}toBytes(e,t,r,i){for(let a=0;a<i;a++){let l=0;for(let d=0;d<8;d++)this.get(e)&&(l|=1<<7-d),e++;t[r+a]=l}}getBitArray(){return this.bits}reverse(){const e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),r=t+1,i=this.bits;for(let a=0;a<r;a++){let l=i[a];l=l>>1&1431655765|(l&1431655765)<<1,l=l>>2&858993459|(l&858993459)<<2,l=l>>4&252645135|(l&252645135)<<4,l=l>>8&16711935|(l&16711935)<<8,l=l>>16&65535|(l&65535)<<16,e[t-a]=l}if(this.size!==r*32){const a=r*32-this.size;let l=e[0]>>>a;for(let d=1;d<r;d++){const g=e[d];l|=g<<32-a,e[d-1]=l,l=g>>>a}e[r-1]=l}this.bits=e}static makeArray(e){return new Int32Array(Math.floor((e+31)/32))}equals(e){if(!(e instanceof K))return!1;const t=e;return this.size===t.size&&G.equals(this.bits,t.bits)}hashCode(){return 31*this.size+G.hashCode(this.bits)}toString(){let e="";for(let t=0,r=this.size;t<r;t++)t&7||(e+=" "),e+=this.get(t)?"X":".";return e}clone(){return new K(this.size,this.bits.slice())}}var we;(function(b){b[b.OTHER=0]="OTHER",b[b.PURE_BARCODE=1]="PURE_BARCODE",b[b.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",b[b.TRY_HARDER=3]="TRY_HARDER",b[b.CHARACTER_SET=4]="CHARACTER_SET",b[b.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",b[b.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",b[b.ASSUME_GS1=7]="ASSUME_GS1",b[b.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",b[b.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",b[b.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(we||(we={}));var re=we;class $ extends p{static getFormatInstance(){return new $}}$.kind="FormatException";var U;(function(b){b[b.Cp437=0]="Cp437",b[b.ISO8859_1=1]="ISO8859_1",b[b.ISO8859_2=2]="ISO8859_2",b[b.ISO8859_3=3]="ISO8859_3",b[b.ISO8859_4=4]="ISO8859_4",b[b.ISO8859_5=5]="ISO8859_5",b[b.ISO8859_6=6]="ISO8859_6",b[b.ISO8859_7=7]="ISO8859_7",b[b.ISO8859_8=8]="ISO8859_8",b[b.ISO8859_9=9]="ISO8859_9",b[b.ISO8859_10=10]="ISO8859_10",b[b.ISO8859_11=11]="ISO8859_11",b[b.ISO8859_13=12]="ISO8859_13",b[b.ISO8859_14=13]="ISO8859_14",b[b.ISO8859_15=14]="ISO8859_15",b[b.ISO8859_16=15]="ISO8859_16",b[b.SJIS=16]="SJIS",b[b.Cp1250=17]="Cp1250",b[b.Cp1251=18]="Cp1251",b[b.Cp1252=19]="Cp1252",b[b.Cp1256=20]="Cp1256",b[b.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",b[b.UTF8=22]="UTF8",b[b.ASCII=23]="ASCII",b[b.Big5=24]="Big5",b[b.GB18030=25]="GB18030",b[b.EUC_KR=26]="EUC_KR"})(U||(U={}));class L{constructor(e,t,r,...i){this.valueIdentifier=e,this.name=r,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=i,L.VALUE_IDENTIFIER_TO_ECI.set(e,this),L.NAME_TO_ECI.set(r,this);const a=this.values;for(let l=0,d=a.length;l!==d;l++){const g=a[l];L.VALUES_TO_ECI.set(g,this)}for(const l of i)L.NAME_TO_ECI.set(l,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(e){if(e<0||e>=900)throw new $("incorect value");const t=L.VALUES_TO_ECI.get(e);if(t===void 0)throw new $("incorect value");return t}static getCharacterSetECIByName(e){const t=L.NAME_TO_ECI.get(e);if(t===void 0)throw new $("incorect value");return t}equals(e){if(!(e instanceof L))return!1;const t=e;return this.getName()===t.getName()}}L.VALUE_IDENTIFIER_TO_ECI=new Map,L.VALUES_TO_ECI=new Map,L.NAME_TO_ECI=new Map,L.Cp437=new L(U.Cp437,Int32Array.from([0,2]),"Cp437"),L.ISO8859_1=new L(U.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),L.ISO8859_2=new L(U.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),L.ISO8859_3=new L(U.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),L.ISO8859_4=new L(U.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),L.ISO8859_5=new L(U.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),L.ISO8859_6=new L(U.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),L.ISO8859_7=new L(U.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),L.ISO8859_8=new L(U.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),L.ISO8859_9=new L(U.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),L.ISO8859_10=new L(U.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),L.ISO8859_11=new L(U.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),L.ISO8859_13=new L(U.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),L.ISO8859_14=new L(U.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),L.ISO8859_15=new L(U.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),L.ISO8859_16=new L(U.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),L.SJIS=new L(U.SJIS,20,"SJIS","Shift_JIS"),L.Cp1250=new L(U.Cp1250,21,"Cp1250","windows-1250"),L.Cp1251=new L(U.Cp1251,22,"Cp1251","windows-1251"),L.Cp1252=new L(U.Cp1252,23,"Cp1252","windows-1252"),L.Cp1256=new L(U.Cp1256,24,"Cp1256","windows-1256"),L.UnicodeBigUnmarked=new L(U.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),L.UTF8=new L(U.UTF8,26,"UTF8","UTF-8"),L.ASCII=new L(U.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),L.Big5=new L(U.Big5,28,"Big5"),L.GB18030=new L(U.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),L.EUC_KR=new L(U.EUC_KR,30,"EUC_KR","EUC-KR");class Oe extends p{}Oe.kind="UnsupportedOperationException";class R{static decode(e,t){const r=this.encodingName(t);return this.customDecoder?this.customDecoder(e,r):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(r)?this.decodeFallback(e,r):new TextDecoder(r).decode(e)}static shouldDecodeOnFallback(e){return!R.isBrowser()&&e==="ISO-8859-1"}static encode(e,t){const r=this.encodingName(t);return this.customEncoder?this.customEncoder(e,r):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(e){return typeof e=="string"?e:e.getName()}static encodingCharacterSet(e){return e instanceof L?e:L.getCharacterSetECIByName(e)}static decodeFallback(e,t){const r=this.encodingCharacterSet(t);if(R.isDecodeFallbackSupported(r)){let i="";for(let a=0,l=e.length;a<l;a++){let d=e[a].toString(16);d.length<2&&(d="0"+d),i+="%"+d}return decodeURIComponent(i)}if(r.equals(L.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Oe(`Encoding ${this.encodingName(t)} not supported by fallback.`)}static isDecodeFallbackSupported(e){return e.equals(L.UTF8)||e.equals(L.ISO8859_1)||e.equals(L.ASCII)}static encodeFallback(e){const r=btoa(unescape(encodeURIComponent(e))).split(""),i=[];for(let a=0;a<r.length;a++)i.push(r[a].charCodeAt(0));return new Uint8Array(i)}}class X{static castAsNonUtf8Char(e,t=null){const r=t?t.getName():this.ISO88591;return R.decode(new Uint8Array([e]),r)}static guessEncoding(e,t){if(t!=null&&t.get(re.CHARACTER_SET)!==void 0)return t.get(re.CHARACTER_SET).toString();const r=e.length;let i=!0,a=!0,l=!0,d=0,g=0,x=0,y=0,C=0,v=0,S=0,O=0,D=0,P=0,Z=0;const J=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191;for(let ee=0;ee<r&&(i||a||l);ee++){const Q=e[ee]&255;l&&(d>0?Q&128?d--:l=!1:Q&128&&(Q&64?(d++,Q&32?(d++,Q&16?(d++,Q&8?l=!1:y++):x++):g++):l=!1)),i&&(Q>127&&Q<160?i=!1:Q>159&&(Q<192||Q===215||Q===247)&&Z++),a&&(C>0?Q<64||Q===127||Q>252?a=!1:C--:Q===128||Q===160||Q>239?a=!1:Q>160&&Q<224?(v++,O=0,S++,S>D&&(D=S)):Q>127?(C++,S=0,O++,O>P&&(P=O)):(S=0,O=0))}return l&&d>0&&(l=!1),a&&C>0&&(a=!1),l&&(J||g+x+y>0)?X.UTF8:a&&(X.ASSUME_SHIFT_JIS||D>=3||P>=3)?X.SHIFT_JIS:i&&a?D===2&&v===2||Z*10>=r?X.SHIFT_JIS:X.ISO88591:i?X.ISO88591:a?X.SHIFT_JIS:l?X.UTF8:X.PLATFORM_DEFAULT_ENCODING}static format(e,...t){let r=-1;function i(l,d,g,x,y,C){if(l==="%%")return"%";if(t[++r]===void 0)return;l=x?parseInt(x.substr(1)):void 0;let v=y?parseInt(y.substr(1)):void 0,S;switch(C){case"s":S=t[r];break;case"c":S=t[r][0];break;case"f":S=parseFloat(t[r]).toFixed(l);break;case"p":S=parseFloat(t[r]).toPrecision(l);break;case"e":S=parseFloat(t[r]).toExponential(l);break;case"x":S=parseInt(t[r]).toString(v||16);break;case"d":S=parseFloat(parseInt(t[r],v||10).toPrecision(l)).toFixed(0);break}S=typeof S=="object"?JSON.stringify(S):(+S).toString(v);let O=parseInt(g),D=g&&g[0]+""=="0"?"0":" ";for(;S.length<O;)S=d!==void 0?S+D:D+S;return S}let a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(a,i)}static getBytes(e,t){return R.encode(e,t)}static getCharCode(e,t=0){return e.charCodeAt(t)}static getCharAt(e){return String.fromCharCode(e)}}X.SHIFT_JIS=L.SJIS.getName(),X.GB2312="GB2312",X.ISO88591=L.ISO8859_1.getName(),X.EUC_JP="EUC_JP",X.UTF8=L.UTF8.getName(),X.PLATFORM_DEFAULT_ENCODING=X.UTF8,X.ASSUME_SHIFT_JIS=!1;class te{constructor(e=""){this.value=e}enableDecoding(e){return this.encoding=e,this}append(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=X.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this}appendChars(e,t,r){for(let i=t;t<t+r;i++)this.append(e[i]);return this}length(){return this.value.length}charAt(e){return this.value.charAt(e)}deleteCharAt(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)}setCharAt(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)}substring(e,t){return this.value.substring(e,t)}setLengthToZero(){this.value=""}toString(){return this.value}insert(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+t.length)}}class ce{constructor(e,t,r,i){if(this.width=e,this.height=t,this.rowSize=r,this.bits=i,t==null&&(t=e),this.height=t,e<1||t<1)throw new N("Both dimensions must be greater than 0");r==null&&(r=Math.floor((e+31)/32)),this.rowSize=r,i==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(e){const t=e.length,r=e[0].length,i=new ce(r,t);for(let a=0;a<t;a++){const l=e[a];for(let d=0;d<r;d++)l[d]&&i.set(d,a)}return i}static parseFromString(e,t,r){if(e===null)throw new N("stringRepresentation cannot be null");const i=new Array(e.length);let a=0,l=0,d=-1,g=0,x=0;for(;x<e.length;)if(e.charAt(x)===`
`||e.charAt(x)==="\r"){if(a>l){if(d===-1)d=a-l;else if(a-l!==d)throw new N("row lengths do not match");l=a,g++}x++}else if(e.substring(x,x+t.length)===t)x+=t.length,i[a]=!0,a++;else if(e.substring(x,x+r.length)===r)x+=r.length,i[a]=!1,a++;else throw new N("illegal character encountered: "+e.substring(x));if(a>l){if(d===-1)d=a-l;else if(a-l!==d)throw new N("row lengths do not match");g++}const y=new ce(d,g);for(let C=0;C<a;C++)i[C]&&y.set(Math.floor(C%d),Math.floor(C/d));return y}get(e,t){const r=t*this.rowSize+Math.floor(e/32);return(this.bits[r]>>>(e&31)&1)!==0}set(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]|=1<<(e&31)&4294967295}unset(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]&=~(1<<(e&31)&4294967295)}flip(e,t){const r=t*this.rowSize+Math.floor(e/32);this.bits[r]^=1<<(e&31)&4294967295}xor(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new N("input matrix dimensions do not match");const t=new K(Math.floor(this.width/32)+1),r=this.rowSize,i=this.bits;for(let a=0,l=this.height;a<l;a++){const d=a*r,g=e.getRow(a,t).getBitArray();for(let x=0;x<r;x++)i[d+x]^=g[x]}}clear(){const e=this.bits,t=e.length;for(let r=0;r<t;r++)e[r]=0}setRegion(e,t,r,i){if(t<0||e<0)throw new N("Left and top must be nonnegative");if(i<1||r<1)throw new N("Height and width must be at least 1");const a=e+r,l=t+i;if(l>this.height||a>this.width)throw new N("The region must fit inside the matrix");const d=this.rowSize,g=this.bits;for(let x=t;x<l;x++){const y=x*d;for(let C=e;C<a;C++)g[y+Math.floor(C/32)]|=1<<(C&31)&4294967295}}getRow(e,t){t==null||t.getSize()<this.width?t=new K(this.width):t.clear();const r=this.rowSize,i=this.bits,a=e*r;for(let l=0;l<r;l++)t.setBulk(l*32,i[a+l]);return t}setRow(e,t){k.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)}rotate180(){const e=this.getWidth(),t=this.getHeight();let r=new K(e),i=new K(e);for(let a=0,l=Math.floor((t+1)/2);a<l;a++)r=this.getRow(a,r),i=this.getRow(t-1-a,i),r.reverse(),i.reverse(),this.setRow(a,i),this.setRow(t-1-a,r)}getEnclosingRectangle(){const e=this.width,t=this.height,r=this.rowSize,i=this.bits;let a=e,l=t,d=-1,g=-1;for(let x=0;x<t;x++)for(let y=0;y<r;y++){const C=i[x*r+y];if(C!==0){if(x<l&&(l=x),x>g&&(g=x),y*32<a){let v=0;for(;!(C<<31-v&4294967295);)v++;y*32+v<a&&(a=y*32+v)}if(y*32+31>d){let v=31;for(;!(C>>>v);)v--;y*32+v>d&&(d=y*32+v)}}}return d<a||g<l?null:Int32Array.from([a,l,d-a+1,g-l+1])}getTopLeftOnBit(){const e=this.rowSize,t=this.bits;let r=0;for(;r<t.length&&t[r]===0;)r++;if(r===t.length)return null;const i=r/e;let a=r%e*32;const l=t[r];let d=0;for(;!(l<<31-d&4294967295);)d++;return a+=d,Int32Array.from([a,i])}getBottomRightOnBit(){const e=this.rowSize,t=this.bits;let r=t.length-1;for(;r>=0&&t[r]===0;)r--;if(r<0)return null;const i=Math.floor(r/e);let a=Math.floor(r%e)*32;const l=t[r];let d=31;for(;!(l>>>d);)d--;return a+=d,Int32Array.from([a,i])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(e){if(!(e instanceof ce))return!1;const t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&G.equals(this.bits,t.bits)}hashCode(){let e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+G.hashCode(this.bits),e}toString(e="X ",t="  ",r=`
`){return this.buildToString(e,t,r)}buildToString(e,t,r){let i=new te;for(let a=0,l=this.height;a<l;a++){for(let d=0,g=this.width;d<g;d++)i.append(this.get(d,a)?e:t);i.append(r)}return i.toString()}clone(){return new ce(this.width,this.height,this.rowSize,this.bits.slice())}}class z extends p{static getNotFoundInstance(){return new z}}z.kind="NotFoundException";class Me extends H{constructor(e){super(e),this.luminances=Me.EMPTY,this.buckets=new Int32Array(Me.LUMINANCE_BUCKETS)}getBlackRow(e,t){const r=this.getLuminanceSource(),i=r.getWidth();t==null||t.getSize()<i?t=new K(i):t.clear(),this.initArrays(i);const a=r.getRow(e,this.luminances),l=this.buckets;for(let g=0;g<i;g++)l[(a[g]&255)>>Me.LUMINANCE_SHIFT]++;const d=Me.estimateBlackPoint(l);if(i<3)for(let g=0;g<i;g++)(a[g]&255)<d&&t.set(g);else{let g=a[0]&255,x=a[1]&255;for(let y=1;y<i-1;y++){const C=a[y+1]&255;(x*4-g-C)/2<d&&t.set(y),g=x,x=C}}return t}getBlackMatrix(){const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight(),i=new ce(t,r);this.initArrays(t);const a=this.buckets;for(let g=1;g<5;g++){const x=Math.floor(r*g/5),y=e.getRow(x,this.luminances),C=Math.floor(t*4/5);for(let v=Math.floor(t/5);v<C;v++){const S=y[v]&255;a[S>>Me.LUMINANCE_SHIFT]++}}const l=Me.estimateBlackPoint(a),d=e.getMatrix();for(let g=0;g<r;g++){const x=g*t;for(let y=0;y<t;y++)(d[x+y]&255)<l&&i.set(y,g)}return i}createBinarizer(e){return new Me(e)}initArrays(e){this.luminances.length<e&&(this.luminances=new Uint8ClampedArray(e));const t=this.buckets;for(let r=0;r<Me.LUMINANCE_BUCKETS;r++)t[r]=0}static estimateBlackPoint(e){const t=e.length;let r=0,i=0,a=0;for(let y=0;y<t;y++)e[y]>a&&(i=y,a=e[y]),e[y]>r&&(r=e[y]);let l=0,d=0;for(let y=0;y<t;y++){const C=y-i,v=e[y]*C*C;v>d&&(l=y,d=v)}if(i>l){const y=i;i=l,l=y}if(l-i<=t/16)throw new z;let g=l-1,x=-1;for(let y=l-1;y>i;y--){const C=y-i,v=C*C*(l-y)*(r-e[y]);v>x&&(g=y,x=v)}return g<<Me.LUMINANCE_SHIFT}}Me.LUMINANCE_BITS=5,Me.LUMINANCE_SHIFT=8-Me.LUMINANCE_BITS,Me.LUMINANCE_BUCKETS=1<<Me.LUMINANCE_BITS,Me.EMPTY=Uint8ClampedArray.from([0]);class de extends Me{constructor(e){super(e),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const e=this.getLuminanceSource(),t=e.getWidth(),r=e.getHeight();if(t>=de.MINIMUM_DIMENSION&&r>=de.MINIMUM_DIMENSION){const i=e.getMatrix();let a=t>>de.BLOCK_SIZE_POWER;t&de.BLOCK_SIZE_MASK&&a++;let l=r>>de.BLOCK_SIZE_POWER;r&de.BLOCK_SIZE_MASK&&l++;const d=de.calculateBlackPoints(i,a,l,t,r),g=new ce(t,r);de.calculateThresholdForBlock(i,a,l,t,r,d,g),this.matrix=g}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(e){return new de(e)}static calculateThresholdForBlock(e,t,r,i,a,l,d){const g=a-de.BLOCK_SIZE,x=i-de.BLOCK_SIZE;for(let y=0;y<r;y++){let C=y<<de.BLOCK_SIZE_POWER;C>g&&(C=g);const v=de.cap(y,2,r-3);for(let S=0;S<t;S++){let O=S<<de.BLOCK_SIZE_POWER;O>x&&(O=x);const D=de.cap(S,2,t-3);let P=0;for(let J=-2;J<=2;J++){const ee=l[v+J];P+=ee[D-2]+ee[D-1]+ee[D]+ee[D+1]+ee[D+2]}const Z=P/25;de.thresholdBlock(e,O,C,Z,i,d)}}}static cap(e,t,r){return e<t?t:e>r?r:e}static thresholdBlock(e,t,r,i,a,l){for(let d=0,g=r*a+t;d<de.BLOCK_SIZE;d++,g+=a)for(let x=0;x<de.BLOCK_SIZE;x++)(e[g+x]&255)<=i&&l.set(t+x,r+d)}static calculateBlackPoints(e,t,r,i,a){const l=a-de.BLOCK_SIZE,d=i-de.BLOCK_SIZE,g=new Array(r);for(let x=0;x<r;x++){g[x]=new Int32Array(t);let y=x<<de.BLOCK_SIZE_POWER;y>l&&(y=l);for(let C=0;C<t;C++){let v=C<<de.BLOCK_SIZE_POWER;v>d&&(v=d);let S=0,O=255,D=0;for(let Z=0,J=y*i+v;Z<de.BLOCK_SIZE;Z++,J+=i){for(let ee=0;ee<de.BLOCK_SIZE;ee++){const Q=e[J+ee]&255;S+=Q,Q<O&&(O=Q),Q>D&&(D=Q)}if(D-O>de.MIN_DYNAMIC_RANGE)for(Z++,J+=i;Z<de.BLOCK_SIZE;Z++,J+=i)for(let ee=0;ee<de.BLOCK_SIZE;ee++)S+=e[J+ee]&255}let P=S>>de.BLOCK_SIZE_POWER*2;if(D-O<=de.MIN_DYNAMIC_RANGE&&(P=O/2,x>0&&C>0)){const Z=(g[x-1][C]+2*g[x][C-1]+g[x-1][C-1])/4;O<Z&&(P=Z)}g[x][C]=P}}return g}}de.BLOCK_SIZE_POWER=3,de.BLOCK_SIZE=1<<de.BLOCK_SIZE_POWER,de.BLOCK_SIZE_MASK=de.BLOCK_SIZE-1,de.MINIMUM_DIMENSION=de.BLOCK_SIZE*5,de.MIN_DYNAMIC_RANGE=24;class on{constructor(e,t){this.width=e,this.height=t}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(e,t,r,i){throw new Oe("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new Oe("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new Oe("This luminance source does not support rotation by 45 degrees.")}toString(){const e=new Uint8ClampedArray(this.width);let t=new te;for(let r=0;r<this.height;r++){const i=this.getRow(r,e);for(let a=0;a<this.width;a++){const l=i[a]&255;let d;l<64?d="#":l<128?d="+":l<192?d=".":d=" ",t.append(d)}t.append(`
`)}return t.toString()}}class Lt extends on{constructor(e){super(e.getWidth(),e.getHeight()),this.delegate=e}getRow(e,t){const r=this.delegate.getRow(e,t),i=this.getWidth();for(let a=0;a<i;a++)r[a]=255-(r[a]&255);return r}getMatrix(){const e=this.delegate.getMatrix(),t=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(t);for(let i=0;i<t;i++)r[i]=255-(e[i]&255);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(e,t,r,i){return new Lt(this.delegate.crop(e,t,r,i))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new Lt(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new Lt(this.delegate.rotateCounterClockwise45())}}class Et extends on{constructor(e){super(e.width,e.height),this.canvas=e,this.tempCanvasElement=null,this.buffer=Et.makeBufferFromCanvasImageData(e)}static makeBufferFromCanvasImageData(e){const t=e.getContext("2d").getImageData(0,0,e.width,e.height);return Et.toGrayscaleBuffer(t.data,e.width,e.height)}static toGrayscaleBuffer(e,t,r){const i=new Uint8ClampedArray(t*r);for(let a=0,l=0,d=e.length;a<d;a+=4,l++){let g;if(e[a+3]===0)g=255;else{const y=e[a],C=e[a+1],v=e[a+2];g=306*y+601*C+117*v+512>>10}i[l]=g}return i}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const r=this.getWidth(),i=e*r;return t===null?t=this.buffer.slice(i,i+r):(t.length<r&&(t=new Uint8ClampedArray(r)),t.set(this.buffer.slice(i,i+r))),t}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(e,t,r,i){return super.crop(e,t,r,i),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement}rotate(e){const t=this.getTempCanvasElement(),r=t.getContext("2d"),i=e*Et.DEGREE_TO_RADIANS,a=this.canvas.width,l=this.canvas.height,d=Math.ceil(Math.abs(Math.cos(i))*a+Math.abs(Math.sin(i))*l),g=Math.ceil(Math.abs(Math.sin(i))*a+Math.abs(Math.cos(i))*l);return t.width=d,t.height=g,r.translate(d/2,g/2),r.rotate(i),r.drawImage(this.canvas,a/-2,l/-2),this.buffer=Et.makeBufferFromCanvasImageData(t),this}invert(){return new Lt(this)}}Et.DEGREE_TO_RADIANS=Math.PI/180;class gn{constructor(e,t,r){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Ke=(globalThis||Cr||self||window||void 0)&&(globalThis||Cr||self||window||void 0).__awaiter||function(b,e,t,r){function i(a){return a instanceof t?a:new t(function(l){l(a)})}return new(t||(t=Promise))(function(a,l){function d(y){try{x(r.next(y))}catch(C){l(C)}}function g(y){try{x(r.throw(y))}catch(C){l(C)}}function x(y){y.done?a(y.value):i(y.value).then(d,g)}x((r=r.apply(b,e||[])).next())})};class Wt{constructor(e,t=500,r){this.reader=e,this.timeBetweenScansMillis=t,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(e){this._timeBetweenDecodingAttempts=e<0?0:e}set hints(e){this._hints=e||null}get hints(){return this._hints}listVideoInputDevices(){return Ke(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const e=yield navigator.mediaDevices.enumerateDevices(),t=[];for(const r of e){const i=r.kind==="video"?"videoinput":r.kind;if(i!=="videoinput")continue;const a=r.deviceId||r.id,l=r.label||`Video device ${t.length+1}`,d=r.groupId,g={deviceId:a,label:l,kind:i,groupId:d};t.push(g)}return t})}getVideoInputDevices(){return Ke(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(t=>new gn(t.deviceId,t.label))})}findDeviceById(e){return Ke(this,void 0,void 0,function*(){const t=yield this.listVideoInputDevices();return t?t.find(r=>r.deviceId===e):null})}decodeFromInputVideoDevice(e,t){return Ke(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(e,t)})}decodeOnceFromVideoDevice(e,t){return Ke(this,void 0,void 0,function*(){this.reset();let r;e?r={deviceId:{exact:e}}:r={facingMode:"environment"};const i={video:r};return yield this.decodeOnceFromConstraints(i,t)})}decodeOnceFromConstraints(e,t){return Ke(this,void 0,void 0,function*(){const r=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeOnceFromStream(r,t)})}decodeOnceFromStream(e,t){return Ke(this,void 0,void 0,function*(){this.reset();const r=yield this.attachStreamToVideo(e,t);return yield this.decodeOnce(r)})}decodeFromInputVideoDeviceContinuously(e,t,r){return Ke(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(e,t,r)})}decodeFromVideoDevice(e,t,r){return Ke(this,void 0,void 0,function*(){let i;e?i={deviceId:{exact:e}}:i={facingMode:"environment"};const a={video:i};return yield this.decodeFromConstraints(a,t,r)})}decodeFromConstraints(e,t,r){return Ke(this,void 0,void 0,function*(){const i=yield navigator.mediaDevices.getUserMedia(e);return yield this.decodeFromStream(i,t,r)})}decodeFromStream(e,t,r){return Ke(this,void 0,void 0,function*(){this.reset();const i=yield this.attachStreamToVideo(e,t);return yield this.decodeContinuously(i,r)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(e,t){return Ke(this,void 0,void 0,function*(){const r=this.prepareVideoElement(t);return this.addVideoSource(r,e),this.videoElement=r,this.stream=e,yield this.playVideoOnLoadAsync(r),r})}playVideoOnLoadAsync(e){return new Promise((t,r)=>this.playVideoOnLoad(e,()=>t()))}playVideoOnLoad(e,t){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(e),e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)}isVideoPlaying(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2}tryPlayVideo(e){return Ke(this,void 0,void 0,function*(){if(this.isVideoPlaying(e)){console.warn("Trying to play video that is already playing.");return}try{yield e.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(e,t){const r=document.getElementById(e);if(!r)throw new A(`element with id '${e}' not found`);if(r.nodeName.toLowerCase()!==t.toLowerCase())throw new A(`element with id '${e}' must be an ${t} element`);return r}decodeFromImage(e,t){if(!e&&!t)throw new A("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)}decodeFromVideo(e,t){if(!e&&!t)throw new A("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)}decodeFromVideoContinuously(e,t,r){if(e===void 0&&t===void 0)throw new A("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,r):this.decodeFromVideoElementContinuously(e,r)}decodeFromImageElement(e){if(!e)throw new A("An image element must be provided.");this.reset();const t=this.prepareImageElement(e);this.imageElement=t;let r;return this.isImageLoaded(t)?r=this.decodeOnce(t,!1,!0):r=this._decodeOnLoadImage(t),r}decodeFromVideoElement(e){const t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)}decodeFromVideoElementContinuously(e,t){const r=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(r,t)}_decodeFromVideoElementSetup(e){if(!e)throw new A("A video element must be provided.");this.reset();const t=this.prepareVideoElement(e);return this.videoElement=t,t}decodeFromImageUrl(e){if(!e)throw new A("An URL must be provided.");this.reset();const t=this.prepareImageElement();this.imageElement=t;const r=this._decodeOnLoadImage(t);return t.src=e,r}decodeFromVideoUrl(e){if(!e)throw new A("An URL must be provided.");this.reset();const t=this.prepareVideoElement(),r=this.decodeFromVideoElement(t);return t.src=e,r}decodeFromVideoUrlContinuously(e,t){if(!e)throw new A("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),i=this.decodeFromVideoElementContinuously(r,t);return r.src=e,i}_decodeOnLoadImage(e){return new Promise((t,r)=>{this.imageLoadedListener=()=>this.decodeOnce(e,!1,!0).then(t,r),e.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(e){return Ke(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(e),yield this.decodeOnce(e)})}_decodeOnLoadVideoContinuously(e,t){return Ke(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(e),this.decodeContinuously(e,t)})}isImageLoaded(e){return!(!e.complete||e.naturalWidth===0)}prepareImageElement(e){let t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t}prepareVideoElement(e){let t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t}decodeOnce(e,t=!0,r=!0){this._stopAsyncDecode=!1;const i=(a,l)=>{if(this._stopAsyncDecode){l(new z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const d=this.decode(e);a(d)}catch(d){const g=t&&d instanceof z,y=(d instanceof M||d instanceof $)&&r;if(g||y)return setTimeout(i,this._timeBetweenDecodingAttempts,a,l);l(d)}};return new Promise((a,l)=>i(a,l))}decodeContinuously(e,t){this._stopContinuousDecode=!1;const r=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const i=this.decode(e);t(i,null),setTimeout(r,this.timeBetweenScansMillis)}catch(i){t(null,i);const a=i instanceof M||i instanceof $,l=i instanceof z;(a||l)&&setTimeout(r,this._timeBetweenDecodingAttempts)}};r()}decode(e){const t=this.createBinaryBitmap(e);return this.decodeBitmap(t)}_isHTMLVideoElement(e){return e.videoWidth!==0}drawFrameOnCanvas(e,t,r){t||(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),r||(r=this.captureCanvasContext),r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}drawImageOnCanvas(e,t,r=this.captureCanvasContext){t||(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),r||(r=this.captureCanvasContext),r.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)}createBinaryBitmap(e){this.getCaptureCanvasContext(e),this._isHTMLVideoElement(e)?this.drawFrameOnCanvas(e):this.drawImageOnCanvas(e);const t=this.getCaptureCanvas(e),r=new Et(t),i=new de(r);return new I(i)}getCaptureCanvasContext(e){if(!this.captureCanvasContext){const r=this.getCaptureCanvas(e).getContext("2d");this.captureCanvasContext=r}return this.captureCanvasContext}getCaptureCanvas(e){if(!this.captureCanvas){const t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas}decodeBitmap(e){return this.reader.decode(e,this._hints)}createCaptureCanvas(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const t=document.createElement("canvas");let r,i;return typeof e<"u"&&(e instanceof HTMLVideoElement?(r=e.videoWidth,i=e.videoHeight):e instanceof HTMLImageElement&&(r=e.naturalWidth||e.width,i=e.naturalHeight||e.height)),t.style.width=r+"px",t.style.height=i+"px",t.width=r,t.height=i,t}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(e=>e.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}}cleanVideoSource(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")}}class it{constructor(e,t,r=t==null?0:8*t.length,i,a,l=k.currentTimeMillis()){this.text=e,this.rawBytes=t,this.numBits=r,this.resultPoints=i,this.format=a,this.timestamp=l,this.text=e,this.rawBytes=t,r==null?this.numBits=t==null?0:8*t.length:this.numBits=r,this.resultPoints=i,this.format=a,this.resultMetadata=null,l==null?this.timestamp=k.currentTimeMillis():this.timestamp=l}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)}putAllMetadata(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))}addResultPoints(e){const t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){const r=new Array(t.length+e.length);k.arraycopy(t,0,r,0,t.length),k.arraycopy(e,0,r,t.length,e.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ne;(function(b){b[b.AZTEC=0]="AZTEC",b[b.CODABAR=1]="CODABAR",b[b.CODE_39=2]="CODE_39",b[b.CODE_93=3]="CODE_93",b[b.CODE_128=4]="CODE_128",b[b.DATA_MATRIX=5]="DATA_MATRIX",b[b.EAN_8=6]="EAN_8",b[b.EAN_13=7]="EAN_13",b[b.ITF=8]="ITF",b[b.MAXICODE=9]="MAXICODE",b[b.PDF_417=10]="PDF_417",b[b.QR_CODE=11]="QR_CODE",b[b.RSS_14=12]="RSS_14",b[b.RSS_EXPANDED=13]="RSS_EXPANDED",b[b.UPC_A=14]="UPC_A",b[b.UPC_E=15]="UPC_E",b[b.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ne||(ne={}));var oe=ne,Mt;(function(b){b[b.OTHER=0]="OTHER",b[b.ORIENTATION=1]="ORIENTATION",b[b.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",b[b.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",b[b.ISSUE_NUMBER=4]="ISSUE_NUMBER",b[b.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",b[b.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",b[b.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",b[b.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",b[b.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",b[b.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Mt||(Mt={}));var Fe=Mt;class Rn{constructor(e,t,r,i,a=-1,l=-1){this.rawBytes=e,this.text=t,this.byteSegments=r,this.ecLevel=i,this.structuredAppendSequenceNumber=a,this.structuredAppendParity=l,this.numBits=e==null?0:8*e.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(e){this.numBits=e}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(e){this.errorsCorrected=e}getErasures(){return this.erasures}setErasures(e){this.erasures=e}getOther(){return this.other}setOther(e){this.other=e}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class xn{exp(e){return this.expTable[e]}log(e){if(e===0)throw new N;return this.logTable[e]}static addOrSubtract(e,t){return e^t}}class ft{constructor(e,t){if(t.length===0)throw new N;this.field=e;const r=t.length;if(r>1&&t[0]===0){let i=1;for(;i<r&&t[i]===0;)i++;i===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-i),k.arraycopy(t,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);const t=this.coefficients;let r;if(e===1){r=0;for(let l=0,d=t.length;l!==d;l++){const g=t[l];r=xn.addOrSubtract(r,g)}return r}r=t[0];const i=t.length,a=this.field;for(let l=1;l<i;l++)r=xn.addOrSubtract(a.multiply(e,r),t[l]);return r}addOrSubtract(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){const l=t;t=r,r=l}let i=new Int32Array(r.length);const a=r.length-t.length;k.arraycopy(r,0,i,0,a);for(let l=a;l<r.length;l++)i[l]=xn.addOrSubtract(t[l-a],r[l]);return new ft(this.field,i)}multiply(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();const t=this.coefficients,r=t.length,i=e.coefficients,a=i.length,l=new Int32Array(r+a-1),d=this.field;for(let g=0;g<r;g++){const x=t[g];for(let y=0;y<a;y++)l[g+y]=xn.addOrSubtract(l[g+y],d.multiply(x,i[y]))}return new ft(d,l)}multiplyScalar(e){if(e===0)return this.field.getZero();if(e===1)return this;const t=this.coefficients.length,r=this.field,i=new Int32Array(t),a=this.coefficients;for(let l=0;l<t;l++)i[l]=r.multiply(a[l],e);return new ft(r,i)}multiplyByMonomial(e,t){if(e<0)throw new N;if(t===0)return this.field.getZero();const r=this.coefficients,i=r.length,a=new Int32Array(i+e),l=this.field;for(let d=0;d<i;d++)a[d]=l.multiply(r[d],t);return new ft(l,a)}divide(e){if(!this.field.equals(e.field))throw new N("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new N("Divide by 0");const t=this.field;let r=t.getZero(),i=this;const a=e.getCoefficient(e.getDegree()),l=t.inverse(a);for(;i.getDegree()>=e.getDegree()&&!i.isZero();){const d=i.getDegree()-e.getDegree(),g=t.multiply(i.getCoefficient(i.getDegree()),l),x=e.multiplyByMonomial(d,g),y=t.buildMonomial(d,g);r=r.addOrSubtract(y),i=i.addOrSubtract(x)}return[r,i]}toString(){let e="";for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);if(r!==0){if(r<0?(e+=" - ",r=-r):e.length>0&&(e+=" + "),t===0||r!==1){const i=this.field.log(r);i===0?e+="1":i===1?e+="a":(e+="a^",e+=i)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e}}class Dr extends p{}Dr.kind="ArithmeticException";class ve extends xn{constructor(e,t,r){super(),this.primitive=e,this.size=t,this.generatorBase=r;const i=new Int32Array(t);let a=1;for(let d=0;d<t;d++)i[d]=a,a*=2,a>=t&&(a^=e,a&=t-1);this.expTable=i;const l=new Int32Array(t);for(let d=0;d<t-1;d++)l[i[d]]=d;this.logTable=l,this.zero=new ft(this,Int32Array.from([0])),this.one=new ft(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new N;if(t===0)return this.zero;const r=new Int32Array(e+1);return r[0]=t,new ft(this,r)}inverse(e){if(e===0)throw new Dr;return this.expTable[this.size-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+B.toHexString(this.primitive)+","+this.size+")"}equals(e){return e===this}}ve.AZTEC_DATA_12=new ve(4201,4096,1),ve.AZTEC_DATA_10=new ve(1033,1024,1),ve.AZTEC_DATA_6=new ve(67,64,1),ve.AZTEC_PARAM=new ve(19,16,1),ve.QR_CODE_FIELD_256=new ve(285,256,0),ve.DATA_MATRIX_FIELD_256=new ve(301,256,1),ve.AZTEC_DATA_8=ve.DATA_MATRIX_FIELD_256,ve.MAXICODE_FIELD_64=ve.AZTEC_DATA_6;class Xn extends p{}Xn.kind="ReedSolomonException";class $t extends p{}$t.kind="IllegalStateException";class dr{constructor(e){this.field=e}decode(e,t){const r=this.field,i=new ft(r,e),a=new Int32Array(t);let l=!0;for(let S=0;S<t;S++){const O=i.evaluateAt(r.exp(S+r.getGeneratorBase()));a[a.length-1-S]=O,O!==0&&(l=!1)}if(l)return;const d=new ft(r,a),g=this.runEuclideanAlgorithm(r.buildMonomial(t,1),d,t),x=g[0],y=g[1],C=this.findErrorLocations(x),v=this.findErrorMagnitudes(y,C);for(let S=0;S<C.length;S++){const O=e.length-1-r.log(C[S]);if(O<0)throw new Xn("Bad error location");e[O]=ve.addOrSubtract(e[O],v[S])}}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){const S=e;e=t,t=S}const i=this.field;let a=e,l=t,d=i.getZero(),g=i.getOne();for(;l.getDegree()>=(r/2|0);){let S=a,O=d;if(a=l,d=g,a.isZero())throw new Xn("r_{i-1} was zero");l=S;let D=i.getZero();const P=a.getCoefficient(a.getDegree()),Z=i.inverse(P);for(;l.getDegree()>=a.getDegree()&&!l.isZero();){const J=l.getDegree()-a.getDegree(),ee=i.multiply(l.getCoefficient(l.getDegree()),Z);D=D.addOrSubtract(i.buildMonomial(J,ee)),l=l.addOrSubtract(a.multiplyByMonomial(J,ee))}if(g=D.multiply(d).addOrSubtract(O),l.getDegree()>=a.getDegree())throw new $t("Division algorithm failed to reduce polynomial?")}const x=g.getCoefficient(0);if(x===0)throw new Xn("sigmaTilde(0) was zero");const y=i.inverse(x),C=g.multiplyScalar(y),v=l.multiplyScalar(y);return[C,v]}findErrorLocations(e){const t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);const r=new Int32Array(t);let i=0;const a=this.field;for(let l=1;l<a.getSize()&&i<t;l++)e.evaluateAt(l)===0&&(r[i]=a.inverse(l),i++);if(i!==t)throw new Xn("Error locator degree does not match number of roots");return r}findErrorMagnitudes(e,t){const r=t.length,i=new Int32Array(r),a=this.field;for(let l=0;l<r;l++){const d=a.inverse(t[l]);let g=1;for(let x=0;x<r;x++)if(l!==x){const y=a.multiply(t[x],d),C=y&1?y&-2:y|1;g=a.multiply(g,C)}i[l]=a.multiply(e.evaluateAt(d),a.inverse(g)),a.getGeneratorBase()!==0&&(i[l]=a.multiply(i[l],d))}return i}}var gt;(function(b){b[b.UPPER=0]="UPPER",b[b.LOWER=1]="LOWER",b[b.MIXED=2]="MIXED",b[b.DIGIT=3]="DIGIT",b[b.PUNCT=4]="PUNCT",b[b.BINARY=5]="BINARY"})(gt||(gt={}));class Le{decode(e){this.ddata=e;let t=e.getBits(),r=this.extractBits(t),i=this.correctBits(r),a=Le.convertBoolArrayToByteArray(i),l=Le.getEncodedData(i),d=new Rn(a,l,null,null);return d.setNumBits(i.length),d}static highLevelDecode(e){return this.getEncodedData(e)}static getEncodedData(e){let t=e.length,r=gt.UPPER,i=gt.UPPER,a="",l=0;for(;l<t;)if(i===gt.BINARY){if(t-l<5)break;let d=Le.readCode(e,l,5);if(l+=5,d===0){if(t-l<11)break;d=Le.readCode(e,l,11)+31,l+=11}for(let g=0;g<d;g++){if(t-l<8){l=t;break}const x=Le.readCode(e,l,8);a+=X.castAsNonUtf8Char(x),l+=8}i=r}else{let d=i===gt.DIGIT?4:5;if(t-l<d)break;let g=Le.readCode(e,l,d);l+=d;let x=Le.getCharacter(i,g);x.startsWith("CTRL_")?(r=i,i=Le.getTable(x.charAt(5)),x.charAt(6)==="L"&&(r=i)):(a+=x,i=r)}return a}static getTable(e){switch(e){case"L":return gt.LOWER;case"P":return gt.PUNCT;case"M":return gt.MIXED;case"D":return gt.DIGIT;case"B":return gt.BINARY;case"U":default:return gt.UPPER}}static getCharacter(e,t){switch(e){case gt.UPPER:return Le.UPPER_TABLE[t];case gt.LOWER:return Le.LOWER_TABLE[t];case gt.MIXED:return Le.MIXED_TABLE[t];case gt.PUNCT:return Le.PUNCT_TABLE[t];case gt.DIGIT:return Le.DIGIT_TABLE[t];default:throw new $t("Bad table")}}correctBits(e){let t,r;this.ddata.getNbLayers()<=2?(r=6,t=ve.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,t=ve.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,t=ve.AZTEC_DATA_10):(r=12,t=ve.AZTEC_DATA_12);let i=this.ddata.getNbDatablocks(),a=e.length/r;if(a<i)throw new $;let l=e.length%r,d=new Int32Array(a);for(let v=0;v<a;v++,l+=r)d[v]=Le.readCode(e,l,r);try{new dr(t).decode(d,a-i)}catch(v){throw new $(v)}let g=(1<<r)-1,x=0;for(let v=0;v<i;v++){let S=d[v];if(S===0||S===g)throw new $;(S===1||S===g-1)&&x++}let y=new Array(i*r-x),C=0;for(let v=0;v<i;v++){let S=d[v];if(S===1||S===g-1)y.fill(S>1,C,C+r-1),C+=r-1;else for(let O=r-1;O>=0;--O)y[C++]=(S&1<<O)!==0}return y}extractBits(e){let t=this.ddata.isCompact(),r=this.ddata.getNbLayers(),i=(t?11:14)+r*4,a=new Int32Array(i),l=new Array(this.totalBitsInLayer(r,t));if(t)for(let d=0;d<a.length;d++)a[d]=d;else{let d=i+1+2*B.truncDivision(B.truncDivision(i,2)-1,15),g=i/2,x=B.truncDivision(d,2);for(let y=0;y<g;y++){let C=y+B.truncDivision(y,15);a[g-y-1]=x-C-1,a[g+y]=x+C+1}}for(let d=0,g=0;d<r;d++){let x=(r-d)*4+(t?9:12),y=d*2,C=i-1-y;for(let v=0;v<x;v++){let S=v*2;for(let O=0;O<2;O++)l[g+S+O]=e.get(a[y+O],a[y+v]),l[g+2*x+S+O]=e.get(a[y+v],a[C-O]),l[g+4*x+S+O]=e.get(a[C-O],a[C-v]),l[g+6*x+S+O]=e.get(a[C-v],a[y+O])}g+=x*8}return l}static readCode(e,t,r){let i=0;for(let a=t;a<t+r;a++)i<<=1,e[a]&&(i|=1);return i}static readByte(e,t){let r=e.length-t;return r>=8?Le.readCode(e,t,8):Le.readCode(e,t,r)<<8-r}static convertBoolArrayToByteArray(e){let t=new Uint8Array((e.length+7)/8);for(let r=0;r<t.length;r++)t[r]=Le.readByte(e,8*r);return t}totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Le.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Le.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Le.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Le.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Le.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class Ne{constructor(){}static round(e){return e===NaN?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0}static distance(e,t,r,i){const a=e-r,l=t-i;return Math.sqrt(a*a+l*l)}static sum(e){let t=0;for(let r=0,i=e.length;r!==i;r++){const a=e[r];t+=a}return t}}class jr{static floatToIntBits(e){return e}}jr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class le{constructor(e,t){this.x=e,this.y=t}getX(){return this.x}getY(){return this.y}equals(e){if(e instanceof le){const t=e;return this.x===t.x&&this.y===t.y}return!1}hashCode(){return 31*jr.floatToIntBits(this.x)+jr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(e){const t=this.distance(e[0],e[1]),r=this.distance(e[1],e[2]),i=this.distance(e[0],e[2]);let a,l,d;if(r>=t&&r>=i?(l=e[0],a=e[1],d=e[2]):i>=r&&i>=t?(l=e[1],a=e[0],d=e[2]):(l=e[2],a=e[0],d=e[1]),this.crossProductZ(a,l,d)<0){const g=a;a=d,d=g}e[0]=a,e[1]=l,e[2]=d}static distance(e,t){return Ne.distance(e.x,e.y,t.x,t.y)}static crossProductZ(e,t,r){const i=t.x,a=t.y;return(r.x-i)*(e.y-a)-(r.y-a)*(e.x-i)}}class Rr{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class Ti extends Rr{constructor(e,t,r,i,a){super(e,t),this.compact=r,this.nbDatablocks=i,this.nbLayers=a}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ln{constructor(e,t,r,i){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=ln.INIT_SIZE),r==null&&(r=e.getWidth()/2|0),i==null&&(i=e.getHeight()/2|0);const a=t/2|0;if(this.leftInit=r-a,this.rightInit=r+a,this.upInit=i-a,this.downInit=i+a,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new z}detect(){let e=this.leftInit,t=this.rightInit,r=this.upInit,i=this.downInit,a=!1,l=!0,d=!1,g=!1,x=!1,y=!1,C=!1;const v=this.width,S=this.height;for(;l;){l=!1;let O=!0;for(;(O||!g)&&t<v;)O=this.containsBlackPoint(r,i,t,!1),O?(t++,l=!0,g=!0):g||t++;if(t>=v){a=!0;break}let D=!0;for(;(D||!x)&&i<S;)D=this.containsBlackPoint(e,t,i,!0),D?(i++,l=!0,x=!0):x||i++;if(i>=S){a=!0;break}let P=!0;for(;(P||!y)&&e>=0;)P=this.containsBlackPoint(r,i,e,!1),P?(e--,l=!0,y=!0):y||e--;if(e<0){a=!0;break}let Z=!0;for(;(Z||!C)&&r>=0;)Z=this.containsBlackPoint(e,t,r,!0),Z?(r--,l=!0,C=!0):C||r--;if(r<0){a=!0;break}l&&(d=!0)}if(!a&&d){const O=t-e;let D=null;for(let ee=1;D===null&&ee<O;ee++)D=this.getBlackPointOnSegment(e,i-ee,e+ee,i);if(D==null)throw new z;let P=null;for(let ee=1;P===null&&ee<O;ee++)P=this.getBlackPointOnSegment(e,r+ee,e+ee,r);if(P==null)throw new z;let Z=null;for(let ee=1;Z===null&&ee<O;ee++)Z=this.getBlackPointOnSegment(t,r+ee,t-ee,r);if(Z==null)throw new z;let J=null;for(let ee=1;J===null&&ee<O;ee++)J=this.getBlackPointOnSegment(t,i-ee,t-ee,i);if(J==null)throw new z;return this.centerEdges(J,D,Z,P)}else throw new z}getBlackPointOnSegment(e,t,r,i){const a=Ne.round(Ne.distance(e,t,r,i)),l=(r-e)/a,d=(i-t)/a,g=this.image;for(let x=0;x<a;x++){const y=Ne.round(e+x*l),C=Ne.round(t+x*d);if(g.get(y,C))return new le(y,C)}return null}centerEdges(e,t,r,i){const a=e.getX(),l=e.getY(),d=t.getX(),g=t.getY(),x=r.getX(),y=r.getY(),C=i.getX(),v=i.getY(),S=ln.CORR;return a<this.width/2?[new le(C-S,v+S),new le(d+S,g+S),new le(x-S,y-S),new le(a+S,l-S)]:[new le(C+S,v+S),new le(d+S,g-S),new le(x-S,y+S),new le(a-S,l-S)]}containsBlackPoint(e,t,r,i){const a=this.image;if(i){for(let l=e;l<=t;l++)if(a.get(l,r))return!0}else for(let l=e;l<=t;l++)if(a.get(r,l))return!0;return!1}}ln.INIT_SIZE=10,ln.CORR=1;class ys{static checkAndNudgePoints(e,t){const r=e.getWidth(),i=e.getHeight();let a=!0;for(let l=0;l<t.length&&a;l+=2){const d=Math.floor(t[l]),g=Math.floor(t[l+1]);if(d<-1||d>r||g<-1||g>i)throw new z;a=!1,d===-1?(t[l]=0,a=!0):d===r&&(t[l]=r-1,a=!0),g===-1?(t[l+1]=0,a=!0):g===i&&(t[l+1]=i-1,a=!0)}a=!0;for(let l=t.length-2;l>=0&&a;l-=2){const d=Math.floor(t[l]),g=Math.floor(t[l+1]);if(d<-1||d>r||g<-1||g>i)throw new z;a=!1,d===-1?(t[l]=0,a=!0):d===r&&(t[l]=r-1,a=!0),g===-1?(t[l+1]=0,a=!0):g===i&&(t[l+1]=i-1,a=!0)}}}class Gt{constructor(e,t,r,i,a,l,d,g,x){this.a11=e,this.a21=t,this.a31=r,this.a12=i,this.a22=a,this.a32=l,this.a13=d,this.a23=g,this.a33=x}static quadrilateralToQuadrilateral(e,t,r,i,a,l,d,g,x,y,C,v,S,O,D,P){const Z=Gt.quadrilateralToSquare(e,t,r,i,a,l,d,g);return Gt.squareToQuadrilateral(x,y,C,v,S,O,D,P).times(Z)}transformPoints(e){const t=e.length,r=this.a11,i=this.a12,a=this.a13,l=this.a21,d=this.a22,g=this.a23,x=this.a31,y=this.a32,C=this.a33;for(let v=0;v<t;v+=2){const S=e[v],O=e[v+1],D=a*S+g*O+C;e[v]=(r*S+l*O+x)/D,e[v+1]=(i*S+d*O+y)/D}}transformPointsWithValues(e,t){const r=this.a11,i=this.a12,a=this.a13,l=this.a21,d=this.a22,g=this.a23,x=this.a31,y=this.a32,C=this.a33,v=e.length;for(let S=0;S<v;S++){const O=e[S],D=t[S],P=a*O+g*D+C;e[S]=(r*O+l*D+x)/P,t[S]=(i*O+d*D+y)/P}}static squareToQuadrilateral(e,t,r,i,a,l,d,g){const x=e-r+a-d,y=t-i+l-g;if(x===0&&y===0)return new Gt(r-e,a-r,e,i-t,l-i,t,0,0,1);{const C=r-a,v=d-a,S=i-l,O=g-l,D=C*O-v*S,P=(x*O-v*y)/D,Z=(C*y-x*S)/D;return new Gt(r-e+P*r,d-e+Z*d,e,i-t+P*i,g-t+Z*g,t,P,Z,1)}}static quadrilateralToSquare(e,t,r,i,a,l,d,g){return Gt.squareToQuadrilateral(e,t,r,i,a,l,d,g).buildAdjoint()}buildAdjoint(){return new Gt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(e){return new Gt(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}class Oi extends ys{sampleGrid(e,t,r,i,a,l,d,g,x,y,C,v,S,O,D,P,Z,J,ee){const Q=Gt.quadrilateralToQuadrilateral(i,a,l,d,g,x,y,C,v,S,O,D,P,Z,J,ee);return this.sampleGridWithTransform(e,t,r,Q)}sampleGridWithTransform(e,t,r,i){if(t<=0||r<=0)throw new z;const a=new ce(t,r),l=new Float32Array(2*t);for(let d=0;d<r;d++){const g=l.length,x=d+.5;for(let y=0;y<g;y+=2)l[y]=y/2+.5,l[y+1]=x;i.transformPoints(l),ys.checkAndNudgePoints(e,l);try{for(let y=0;y<g;y+=2)e.get(Math.floor(l[y]),Math.floor(l[y+1]))&&a.set(y/2,d)}catch{throw new z}}return a}}class mn{static setGridSampler(e){mn.gridSampler=e}static getInstance(){return mn.gridSampler}}mn.gridSampler=new Oi;class Ct{constructor(e,t){this.x=e,this.y=t}toResultPoint(){return new le(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Mi{constructor(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}detect(){return this.detectMirror(!1)}detectMirror(e){let t=this.getMatrixCenter(),r=this.getBullsEyeCorners(t);if(e){let l=r[0];r[0]=r[2],r[2]=l}this.extractParameters(r);let i=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),a=this.getMatrixCornerPoints(r);return new Ti(i,a,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new z;let t=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(r,t);let i=0;for(let l=0;l<4;l++){let d=r[(this.shift+l)%4];this.compact?(i<<=7,i+=d>>1&127):(i<<=10,i+=(d>>2&992)+(d>>1&31))}let a=this.getCorrectedParameterData(i,this.compact);this.compact?(this.nbLayers=(a>>6)+1,this.nbDataBlocks=(a&63)+1):(this.nbLayers=(a>>11)+1,this.nbDataBlocks=(a&2047)+1)}getRotation(e,t){let r=0;e.forEach((i,a,l)=>{let d=(i>>t-2<<1)+(i&1);r=(r<<3)+d}),r=((r&1)<<11)+(r>>1);for(let i=0;i<4;i++)if(B.bitCount(r^this.EXPECTED_CORNER_BITS[i])<=2)return i;throw new z}getCorrectedParameterData(e,t){let r,i;t?(r=7,i=2):(r=10,i=4);let a=r-i,l=new Int32Array(r);for(let g=r-1;g>=0;--g)l[g]=e&15,e>>=4;try{new dr(ve.AZTEC_PARAM).decode(l,a)}catch{throw new z}let d=0;for(let g=0;g<i;g++)d=(d<<4)+l[g];return d}getBullsEyeCorners(e){let t=e,r=e,i=e,a=e,l=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let C=this.getFirstDifferent(t,l,1,-1),v=this.getFirstDifferent(r,l,1,1),S=this.getFirstDifferent(i,l,-1,1),O=this.getFirstDifferent(a,l,-1,-1);if(this.nbCenterLayers>2){let D=this.distancePoint(O,C)*this.nbCenterLayers/(this.distancePoint(a,t)*(this.nbCenterLayers+2));if(D<.75||D>1.25||!this.isWhiteOrBlackRectangle(C,v,S,O))break}t=C,r=v,i=S,a=O,l=!l}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new z;this.compact=this.nbCenterLayers===5;let d=new le(t.getX()+.5,t.getY()-.5),g=new le(r.getX()+.5,r.getY()+.5),x=new le(i.getX()-.5,i.getY()+.5),y=new le(a.getX()-.5,a.getY()-.5);return this.expandSquare([d,g,x,y],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let e,t,r,i;try{let d=new ln(this.image).detect();e=d[0],t=d[1],r=d[2],i=d[3]}catch{let g=this.image.getWidth()/2,x=this.image.getHeight()/2;e=this.getFirstDifferent(new Ct(g+7,x-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Ct(g+7,x+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new Ct(g-7,x+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new Ct(g-7,x-7),!1,-1,-1).toResultPoint()}let a=Ne.round((e.getX()+i.getX()+t.getX()+r.getX())/4),l=Ne.round((e.getY()+i.getY()+t.getY()+r.getY())/4);try{let d=new ln(this.image,15,a,l).detect();e=d[0],t=d[1],r=d[2],i=d[3]}catch{e=this.getFirstDifferent(new Ct(a+7,l-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Ct(a+7,l+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new Ct(a-7,l+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new Ct(a-7,l-7),!1,-1,-1).toResultPoint()}return a=Ne.round((e.getX()+i.getX()+t.getX()+r.getX())/4),l=Ne.round((e.getY()+i.getY()+t.getY()+r.getY())/4),new Ct(a,l)}getMatrixCornerPoints(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())}sampleGrid(e,t,r,i,a){let l=mn.getInstance(),d=this.getDimension(),g=d/2-this.nbCenterLayers,x=d/2+this.nbCenterLayers;return l.sampleGrid(e,d,d,g,g,x,g,x,x,g,x,t.getX(),t.getY(),r.getX(),r.getY(),i.getX(),i.getY(),a.getX(),a.getY())}sampleLine(e,t,r){let i=0,a=this.distanceResultPoint(e,t),l=a/r,d=e.getX(),g=e.getY(),x=l*(t.getX()-e.getX())/a,y=l*(t.getY()-e.getY())/a;for(let C=0;C<r;C++)this.image.get(Ne.round(d+C*x),Ne.round(g+C*y))&&(i|=1<<r-C-1);return i}isWhiteOrBlackRectangle(e,t,r,i){let a=3;e=new Ct(e.getX()-a,e.getY()+a),t=new Ct(t.getX()-a,t.getY()-a),r=new Ct(r.getX()+a,r.getY()-a),i=new Ct(i.getX()+a,i.getY()+a);let l=this.getColor(i,e);if(l===0)return!1;let d=this.getColor(e,t);return d!==l||(d=this.getColor(t,r),d!==l)?!1:(d=this.getColor(r,i),d===l)}getColor(e,t){let r=this.distancePoint(e,t),i=(t.getX()-e.getX())/r,a=(t.getY()-e.getY())/r,l=0,d=e.getX(),g=e.getY(),x=this.image.get(e.getX(),e.getY()),y=Math.ceil(r);for(let v=0;v<y;v++)d+=i,g+=a,this.image.get(Ne.round(d),Ne.round(g))!==x&&l++;let C=l/r;return C>.1&&C<.9?0:C<=.1===x?1:-1}getFirstDifferent(e,t,r,i){let a=e.getX()+r,l=e.getY()+i;for(;this.isValid(a,l)&&this.image.get(a,l)===t;)a+=r,l+=i;for(a-=r,l-=i;this.isValid(a,l)&&this.image.get(a,l)===t;)a+=r;for(a-=r;this.isValid(a,l)&&this.image.get(a,l)===t;)l+=i;return l-=i,new Ct(a,l)}expandSquare(e,t,r){let i=r/(2*t),a=e[0].getX()-e[2].getX(),l=e[0].getY()-e[2].getY(),d=(e[0].getX()+e[2].getX())/2,g=(e[0].getY()+e[2].getY())/2,x=new le(d+i*a,g+i*l),y=new le(d-i*a,g-i*l);a=e[1].getX()-e[3].getX(),l=e[1].getY()-e[3].getY(),d=(e[1].getX()+e[3].getX())/2,g=(e[1].getY()+e[3].getY())/2;let C=new le(d+i*a,g+i*l),v=new le(d-i*a,g-i*l);return[x,C,y,v]}isValid(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()}isValidPoint(e){let t=Ne.round(e.getX()),r=Ne.round(e.getY());return this.isValid(t,r)}distancePoint(e,t){return Ne.distance(e.getX(),e.getY(),t.getX(),t.getY())}distanceResultPoint(e,t){return Ne.distance(e.getX(),e.getY(),t.getX(),t.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(B.truncDivision(this.nbLayers-4,8)+1)+15}}class kr{decode(e,t=null){let r=null,i=new Mi(e.getBlackMatrix()),a=null,l=null;try{let y=i.detectMirror(!1);a=y.getPoints(),this.reportFoundResultPoints(t,a),l=new Le().decode(y)}catch(y){r=y}if(l==null)try{let y=i.detectMirror(!0);a=y.getPoints(),this.reportFoundResultPoints(t,a),l=new Le().decode(y)}catch(y){throw r??y}let d=new it(l.getText(),l.getRawBytes(),l.getNumBits(),a,oe.AZTEC,k.currentTimeMillis()),g=l.getByteSegments();g!=null&&d.putMetadata(Fe.BYTE_SEGMENTS,g);let x=l.getECLevel();return x!=null&&d.putMetadata(Fe.ERROR_CORRECTION_LEVEL,x),d}reportFoundResultPoints(e,t){if(e!=null){let r=e.get(re.NEED_RESULT_POINT_CALLBACK);r!=null&&t.forEach((i,a,l)=>{r.foundPossibleResultPoint(i)})}}reset(){}}class nl extends Wt{constructor(e=500){super(new kr,e)}}class rt{decode(e,t){try{return this.doDecode(e,t)}catch{if(t&&t.get(re.TRY_HARDER)===!0&&e.isRotateSupported()){const a=e.rotateCounterClockwise(),l=this.doDecode(a,t),d=l.getResultMetadata();let g=270;d!==null&&d.get(Fe.ORIENTATION)===!0&&(g=g+d.get(Fe.ORIENTATION)%360),l.putMetadata(Fe.ORIENTATION,g);const x=l.getResultPoints();if(x!==null){const y=a.getHeight();for(let C=0;C<x.length;C++)x[C]=new le(y-x[C].getY()-1,x[C].getX())}return l}else throw new z}}reset(){}doDecode(e,t){const r=e.getWidth(),i=e.getHeight();let a=new K(r);const l=t&&t.get(re.TRY_HARDER)===!0,d=Math.max(1,i>>(l?8:5));let g;l?g=i:g=15;const x=Math.trunc(i/2);for(let y=0;y<g;y++){const C=Math.trunc((y+1)/2),v=(y&1)===0,S=x+d*(v?C:-C);if(S<0||S>=i)break;try{a=e.getBlackRow(S,a)}catch{continue}for(let O=0;O<2;O++){if(O===1&&(a.reverse(),t&&t.get(re.NEED_RESULT_POINT_CALLBACK)===!0)){const D=new Map;t.forEach((P,Z)=>D.set(Z,P)),D.delete(re.NEED_RESULT_POINT_CALLBACK),t=D}try{const D=this.decodeRow(S,a,t);if(O===1){D.putMetadata(Fe.ORIENTATION,180);const P=D.getResultPoints();P!==null&&(P[0]=new le(r-P[0].getX()-1,P[0].getY()),P[1]=new le(r-P[1].getX()-1,P[1].getY()))}return D}catch{}}}throw new z}static recordPattern(e,t,r){const i=r.length;for(let x=0;x<i;x++)r[x]=0;const a=e.getSize();if(t>=a)throw new z;let l=!e.get(t),d=0,g=t;for(;g<a;){if(e.get(g)!==l)r[d]++;else{if(++d===i)break;r[d]=1,l=!l}g++}if(!(d===i||d===i-1&&g===a))throw new z}static recordPatternInReverse(e,t,r){let i=r.length,a=e.get(t);for(;t>0&&i>=0;)e.get(--t)!==a&&(i--,a=!a);if(i>=0)throw new z;rt.recordPattern(e,t+1,r)}static patternMatchVariance(e,t,r){const i=e.length;let a=0,l=0;for(let x=0;x<i;x++)a+=e[x],l+=t[x];if(a<l)return Number.POSITIVE_INFINITY;const d=a/l;r*=d;let g=0;for(let x=0;x<i;x++){const y=e[x],C=t[x]*d,v=y>C?y-C:C-y;if(v>r)return Number.POSITIVE_INFINITY;g+=v}return g/a}}class se extends rt{static findStartPattern(e){const t=e.getSize(),r=e.getNextSet(0);let i=0,a=Int32Array.from([0,0,0,0,0,0]),l=r,d=!1;const g=6;for(let x=r;x<t;x++)if(e.get(x)!==d)a[i]++;else{if(i===g-1){let y=se.MAX_AVG_VARIANCE,C=-1;for(let v=se.CODE_START_A;v<=se.CODE_START_C;v++){const S=rt.patternMatchVariance(a,se.CODE_PATTERNS[v],se.MAX_INDIVIDUAL_VARIANCE);S<y&&(y=S,C=v)}if(C>=0&&e.isRange(Math.max(0,l-(x-l)/2),l,!1))return Int32Array.from([l,x,C]);l+=a[0]+a[1],a=a.slice(2,a.length-1),a[i-1]=0,a[i]=0,i--}else i++;a[i]=1,d=!d}throw new z}static decodeCode(e,t,r){rt.recordPattern(e,r,t);let i=se.MAX_AVG_VARIANCE,a=-1;for(let l=0;l<se.CODE_PATTERNS.length;l++){const d=se.CODE_PATTERNS[l],g=this.patternMatchVariance(t,d,se.MAX_INDIVIDUAL_VARIANCE);g<i&&(i=g,a=l)}if(a>=0)return a;throw new z}decodeRow(e,t,r){const i=r&&r.get(re.ASSUME_GS1)===!0,a=se.findStartPattern(t),l=a[2];let d=0;const g=new Uint8Array(20);g[d++]=l;let x;switch(l){case se.CODE_START_A:x=se.CODE_CODE_A;break;case se.CODE_START_B:x=se.CODE_CODE_B;break;case se.CODE_START_C:x=se.CODE_CODE_C;break;default:throw new $}let y=!1,C=!1,v="",S=a[0],O=a[1];const D=Int32Array.from([0,0,0,0,0,0]);let P=0,Z=0,J=l,ee=0,Q=!0,be=!1,me=!1;for(;!y;){const rr=C;switch(C=!1,P=Z,Z=se.decodeCode(t,D,O),g[d++]=Z,Z!==se.CODE_STOP&&(Q=!0),Z!==se.CODE_STOP&&(ee++,J+=ee*Z),S=O,O+=D.reduce((Ml,Dl)=>Ml+Dl,0),Z){case se.CODE_START_A:case se.CODE_START_B:case se.CODE_START_C:throw new $}switch(x){case se.CODE_CODE_A:if(Z<64)me===be?v+=String.fromCharCode(32+Z):v+=String.fromCharCode(32+Z+128),me=!1;else if(Z<96)me===be?v+=String.fromCharCode(Z-64):v+=String.fromCharCode(Z+64),me=!1;else switch(Z!==se.CODE_STOP&&(Q=!1),Z){case se.CODE_FNC_1:i&&(v.length===0?v+="]C1":v+="");break;case se.CODE_FNC_2:case se.CODE_FNC_3:break;case se.CODE_FNC_4_A:!be&&me?(be=!0,me=!1):be&&me?(be=!1,me=!1):me=!0;break;case se.CODE_SHIFT:C=!0,x=se.CODE_CODE_B;break;case se.CODE_CODE_B:x=se.CODE_CODE_B;break;case se.CODE_CODE_C:x=se.CODE_CODE_C;break;case se.CODE_STOP:y=!0;break}break;case se.CODE_CODE_B:if(Z<96)me===be?v+=String.fromCharCode(32+Z):v+=String.fromCharCode(32+Z+128),me=!1;else switch(Z!==se.CODE_STOP&&(Q=!1),Z){case se.CODE_FNC_1:i&&(v.length===0?v+="]C1":v+="");break;case se.CODE_FNC_2:case se.CODE_FNC_3:break;case se.CODE_FNC_4_B:!be&&me?(be=!0,me=!1):be&&me?(be=!1,me=!1):me=!0;break;case se.CODE_SHIFT:C=!0,x=se.CODE_CODE_A;break;case se.CODE_CODE_A:x=se.CODE_CODE_A;break;case se.CODE_CODE_C:x=se.CODE_CODE_C;break;case se.CODE_STOP:y=!0;break}break;case se.CODE_CODE_C:if(Z<100)Z<10&&(v+="0"),v+=Z;else switch(Z!==se.CODE_STOP&&(Q=!1),Z){case se.CODE_FNC_1:i&&(v.length===0?v+="]C1":v+="");break;case se.CODE_CODE_A:x=se.CODE_CODE_A;break;case se.CODE_CODE_B:x=se.CODE_CODE_B;break;case se.CODE_STOP:y=!0;break}break}rr&&(x=x===se.CODE_CODE_A?se.CODE_CODE_B:se.CODE_CODE_A)}const It=O-S;if(O=t.getNextUnset(O),!t.isRange(O,Math.min(t.getSize(),O+(O-S)/2),!1))throw new z;if(J-=ee*P,J%103!==P)throw new M;const Xt=v.length;if(Xt===0)throw new z;Xt>0&&Q&&(x===se.CODE_CODE_C?v=v.substring(0,Xt-2):v=v.substring(0,Xt-1));const Tt=(a[1]+a[0])/2,ke=S+It/2,pt=g.length,Dt=new Uint8Array(pt);for(let rr=0;rr<pt;rr++)Dt[rr]=g[rr];const nr=[new le(Tt,e),new le(ke,e)];return new it(v,Dt,0,nr,oe.CODE_128,new Date().getTime())}}se.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],se.MAX_AVG_VARIANCE=.25,se.MAX_INDIVIDUAL_VARIANCE=.7,se.CODE_SHIFT=98,se.CODE_CODE_C=99,se.CODE_CODE_B=100,se.CODE_CODE_A=101,se.CODE_FNC_1=102,se.CODE_FNC_2=97,se.CODE_FNC_3=96,se.CODE_FNC_4_A=101,se.CODE_FNC_4_B=100,se.CODE_START_A=103,se.CODE_START_B=104,se.CODE_START_C=105,se.CODE_STOP=106;class at extends rt{constructor(e=!1,t=!1){super(),this.usingCheckDigit=e,this.extendedMode=t,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(e,t,r){let i=this.counters;i.fill(0),this.decodeRowResult="";let a=at.findAsteriskPattern(t,i),l=t.getNextSet(a[1]),d=t.getSize(),g,x;do{at.recordPattern(t,l,i);let D=at.toNarrowWidePattern(i);if(D<0)throw new z;g=at.patternToChar(D),this.decodeRowResult+=g,x=l;for(let P of i)l+=P;l=t.getNextSet(l)}while(g!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let y=0;for(let D of i)y+=D;let C=l-x-y;if(l!==d&&C*2<y)throw new z;if(this.usingCheckDigit){let D=this.decodeRowResult.length-1,P=0;for(let Z=0;Z<D;Z++)P+=at.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(Z));if(this.decodeRowResult.charAt(D)!==at.ALPHABET_STRING.charAt(P%43))throw new M;this.decodeRowResult=this.decodeRowResult.substring(0,D)}if(this.decodeRowResult.length===0)throw new z;let v;this.extendedMode?v=at.decodeExtended(this.decodeRowResult):v=this.decodeRowResult;let S=(a[1]+a[0])/2,O=x+y/2;return new it(v,null,0,[new le(S,e),new le(O,e)],oe.CODE_39,new Date().getTime())}static findAsteriskPattern(e,t){let r=e.getSize(),i=e.getNextSet(0),a=0,l=i,d=!1,g=t.length;for(let x=i;x<r;x++)if(e.get(x)!==d)t[a]++;else{if(a===g-1){if(this.toNarrowWidePattern(t)===at.ASTERISK_ENCODING&&e.isRange(Math.max(0,l-Math.floor((x-l)/2)),l,!1))return[l,x];l+=t[0]+t[1],t.copyWithin(0,2,2+a-1),t[a-1]=0,t[a]=0,a--}else a++;t[a]=1,d=!d}throw new z}static toNarrowWidePattern(e){let t=e.length,r=0,i;do{let a=2147483647;for(let g of e)g<a&&g>r&&(a=g);r=a,i=0;let l=0,d=0;for(let g=0;g<t;g++){let x=e[g];x>r&&(d|=1<<t-1-g,i++,l+=x)}if(i===3){for(let g=0;g<t&&i>0;g++){let x=e[g];if(x>r&&(i--,x*2>=l))return-1}return d}}while(i>3);return-1}static patternToChar(e){for(let t=0;t<at.CHARACTER_ENCODINGS.length;t++)if(at.CHARACTER_ENCODINGS[t]===e)return at.ALPHABET_STRING.charAt(t);if(e===at.ASTERISK_ENCODING)return"*";throw new z}static decodeExtended(e){let t=e.length,r="";for(let i=0;i<t;i++){let a=e.charAt(i);if(a==="+"||a==="$"||a==="%"||a==="/"){let l=e.charAt(i+1),d="\0";switch(a){case"+":if(l>="A"&&l<="Z")d=String.fromCharCode(l.charCodeAt(0)+32);else throw new $;break;case"$":if(l>="A"&&l<="Z")d=String.fromCharCode(l.charCodeAt(0)-64);else throw new $;break;case"%":if(l>="A"&&l<="E")d=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")d=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")d=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")d=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")d="\0";else if(l==="V")d="@";else if(l==="W")d="`";else if(l==="X"||l==="Y"||l==="Z")d="";else throw new $;break;case"/":if(l>="A"&&l<="O")d=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")d=":";else throw new $;break}r+=d,i++}else r+=a}return r}}at.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",at.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],at.ASTERISK_ENCODING=148;class je extends rt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(e,t,r){let i=this.decodeStart(t),a=this.decodeEnd(t),l=new te;je.decodeMiddle(t,i[1],a[0],l);let d=l.toString(),g=null;r!=null&&(g=r.get(re.ALLOWED_LENGTHS)),g==null&&(g=je.DEFAULT_ALLOWED_LENGTHS);let x=d.length,y=!1,C=0;for(let O of g){if(x===O){y=!0;break}O>C&&(C=O)}if(!y&&x>C&&(y=!0),!y)throw new $;const v=[new le(i[1],e),new le(a[0],e)];return new it(d,null,0,v,oe.ITF,new Date().getTime())}static decodeMiddle(e,t,r,i){let a=new Int32Array(10),l=new Int32Array(5),d=new Int32Array(5);for(a.fill(0),l.fill(0),d.fill(0);t<r;){rt.recordPattern(e,t,a);for(let x=0;x<5;x++){let y=2*x;l[x]=a[y],d[x]=a[y+1]}let g=je.decodeDigit(l);i.append(g.toString()),g=this.decodeDigit(d),i.append(g.toString()),a.forEach(function(x){t+=x})}}decodeStart(e){let t=je.skipWhiteSpace(e),r=je.findGuardPattern(e,t,je.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(e,r[0]),r}validateQuietZone(e,t){let r=this.narrowLineWidth*10;r=r<t?r:t;for(let i=t-1;r>0&&i>=0&&!e.get(i);i--)r--;if(r!==0)throw new z}static skipWhiteSpace(e){const t=e.getSize(),r=e.getNextSet(0);if(r===t)throw new z;return r}decodeEnd(e){e.reverse();try{let t=je.skipWhiteSpace(e),r;try{r=je.findGuardPattern(e,t,je.END_PATTERN_REVERSED[0])}catch(a){a instanceof z&&(r=je.findGuardPattern(e,t,je.END_PATTERN_REVERSED[1]))}this.validateQuietZone(e,r[0]);let i=r[0];return r[0]=e.getSize()-r[1],r[1]=e.getSize()-i,r}finally{e.reverse()}}static findGuardPattern(e,t,r){let i=r.length,a=new Int32Array(i),l=e.getSize(),d=!1,g=0,x=t;a.fill(0);for(let y=t;y<l;y++)if(e.get(y)!==d)a[g]++;else{if(g===i-1){if(rt.patternMatchVariance(a,r,je.MAX_INDIVIDUAL_VARIANCE)<je.MAX_AVG_VARIANCE)return[x,y];x+=a[0]+a[1],k.arraycopy(a,2,a,0,g-1),a[g-1]=0,a[g]=0,g--}else g++;a[g]=1,d=!d}throw new z}static decodeDigit(e){let t=je.MAX_AVG_VARIANCE,r=-1,i=je.PATTERNS.length;for(let a=0;a<i;a++){let l=je.PATTERNS[a],d=rt.patternMatchVariance(e,l,je.MAX_INDIVIDUAL_VARIANCE);d<t?(t=d,r=a):d===t&&(r=-1)}if(r>=0)return r%10;throw new z}}je.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],je.MAX_AVG_VARIANCE=.38,je.MAX_INDIVIDUAL_VARIANCE=.5,je.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],je.START_PATTERN=Int32Array.from([1,1,1,1]),je.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ye extends rt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(e){let t=!1,r,i=0,a=Int32Array.from([0,0,0]);for(;!t;){a=Int32Array.from([0,0,0]),r=Ye.findGuardPattern(e,i,!1,this.START_END_PATTERN,a);let l=r[0];i=r[1];let d=l-(i-l);d>=0&&(t=e.isRange(d,l,!1))}return r}static checkChecksum(e){return Ye.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let r=parseInt(e.charAt(t-1),10);return Ye.getStandardUPCEANChecksum(e.substring(0,t-1))===r}static getStandardUPCEANChecksum(e){let t=e.length,r=0;for(let i=t-1;i>=0;i-=2){let a=e.charAt(i).charCodeAt(0)-48;if(a<0||a>9)throw new $;r+=a}r*=3;for(let i=t-2;i>=0;i-=2){let a=e.charAt(i).charCodeAt(0)-48;if(a<0||a>9)throw new $;r+=a}return(1e3-r)%10}static decodeEnd(e,t){return Ye.findGuardPattern(e,t,!1,Ye.START_END_PATTERN,new Int32Array(Ye.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(e,t,r,i){return this.findGuardPattern(e,t,r,i,new Int32Array(i.length))}static findGuardPattern(e,t,r,i,a){let l=e.getSize();t=r?e.getNextUnset(t):e.getNextSet(t);let d=0,g=t,x=i.length,y=r;for(let C=t;C<l;C++)if(e.get(C)!==y)a[d]++;else{if(d===x-1){if(rt.patternMatchVariance(a,i,Ye.MAX_INDIVIDUAL_VARIANCE)<Ye.MAX_AVG_VARIANCE)return Int32Array.from([g,C]);g+=a[0]+a[1];let v=a.slice(2,a.length-1);for(let S=0;S<d-1;S++)a[S]=v[S];a[d-1]=0,a[d]=0,d--}else d++;a[d]=1,y=!y}throw new z}static decodeDigit(e,t,r,i){this.recordPattern(e,r,t);let a=this.MAX_AVG_VARIANCE,l=-1,d=i.length;for(let g=0;g<d;g++){let x=i[g],y=rt.patternMatchVariance(t,x,Ye.MAX_INDIVIDUAL_VARIANCE);y<a&&(a=y,l=g)}if(l>=0)return l;throw new z}}Ye.MAX_AVG_VARIANCE=.48,Ye.MAX_INDIVIDUAL_VARIANCE=.7,Ye.START_END_PATTERN=Int32Array.from([1,1,1]),Ye.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ye.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ye.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class hr{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,r){let i=this.decodeRowStringBuffer,a=this.decodeMiddle(t,r,i),l=i.toString(),d=hr.parseExtensionString(l),g=[new le((r[0]+r[1])/2,e),new le(a,e)],x=new it(l,null,0,g,oe.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&x.putAllMetadata(d),x}decodeMiddle(e,t,r){let i=this.decodeMiddleCounters;i[0]=0,i[1]=0,i[2]=0,i[3]=0;let a=e.getSize(),l=t[1],d=0;for(let x=0;x<5&&l<a;x++){let y=Ye.decodeDigit(e,i,l,Ye.L_AND_G_PATTERNS);r+=String.fromCharCode(48+y%10);for(let C of i)l+=C;y>=10&&(d|=1<<4-x),x!==4&&(l=e.getNextSet(l),l=e.getNextUnset(l))}if(r.length!==5)throw new z;let g=this.determineCheckDigit(d);if(hr.extensionChecksum(r.toString())!==g)throw new z;return l}static extensionChecksum(e){let t=e.length,r=0;for(let i=t-2;i>=0;i-=2)r+=e.charAt(i).charCodeAt(0)-48;r*=3;for(let i=t-1;i>=0;i-=2)r+=e.charAt(i).charCodeAt(0)-48;return r*=3,r%10}determineCheckDigit(e){for(let t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new z}static parseExtensionString(e){if(e.length!==5)return null;let t=hr.parseExtension5String(e);return t==null?null:new Map([[Fe.SUGGESTED_PRICE,t]])}static parseExtension5String(e){let t;switch(e.charAt(0)){case"0":t="Â£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}let r=parseInt(e.substring(1)),i=(r/100).toString(),a=r%100,l=a<10?"0"+a:a.toString();return t+i+"."+l}}class ws{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(e,t,r){let i=this.decodeRowStringBuffer,a=this.decodeMiddle(t,r,i),l=i.toString(),d=ws.parseExtensionString(l),g=[new le((r[0]+r[1])/2,e),new le(a,e)],x=new it(l,null,0,g,oe.UPC_EAN_EXTENSION,new Date().getTime());return d!=null&&x.putAllMetadata(d),x}decodeMiddle(e,t,r){let i=this.decodeMiddleCounters;i[0]=0,i[1]=0,i[2]=0,i[3]=0;let a=e.getSize(),l=t[1],d=0;for(let g=0;g<2&&l<a;g++){let x=Ye.decodeDigit(e,i,l,Ye.L_AND_G_PATTERNS);r+=String.fromCharCode(48+x%10);for(let y of i)l+=y;x>=10&&(d|=1<<1-g),g!==1&&(l=e.getNextSet(l),l=e.getNextUnset(l))}if(r.length!==2)throw new z;if(parseInt(r.toString())%4!==d)throw new z;return l}static parseExtensionString(e){return e.length!==2?null:new Map([[Fe.ISSUE_NUMBER,parseInt(e)]])}}class Di{static decodeRow(e,t,r){let i=Ye.findGuardPattern(t,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new hr().decodeRow(e,t,i)}catch{return new ws().decodeRow(e,t,i)}}}Di.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class _e extends Ye{constructor(){super(),this.decodeRowStringBuffer="",_e.L_AND_G_PATTERNS=_e.L_PATTERNS.map(e=>Int32Array.from(e));for(let e=10;e<20;e++){let t=_e.L_PATTERNS[e-10],r=new Int32Array(t.length);for(let i=0;i<t.length;i++)r[i]=t[t.length-i-1];_e.L_AND_G_PATTERNS[e]=r}}decodeRow(e,t,r){let i=_e.findStartGuardPattern(t),a=r==null?null:r.get(re.NEED_RESULT_POINT_CALLBACK);if(a!=null){const Q=new le((i[0]+i[1])/2,e);a.foundPossibleResultPoint(Q)}let l=this.decodeMiddle(t,i,this.decodeRowStringBuffer),d=l.rowOffset,g=l.resultString;if(a!=null){const Q=new le(d,e);a.foundPossibleResultPoint(Q)}let x=this.decodeEnd(t,d);if(a!=null){const Q=new le((x[0]+x[1])/2,e);a.foundPossibleResultPoint(Q)}let y=x[1],C=y+(y-x[0]);if(C>=t.getSize()||!t.isRange(y,C,!1))throw new z;let v=g.toString();if(v.length<8)throw new $;if(!_e.checkChecksum(v))throw new M;let S=(i[1]+i[0])/2,O=(x[1]+x[0])/2,D=this.getBarcodeFormat(),P=[new le(S,e),new le(O,e)],Z=new it(v,null,0,P,D,new Date().getTime()),J=0;try{let Q=Di.decodeRow(e,t,x[1]);Z.putMetadata(Fe.UPC_EAN_EXTENSION,Q.getText()),Z.putAllMetadata(Q.getResultMetadata()),Z.addResultPoints(Q.getResultPoints()),J=Q.getText().length}catch{}let ee=r==null?null:r.get(re.ALLOWED_EAN_EXTENSIONS);if(ee!=null){let Q=!1;for(let be in ee)if(J.toString()===be){Q=!0;break}if(!Q)throw new z}return Z}decodeEnd(e,t){return _e.findGuardPattern(e,t,!1,_e.START_END_PATTERN,new Int32Array(_e.START_END_PATTERN.length).fill(0))}static checkChecksum(e){return _e.checkStandardUPCEANChecksum(e)}static checkStandardUPCEANChecksum(e){let t=e.length;if(t===0)return!1;let r=parseInt(e.charAt(t-1),10);return _e.getStandardUPCEANChecksum(e.substring(0,t-1))===r}static getStandardUPCEANChecksum(e){let t=e.length,r=0;for(let i=t-1;i>=0;i-=2){let a=e.charAt(i).charCodeAt(0)-48;if(a<0||a>9)throw new $;r+=a}r*=3;for(let i=t-2;i>=0;i-=2){let a=e.charAt(i).charCodeAt(0)-48;if(a<0||a>9)throw new $;r+=a}return(1e3-r)%10}}class kn extends _e{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,r){let i=this.decodeMiddleCounters;i[0]=0,i[1]=0,i[2]=0,i[3]=0;let a=e.getSize(),l=t[1],d=0;for(let x=0;x<6&&l<a;x++){let y=_e.decodeDigit(e,i,l,_e.L_AND_G_PATTERNS);r+=String.fromCharCode(48+y%10);for(let C of i)l+=C;y>=10&&(d|=1<<5-x)}r=kn.determineFirstDigit(r,d),l=_e.findGuardPattern(e,l,!0,_e.MIDDLE_PATTERN,new Int32Array(_e.MIDDLE_PATTERN.length).fill(0))[1];for(let x=0;x<6&&l<a;x++){let y=_e.decodeDigit(e,i,l,_e.L_PATTERNS);r+=String.fromCharCode(48+y);for(let C of i)l+=C}return{rowOffset:l,resultString:r}}getBarcodeFormat(){return oe.EAN_13}static determineFirstDigit(e,t){for(let r=0;r<10;r++)if(t===this.FIRST_DIGIT_ENCODINGS[r])return e=String.fromCharCode(48+r)+e,e;throw new z}}kn.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ji extends _e{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(e,t,r){const i=this.decodeMiddleCounters;i[0]=0,i[1]=0,i[2]=0,i[3]=0;let a=e.getSize(),l=t[1];for(let g=0;g<4&&l<a;g++){let x=_e.decodeDigit(e,i,l,_e.L_PATTERNS);r+=String.fromCharCode(48+x);for(let y of i)l+=y}l=_e.findGuardPattern(e,l,!0,_e.MIDDLE_PATTERN,new Int32Array(_e.MIDDLE_PATTERN.length).fill(0))[1];for(let g=0;g<4&&l<a;g++){let x=_e.decodeDigit(e,i,l,_e.L_PATTERNS);r+=String.fromCharCode(48+x);for(let y of i)l+=y}return{rowOffset:l,resultString:r}}getBarcodeFormat(){return oe.EAN_8}}class Ri extends _e{constructor(){super(...arguments),this.ean13Reader=new kn}getBarcodeFormat(){return oe.UPC_A}decode(e,t){return this.maybeReturnResult(this.ean13Reader.decode(e))}decodeRow(e,t,r){return this.maybeReturnResult(this.ean13Reader.decodeRow(e,t,r))}decodeMiddle(e,t,r){return this.ean13Reader.decodeMiddle(e,t,r)}maybeReturnResult(e){let t=e.getText();if(t.charAt(0)==="0"){let r=new it(t.substring(1),null,null,e.getResultPoints(),oe.UPC_A);return e.getResultMetadata()!=null&&r.putAllMetadata(e.getResultMetadata()),r}else throw new z}reset(){this.ean13Reader.reset()}}class Yt extends _e{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(e,t,r){const i=this.decodeMiddleCounters.map(x=>x);i[0]=0,i[1]=0,i[2]=0,i[3]=0;const a=e.getSize();let l=t[1],d=0;for(let x=0;x<6&&l<a;x++){const y=Yt.decodeDigit(e,i,l,Yt.L_AND_G_PATTERNS);r+=String.fromCharCode(48+y%10);for(let C of i)l+=C;y>=10&&(d|=1<<5-x)}let g=Yt.determineNumSysAndCheckDigit(r,d);return{rowOffset:l,resultString:g}}decodeEnd(e,t){return Yt.findGuardPatternWithoutCounters(e,t,!0,Yt.MIDDLE_END_PATTERN)}checkChecksum(e){return _e.checkChecksum(Yt.convertUPCEtoUPCA(e))}static determineNumSysAndCheckDigit(e,t){for(let r=0;r<=1;r++)for(let i=0;i<10;i++)if(t===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[r][i]){let a=String.fromCharCode(48+r),l=String.fromCharCode(48+i);return a+e+l}throw z.getNotFoundInstance()}getBarcodeFormat(){return oe.UPC_E}static convertUPCEtoUPCA(e){const t=e.slice(1,7).split("").map(a=>a.charCodeAt(0)),r=new te;r.append(e.charAt(0));let i=t[5];switch(i){case 0:case 1:case 2:r.appendChars(t,0,2),r.append(i),r.append("0000"),r.appendChars(t,2,3);break;case 3:r.appendChars(t,0,3),r.append("00000"),r.appendChars(t,3,2);break;case 4:r.appendChars(t,0,4),r.append("00000"),r.append(t[4]);break;default:r.appendChars(t,0,5),r.append("0000"),r.append(i);break}return e.length>=8&&r.append(e.charAt(7)),r.toString()}}Yt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Yt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class bs extends rt{constructor(e){super();let t=e==null?null:e.get(re.POSSIBLE_FORMATS),r=[];u(t)?(r.push(new kn),r.push(new Ri),r.push(new ji),r.push(new Yt)):(t.indexOf(oe.EAN_13)>-1&&r.push(new kn),t.indexOf(oe.UPC_A)>-1&&r.push(new Ri),t.indexOf(oe.EAN_8)>-1&&r.push(new ji),t.indexOf(oe.UPC_E)>-1&&r.push(new Yt)),this.readers=r}decodeRow(e,t,r){for(let i of this.readers)try{const a=i.decodeRow(e,t,r),l=a.getBarcodeFormat()===oe.EAN_13&&a.getText().charAt(0)==="0",d=r==null?null:r.get(re.POSSIBLE_FORMATS),g=d==null||d.includes(oe.UPC_A);if(l&&g){const x=a.getRawBytes(),y=new it(a.getText().substring(1),x,x?x.length:null,a.getResultPoints(),oe.UPC_A);return y.putAllMetadata(a.getResultMetadata()),y}return a}catch{}throw new z}reset(){for(let e of this.readers)e.reset()}}class yt extends rt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(e,t){for(let r=0;r<t.length;r++)if(rt.patternMatchVariance(e,t[r],yt.MAX_INDIVIDUAL_VARIANCE)<yt.MAX_AVG_VARIANCE)return r;throw new z}static count(e){return Ne.sum(new Int32Array(e))}static increment(e,t){let r=0,i=t[0];for(let a=1;a<e.length;a++)t[a]>i&&(i=t[a],r=a);e[r]++}static decrement(e,t){let r=0,i=t[0];for(let a=1;a<e.length;a++)t[a]<i&&(i=t[a],r=a);e[r]--}static isFinderPattern(e){let t=e[0]+e[1],r=t+e[2]+e[3],i=t/r;if(i>=yt.MIN_FINDER_PATTERN_RATIO&&i<=yt.MAX_FINDER_PATTERN_RATIO){let a=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER;for(let d of e)d>l&&(l=d),d<a&&(a=d);return l<10*a}return!1}}yt.MAX_AVG_VARIANCE=.2,yt.MAX_INDIVIDUAL_VARIANCE=.45,yt.MIN_FINDER_PATTERN_RATIO=9.5/12,yt.MAX_FINDER_PATTERN_RATIO=12.5/14;class qn{constructor(e,t){this.value=e,this.checksumPortion=t}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(e){if(!(e instanceof qn))return!1;const t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Lr{constructor(e,t,r,i,a){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new le(r,a)),this.resultPoints.push(new le(i,a))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(e){if(!(e instanceof Lr))return!1;const t=e;return this.value===t.value}hashCode(){return this.value}}class Qt{constructor(){}static getRSSvalue(e,t,r){let i=0;for(let g of e)i+=g;let a=0,l=0,d=e.length;for(let g=0;g<d-1;g++){let x;for(x=1,l|=1<<g;x<e[g];x++,l&=~(1<<g)){let y=Qt.combins(i-x-1,d-g-2);if(r&&l===0&&i-x-(d-g-1)>=d-g-1&&(y-=Qt.combins(i-x-(d-g),d-g-2)),d-g-1>1){let C=0;for(let v=i-x-(d-g-2);v>t;v--)C+=Qt.combins(i-x-v-1,d-g-3);y-=C*(d-1-g)}else i-x>t&&y--;a+=y}i-=x}return a}static combins(e,t){let r,i;e-t>t?(i=t,r=e-t):(i=e-t,r=t);let a=1,l=1;for(let d=e;d>r;d--)a*=d,l<=i&&(a/=l,l++);for(;l<=i;)a/=l,l++;return a}}class rl{static buildBitArray(e){let t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);let r=12*t,i=new K(r),a=0,d=e[0].getRightChar().getValue();for(let g=11;g>=0;--g)d&1<<g&&i.set(a),a++;for(let g=1;g<e.length;++g){let x=e[g],y=x.getLeftChar().getValue();for(let C=11;C>=0;--C)y&1<<C&&i.set(a),a++;if(x.getRightChar()!=null){let C=x.getRightChar().getValue();for(let v=11;v>=0;--v)C&1<<v&&i.set(a),a++}}return i}}class Ln{constructor(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Cs{constructor(e){this.newPosition=e}getNewPosition(){return this.newPosition}}class vt extends Cs{constructor(e,t){super(e),this.value=t}getValue(){return this.value}isFNC1(){return this.value===vt.FNC1}}vt.FNC1="$";class Bn extends Cs{constructor(e,t,r){super(e),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=t}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Bt extends Cs{constructor(e,t,r){if(super(e),t<0||t>10||r<0||r>10)throw new $;this.firstDigit=t,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Bt.FNC1}isSecondDigitFNC1(){return this.secondDigit===Bt.FNC1}isAnyFNC1(){return this.firstDigit===Bt.FNC1||this.secondDigit===Bt.FNC1}}Bt.FNC1=10;class ie{constructor(){}static parseFieldsInGeneralPurpose(e){if(!e)return null;if(e.length<2)throw new z;let t=e.substring(0,2);for(let a of ie.TWO_DIGIT_DATA_LENGTH)if(a[0]===t)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(2,a[2],e):ie.processFixedAI(2,a[1],e);if(e.length<3)throw new z;let r=e.substring(0,3);for(let a of ie.THREE_DIGIT_DATA_LENGTH)if(a[0]===r)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(3,a[2],e):ie.processFixedAI(3,a[1],e);for(let a of ie.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(a[0]===r)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(4,a[2],e):ie.processFixedAI(4,a[1],e);if(e.length<4)throw new z;let i=e.substring(0,4);for(let a of ie.FOUR_DIGIT_DATA_LENGTH)if(a[0]===i)return a[1]===ie.VARIABLE_LENGTH?ie.processVariableAI(4,a[2],e):ie.processFixedAI(4,a[1],e);throw new z}static processFixedAI(e,t,r){if(r.length<e)throw new z;let i=r.substring(0,e);if(r.length<e+t)throw new z;let a=r.substring(e,e+t),l=r.substring(e+t),d="("+i+")"+a,g=ie.parseFieldsInGeneralPurpose(l);return g==null?d:d+g}static processVariableAI(e,t,r){let i=r.substring(0,e),a;r.length<e+t?a=r.length:a=e+t;let l=r.substring(e,a),d=r.substring(a),g="("+i+")"+l,x=ie.parseFieldsInGeneralPurpose(d);return x==null?g:g+x}}ie.VARIABLE_LENGTH=[],ie.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ie.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ie.VARIABLE_LENGTH,20],["22",ie.VARIABLE_LENGTH,29],["30",ie.VARIABLE_LENGTH,8],["37",ie.VARIABLE_LENGTH,8],["90",ie.VARIABLE_LENGTH,30],["91",ie.VARIABLE_LENGTH,30],["92",ie.VARIABLE_LENGTH,30],["93",ie.VARIABLE_LENGTH,30],["94",ie.VARIABLE_LENGTH,30],["95",ie.VARIABLE_LENGTH,30],["96",ie.VARIABLE_LENGTH,30],["97",ie.VARIABLE_LENGTH,3],["98",ie.VARIABLE_LENGTH,30],["99",ie.VARIABLE_LENGTH,30]],ie.THREE_DIGIT_DATA_LENGTH=[["240",ie.VARIABLE_LENGTH,30],["241",ie.VARIABLE_LENGTH,30],["242",ie.VARIABLE_LENGTH,6],["250",ie.VARIABLE_LENGTH,30],["251",ie.VARIABLE_LENGTH,30],["253",ie.VARIABLE_LENGTH,17],["254",ie.VARIABLE_LENGTH,20],["400",ie.VARIABLE_LENGTH,30],["401",ie.VARIABLE_LENGTH,30],["402",17],["403",ie.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ie.VARIABLE_LENGTH,20],["421",ie.VARIABLE_LENGTH,15],["422",3],["423",ie.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ie.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ie.VARIABLE_LENGTH,15],["391",ie.VARIABLE_LENGTH,18],["392",ie.VARIABLE_LENGTH,15],["393",ie.VARIABLE_LENGTH,18],["703",ie.VARIABLE_LENGTH,30]],ie.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ie.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ie.VARIABLE_LENGTH,20],["8003",ie.VARIABLE_LENGTH,30],["8004",ie.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ie.VARIABLE_LENGTH,30],["8008",ie.VARIABLE_LENGTH,12],["8018",18],["8020",ie.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ie.VARIABLE_LENGTH,70],["8200",ie.VARIABLE_LENGTH,70]];class $n{constructor(e){this.buffer=new te,this.information=e}decodeAllCodes(e,t){let r=t,i=null;do{let a=this.decodeGeneralPurposeField(r,i),l=ie.parseFieldsInGeneralPurpose(a.getNewString());if(l!=null&&e.append(l),a.isRemaining()?i=""+a.getRemainingValue():i=null,r===a.getNewPosition())break;r=a.getNewPosition()}while(!0);return e.toString()}isStillNumeric(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(let t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)}decodeNumeric(e){if(e+7>this.information.getSize()){let a=this.extractNumericValueFromBitArray(e,4);return a===0?new Bt(this.information.getSize(),Bt.FNC1,Bt.FNC1):new Bt(this.information.getSize(),a-1,Bt.FNC1)}let t=this.extractNumericValueFromBitArray(e,7),r=(t-8)/11,i=(t-8)%11;return new Bt(e+7,r,i)}extractNumericValueFromBitArray(e,t){return $n.extractNumericValueFromBitArray(this.information,e,t)}static extractNumericValueFromBitArray(e,t,r){let i=0;for(let a=0;a<r;++a)e.get(t+a)&&(i|=1<<r-a-1);return i}decodeGeneralPurposeField(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);let r=this.parseBlocks();return r!=null&&r.isRemaining()?new Bn(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new Bn(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let e,t;do{let r=this.current.getPosition();if(this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished()),!(r!==this.current.getPosition())&&!e)break}while(!e);return t.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){let t;return e.isSecondDigitFNC1()?t=new Bn(this.current.getPosition(),this.buffer.toString()):t=new Bn(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new Ln(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){let t=new Bn(this.current.getPosition(),this.buffer.toString());return new Ln(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ln(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Bn(this.current.getPosition(),this.buffer.toString());return new Ln(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ln(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){let t=new Bn(this.current.getPosition(),this.buffer.toString());return new Ln(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ln(!1)}isStillIsoIec646(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<116)return!0;if(e+8>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(e,8);return i>=232&&i<253}decodeIsoIec646(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new vt(e+5,vt.FNC1);if(t>=5&&t<15)return new vt(e+5,"0"+(t-5));let r=this.extractNumericValueFromBitArray(e,7);if(r>=64&&r<90)return new vt(e+7,""+(r+1));if(r>=90&&r<116)return new vt(e+7,""+(r+7));let i=this.extractNumericValueFromBitArray(e,8),a;switch(i){case 232:a="!";break;case 233:a='"';break;case 234:a="%";break;case 235:a="&";break;case 236:a="'";break;case 237:a="(";break;case 238:a=")";break;case 239:a="*";break;case 240:a="+";break;case 241:a=",";break;case 242:a="-";break;case 243:a=".";break;case 244:a="/";break;case 245:a=":";break;case 246:a=";";break;case 247:a="<";break;case 248:a="=";break;case 249:a=">";break;case 250:a="?";break;case 251:a="_";break;case 252:a=" ";break;default:throw new $}return new vt(e+8,a)}isStillAlpha(e){if(e+5>this.information.getSize())return!1;let t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(e,6);return r>=16&&r<63}decodeAlphanumeric(e){let t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new vt(e+5,vt.FNC1);if(t>=5&&t<15)return new vt(e+5,"0"+(t-5));let r=this.extractNumericValueFromBitArray(e,6);if(r>=32&&r<58)return new vt(e+6,""+(r+33));let i;switch(r){case 58:i="*";break;case 59:i=",";break;case 60:i="-";break;case 61:i=".";break;case 62:i="/";break;default:throw new $t("Decoding invalid alphanumeric value: "+r)}return new vt(e+6,i)}isAlphaTo646ToAlphaLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0}isAlphaOr646ToNumericLatch(e){if(e+3>this.information.getSize())return!1;for(let t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0}isNumericToAlphaNumericLatch(e){if(e+1>this.information.getSize())return!1;for(let t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0}}class As{constructor(e){this.information=e,this.generalDecoder=new $n(e)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class _t extends As{constructor(e){super(e)}encodeCompressedGtin(e,t){e.append("(01)");let r=e.length();e.append("9"),this.encodeCompressedGtinWithoutAI(e,t,r)}encodeCompressedGtinWithoutAI(e,t,r){for(let i=0;i<4;++i){let a=this.getGeneralDecoder().extractNumericValueFromBitArray(t+10*i,10);a/100===0&&e.append("0"),a/10===0&&e.append("0"),e.append(a)}_t.appendCheckDigit(e,r)}static appendCheckDigit(e,t){let r=0;for(let i=0;i<13;i++){let a=e.charAt(i+t).charCodeAt(0)-48;r+=i&1?a:3*a}r=10-r%10,r===10&&(r=0),e.append(r)}}_t.GTIN_SIZE=40;class Qn extends _t{constructor(e){super(e)}parseInformation(){let e=new te;e.append("(01)");let t=e.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(Qn.HEADER_SIZE,4);return e.append(r),this.encodeCompressedGtinWithoutAI(e,Qn.HEADER_SIZE+4,t),this.getGeneralDecoder().decodeAllCodes(e,Qn.HEADER_SIZE+44)}}Qn.HEADER_SIZE=4;class Br extends As{constructor(e){super(e)}parseInformation(){let e=new te;return this.getGeneralDecoder().decodeAllCodes(e,Br.HEADER_SIZE)}}Br.HEADER_SIZE=5;class Pr extends _t{constructor(e){super(e)}encodeCompressedWeight(e,t,r){let i=this.getGeneralDecoder().extractNumericValueFromBitArray(t,r);this.addWeightCode(e,i);let a=this.checkWeight(i),l=1e5;for(let d=0;d<5;++d)a/l===0&&e.append("0"),l/=10;e.append(a)}}class Kt extends Pr{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()!=Kt.HEADER_SIZE+Pr.GTIN_SIZE+Kt.WEIGHT_SIZE)throw new z;let e=new te;return this.encodeCompressedGtin(e,Kt.HEADER_SIZE),this.encodeCompressedWeight(e,Kt.HEADER_SIZE+Pr.GTIN_SIZE,Kt.WEIGHT_SIZE),e.toString()}}Kt.HEADER_SIZE=5,Kt.WEIGHT_SIZE=15;class sl extends Kt{constructor(e){super(e)}addWeightCode(e,t){e.append("(3103)")}checkWeight(e){return e}}class il extends Kt{constructor(e){super(e)}addWeightCode(e,t){t<1e4?e.append("(3202)"):e.append("(3203)")}checkWeight(e){return e<1e4?e:e-1e4}}class Jt extends _t{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<Jt.HEADER_SIZE+_t.GTIN_SIZE)throw new z;let e=new te;this.encodeCompressedGtin(e,Jt.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(Jt.HEADER_SIZE+_t.GTIN_SIZE,Jt.LAST_DIGIT_SIZE);e.append("(392"),e.append(t),e.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(Jt.HEADER_SIZE+_t.GTIN_SIZE+Jt.LAST_DIGIT_SIZE,null);return e.append(r.getNewString()),e.toString()}}Jt.HEADER_SIZE=8,Jt.LAST_DIGIT_SIZE=2;class At extends _t{constructor(e){super(e)}parseInformation(){if(this.getInformation().getSize()<At.HEADER_SIZE+_t.GTIN_SIZE)throw new z;let e=new te;this.encodeCompressedGtin(e,At.HEADER_SIZE);let t=this.getGeneralDecoder().extractNumericValueFromBitArray(At.HEADER_SIZE+_t.GTIN_SIZE,At.LAST_DIGIT_SIZE);e.append("(393"),e.append(t),e.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(At.HEADER_SIZE+_t.GTIN_SIZE+At.LAST_DIGIT_SIZE,At.FIRST_THREE_DIGITS_SIZE);r/100==0&&e.append("0"),r/10==0&&e.append("0"),e.append(r);let i=this.getGeneralDecoder().decodeGeneralPurposeField(At.HEADER_SIZE+_t.GTIN_SIZE+At.LAST_DIGIT_SIZE+At.FIRST_THREE_DIGITS_SIZE,null);return e.append(i.getNewString()),e.toString()}}At.HEADER_SIZE=8,At.LAST_DIGIT_SIZE=2,At.FIRST_THREE_DIGITS_SIZE=10;class Ve extends Pr{constructor(e,t,r){super(e),this.dateCode=r,this.firstAIdigits=t}parseInformation(){if(this.getInformation().getSize()!=Ve.HEADER_SIZE+Ve.GTIN_SIZE+Ve.WEIGHT_SIZE+Ve.DATE_SIZE)throw new z;let e=new te;return this.encodeCompressedGtin(e,Ve.HEADER_SIZE),this.encodeCompressedWeight(e,Ve.HEADER_SIZE+Ve.GTIN_SIZE,Ve.WEIGHT_SIZE),this.encodeCompressedDate(e,Ve.HEADER_SIZE+Ve.GTIN_SIZE+Ve.WEIGHT_SIZE),e.toString()}encodeCompressedDate(e,t){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(t,Ve.DATE_SIZE);if(r==38400)return;e.append("("),e.append(this.dateCode),e.append(")");let i=r%32;r/=32;let a=r%12+1;r/=12;let l=r;l/10==0&&e.append("0"),e.append(l),a/10==0&&e.append("0"),e.append(a),i/10==0&&e.append("0"),e.append(i)}addWeightCode(e,t){e.append("("),e.append(this.firstAIdigits),e.append(t/1e5),e.append(")")}checkWeight(e){return e%1e5}}Ve.HEADER_SIZE=8,Ve.WEIGHT_SIZE=20,Ve.DATE_SIZE=16;function ki(b){try{if(b.get(1))return new Qn(b);if(!b.get(2))return new Br(b);switch($n.extractNumericValueFromBitArray(b,1,4)){case 4:return new sl(b);case 5:return new il(b)}switch($n.extractNumericValueFromBitArray(b,1,5)){case 12:return new Jt(b);case 13:return new At(b)}switch($n.extractNumericValueFromBitArray(b,1,7)){case 56:return new Ve(b,"310","11");case 57:return new Ve(b,"320","11");case 58:return new Ve(b,"310","13");case 59:return new Ve(b,"320","13");case 60:return new Ve(b,"310","15");case 61:return new Ve(b,"320","15");case 62:return new Ve(b,"310","17");case 63:return new Ve(b,"320","17")}}catch(e){throw console.log(e),new $t("unknown decoder: "+b)}}class pn{constructor(e,t,r,i){this.leftchar=e,this.rightchar=t,this.finderpattern=r,this.maybeLast=i}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(e,t){return e instanceof pn?pn.equalsOrNull(e.leftchar,t.leftchar)&&pn.equalsOrNull(e.rightchar,t.rightchar)&&pn.equalsOrNull(e.finderpattern,t.finderpattern):!1}static equalsOrNull(e,t){return e===null?t===null:pn.equals(e,t)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ns{constructor(e,t,r){this.pairs=e,this.rowNumber=t,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(e){return this.checkEqualitity(this,e)}toString(){return"{ "+this.pairs+" }"}equals(e,t){return e instanceof Ns?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1}checkEqualitity(e,t){if(!e||!t)return;let r;return e.forEach((i,a)=>{t.forEach(l=>{i.getLeftChar().getValue()===l.getLeftChar().getValue()&&i.getRightChar().getValue()===l.getRightChar().getValue()&&i.getFinderPatter().getValue()===l.getFinderPatter().getValue()&&(r=!0)})}),r}}class q extends yt{constructor(e){super(...arguments),this.pairs=new Array(q.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=e===!0}decodeRow(e,t,r){this.pairs.length=0,this.startFromEven=!1;try{return q.constructResult(this.decodeRow2pairs(e,t))}catch(i){this.verbose&&console.log(i)}return this.pairs.length=0,this.startFromEven=!0,q.constructResult(this.decodeRow2pairs(e,t))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(e,t){let r=!1;for(;!r;)try{this.pairs.push(this.retrieveNextPair(t,this.pairs,e))}catch(a){if(a instanceof z){if(!this.pairs.length)throw new z;r=!0}}if(this.checkChecksum())return this.pairs;let i;if(this.rows.length?i=!0:i=!1,this.storeRow(e,!1),i){let a=this.checkRowsBoolean(!1);if(a!=null||(a=this.checkRowsBoolean(!0),a!=null))return a}throw new z}checkRowsBoolean(e){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,e&&(this.rows=this.rows.reverse());let t=null;try{t=this.checkRows(new Array,0)}catch(r){this.verbose&&console.log(r)}return e&&(this.rows=this.rows.reverse()),t}checkRows(e,t){for(let r=t;r<this.rows.length;r++){let i=this.rows[r];this.pairs.length=0;for(let l of e)this.pairs.push(l.getPairs());if(this.pairs.push(i.getPairs()),!q.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let a=new Array(e);a.push(i);try{return this.checkRows(a,r+1)}catch(l){this.verbose&&console.log(l)}}throw new z}static isValidSequence(e){for(let t of q.FINDER_PATTERN_SEQUENCES){if(e.length>t.length)continue;let r=!0;for(let i=0;i<e.length;i++)if(e[i].getFinderPattern().getValue()!=t[i]){r=!1;break}if(r)return!0}return!1}storeRow(e,t){let r=0,i=!1,a=!1;for(;r<this.rows.length;){let l=this.rows[r];if(l.getRowNumber()>e){a=l.isEquivalent(this.pairs);break}i=l.isEquivalent(this.pairs),r++}a||i||q.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new Ns(this.pairs,e,t)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(e,t){for(let r of t)if(r.getPairs().length!==e.length){for(let i of r.getPairs())for(let a of e)if(pn.equals(i,a))break}}static isPartialRow(e,t){for(let r of t){let i=!0;for(let a of e){let l=!1;for(let d of r.getPairs())if(a.equals(d)){l=!0;break}if(!l){i=!1;break}}if(i)return!0}return!1}getRows(){return this.rows}static constructResult(e){let t=rl.buildBitArray(e),i=ki(t).parseInformation(),a=e[0].getFinderPattern().getResultPoints(),l=e[e.length-1].getFinderPattern().getResultPoints(),d=[a[0],a[1],l[0],l[1]];return new it(i,null,null,d,oe.RSS_EXPANDED,null)}checkChecksum(){let e=this.pairs.get(0),t=e.getLeftChar(),r=e.getRightChar();if(r==null)return!1;let i=r.getChecksumPortion(),a=2;for(let d=1;d<this.pairs.size();++d){let g=this.pairs.get(d);i+=g.getLeftChar().getChecksumPortion(),a++;let x=g.getRightChar();x!=null&&(i+=x.getChecksumPortion(),a++)}return i%=211,211*(a-4)+i==t.getValue()}static getNextSecondBar(e,t){let r;return e.get(t)?(r=e.getNextUnset(t),r=e.getNextSet(r)):(r=e.getNextSet(t),r=e.getNextUnset(r)),r}retrieveNextPair(e,t,r){let i=t.length%2==0;this.startFromEven&&(i=!i);let a,l=!0,d=-1;do this.findNextPair(e,t,d),a=this.parseFoundFinderPattern(e,r,i),a==null?d=q.getNextSecondBar(e,this.startEnd[0]):l=!1;while(l);let g=this.decodeDataCharacter(e,a,i,!0);if(!this.isEmptyPair(t)&&t[t.length-1].mustBeLast())throw new z;let x;try{x=this.decodeDataCharacter(e,a,i,!1)}catch(y){x=null,this.verbose&&console.log(y)}return new pn(g,x,a,!0)}isEmptyPair(e){return e.length===0}findNextPair(e,t,r){let i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;let a=e.getSize(),l;r>=0?l=r:this.isEmptyPair(t)?l=0:l=t[t.length-1].getFinderPattern().getStartEnd()[1];let d=t.length%2!=0;this.startFromEven&&(d=!d);let g=!1;for(;l<a&&(g=!e.get(l),!!g);)l++;let x=0,y=l;for(let C=l;C<a;C++)if(e.get(C)!=g)i[x]++;else{if(x==3){if(d&&q.reverseCounters(i),q.isFinderPattern(i)){this.startEnd[0]=y,this.startEnd[1]=C;return}d&&q.reverseCounters(i),y+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,x--}else x++;i[x]=1,g=!g}throw new z}static reverseCounters(e){let t=e.length;for(let r=0;r<t/2;++r){let i=e[r];e[r]=e[t-r-1],e[t-r-1]=i}}parseFoundFinderPattern(e,t,r){let i,a,l;if(r){let x=this.startEnd[0]-1;for(;x>=0&&!e.get(x);)x--;x++,i=this.startEnd[0]-x,a=x,l=this.startEnd[1]}else a=this.startEnd[0],l=e.getNextUnset(this.startEnd[1]+1),i=l-this.startEnd[1];let d=this.getDecodeFinderCounters();k.arraycopy(d,0,d,1,d.length-1),d[0]=i;let g;try{g=this.parseFinderValue(d,q.FINDER_PATTERNS)}catch{return null}return new Lr(g,[a,l],a,l,t)}decodeDataCharacter(e,t,r,i){let a=this.getDataCharacterCounters();for(let ke=0;ke<a.length;ke++)a[ke]=0;if(i)q.recordPatternInReverse(e,t.getStartEnd()[0],a);else{q.recordPattern(e,t.getStartEnd()[1],a);for(let ke=0,pt=a.length-1;ke<pt;ke++,pt--){let Dt=a[ke];a[ke]=a[pt],a[pt]=Dt}}let l=17,d=Ne.sum(new Int32Array(a))/l,g=(t.getStartEnd()[1]-t.getStartEnd()[0])/15;if(Math.abs(d-g)/g>.3)throw new z;let x=this.getOddCounts(),y=this.getEvenCounts(),C=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors();for(let ke=0;ke<a.length;ke++){let pt=1*a[ke]/d,Dt=pt+.5;if(Dt<1){if(pt<.3)throw new z;Dt=1}else if(Dt>8){if(pt>8.7)throw new z;Dt=8}let nr=ke/2;ke&1?(y[nr]=Dt,v[nr]=pt-Dt):(x[nr]=Dt,C[nr]=pt-Dt)}this.adjustOddEvenCounts(l);let S=4*t.getValue()+(r?0:2)+(i?0:1)-1,O=0,D=0;for(let ke=x.length-1;ke>=0;ke--){if(q.isNotA1left(t,r,i)){let pt=q.WEIGHTS[S][2*ke];D+=x[ke]*pt}O+=x[ke]}let P=0;for(let ke=y.length-1;ke>=0;ke--)if(q.isNotA1left(t,r,i)){let pt=q.WEIGHTS[S][2*ke+1];P+=y[ke]*pt}let Z=D+P;if(O&1||O>13||O<4)throw new z;let J=(13-O)/2,ee=q.SYMBOL_WIDEST[J],Q=9-ee,be=Qt.getRSSvalue(x,ee,!0),me=Qt.getRSSvalue(y,Q,!1),It=q.EVEN_TOTAL_SUBSET[J],Xt=q.GSUM[J],Tt=be*It+me+Xt;return new qn(Tt,Z)}static isNotA1left(e,t,r){return!(e.getValue()==0&&t&&r)}adjustOddEvenCounts(e){let t=Ne.sum(new Int32Array(this.getOddCounts())),r=Ne.sum(new Int32Array(this.getEvenCounts())),i=!1,a=!1;t>13?a=!0:t<4&&(i=!0);let l=!1,d=!1;r>13?d=!0:r<4&&(l=!0);let g=t+r-e,x=(t&1)==1,y=(r&1)==0;if(g==1)if(x){if(y)throw new z;a=!0}else{if(!y)throw new z;d=!0}else if(g==-1)if(x){if(y)throw new z;i=!0}else{if(!y)throw new z;l=!0}else if(g==0){if(x){if(!y)throw new z;t<r?(i=!0,d=!0):(a=!0,l=!0)}else if(y)throw new z}else throw new z;if(i){if(a)throw new z;q.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(a&&q.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(d)throw new z;q.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&q.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}q.SYMBOL_WIDEST=[7,5,4,3,1],q.EVEN_TOTAL_SUBSET=[4,20,52,104,204],q.GSUM=[0,348,1388,2948,3988],q.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],q.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],q.FINDER_PAT_A=0,q.FINDER_PAT_B=1,q.FINDER_PAT_C=2,q.FINDER_PAT_D=3,q.FINDER_PAT_E=4,q.FINDER_PAT_F=5,q.FINDER_PATTERN_SEQUENCES=[[q.FINDER_PAT_A,q.FINDER_PAT_A],[q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B],[q.FINDER_PAT_A,q.FINDER_PAT_C,q.FINDER_PAT_B,q.FINDER_PAT_D],[q.FINDER_PAT_A,q.FINDER_PAT_E,q.FINDER_PAT_B,q.FINDER_PAT_D,q.FINDER_PAT_C],[q.FINDER_PAT_A,q.FINDER_PAT_E,q.FINDER_PAT_B,q.FINDER_PAT_D,q.FINDER_PAT_D,q.FINDER_PAT_F],[q.FINDER_PAT_A,q.FINDER_PAT_E,q.FINDER_PAT_B,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_F,q.FINDER_PAT_F],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_D],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_E],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_F,q.FINDER_PAT_F],[q.FINDER_PAT_A,q.FINDER_PAT_A,q.FINDER_PAT_B,q.FINDER_PAT_B,q.FINDER_PAT_C,q.FINDER_PAT_D,q.FINDER_PAT_D,q.FINDER_PAT_E,q.FINDER_PAT_E,q.FINDER_PAT_F,q.FINDER_PAT_F]],q.MAX_PAIRS=11;class al extends qn{constructor(e,t,r){super(e,t),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Xe extends yt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(e,t,r){const i=this.decodePair(t,!1,e,r);Xe.addOrTally(this.possibleLeftPairs,i),t.reverse();let a=this.decodePair(t,!0,e,r);Xe.addOrTally(this.possibleRightPairs,a),t.reverse();for(let l of this.possibleLeftPairs)if(l.getCount()>1){for(let d of this.possibleRightPairs)if(d.getCount()>1&&Xe.checkChecksum(l,d))return Xe.constructResult(l,d)}throw new z}static addOrTally(e,t){if(t==null)return;let r=!1;for(let i of e)if(i.getValue()===t.getValue()){i.incrementCount(),r=!0;break}r||e.push(t)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(e,t){let r=4537077*e.getValue()+t.getValue(),i=new String(r).toString(),a=new te;for(let x=13-i.length;x>0;x--)a.append("0");a.append(i);let l=0;for(let x=0;x<13;x++){let y=a.charAt(x).charCodeAt(0)-48;l+=x&1?y:3*y}l=10-l%10,l===10&&(l=0),a.append(l.toString());let d=e.getFinderPattern().getResultPoints(),g=t.getFinderPattern().getResultPoints();return new it(a.toString(),null,0,[d[0],d[1],g[0],g[1]],oe.RSS_14,new Date().getTime())}static checkChecksum(e,t){let r=(e.getChecksumPortion()+16*t.getChecksumPortion())%79,i=9*e.getFinderPattern().getValue()+t.getFinderPattern().getValue();return i>72&&i--,i>8&&i--,r===i}decodePair(e,t,r,i){try{let a=this.findFinderPattern(e,t),l=this.parseFoundFinderPattern(e,r,t,a),d=i==null?null:i.get(re.NEED_RESULT_POINT_CALLBACK);if(d!=null){let y=(a[0]+a[1])/2;t&&(y=e.getSize()-1-y),d.foundPossibleResultPoint(new le(y,r))}let g=this.decodeDataCharacter(e,l,!0),x=this.decodeDataCharacter(e,l,!1);return new al(1597*g.getValue()+x.getValue(),g.getChecksumPortion()+4*x.getChecksumPortion(),l)}catch{return null}}decodeDataCharacter(e,t,r){let i=this.getDataCharacterCounters();for(let P=0;P<i.length;P++)i[P]=0;if(r)rt.recordPatternInReverse(e,t.getStartEnd()[0],i);else{rt.recordPattern(e,t.getStartEnd()[1]+1,i);for(let P=0,Z=i.length-1;P<Z;P++,Z--){let J=i[P];i[P]=i[Z],i[Z]=J}}let a=r?16:15,l=Ne.sum(new Int32Array(i))/a,d=this.getOddCounts(),g=this.getEvenCounts(),x=this.getOddRoundingErrors(),y=this.getEvenRoundingErrors();for(let P=0;P<i.length;P++){let Z=i[P]/l,J=Math.floor(Z+.5);J<1?J=1:J>8&&(J=8);let ee=Math.floor(P/2);P&1?(g[ee]=J,y[ee]=Z-J):(d[ee]=J,x[ee]=Z-J)}this.adjustOddEvenCounts(r,a);let C=0,v=0;for(let P=d.length-1;P>=0;P--)v*=9,v+=d[P],C+=d[P];let S=0,O=0;for(let P=g.length-1;P>=0;P--)S*=9,S+=g[P],O+=g[P];let D=v+3*S;if(r){if(C&1||C>12||C<4)throw new z;let P=(12-C)/2,Z=Xe.OUTSIDE_ODD_WIDEST[P],J=9-Z,ee=Qt.getRSSvalue(d,Z,!1),Q=Qt.getRSSvalue(g,J,!0),be=Xe.OUTSIDE_EVEN_TOTAL_SUBSET[P],me=Xe.OUTSIDE_GSUM[P];return new qn(ee*be+Q+me,D)}else{if(O&1||O>10||O<4)throw new z;let P=(10-O)/2,Z=Xe.INSIDE_ODD_WIDEST[P],J=9-Z,ee=Qt.getRSSvalue(d,Z,!0),Q=Qt.getRSSvalue(g,J,!1),be=Xe.INSIDE_ODD_TOTAL_SUBSET[P],me=Xe.INSIDE_GSUM[P];return new qn(Q*be+ee+me,D)}}findFinderPattern(e,t){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let i=e.getSize(),a=!1,l=0;for(;l<i&&(a=!e.get(l),t!==a);)l++;let d=0,g=l;for(let x=l;x<i;x++)if(e.get(x)!==a)r[d]++;else{if(d===3){if(yt.isFinderPattern(r))return[g,x];g+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,d--}else d++;r[d]=1,a=!a}throw new z}parseFoundFinderPattern(e,t,r,i){let a=e.get(i[0]),l=i[0]-1;for(;l>=0&&a!==e.get(l);)l--;l++;const d=i[0]-l,g=this.getDecodeFinderCounters(),x=new Int32Array(g.length);k.arraycopy(g,0,x,1,g.length-1),x[0]=d;const y=this.parseFinderValue(x,Xe.FINDER_PATTERNS);let C=l,v=i[1];return r&&(C=e.getSize()-1-C,v=e.getSize()-1-v),new Lr(y,[l,i[1]],C,v,t)}adjustOddEvenCounts(e,t){let r=Ne.sum(new Int32Array(this.getOddCounts())),i=Ne.sum(new Int32Array(this.getEvenCounts())),a=!1,l=!1,d=!1,g=!1;e?(r>12?l=!0:r<4&&(a=!0),i>12?g=!0:i<4&&(d=!0)):(r>11?l=!0:r<5&&(a=!0),i>10?g=!0:i<4&&(d=!0));let x=r+i-t,y=(r&1)===(e?1:0),C=(i&1)===1;if(x===1)if(y){if(C)throw new z;l=!0}else{if(!C)throw new z;g=!0}else if(x===-1)if(y){if(C)throw new z;a=!0}else{if(!C)throw new z;d=!0}else if(x===0){if(y){if(!C)throw new z;r<i?(a=!0,g=!0):(l=!0,d=!0)}else if(C)throw new z}else throw new z;if(a){if(l)throw new z;yt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&yt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),d){if(g)throw new z;yt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}g&&yt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Xe.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Xe.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Xe.OUTSIDE_GSUM=[0,161,961,2015,2715],Xe.INSIDE_GSUM=[0,336,1036,1516],Xe.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Xe.INSIDE_ODD_WIDEST=[2,4,6,8],Xe.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Kn extends rt{constructor(e,t){super(),this.readers=[],this.verbose=t===!0;const r=e?e.get(re.POSSIBLE_FORMATS):null,i=e&&e.get(re.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;r?((r.includes(oe.EAN_13)||r.includes(oe.UPC_A)||r.includes(oe.EAN_8)||r.includes(oe.UPC_E))&&this.readers.push(new bs(e)),r.includes(oe.CODE_39)&&this.readers.push(new at(i)),r.includes(oe.CODE_128)&&this.readers.push(new se),r.includes(oe.ITF)&&this.readers.push(new je),r.includes(oe.RSS_14)&&this.readers.push(new Xe),r.includes(oe.RSS_EXPANDED)&&this.readers.push(new q(this.verbose))):(this.readers.push(new bs(e)),this.readers.push(new at),this.readers.push(new bs(e)),this.readers.push(new se),this.readers.push(new je),this.readers.push(new Xe),this.readers.push(new q(this.verbose)))}decodeRow(e,t,r){for(let i=0;i<this.readers.length;i++)try{return this.readers[i].decodeRow(e,t,r)}catch{}throw new z}reset(){this.readers.forEach(e=>e.reset())}}class ol extends Wt{constructor(e=500,t){super(new Kn(t),e,t)}}class Ie{constructor(e,t,r){this.ecCodewords=e,this.ecBlocks=[t],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Se{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ae{constructor(e,t,r,i,a,l){this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=r,this.dataRegionSizeRows=i,this.dataRegionSizeColumns=a,this.ecBlocks=l;let d=0;const g=l.getECCodewords(),x=l.getECBlocks();for(let y of x)d+=y.getCount()*(y.getDataCodewords()+g);this.totalCodewords=d}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(e,t){if(e&1||t&1)throw new $;for(let r of Ae.VERSIONS)if(r.symbolSizeRows===e&&r.symbolSizeColumns===t)return r;throw new $}toString(){return""+this.versionNumber}static buildVersions(){return[new Ae(1,10,10,8,8,new Ie(5,new Se(1,3))),new Ae(2,12,12,10,10,new Ie(7,new Se(1,5))),new Ae(3,14,14,12,12,new Ie(10,new Se(1,8))),new Ae(4,16,16,14,14,new Ie(12,new Se(1,12))),new Ae(5,18,18,16,16,new Ie(14,new Se(1,18))),new Ae(6,20,20,18,18,new Ie(18,new Se(1,22))),new Ae(7,22,22,20,20,new Ie(20,new Se(1,30))),new Ae(8,24,24,22,22,new Ie(24,new Se(1,36))),new Ae(9,26,26,24,24,new Ie(28,new Se(1,44))),new Ae(10,32,32,14,14,new Ie(36,new Se(1,62))),new Ae(11,36,36,16,16,new Ie(42,new Se(1,86))),new Ae(12,40,40,18,18,new Ie(48,new Se(1,114))),new Ae(13,44,44,20,20,new Ie(56,new Se(1,144))),new Ae(14,48,48,22,22,new Ie(68,new Se(1,174))),new Ae(15,52,52,24,24,new Ie(42,new Se(2,102))),new Ae(16,64,64,14,14,new Ie(56,new Se(2,140))),new Ae(17,72,72,16,16,new Ie(36,new Se(4,92))),new Ae(18,80,80,18,18,new Ie(48,new Se(4,114))),new Ae(19,88,88,20,20,new Ie(56,new Se(4,144))),new Ae(20,96,96,22,22,new Ie(68,new Se(4,174))),new Ae(21,104,104,24,24,new Ie(56,new Se(6,136))),new Ae(22,120,120,18,18,new Ie(68,new Se(6,175))),new Ae(23,132,132,20,20,new Ie(62,new Se(8,163))),new Ae(24,144,144,22,22,new Ie(62,new Se(8,156),new Se(2,155))),new Ae(25,8,18,6,16,new Ie(7,new Se(1,5))),new Ae(26,8,32,6,14,new Ie(11,new Se(1,10))),new Ae(27,12,26,10,24,new Ie(14,new Se(1,16))),new Ae(28,12,36,10,16,new Ie(18,new Se(1,22))),new Ae(29,16,36,14,16,new Ie(24,new Se(1,32))),new Ae(30,16,48,14,22,new Ie(28,new Se(1,49)))]}}Ae.VERSIONS=Ae.buildVersions();class Es{constructor(e){const t=e.getHeight();if(t<8||t>144||t&1)throw new $;this.version=Es.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new ce(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(e){const t=e.getHeight(),r=e.getWidth();return Ae.getVersionForDimensions(t,r)}readCodewords(){const e=new Int8Array(this.version.getTotalCodewords());let t=0,r=4,i=0;const a=this.mappingBitMatrix.getHeight(),l=this.mappingBitMatrix.getWidth();let d=!1,g=!1,x=!1,y=!1;do if(r===a&&i===0&&!d)e[t++]=this.readCorner1(a,l)&255,r-=2,i+=2,d=!0;else if(r===a-2&&i===0&&l&3&&!g)e[t++]=this.readCorner2(a,l)&255,r-=2,i+=2,g=!0;else if(r===a+4&&i===2&&!(l&7)&&!x)e[t++]=this.readCorner3(a,l)&255,r-=2,i+=2,x=!0;else if(r===a-2&&i===0&&(l&7)===4&&!y)e[t++]=this.readCorner4(a,l)&255,r-=2,i+=2,y=!0;else{do r<a&&i>=0&&!this.readMappingMatrix.get(i,r)&&(e[t++]=this.readUtah(r,i,a,l)&255),r-=2,i+=2;while(r>=0&&i<l);r+=1,i+=3;do r>=0&&i<l&&!this.readMappingMatrix.get(i,r)&&(e[t++]=this.readUtah(r,i,a,l)&255),r+=2,i-=2;while(r<a&&i>=0);r+=3,i+=1}while(r<a||i<l);if(t!==this.version.getTotalCodewords())throw new $;return e}readModule(e,t,r,i){return e<0&&(e+=r,t+=4-(r+4&7)),t<0&&(t+=i,e+=4-(i+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)}readUtah(e,t,r,i){let a=0;return this.readModule(e-2,t-2,r,i)&&(a|=1),a<<=1,this.readModule(e-2,t-1,r,i)&&(a|=1),a<<=1,this.readModule(e-1,t-2,r,i)&&(a|=1),a<<=1,this.readModule(e-1,t-1,r,i)&&(a|=1),a<<=1,this.readModule(e-1,t,r,i)&&(a|=1),a<<=1,this.readModule(e,t-2,r,i)&&(a|=1),a<<=1,this.readModule(e,t-1,r,i)&&(a|=1),a<<=1,this.readModule(e,t,r,i)&&(a|=1),a}readCorner1(e,t){let r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,1,e,t)&&(r|=1),r<<=1,this.readModule(e-1,2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r}readCorner2(e,t){let r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-4,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r}readCorner3(e,t){let r=0;return this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(0,t-3,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-3,e,t)&&(r|=1),r<<=1,this.readModule(1,t-2,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r}readCorner4(e,t){let r=0;return this.readModule(e-3,0,e,t)&&(r|=1),r<<=1,this.readModule(e-2,0,e,t)&&(r|=1),r<<=1,this.readModule(e-1,0,e,t)&&(r|=1),r<<=1,this.readModule(0,t-2,e,t)&&(r|=1),r<<=1,this.readModule(0,t-1,e,t)&&(r|=1),r<<=1,this.readModule(1,t-1,e,t)&&(r|=1),r<<=1,this.readModule(2,t-1,e,t)&&(r|=1),r<<=1,this.readModule(3,t-1,e,t)&&(r|=1),r}extractDataRegion(e){const t=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new N("Dimension of bitMatrix must match the version size");const i=this.version.getDataRegionSizeRows(),a=this.version.getDataRegionSizeColumns(),l=t/i|0,d=r/a|0,g=l*i,x=d*a,y=new ce(x,g);for(let C=0;C<l;++C){const v=C*i;for(let S=0;S<d;++S){const O=S*a;for(let D=0;D<i;++D){const P=C*(i+2)+1+D,Z=v+D;for(let J=0;J<a;++J){const ee=S*(a+2)+1+J;if(e.get(ee,P)){const Q=O+J;y.set(Q,Z)}}}}}return y}}class vs{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t){const r=t.getECBlocks();let i=0;const a=r.getECBlocks();for(let D of a)i+=D.getCount();const l=new Array(i);let d=0;for(let D of a)for(let P=0;P<D.getCount();P++){const Z=D.getDataCodewords(),J=r.getECCodewords()+Z;l[d++]=new vs(Z,new Uint8Array(J))}const x=l[0].codewords.length-r.getECCodewords(),y=x-1;let C=0;for(let D=0;D<y;D++)for(let P=0;P<d;P++)l[P].codewords[D]=e[C++];const v=t.getVersionNumber()===24,S=v?8:d;for(let D=0;D<S;D++)l[D].codewords[x-1]=e[C++];const O=l[0].codewords.length;for(let D=x;D<O;D++)for(let P=0;P<d;P++){const Z=v?(P+8)%d:P,J=v&&Z>7?D-1:D;l[Z].codewords[J]=e[C++]}if(C!==e.length)throw new N;return l}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class _s{constructor(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(e){if(e<1||e>32||e>this.available())throw new N(""+e);let t=0,r=this.bitOffset,i=this.byteOffset;const a=this.bytes;if(r>0){const l=8-r,d=e<l?e:l,g=l-d,x=255>>8-d<<g;t=(a[i]&x)>>g,e-=d,r+=d,r===8&&(r=0,i++)}if(e>0){for(;e>=8;)t=t<<8|a[i]&255,i++,e-=8;if(e>0){const l=8-e,d=255>>l<<l;t=t<<e|(a[i]&d)>>l,r+=e}}return this.bitOffset=r,this.byteOffset=i,t}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var ot;(function(b){b[b.PAD_ENCODE=0]="PAD_ENCODE",b[b.ASCII_ENCODE=1]="ASCII_ENCODE",b[b.C40_ENCODE=2]="C40_ENCODE",b[b.TEXT_ENCODE=3]="TEXT_ENCODE",b[b.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",b[b.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",b[b.BASE256_ENCODE=6]="BASE256_ENCODE"})(ot||(ot={}));class yn{static decode(e){const t=new _s(e),r=new te,i=new te,a=new Array;let l=ot.ASCII_ENCODE;do if(l===ot.ASCII_ENCODE)l=this.decodeAsciiSegment(t,r,i);else{switch(l){case ot.C40_ENCODE:this.decodeC40Segment(t,r);break;case ot.TEXT_ENCODE:this.decodeTextSegment(t,r);break;case ot.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,r);break;case ot.EDIFACT_ENCODE:this.decodeEdifactSegment(t,r);break;case ot.BASE256_ENCODE:this.decodeBase256Segment(t,r,a);break;default:throw new $}l=ot.ASCII_ENCODE}while(l!==ot.PAD_ENCODE&&t.available()>0);return i.length()>0&&r.append(i.toString()),new Rn(e,r.toString(),a.length===0?null:a,null)}static decodeAsciiSegment(e,t,r){let i=!1;do{let a=e.readBits(8);if(a===0)throw new $;if(a<=128)return i&&(a+=128),t.append(String.fromCharCode(a-1)),ot.ASCII_ENCODE;if(a===129)return ot.PAD_ENCODE;if(a<=229){const l=a-130;l<10&&t.append("0"),t.append(""+l)}else switch(a){case 230:return ot.C40_ENCODE;case 231:return ot.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:i=!0;break;case 236:t.append("[)>05"),r.insert(0,"");break;case 237:t.append("[)>06"),r.insert(0,"");break;case 238:return ot.ANSIX12_ENCODE;case 239:return ot.TEXT_ENCODE;case 240:return ot.EDIFACT_ENCODE;case 241:break;default:if(a!==254||e.available()!==0)throw new $;break}}while(e.available()>0);return ot.ASCII_ENCODE}static decodeC40Segment(e,t){let r=!1;const i=[];let a=0;do{if(e.available()===8)return;const l=e.readBits(8);if(l===254)return;this.parseTwoBytes(l,e.readBits(8),i);for(let d=0;d<3;d++){const g=i[d];switch(a){case 0:if(g<3)a=g+1;else if(g<this.C40_BASIC_SET_CHARS.length){const x=this.C40_BASIC_SET_CHARS[g];r?(t.append(String.fromCharCode(x.charCodeAt(0)+128)),r=!1):t.append(x)}else throw new $;break;case 1:r?(t.append(String.fromCharCode(g+128)),r=!1):t.append(String.fromCharCode(g)),a=0;break;case 2:if(g<this.C40_SHIFT2_SET_CHARS.length){const x=this.C40_SHIFT2_SET_CHARS[g];r?(t.append(String.fromCharCode(x.charCodeAt(0)+128)),r=!1):t.append(x)}else switch(g){case 27:t.append("");break;case 30:r=!0;break;default:throw new $}a=0;break;case 3:r?(t.append(String.fromCharCode(g+224)),r=!1):t.append(String.fromCharCode(g+96)),a=0;break;default:throw new $}}}while(e.available()>0)}static decodeTextSegment(e,t){let r=!1,i=[],a=0;do{if(e.available()===8)return;const l=e.readBits(8);if(l===254)return;this.parseTwoBytes(l,e.readBits(8),i);for(let d=0;d<3;d++){const g=i[d];switch(a){case 0:if(g<3)a=g+1;else if(g<this.TEXT_BASIC_SET_CHARS.length){const x=this.TEXT_BASIC_SET_CHARS[g];r?(t.append(String.fromCharCode(x.charCodeAt(0)+128)),r=!1):t.append(x)}else throw new $;break;case 1:r?(t.append(String.fromCharCode(g+128)),r=!1):t.append(String.fromCharCode(g)),a=0;break;case 2:if(g<this.TEXT_SHIFT2_SET_CHARS.length){const x=this.TEXT_SHIFT2_SET_CHARS[g];r?(t.append(String.fromCharCode(x.charCodeAt(0)+128)),r=!1):t.append(x)}else switch(g){case 27:t.append("");break;case 30:r=!0;break;default:throw new $}a=0;break;case 3:if(g<this.TEXT_SHIFT3_SET_CHARS.length){const x=this.TEXT_SHIFT3_SET_CHARS[g];r?(t.append(String.fromCharCode(x.charCodeAt(0)+128)),r=!1):t.append(x),a=0}else throw new $;break;default:throw new $}}}while(e.available()>0)}static decodeAnsiX12Segment(e,t){const r=[];do{if(e.available()===8)return;const i=e.readBits(8);if(i===254)return;this.parseTwoBytes(i,e.readBits(8),r);for(let a=0;a<3;a++){const l=r[a];switch(l){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(l<14)t.append(String.fromCharCode(l+44));else if(l<40)t.append(String.fromCharCode(l+51));else throw new $;break}}}while(e.available()>0)}static parseTwoBytes(e,t,r){let i=(e<<8)+t-1,a=Math.floor(i/1600);r[0]=a,i-=a*1600,a=Math.floor(i/40),r[1]=a,r[2]=i-a*40}static decodeEdifactSegment(e,t){do{if(e.available()<=16)return;for(let r=0;r<4;r++){let i=e.readBits(6);if(i===31){const a=8-e.getBitOffset();a!==8&&e.readBits(a);return}i&32||(i|=64),t.append(String.fromCharCode(i))}}while(e.available()>0)}static decodeBase256Segment(e,t,r){let i=1+e.getByteOffset();const a=this.unrandomize255State(e.readBits(8),i++);let l;if(a===0?l=e.available()/8|0:a<250?l=a:l=250*(a-249)+this.unrandomize255State(e.readBits(8),i++),l<0)throw new $;const d=new Uint8Array(l);for(let g=0;g<l;g++){if(e.available()<8)throw new $;d[g]=this.unrandomize255State(e.readBits(8),i++)}r.push(d);try{t.append(R.decode(d,X.ISO88591))}catch(g){throw new $t("Platform does not support required encoding: "+g.message)}}static unrandomize255State(e,t){const r=149*t%255+1,i=e-r;return i>=0?i:i+256}}yn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],yn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],yn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],yn.TEXT_SHIFT2_SET_CHARS=yn.C40_SHIFT2_SET_CHARS,yn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class ll{constructor(){this.rsDecoder=new dr(ve.DATA_MATRIX_FIELD_256)}decode(e){const t=new Es(e),r=t.getVersion(),i=t.readCodewords(),a=vs.getDataBlocks(i,r);let l=0;for(let x of a)l+=x.getNumDataCodewords();const d=new Uint8Array(l),g=a.length;for(let x=0;x<g;x++){const y=a[x],C=y.getCodewords(),v=y.getNumDataCodewords();this.correctErrors(C,v);for(let S=0;S<v;S++)d[S*g+x]=C[S]}return yn.decode(d)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch{throw new M}for(let i=0;i<t;i++)e[i]=r[i]}}class Je{constructor(e){this.image=e,this.rectangleDetector=new ln(this.image)}detect(){const e=this.rectangleDetector.detect();let t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new z;t=this.shiftToModuleCenter(t);const r=t[0],i=t[1],a=t[2],l=t[3];let d=this.transitionsBetween(r,l)+1,g=this.transitionsBetween(a,l)+1;(d&1)===1&&(d+=1),(g&1)===1&&(g+=1),4*d<7*g&&4*g<7*d&&(d=g=Math.max(d,g));let x=Je.sampleGrid(this.image,r,i,a,l,d,g);return new Rr(x,[r,i,a,l])}static shiftPoint(e,t,r){let i=(t.getX()-e.getX())/(r+1),a=(t.getY()-e.getY())/(r+1);return new le(e.getX()+i,e.getY()+a)}static moveAway(e,t,r){let i=e.getX(),a=e.getY();return i<t?i-=1:i+=1,a<r?a-=1:a+=1,new le(i,a)}detectSolid1(e){let t=e[0],r=e[1],i=e[3],a=e[2],l=this.transitionsBetween(t,r),d=this.transitionsBetween(r,i),g=this.transitionsBetween(i,a),x=this.transitionsBetween(a,t),y=l,C=[a,t,r,i];return y>d&&(y=d,C[0]=t,C[1]=r,C[2]=i,C[3]=a),y>g&&(y=g,C[0]=r,C[1]=i,C[2]=a,C[3]=t),y>x&&(C[0]=i,C[1]=a,C[2]=t,C[3]=r),C}detectSolid2(e){let t=e[0],r=e[1],i=e[2],a=e[3],l=this.transitionsBetween(t,a),d=Je.shiftPoint(r,i,(l+1)*4),g=Je.shiftPoint(i,r,(l+1)*4),x=this.transitionsBetween(d,t),y=this.transitionsBetween(g,a);return x<y?(e[0]=t,e[1]=r,e[2]=i,e[3]=a):(e[0]=r,e[1]=i,e[2]=a,e[3]=t),e}correctTopRight(e){let t=e[0],r=e[1],i=e[2],a=e[3],l=this.transitionsBetween(t,a),d=this.transitionsBetween(r,a),g=Je.shiftPoint(t,r,(d+1)*4),x=Je.shiftPoint(i,r,(l+1)*4);l=this.transitionsBetween(g,a),d=this.transitionsBetween(x,a);let y=new le(a.getX()+(i.getX()-r.getX())/(l+1),a.getY()+(i.getY()-r.getY())/(l+1)),C=new le(a.getX()+(t.getX()-r.getX())/(d+1),a.getY()+(t.getY()-r.getY())/(d+1));if(!this.isValid(y))return this.isValid(C)?C:null;if(!this.isValid(C))return y;let v=this.transitionsBetween(g,y)+this.transitionsBetween(x,y),S=this.transitionsBetween(g,C)+this.transitionsBetween(x,C);return v>S?y:C}shiftToModuleCenter(e){let t=e[0],r=e[1],i=e[2],a=e[3],l=this.transitionsBetween(t,a)+1,d=this.transitionsBetween(i,a)+1,g=Je.shiftPoint(t,r,d*4),x=Je.shiftPoint(i,r,l*4);l=this.transitionsBetween(g,a)+1,d=this.transitionsBetween(x,a)+1,(l&1)===1&&(l+=1),(d&1)===1&&(d+=1);let y=(t.getX()+r.getX()+i.getX()+a.getX())/4,C=(t.getY()+r.getY()+i.getY()+a.getY())/4;t=Je.moveAway(t,y,C),r=Je.moveAway(r,y,C),i=Je.moveAway(i,y,C),a=Je.moveAway(a,y,C);let v,S;return g=Je.shiftPoint(t,r,d*4),g=Je.shiftPoint(g,a,l*4),v=Je.shiftPoint(r,t,d*4),v=Je.shiftPoint(v,i,l*4),x=Je.shiftPoint(i,a,d*4),x=Je.shiftPoint(x,r,l*4),S=Je.shiftPoint(a,i,d*4),S=Je.shiftPoint(S,t,l*4),[g,v,x,S]}isValid(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()}static sampleGrid(e,t,r,i,a,l,d){return mn.getInstance().sampleGrid(e,l,d,.5,.5,l-.5,.5,l-.5,d-.5,.5,d-.5,t.getX(),t.getY(),a.getX(),a.getY(),i.getX(),i.getY(),r.getX(),r.getY())}transitionsBetween(e,t){let r=Math.trunc(e.getX()),i=Math.trunc(e.getY()),a=Math.trunc(t.getX()),l=Math.trunc(t.getY()),d=Math.abs(l-i)>Math.abs(a-r);if(d){let D=r;r=i,i=D,D=a,a=l,l=D}let g=Math.abs(a-r),x=Math.abs(l-i),y=-g/2,C=i<l?1:-1,v=r<a?1:-1,S=0,O=this.image.get(d?i:r,d?r:i);for(let D=r,P=i;D!==a;D+=v){let Z=this.image.get(d?P:D,d?D:P);if(Z!==O&&(S++,O=Z),y+=x,y>0){if(P===l)break;P+=C,y-=g}}return S}}class wn{constructor(){this.decoder=new ll}decode(e,t=null){let r,i;if(t!=null&&t.has(re.PURE_BARCODE)){const x=wn.extractPureBits(e.getBlackMatrix());r=this.decoder.decode(x),i=wn.NO_POINTS}else{const x=new Je(e.getBlackMatrix()).detect();r=this.decoder.decode(x.getBits()),i=x.getPoints()}const a=r.getRawBytes(),l=new it(r.getText(),a,8*a.length,i,oe.DATA_MATRIX,k.currentTimeMillis()),d=r.getByteSegments();d!=null&&l.putMetadata(Fe.BYTE_SEGMENTS,d);const g=r.getECLevel();return g!=null&&l.putMetadata(Fe.ERROR_CORRECTION_LEVEL,g),l}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(t==null||r==null)throw new z;const i=this.moduleSize(t,e);let a=t[1];const l=r[1];let d=t[0];const x=(r[0]-d+1)/i,y=(l-a+1)/i;if(x<=0||y<=0)throw new z;const C=i/2;a+=C,d+=C;const v=new ce(x,y);for(let S=0;S<y;S++){const O=a+S*i;for(let D=0;D<x;D++)e.get(d+D*i,O)&&v.set(D,S)}return v}static moduleSize(e,t){const r=t.getWidth();let i=e[0];const a=e[1];for(;i<r&&t.get(i,a);)i++;if(i===r)throw new z;const l=i-e[0];if(l===0)throw new z;return l}}wn.NO_POINTS=[];class cl extends Wt{constructor(e=500){super(new wn,e)}}var Jn;(function(b){b[b.L=0]="L",b[b.M=1]="M",b[b.Q=2]="Q",b[b.H=3]="H"})(Jn||(Jn={}));class Be{constructor(e,t,r){this.value=e,this.stringValue=t,this.bits=r,Be.FOR_BITS.set(r,this),Be.FOR_VALUE.set(e,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(e){switch(e){case"L":return Be.L;case"M":return Be.M;case"Q":return Be.Q;case"H":return Be.H;default:throw new A(e+"not available")}}toString(){return this.stringValue}equals(e){if(!(e instanceof Be))return!1;const t=e;return this.value===t.value}static forBits(e){if(e<0||e>=Be.FOR_BITS.size)throw new N;return Be.FOR_BITS.get(e)}}Be.FOR_BITS=new Map,Be.FOR_VALUE=new Map,Be.L=new Be(Jn.L,"L",1),Be.M=new Be(Jn.M,"M",0),Be.Q=new Be(Jn.Q,"Q",3),Be.H=new Be(Jn.H,"H",2);class wt{constructor(e){this.errorCorrectionLevel=Be.forBits(e>>3&3),this.dataMask=e&7}static numBitsDiffering(e,t){return B.bitCount(e^t)}static decodeFormatInformation(e,t){const r=wt.doDecodeFormatInformation(e,t);return r!==null?r:wt.doDecodeFormatInformation(e^wt.FORMAT_INFO_MASK_QR,t^wt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(e,t){let r=Number.MAX_SAFE_INTEGER,i=0;for(const a of wt.FORMAT_INFO_DECODE_LOOKUP){const l=a[0];if(l===e||l===t)return new wt(a[1]);let d=wt.numBitsDiffering(e,l);d<r&&(i=a[1],r=d),e!==t&&(d=wt.numBitsDiffering(t,l),d<r&&(i=a[1],r=d))}return r<=3?new wt(i):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(e){if(!(e instanceof wt))return!1;const t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask}}wt.FORMAT_INFO_MASK_QR=21522,wt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class F{constructor(e,...t){this.ecCodewordsPerBlock=e,this.ecBlocks=t}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let e=0;const t=this.ecBlocks;for(const r of t)e+=r.getCount();return e}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class _{constructor(e,t){this.count=e,this.dataCodewords=t}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ue{constructor(e,t,...r){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=r;let i=0;const a=r[0].getECCodewordsPerBlock(),l=r[0].getECBlocks();for(const d of l)i+=d.getCount()*(d.getDataCodewords()+a);this.totalCodewords=i}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(e){return this.ecBlocks[e.getValue()]}static getProvisionalVersionForDimension(e){if(e%4!==1)throw new $;try{return this.getVersionForNumber((e-17)/4)}catch{throw new $}}static getVersionForNumber(e){if(e<1||e>40)throw new N;return ue.VERSIONS[e-1]}static decodeVersionInformation(e){let t=Number.MAX_SAFE_INTEGER,r=0;for(let i=0;i<ue.VERSION_DECODE_INFO.length;i++){const a=ue.VERSION_DECODE_INFO[i];if(a===e)return ue.getVersionForNumber(i+7);const l=wt.numBitsDiffering(e,a);l<t&&(r=i+7,t=l)}return t<=3?ue.getVersionForNumber(r):null}buildFunctionPattern(){const e=this.getDimensionForVersion(),t=new ce(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);const r=this.alignmentPatternCenters.length;for(let i=0;i<r;i++){const a=this.alignmentPatternCenters[i]-2;for(let l=0;l<r;l++)i===0&&(l===0||l===r-1)||i===r-1&&l===0||t.setRegion(this.alignmentPatternCenters[l]-2,a,5,5)}return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t}toString(){return""+this.versionNumber}}ue.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ue.VERSIONS=[new ue(1,new Int32Array(0),new F(7,new _(1,19)),new F(10,new _(1,16)),new F(13,new _(1,13)),new F(17,new _(1,9))),new ue(2,Int32Array.from([6,18]),new F(10,new _(1,34)),new F(16,new _(1,28)),new F(22,new _(1,22)),new F(28,new _(1,16))),new ue(3,Int32Array.from([6,22]),new F(15,new _(1,55)),new F(26,new _(1,44)),new F(18,new _(2,17)),new F(22,new _(2,13))),new ue(4,Int32Array.from([6,26]),new F(20,new _(1,80)),new F(18,new _(2,32)),new F(26,new _(2,24)),new F(16,new _(4,9))),new ue(5,Int32Array.from([6,30]),new F(26,new _(1,108)),new F(24,new _(2,43)),new F(18,new _(2,15),new _(2,16)),new F(22,new _(2,11),new _(2,12))),new ue(6,Int32Array.from([6,34]),new F(18,new _(2,68)),new F(16,new _(4,27)),new F(24,new _(4,19)),new F(28,new _(4,15))),new ue(7,Int32Array.from([6,22,38]),new F(20,new _(2,78)),new F(18,new _(4,31)),new F(18,new _(2,14),new _(4,15)),new F(26,new _(4,13),new _(1,14))),new ue(8,Int32Array.from([6,24,42]),new F(24,new _(2,97)),new F(22,new _(2,38),new _(2,39)),new F(22,new _(4,18),new _(2,19)),new F(26,new _(4,14),new _(2,15))),new ue(9,Int32Array.from([6,26,46]),new F(30,new _(2,116)),new F(22,new _(3,36),new _(2,37)),new F(20,new _(4,16),new _(4,17)),new F(24,new _(4,12),new _(4,13))),new ue(10,Int32Array.from([6,28,50]),new F(18,new _(2,68),new _(2,69)),new F(26,new _(4,43),new _(1,44)),new F(24,new _(6,19),new _(2,20)),new F(28,new _(6,15),new _(2,16))),new ue(11,Int32Array.from([6,30,54]),new F(20,new _(4,81)),new F(30,new _(1,50),new _(4,51)),new F(28,new _(4,22),new _(4,23)),new F(24,new _(3,12),new _(8,13))),new ue(12,Int32Array.from([6,32,58]),new F(24,new _(2,92),new _(2,93)),new F(22,new _(6,36),new _(2,37)),new F(26,new _(4,20),new _(6,21)),new F(28,new _(7,14),new _(4,15))),new ue(13,Int32Array.from([6,34,62]),new F(26,new _(4,107)),new F(22,new _(8,37),new _(1,38)),new F(24,new _(8,20),new _(4,21)),new F(22,new _(12,11),new _(4,12))),new ue(14,Int32Array.from([6,26,46,66]),new F(30,new _(3,115),new _(1,116)),new F(24,new _(4,40),new _(5,41)),new F(20,new _(11,16),new _(5,17)),new F(24,new _(11,12),new _(5,13))),new ue(15,Int32Array.from([6,26,48,70]),new F(22,new _(5,87),new _(1,88)),new F(24,new _(5,41),new _(5,42)),new F(30,new _(5,24),new _(7,25)),new F(24,new _(11,12),new _(7,13))),new ue(16,Int32Array.from([6,26,50,74]),new F(24,new _(5,98),new _(1,99)),new F(28,new _(7,45),new _(3,46)),new F(24,new _(15,19),new _(2,20)),new F(30,new _(3,15),new _(13,16))),new ue(17,Int32Array.from([6,30,54,78]),new F(28,new _(1,107),new _(5,108)),new F(28,new _(10,46),new _(1,47)),new F(28,new _(1,22),new _(15,23)),new F(28,new _(2,14),new _(17,15))),new ue(18,Int32Array.from([6,30,56,82]),new F(30,new _(5,120),new _(1,121)),new F(26,new _(9,43),new _(4,44)),new F(28,new _(17,22),new _(1,23)),new F(28,new _(2,14),new _(19,15))),new ue(19,Int32Array.from([6,30,58,86]),new F(28,new _(3,113),new _(4,114)),new F(26,new _(3,44),new _(11,45)),new F(26,new _(17,21),new _(4,22)),new F(26,new _(9,13),new _(16,14))),new ue(20,Int32Array.from([6,34,62,90]),new F(28,new _(3,107),new _(5,108)),new F(26,new _(3,41),new _(13,42)),new F(30,new _(15,24),new _(5,25)),new F(28,new _(15,15),new _(10,16))),new ue(21,Int32Array.from([6,28,50,72,94]),new F(28,new _(4,116),new _(4,117)),new F(26,new _(17,42)),new F(28,new _(17,22),new _(6,23)),new F(30,new _(19,16),new _(6,17))),new ue(22,Int32Array.from([6,26,50,74,98]),new F(28,new _(2,111),new _(7,112)),new F(28,new _(17,46)),new F(30,new _(7,24),new _(16,25)),new F(24,new _(34,13))),new ue(23,Int32Array.from([6,30,54,78,102]),new F(30,new _(4,121),new _(5,122)),new F(28,new _(4,47),new _(14,48)),new F(30,new _(11,24),new _(14,25)),new F(30,new _(16,15),new _(14,16))),new ue(24,Int32Array.from([6,28,54,80,106]),new F(30,new _(6,117),new _(4,118)),new F(28,new _(6,45),new _(14,46)),new F(30,new _(11,24),new _(16,25)),new F(30,new _(30,16),new _(2,17))),new ue(25,Int32Array.from([6,32,58,84,110]),new F(26,new _(8,106),new _(4,107)),new F(28,new _(8,47),new _(13,48)),new F(30,new _(7,24),new _(22,25)),new F(30,new _(22,15),new _(13,16))),new ue(26,Int32Array.from([6,30,58,86,114]),new F(28,new _(10,114),new _(2,115)),new F(28,new _(19,46),new _(4,47)),new F(28,new _(28,22),new _(6,23)),new F(30,new _(33,16),new _(4,17))),new ue(27,Int32Array.from([6,34,62,90,118]),new F(30,new _(8,122),new _(4,123)),new F(28,new _(22,45),new _(3,46)),new F(30,new _(8,23),new _(26,24)),new F(30,new _(12,15),new _(28,16))),new ue(28,Int32Array.from([6,26,50,74,98,122]),new F(30,new _(3,117),new _(10,118)),new F(28,new _(3,45),new _(23,46)),new F(30,new _(4,24),new _(31,25)),new F(30,new _(11,15),new _(31,16))),new ue(29,Int32Array.from([6,30,54,78,102,126]),new F(30,new _(7,116),new _(7,117)),new F(28,new _(21,45),new _(7,46)),new F(30,new _(1,23),new _(37,24)),new F(30,new _(19,15),new _(26,16))),new ue(30,Int32Array.from([6,26,52,78,104,130]),new F(30,new _(5,115),new _(10,116)),new F(28,new _(19,47),new _(10,48)),new F(30,new _(15,24),new _(25,25)),new F(30,new _(23,15),new _(25,16))),new ue(31,Int32Array.from([6,30,56,82,108,134]),new F(30,new _(13,115),new _(3,116)),new F(28,new _(2,46),new _(29,47)),new F(30,new _(42,24),new _(1,25)),new F(30,new _(23,15),new _(28,16))),new ue(32,Int32Array.from([6,34,60,86,112,138]),new F(30,new _(17,115)),new F(28,new _(10,46),new _(23,47)),new F(30,new _(10,24),new _(35,25)),new F(30,new _(19,15),new _(35,16))),new ue(33,Int32Array.from([6,30,58,86,114,142]),new F(30,new _(17,115),new _(1,116)),new F(28,new _(14,46),new _(21,47)),new F(30,new _(29,24),new _(19,25)),new F(30,new _(11,15),new _(46,16))),new ue(34,Int32Array.from([6,34,62,90,118,146]),new F(30,new _(13,115),new _(6,116)),new F(28,new _(14,46),new _(23,47)),new F(30,new _(44,24),new _(7,25)),new F(30,new _(59,16),new _(1,17))),new ue(35,Int32Array.from([6,30,54,78,102,126,150]),new F(30,new _(12,121),new _(7,122)),new F(28,new _(12,47),new _(26,48)),new F(30,new _(39,24),new _(14,25)),new F(30,new _(22,15),new _(41,16))),new ue(36,Int32Array.from([6,24,50,76,102,128,154]),new F(30,new _(6,121),new _(14,122)),new F(28,new _(6,47),new _(34,48)),new F(30,new _(46,24),new _(10,25)),new F(30,new _(2,15),new _(64,16))),new ue(37,Int32Array.from([6,28,54,80,106,132,158]),new F(30,new _(17,122),new _(4,123)),new F(28,new _(29,46),new _(14,47)),new F(30,new _(49,24),new _(10,25)),new F(30,new _(24,15),new _(46,16))),new ue(38,Int32Array.from([6,32,58,84,110,136,162]),new F(30,new _(4,122),new _(18,123)),new F(28,new _(13,46),new _(32,47)),new F(30,new _(48,24),new _(14,25)),new F(30,new _(42,15),new _(32,16))),new ue(39,Int32Array.from([6,26,54,82,110,138,166]),new F(30,new _(20,117),new _(4,118)),new F(28,new _(40,47),new _(7,48)),new F(30,new _(43,24),new _(22,25)),new F(30,new _(10,15),new _(67,16))),new ue(40,Int32Array.from([6,30,58,86,114,142,170]),new F(30,new _(19,118),new _(6,119)),new F(28,new _(18,47),new _(31,48)),new F(30,new _(34,24),new _(34,25)),new F(30,new _(20,15),new _(61,16)))];var dt;(function(b){b[b.DATA_MASK_000=0]="DATA_MASK_000",b[b.DATA_MASK_001=1]="DATA_MASK_001",b[b.DATA_MASK_010=2]="DATA_MASK_010",b[b.DATA_MASK_011=3]="DATA_MASK_011",b[b.DATA_MASK_100=4]="DATA_MASK_100",b[b.DATA_MASK_101=5]="DATA_MASK_101",b[b.DATA_MASK_110=6]="DATA_MASK_110",b[b.DATA_MASK_111=7]="DATA_MASK_111"})(dt||(dt={}));class Pt{constructor(e,t){this.value=e,this.isMasked=t}unmaskBitMatrix(e,t){for(let r=0;r<t;r++)for(let i=0;i<t;i++)this.isMasked(r,i)&&e.flip(i,r)}}Pt.values=new Map([[dt.DATA_MASK_000,new Pt(dt.DATA_MASK_000,(b,e)=>(b+e&1)===0)],[dt.DATA_MASK_001,new Pt(dt.DATA_MASK_001,(b,e)=>(b&1)===0)],[dt.DATA_MASK_010,new Pt(dt.DATA_MASK_010,(b,e)=>e%3===0)],[dt.DATA_MASK_011,new Pt(dt.DATA_MASK_011,(b,e)=>(b+e)%3===0)],[dt.DATA_MASK_100,new Pt(dt.DATA_MASK_100,(b,e)=>(Math.floor(b/2)+Math.floor(e/3)&1)===0)],[dt.DATA_MASK_101,new Pt(dt.DATA_MASK_101,(b,e)=>b*e%6===0)],[dt.DATA_MASK_110,new Pt(dt.DATA_MASK_110,(b,e)=>b*e%6<3)],[dt.DATA_MASK_111,new Pt(dt.DATA_MASK_111,(b,e)=>(b+e+b*e%3&1)===0)]]);class ul{constructor(e){const t=e.getHeight();if(t<21||(t&3)!==1)throw new $;this.bitMatrix=e}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let e=0;for(let a=0;a<6;a++)e=this.copyBit(a,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(let a=5;a>=0;a--)e=this.copyBit(8,a,e);const t=this.bitMatrix.getHeight();let r=0;const i=t-7;for(let a=t-1;a>=i;a--)r=this.copyBit(8,a,r);for(let a=t-8;a<t;a++)r=this.copyBit(a,8,r);if(this.parsedFormatInfo=wt.decodeFormatInformation(e,r),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new $}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return ue.getVersionForNumber(t);let r=0;const i=e-11;for(let l=5;l>=0;l--)for(let d=e-9;d>=i;d--)r=this.copyBit(d,l,r);let a=ue.decodeVersionInformation(r);if(a!==null&&a.getDimensionForVersion()===e)return this.parsedVersion=a,a;r=0;for(let l=5;l>=0;l--)for(let d=e-9;d>=i;d--)r=this.copyBit(l,d,r);if(a=ue.decodeVersionInformation(r),a!==null&&a.getDimensionForVersion()===e)return this.parsedVersion=a,a;throw new $}copyBit(e,t,r){return(this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t))?r<<1|1:r<<1}readCodewords(){const e=this.readFormatInformation(),t=this.readVersion(),r=Pt.values.get(e.getDataMask()),i=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,i);const a=t.buildFunctionPattern();let l=!0;const d=new Uint8Array(t.getTotalCodewords());let g=0,x=0,y=0;for(let C=i-1;C>0;C-=2){C===6&&C--;for(let v=0;v<i;v++){const S=l?i-1-v:v;for(let O=0;O<2;O++)a.get(C-O,S)||(y++,x<<=1,this.bitMatrix.get(C-O,S)&&(x|=1),y===8&&(d[g++]=x,y=0,x=0))}l=!l}if(g!==t.getTotalCodewords())throw new $;return d}remask(){if(this.parsedFormatInfo===null)return;const e=Pt.values[this.parsedFormatInfo.getDataMask()],t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}setMirror(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e}mirror(){const e=this.bitMatrix;for(let t=0,r=e.getWidth();t<r;t++)for(let i=t+1,a=e.getHeight();i<a;i++)e.get(t,i)!==e.get(i,t)&&(e.flip(i,t),e.flip(t,i))}}class Ss{constructor(e,t){this.numDataCodewords=e,this.codewords=t}static getDataBlocks(e,t,r){if(e.length!==t.getTotalCodewords())throw new N;const i=t.getECBlocksForLevel(r);let a=0;const l=i.getECBlocks();for(const O of l)a+=O.getCount();const d=new Array(a);let g=0;for(const O of l)for(let D=0;D<O.getCount();D++){const P=O.getDataCodewords(),Z=i.getECCodewordsPerBlock()+P;d[g++]=new Ss(P,new Uint8Array(Z))}const x=d[0].codewords.length;let y=d.length-1;for(;y>=0&&d[y].codewords.length!==x;)y--;y++;const C=x-i.getECCodewordsPerBlock();let v=0;for(let O=0;O<C;O++)for(let D=0;D<g;D++)d[D].codewords[O]=e[v++];for(let O=y;O<g;O++)d[O].codewords[C]=e[v++];const S=d[0].codewords.length;for(let O=C;O<S;O++)for(let D=0;D<g;D++){const P=D<y?O:O+1;d[D].codewords[P]=e[v++]}return d}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ft;(function(b){b[b.TERMINATOR=0]="TERMINATOR",b[b.NUMERIC=1]="NUMERIC",b[b.ALPHANUMERIC=2]="ALPHANUMERIC",b[b.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",b[b.BYTE=4]="BYTE",b[b.ECI=5]="ECI",b[b.KANJI=6]="KANJI",b[b.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",b[b.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",b[b.HANZI=9]="HANZI"})(Ft||(Ft={}));class he{constructor(e,t,r,i){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=r,this.bits=i,he.FOR_BITS.set(i,this),he.FOR_VALUE.set(e,this)}static forBits(e){const t=he.FOR_BITS.get(e);if(t===void 0)throw new N;return t}getCharacterCountBits(e){const t=e.getVersionNumber();let r;return t<=9?r=0:t<=26?r=1:r=2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(e){if(!(e instanceof he))return!1;const t=e;return this.value===t.value}toString(){return this.stringValue}}he.FOR_BITS=new Map,he.FOR_VALUE=new Map,he.TERMINATOR=new he(Ft.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),he.NUMERIC=new he(Ft.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),he.ALPHANUMERIC=new he(Ft.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),he.STRUCTURED_APPEND=new he(Ft.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),he.BYTE=new he(Ft.BYTE,"BYTE",Int32Array.from([8,16,16]),4),he.ECI=new he(Ft.ECI,"ECI",Int32Array.from([0,0,0]),7),he.KANJI=new he(Ft.KANJI,"KANJI",Int32Array.from([8,10,12]),8),he.FNC1_FIRST_POSITION=new he(Ft.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),he.FNC1_SECOND_POSITION=new he(Ft.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),he.HANZI=new he(Ft.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class We{static decode(e,t,r,i){const a=new _s(e);let l=new te;const d=new Array;let g=-1,x=-1;try{let y=null,C=!1,v;do{if(a.available()<4)v=he.TERMINATOR;else{const S=a.readBits(4);v=he.forBits(S)}switch(v){case he.TERMINATOR:break;case he.FNC1_FIRST_POSITION:case he.FNC1_SECOND_POSITION:C=!0;break;case he.STRUCTURED_APPEND:if(a.available()<16)throw new $;g=a.readBits(8),x=a.readBits(8);break;case he.ECI:const S=We.parseECIValue(a);if(y=L.getCharacterSetECIByValue(S),y===null)throw new $;break;case he.HANZI:const O=a.readBits(4),D=a.readBits(v.getCharacterCountBits(t));O===We.GB2312_SUBSET&&We.decodeHanziSegment(a,l,D);break;default:const P=a.readBits(v.getCharacterCountBits(t));switch(v){case he.NUMERIC:We.decodeNumericSegment(a,l,P);break;case he.ALPHANUMERIC:We.decodeAlphanumericSegment(a,l,P,C);break;case he.BYTE:We.decodeByteSegment(a,l,P,y,d,i);break;case he.KANJI:We.decodeKanjiSegment(a,l,P);break;default:throw new $}break}}while(v!==he.TERMINATOR)}catch{throw new $}return new Rn(e,l.toString(),d.length===0?null:d,r===null?null:r.toString(),g,x)}static decodeHanziSegment(e,t,r){if(r*13>e.available())throw new $;const i=new Uint8Array(2*r);let a=0;for(;r>0;){const l=e.readBits(13);let d=l/96<<8&4294967295|l%96;d<959?d+=41377:d+=42657,i[a]=d>>8&255,i[a+1]=d&255,a+=2,r--}try{t.append(R.decode(i,X.GB2312))}catch(l){throw new $(l)}}static decodeKanjiSegment(e,t,r){if(r*13>e.available())throw new $;const i=new Uint8Array(2*r);let a=0;for(;r>0;){const l=e.readBits(13);let d=l/192<<8&4294967295|l%192;d<7936?d+=33088:d+=49472,i[a]=d>>8,i[a+1]=d,a+=2,r--}try{t.append(R.decode(i,X.SHIFT_JIS))}catch(l){throw new $(l)}}static decodeByteSegment(e,t,r,i,a,l){if(8*r>e.available())throw new $;const d=new Uint8Array(r);for(let x=0;x<r;x++)d[x]=e.readBits(8);let g;i===null?g=X.guessEncoding(d,l):g=i.getName();try{t.append(R.decode(d,g))}catch(x){throw new $(x)}a.push(d)}static toAlphaNumericChar(e){if(e>=We.ALPHANUMERIC_CHARS.length)throw new $;return We.ALPHANUMERIC_CHARS[e]}static decodeAlphanumericSegment(e,t,r,i){const a=t.length();for(;r>1;){if(e.available()<11)throw new $;const l=e.readBits(11);t.append(We.toAlphaNumericChar(Math.floor(l/45))),t.append(We.toAlphaNumericChar(l%45)),r-=2}if(r===1){if(e.available()<6)throw new $;t.append(We.toAlphaNumericChar(e.readBits(6)))}if(i)for(let l=a;l<t.length();l++)t.charAt(l)==="%"&&(l<t.length()-1&&t.charAt(l+1)==="%"?t.deleteCharAt(l+1):t.setCharAt(l,""))}static decodeNumericSegment(e,t,r){for(;r>=3;){if(e.available()<10)throw new $;const i=e.readBits(10);if(i>=1e3)throw new $;t.append(We.toAlphaNumericChar(Math.floor(i/100))),t.append(We.toAlphaNumericChar(Math.floor(i/10)%10)),t.append(We.toAlphaNumericChar(i%10)),r-=3}if(r===2){if(e.available()<7)throw new $;const i=e.readBits(7);if(i>=100)throw new $;t.append(We.toAlphaNumericChar(Math.floor(i/10))),t.append(We.toAlphaNumericChar(i%10))}else if(r===1){if(e.available()<4)throw new $;const i=e.readBits(4);if(i>=10)throw new $;t.append(We.toAlphaNumericChar(i))}}static parseECIValue(e){const t=e.readBits(8);if(!(t&128))return t&127;if((t&192)===128){const r=e.readBits(8);return(t&63)<<8&4294967295|r}if((t&224)===192){const r=e.readBits(16);return(t&31)<<16&4294967295|r}throw new $}}We.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",We.GB2312_SUBSET=1;class Li{constructor(e){this.mirrored=e}isMirrored(){return this.mirrored}applyMirroredCorrection(e){if(!this.mirrored||e===null||e.length<3)return;const t=e[0];e[0]=e[2],e[2]=t}}class dl{constructor(){this.rsDecoder=new dr(ve.QR_CODE_FIELD_256)}decodeBooleanArray(e,t){return this.decodeBitMatrix(ce.parseFromBooleanArray(e),t)}decodeBitMatrix(e,t){const r=new ul(e);let i=null;try{return this.decodeBitMatrixParser(r,t)}catch(a){i=a}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const a=this.decodeBitMatrixParser(r,t);return a.setOther(new Li(!0)),a}catch(a){throw i!==null?i:a}}decodeBitMatrixParser(e,t){const r=e.readVersion(),i=e.readFormatInformation().getErrorCorrectionLevel(),a=e.readCodewords(),l=Ss.getDataBlocks(a,r,i);let d=0;for(const y of l)d+=y.getNumDataCodewords();const g=new Uint8Array(d);let x=0;for(const y of l){const C=y.getCodewords(),v=y.getNumDataCodewords();this.correctErrors(C,v);for(let S=0;S<v;S++)g[x++]=C[S]}return We.decode(g,r,i,t)}correctErrors(e,t){const r=new Int32Array(e);try{this.rsDecoder.decode(r,e.length-t)}catch{throw new M}for(let i=0;i<t;i++)e[i]=r[i]}}class Is extends le{constructor(e,t,r){super(e,t),this.estimatedModuleSize=r}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const i=Math.abs(e-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const i=(this.getX()+t)/2,a=(this.getY()+e)/2,l=(this.estimatedModuleSize+r)/2;return new Is(i,a,l)}}class Fr{constructor(e,t,r,i,a,l,d){this.image=e,this.startX=t,this.startY=r,this.width=i,this.height=a,this.moduleSize=l,this.resultPointCallback=d,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const e=this.startX,t=this.height,r=this.width,i=e+r,a=this.startY+t/2,l=new Int32Array(3),d=this.image;for(let g=0;g<t;g++){const x=a+(g&1?-Math.floor((g+1)/2):Math.floor((g+1)/2));l[0]=0,l[1]=0,l[2]=0;let y=e;for(;y<i&&!d.get(y,x);)y++;let C=0;for(;y<i;){if(d.get(y,x))if(C===1)l[1]++;else if(C===2){if(this.foundPatternCross(l)){const v=this.handlePossibleCenter(l,x,y);if(v!==null)return v}l[0]=l[2],l[1]=1,l[2]=0,C=1}else l[++C]++;else C===1&&C++,l[C]++;y++}if(this.foundPatternCross(l)){const v=this.handlePossibleCenter(l,x,i);if(v!==null)return v}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new z}static centerFromEnd(e,t){return t-e[2]-e[1]/2}foundPatternCross(e){const t=this.moduleSize,r=t/2;for(let i=0;i<3;i++)if(Math.abs(t-e[i])>=r)return!1;return!0}crossCheckVertical(e,t,r,i){const a=this.image,l=a.getHeight(),d=this.crossCheckStateCount;d[0]=0,d[1]=0,d[2]=0;let g=e;for(;g>=0&&a.get(t,g)&&d[1]<=r;)d[1]++,g--;if(g<0||d[1]>r)return NaN;for(;g>=0&&!a.get(t,g)&&d[0]<=r;)d[0]++,g--;if(d[0]>r)return NaN;for(g=e+1;g<l&&a.get(t,g)&&d[1]<=r;)d[1]++,g++;if(g===l||d[1]>r)return NaN;for(;g<l&&!a.get(t,g)&&d[2]<=r;)d[2]++,g++;if(d[2]>r)return NaN;const x=d[0]+d[1]+d[2];return 5*Math.abs(x-i)>=2*i?NaN:this.foundPatternCross(d)?Fr.centerFromEnd(d,g):NaN}handlePossibleCenter(e,t,r){const i=e[0]+e[1]+e[2],a=Fr.centerFromEnd(e,r),l=this.crossCheckVertical(t,a,2*e[1],i);if(!isNaN(l)){const d=(e[0]+e[1]+e[2])/3;for(const x of this.possibleCenters)if(x.aboutEquals(d,l,a))return x.combineEstimate(l,a,d);const g=new Is(a,l,d);this.possibleCenters.push(g),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(g)}return null}}class Ts extends le{constructor(e,t,r,i){super(e,t),this.estimatedModuleSize=r,this.count=i,i===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(e,t,r){if(Math.abs(t-this.getY())<=e&&Math.abs(r-this.getX())<=e){const i=Math.abs(e-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1}combineEstimate(e,t,r){const i=this.count+1,a=(this.count*this.getX()+t)/i,l=(this.count*this.getY()+e)/i,d=(this.count*this.estimatedModuleSize+r)/i;return new Ts(a,l,d,i)}}class hl{constructor(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class ht{constructor(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(e){const t=e!=null&&e.get(re.TRY_HARDER)!==void 0,r=e!=null&&e.get(re.PURE_BARCODE)!==void 0,i=this.image,a=i.getHeight(),l=i.getWidth();let d=Math.floor(3*a/(4*ht.MAX_MODULES));(d<ht.MIN_SKIP||t)&&(d=ht.MIN_SKIP);let g=!1;const x=new Int32Array(5);for(let C=d-1;C<a&&!g;C+=d){x[0]=0,x[1]=0,x[2]=0,x[3]=0,x[4]=0;let v=0;for(let S=0;S<l;S++)if(i.get(S,C))(v&1)===1&&v++,x[v]++;else if(v&1)x[v]++;else if(v===4)if(ht.foundPatternCross(x)){if(this.handlePossibleCenter(x,C,S,r)===!0)if(d=2,this.hasSkipped===!0)g=this.haveMultiplyConfirmedCenters();else{const D=this.findRowSkip();D>x[2]&&(C+=D-x[2]-d,S=l-1)}else{x[0]=x[2],x[1]=x[3],x[2]=x[4],x[3]=1,x[4]=0,v=3;continue}v=0,x[0]=0,x[1]=0,x[2]=0,x[3]=0,x[4]=0}else x[0]=x[2],x[1]=x[3],x[2]=x[4],x[3]=1,x[4]=0,v=3;else x[++v]++;ht.foundPatternCross(x)&&this.handlePossibleCenter(x,C,l,r)===!0&&(d=x[0],this.hasSkipped&&(g=this.haveMultiplyConfirmedCenters()))}const y=this.selectBestPatterns();return le.orderBestPatterns(y),new hl(y)}static centerFromEnd(e,t){return t-e[4]-e[3]-e[2]/2}static foundPatternCross(e){let t=0;for(let a=0;a<5;a++){const l=e[a];if(l===0)return!1;t+=l}if(t<7)return!1;const r=t/7,i=r/2;return Math.abs(r-e[0])<i&&Math.abs(r-e[1])<i&&Math.abs(3*r-e[2])<3*i&&Math.abs(r-e[3])<i&&Math.abs(r-e[4])<i}getCrossCheckStateCount(){const e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e}crossCheckDiagonal(e,t,r,i){const a=this.getCrossCheckStateCount();let l=0;const d=this.image;for(;e>=l&&t>=l&&d.get(t-l,e-l);)a[2]++,l++;if(e<l||t<l)return!1;for(;e>=l&&t>=l&&!d.get(t-l,e-l)&&a[1]<=r;)a[1]++,l++;if(e<l||t<l||a[1]>r)return!1;for(;e>=l&&t>=l&&d.get(t-l,e-l)&&a[0]<=r;)a[0]++,l++;if(a[0]>r)return!1;const g=d.getHeight(),x=d.getWidth();for(l=1;e+l<g&&t+l<x&&d.get(t+l,e+l);)a[2]++,l++;if(e+l>=g||t+l>=x)return!1;for(;e+l<g&&t+l<x&&!d.get(t+l,e+l)&&a[3]<r;)a[3]++,l++;if(e+l>=g||t+l>=x||a[3]>=r)return!1;for(;e+l<g&&t+l<x&&d.get(t+l,e+l)&&a[4]<r;)a[4]++,l++;if(a[4]>=r)return!1;const y=a[0]+a[1]+a[2]+a[3]+a[4];return Math.abs(y-i)<2*i&&ht.foundPatternCross(a)}crossCheckVertical(e,t,r,i){const a=this.image,l=a.getHeight(),d=this.getCrossCheckStateCount();let g=e;for(;g>=0&&a.get(t,g);)d[2]++,g--;if(g<0)return NaN;for(;g>=0&&!a.get(t,g)&&d[1]<=r;)d[1]++,g--;if(g<0||d[1]>r)return NaN;for(;g>=0&&a.get(t,g)&&d[0]<=r;)d[0]++,g--;if(d[0]>r)return NaN;for(g=e+1;g<l&&a.get(t,g);)d[2]++,g++;if(g===l)return NaN;for(;g<l&&!a.get(t,g)&&d[3]<r;)d[3]++,g++;if(g===l||d[3]>=r)return NaN;for(;g<l&&a.get(t,g)&&d[4]<r;)d[4]++,g++;if(d[4]>=r)return NaN;const x=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(x-i)>=2*i?NaN:ht.foundPatternCross(d)?ht.centerFromEnd(d,g):NaN}crossCheckHorizontal(e,t,r,i){const a=this.image,l=a.getWidth(),d=this.getCrossCheckStateCount();let g=e;for(;g>=0&&a.get(g,t);)d[2]++,g--;if(g<0)return NaN;for(;g>=0&&!a.get(g,t)&&d[1]<=r;)d[1]++,g--;if(g<0||d[1]>r)return NaN;for(;g>=0&&a.get(g,t)&&d[0]<=r;)d[0]++,g--;if(d[0]>r)return NaN;for(g=e+1;g<l&&a.get(g,t);)d[2]++,g++;if(g===l)return NaN;for(;g<l&&!a.get(g,t)&&d[3]<r;)d[3]++,g++;if(g===l||d[3]>=r)return NaN;for(;g<l&&a.get(g,t)&&d[4]<r;)d[4]++,g++;if(d[4]>=r)return NaN;const x=d[0]+d[1]+d[2]+d[3]+d[4];return 5*Math.abs(x-i)>=i?NaN:ht.foundPatternCross(d)?ht.centerFromEnd(d,g):NaN}handlePossibleCenter(e,t,r,i){const a=e[0]+e[1]+e[2]+e[3]+e[4];let l=ht.centerFromEnd(e,r),d=this.crossCheckVertical(t,Math.floor(l),e[2],a);if(!isNaN(d)&&(l=this.crossCheckHorizontal(Math.floor(l),Math.floor(d),e[2],a),!isNaN(l)&&(!i||this.crossCheckDiagonal(Math.floor(d),Math.floor(l),e[2],a)))){const g=a/7;let x=!1;const y=this.possibleCenters;for(let C=0,v=y.length;C<v;C++){const S=y[C];if(S.aboutEquals(g,d,l)){y[C]=S.combineEstimate(d,l,g),x=!0;break}}if(!x){const C=new Ts(l,d,g);y.push(C),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(C)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const r of this.possibleCenters)if(r.getCount()>=ht.CENTER_QUORUM)if(t==null)t=r;else return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-r.getX())-Math.abs(t.getY()-r.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let e=0,t=0;const r=this.possibleCenters.length;for(const l of this.possibleCenters)l.getCount()>=ht.CENTER_QUORUM&&(e++,t+=l.getEstimatedModuleSize());if(e<3)return!1;const i=t/r;let a=0;for(const l of this.possibleCenters)a+=Math.abs(l.getEstimatedModuleSize()-i);return a<=.05*t}selectBestPatterns(){const e=this.possibleCenters.length;if(e<3)throw new z;const t=this.possibleCenters;let r;if(e>3){let i=0,a=0;for(const g of this.possibleCenters){const x=g.getEstimatedModuleSize();i+=x,a+=x*x}r=i/e;let l=Math.sqrt(a/e-r*r);t.sort((g,x)=>{const y=Math.abs(x.getEstimatedModuleSize()-r),C=Math.abs(g.getEstimatedModuleSize()-r);return y<C?-1:y>C?1:0});const d=Math.max(.2*r,l);for(let g=0;g<t.length&&t.length>3;g++){const x=t[g];Math.abs(x.getEstimatedModuleSize()-r)>d&&(t.splice(g,1),g--)}}if(t.length>3){let i=0;for(const a of t)i+=a.getEstimatedModuleSize();r=i/t.length,t.sort((a,l)=>{if(l.getCount()===a.getCount()){const d=Math.abs(l.getEstimatedModuleSize()-r),g=Math.abs(a.getEstimatedModuleSize()-r);return d<g?1:d>g?-1:0}else return l.getCount()-a.getCount()}),t.splice(3)}return[t[0],t[1],t[2]]}}ht.CENTER_QUORUM=2,ht.MIN_SKIP=3,ht.MAX_MODULES=57;class fr{constructor(e){this.image=e}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(e){this.resultPointCallback=e==null?null:e.get(re.NEED_RESULT_POINT_CALLBACK);const r=new ht(this.image,this.resultPointCallback).find(e);return this.processFinderPatternInfo(r)}processFinderPatternInfo(e){const t=e.getTopLeft(),r=e.getTopRight(),i=e.getBottomLeft(),a=this.calculateModuleSize(t,r,i);if(a<1)throw new z("No pattern found in proccess finder.");const l=fr.computeDimension(t,r,i,a),d=ue.getProvisionalVersionForDimension(l),g=d.getDimensionForVersion()-7;let x=null;if(d.getAlignmentPatternCenters().length>0){const S=r.getX()-t.getX()+i.getX(),O=r.getY()-t.getY()+i.getY(),D=1-3/g,P=Math.floor(t.getX()+D*(S-t.getX())),Z=Math.floor(t.getY()+D*(O-t.getY()));for(let J=4;J<=16;J<<=1)try{x=this.findAlignmentInRegion(a,P,Z,J);break}catch(ee){if(!(ee instanceof z))throw ee}}const y=fr.createTransform(t,r,i,x,l),C=fr.sampleGrid(this.image,y,l);let v;return x===null?v=[i,t,r]:v=[i,t,r,x],new Rr(C,v)}static createTransform(e,t,r,i,a){const l=a-3.5;let d,g,x,y;return i!==null?(d=i.getX(),g=i.getY(),x=l-3,y=x):(d=t.getX()-e.getX()+r.getX(),g=t.getY()-e.getY()+r.getY(),x=l,y=l),Gt.quadrilateralToQuadrilateral(3.5,3.5,l,3.5,x,y,3.5,l,e.getX(),e.getY(),t.getX(),t.getY(),d,g,r.getX(),r.getY())}static sampleGrid(e,t,r){return mn.getInstance().sampleGridWithTransform(e,r,r,t)}static computeDimension(e,t,r,i){const a=Ne.round(le.distance(e,t)/i),l=Ne.round(le.distance(e,r)/i);let d=Math.floor((a+l)/2)+7;switch(d&3){case 0:d++;break;case 2:d--;break;case 3:throw new z("Dimensions could be not found.")}return d}calculateModuleSize(e,t,r){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,r))/2}calculateModuleSizeOneWay(e,t){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(r)?i/7:isNaN(i)?r/7:(r+i)/14}sizeOfBlackWhiteBlackRunBothWays(e,t,r,i){let a=this.sizeOfBlackWhiteBlackRun(e,t,r,i),l=1,d=e-(r-e);d<0?(l=e/(e-d),d=0):d>=this.image.getWidth()&&(l=(this.image.getWidth()-1-e)/(d-e),d=this.image.getWidth()-1);let g=Math.floor(t-(i-t)*l);return l=1,g<0?(l=t/(t-g),g=0):g>=this.image.getHeight()&&(l=(this.image.getHeight()-1-t)/(g-t),g=this.image.getHeight()-1),d=Math.floor(e+(d-e)*l),a+=this.sizeOfBlackWhiteBlackRun(e,t,d,g),a-1}sizeOfBlackWhiteBlackRun(e,t,r,i){const a=Math.abs(i-t)>Math.abs(r-e);if(a){let S=e;e=t,t=S,S=r,r=i,i=S}const l=Math.abs(r-e),d=Math.abs(i-t);let g=-l/2;const x=e<r?1:-1,y=t<i?1:-1;let C=0;const v=r+x;for(let S=e,O=t;S!==v;S+=x){const D=a?O:S,P=a?S:O;if(C===1===this.image.get(D,P)){if(C===2)return Ne.distance(S,O,e,t);C++}if(g+=d,g>0){if(O===i)break;O+=y,g-=l}}return C===2?Ne.distance(r+x,i,e,t):NaN}findAlignmentInRegion(e,t,r,i){const a=Math.floor(i*e),l=Math.max(0,t-a),d=Math.min(this.image.getWidth()-1,t+a);if(d-l<e*3)throw new z("Alignment top exceeds estimated module size.");const g=Math.max(0,r-a),x=Math.min(this.image.getHeight()-1,r+a);if(x-g<e*3)throw new z("Alignment bottom exceeds estimated module size.");return new Fr(this.image,l,g,d-l,x-g,e,this.resultPointCallback).find()}}class bn{constructor(){this.decoder=new dl}getDecoder(){return this.decoder}decode(e,t){let r,i;if(t!=null&&t.get(re.PURE_BARCODE)!==void 0){const g=bn.extractPureBits(e.getBlackMatrix());r=this.decoder.decodeBitMatrix(g,t),i=bn.NO_POINTS}else{const g=new fr(e.getBlackMatrix()).detect(t);r=this.decoder.decodeBitMatrix(g.getBits(),t),i=g.getPoints()}r.getOther()instanceof Li&&r.getOther().applyMirroredCorrection(i);const a=new it(r.getText(),r.getRawBytes(),void 0,i,oe.QR_CODE,void 0),l=r.getByteSegments();l!==null&&a.putMetadata(Fe.BYTE_SEGMENTS,l);const d=r.getECLevel();return d!==null&&a.putMetadata(Fe.ERROR_CORRECTION_LEVEL,d),r.hasStructuredAppend()&&(a.putMetadata(Fe.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),a.putMetadata(Fe.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),a}reset(){}static extractPureBits(e){const t=e.getTopLeftOnBit(),r=e.getBottomRightOnBit();if(t===null||r===null)throw new z;const i=this.moduleSize(t,e);let a=t[1],l=r[1],d=t[0],g=r[0];if(d>=g||a>=l)throw new z;if(l-a!==g-d&&(g=d+(l-a),g>=e.getWidth()))throw new z;const x=Math.round((g-d+1)/i),y=Math.round((l-a+1)/i);if(x<=0||y<=0)throw new z;if(y!==x)throw new z;const C=Math.floor(i/2);a+=C,d+=C;const v=d+Math.floor((x-1)*i)-g;if(v>0){if(v>C)throw new z;d-=v}const S=a+Math.floor((y-1)*i)-l;if(S>0){if(S>C)throw new z;a-=S}const O=new ce(x,y);for(let D=0;D<y;D++){const P=a+Math.floor(D*i);for(let Z=0;Z<x;Z++)e.get(d+Math.floor(Z*i),P)&&O.set(Z,D)}return O}static moduleSize(e,t){const r=t.getHeight(),i=t.getWidth();let a=e[0],l=e[1],d=!0,g=0;for(;a<i&&l<r;){if(d!==t.get(a,l)){if(++g===5)break;d=!d}a++,l++}if(a===i||l===r)throw new z;return(a-e[0])/7}}bn.NO_POINTS=new Array;class xe{PDF417Common(){}static getBitCountSum(e){return Ne.sum(e)}static toIntArray(e){if(e==null||!e.length)return xe.EMPTY_INT_ARRAY;const t=new Int32Array(e.length);let r=0;for(const i of e)t[r++]=i;return t}static getCodeword(e){const t=G.binarySearch(xe.SYMBOL_TABLE,e&262143);return t<0?-1:(xe.CODEWORD_TABLE[t]-1)%xe.NUMBER_OF_CODEWORDS}}xe.NUMBER_OF_CODEWORDS=929,xe.MAX_CODEWORDS_IN_BARCODE=xe.NUMBER_OF_CODEWORDS-1,xe.MIN_ROWS_IN_BARCODE=3,xe.MAX_ROWS_IN_BARCODE=90,xe.MODULES_IN_CODEWORD=17,xe.MODULES_IN_STOP_PATTERN=18,xe.BARS_IN_MODULE=8,xe.EMPTY_INT_ARRAY=new Int32Array([]),xe.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),xe.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class fl{constructor(e,t){this.bits=e,this.points=t}getBits(){return this.bits}getPoints(){return this.points}}class pe{static detectMultiple(e,t,r){let i=e.getBlackMatrix(),a=pe.detect(r,i);return a.length||(i=i.clone(),i.rotate180(),a=pe.detect(r,i)),new fl(i,a)}static detect(e,t){const r=new Array;let i=0,a=0,l=!1;for(;i<t.getHeight();){const d=pe.findVertices(t,i,a);if(d[0]==null&&d[3]==null){if(!l)break;l=!1,a=0;for(const g of r)g[1]!=null&&(i=Math.trunc(Math.max(i,g[1].getY()))),g[3]!=null&&(i=Math.max(i,Math.trunc(g[3].getY())));i+=pe.ROW_STEP;continue}if(l=!0,r.push(d),!e)break;d[2]!=null?(a=Math.trunc(d[2].getX()),i=Math.trunc(d[2].getY())):(a=Math.trunc(d[4].getX()),i=Math.trunc(d[4].getY()))}return r}static findVertices(e,t,r){const i=e.getHeight(),a=e.getWidth(),l=new Array(8);return pe.copyToResult(l,pe.findRowsWithPattern(e,i,a,t,r,pe.START_PATTERN),pe.INDEXES_START_PATTERN),l[4]!=null&&(r=Math.trunc(l[4].getX()),t=Math.trunc(l[4].getY())),pe.copyToResult(l,pe.findRowsWithPattern(e,i,a,t,r,pe.STOP_PATTERN),pe.INDEXES_STOP_PATTERN),l}static copyToResult(e,t,r){for(let i=0;i<r.length;i++)e[r[i]]=t[i]}static findRowsWithPattern(e,t,r,i,a,l){const d=new Array(4);let g=!1;const x=new Int32Array(l.length);for(;i<t;i+=pe.ROW_STEP){let C=pe.findGuardPattern(e,a,i,r,!1,l,x);if(C!=null){for(;i>0;){const v=pe.findGuardPattern(e,a,--i,r,!1,l,x);if(v!=null)C=v;else{i++;break}}d[0]=new le(C[0],i),d[1]=new le(C[1],i),g=!0;break}}let y=i+1;if(g){let C=0,v=Int32Array.from([Math.trunc(d[0].getX()),Math.trunc(d[1].getX())]);for(;y<t;y++){const S=pe.findGuardPattern(e,v[0],y,r,!1,l,x);if(S!=null&&Math.abs(v[0]-S[0])<pe.MAX_PATTERN_DRIFT&&Math.abs(v[1]-S[1])<pe.MAX_PATTERN_DRIFT)v=S,C=0;else{if(C>pe.SKIPPED_ROW_COUNT_MAX)break;C++}}y-=C+1,d[2]=new le(v[0],y),d[3]=new le(v[1],y)}return y-i<pe.BARCODE_MIN_HEIGHT&&G.fill(d,null),d}static findGuardPattern(e,t,r,i,a,l,d){G.fillWithin(d,0,d.length,0);let g=t,x=0;for(;e.get(g,r)&&g>0&&x++<pe.MAX_PIXEL_DRIFT;)g--;let y=g,C=0,v=l.length;for(let S=a;y<i;y++)if(e.get(y,r)!==S)d[C]++;else{if(C===v-1){if(pe.patternMatchVariance(d,l,pe.MAX_INDIVIDUAL_VARIANCE)<pe.MAX_AVG_VARIANCE)return new Int32Array([g,y]);g+=d[0]+d[1],k.arraycopy(d,2,d,0,C-1),d[C-1]=0,d[C]=0,C--}else C++;d[C]=1,S=!S}return C===v-1&&pe.patternMatchVariance(d,l,pe.MAX_INDIVIDUAL_VARIANCE)<pe.MAX_AVG_VARIANCE?new Int32Array([g,y-1]):null}static patternMatchVariance(e,t,r){let i=e.length,a=0,l=0;for(let x=0;x<i;x++)a+=e[x],l+=t[x];if(a<l)return 1/0;let d=a/l;r*=d;let g=0;for(let x=0;x<i;x++){let y=e[x],C=t[x]*d,v=y>C?y-C:C-y;if(v>r)return 1/0;g+=v}return g/a}}pe.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),pe.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),pe.MAX_AVG_VARIANCE=.42,pe.MAX_INDIVIDUAL_VARIANCE=.8,pe.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),pe.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),pe.MAX_PIXEL_DRIFT=3,pe.MAX_PATTERN_DRIFT=5,pe.SKIPPED_ROW_COUNT_MAX=25,pe.ROW_STEP=5,pe.BARCODE_MIN_HEIGHT=10;class xt{constructor(e,t){if(t.length===0)throw new N;this.field=e;let r=t.length;if(r>1&&t[0]===0){let i=1;for(;i<r&&t[i]===0;)i++;i===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-i),k.arraycopy(t,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(e){return this.coefficients[this.coefficients.length-1-e]}evaluateAt(e){if(e===0)return this.getCoefficient(0);if(e===1){let i=0;for(let a of this.coefficients)i=this.field.add(i,a);return i}let t=this.coefficients[0],r=this.coefficients.length;for(let i=1;i<r;i++)t=this.field.add(this.field.multiply(e,t),this.coefficients[i]);return t}add(e){if(!this.field.equals(e.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;let t=this.coefficients,r=e.coefficients;if(t.length>r.length){let l=t;t=r,r=l}let i=new Int32Array(r.length),a=r.length-t.length;k.arraycopy(r,0,i,0,a);for(let l=a;l<r.length;l++)i[l]=this.field.add(t[l-a],r[l]);return new xt(this.field,i)}subtract(e){if(!this.field.equals(e.field))throw new N("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())}multiply(e){return e instanceof xt?this.multiplyOther(e):this.multiplyScalar(e)}multiplyOther(e){if(!this.field.equals(e.field))throw new N("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new xt(this.field,new Int32Array([0]));let t=this.coefficients,r=t.length,i=e.coefficients,a=i.length,l=new Int32Array(r+a-1);for(let d=0;d<r;d++){let g=t[d];for(let x=0;x<a;x++)l[d+x]=this.field.add(l[d+x],this.field.multiply(g,i[x]))}return new xt(this.field,l)}negative(){let e=this.coefficients.length,t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=this.field.subtract(0,this.coefficients[r]);return new xt(this.field,t)}multiplyScalar(e){if(e===0)return new xt(this.field,new Int32Array([0]));if(e===1)return this;let t=this.coefficients.length,r=new Int32Array(t);for(let i=0;i<t;i++)r[i]=this.field.multiply(this.coefficients[i],e);return new xt(this.field,r)}multiplyByMonomial(e,t){if(e<0)throw new N;if(t===0)return new xt(this.field,new Int32Array([0]));let r=this.coefficients.length,i=new Int32Array(r+e);for(let a=0;a<r;a++)i[a]=this.field.multiply(this.coefficients[a],t);return new xt(this.field,i)}toString(){let e=new te;for(let t=this.getDegree();t>=0;t--){let r=this.getCoefficient(t);r!==0&&(r<0?(e.append(" - "),r=-r):e.length()>0&&e.append(" + "),(t===0||r!==1)&&e.append(r),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()}}class gl{add(e,t){return(e+t)%this.modulus}subtract(e,t){return(this.modulus+e-t)%this.modulus}exp(e){return this.expTable[e]}log(e){if(e===0)throw new N;return this.logTable[e]}inverse(e){if(e===0)throw new Dr;return this.expTable[this.modulus-this.logTable[e]-1]}multiply(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]}getSize(){return this.modulus}equals(e){return e===this}}class Os extends gl{constructor(e,t){super(),this.modulus=e,this.expTable=new Int32Array(e),this.logTable=new Int32Array(e);let r=1;for(let i=0;i<e;i++)this.expTable[i]=r,r=r*t%e;for(let i=0;i<e-1;i++)this.logTable[this.expTable[i]]=i;this.zero=new xt(this,new Int32Array([0])),this.one=new xt(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(e,t){if(e<0)throw new N;if(t===0)return this.zero;let r=new Int32Array(e+1);return r[0]=t,new xt(this,r)}}Os.PDF417_GF=new Os(xe.NUMBER_OF_CODEWORDS,3);class Bi{constructor(){this.field=Os.PDF417_GF}decode(e,t,r){let i=new xt(this.field,e),a=new Int32Array(t),l=!1;for(let O=t;O>0;O--){let D=i.evaluateAt(this.field.exp(O));a[t-O]=D,D!==0&&(l=!0)}if(!l)return 0;let d=this.field.getOne();if(r!=null)for(const O of r){let D=this.field.exp(e.length-1-O),P=new xt(this.field,new Int32Array([this.field.subtract(0,D),1]));d=d.multiply(P)}let g=new xt(this.field,a),x=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),g,t),y=x[0],C=x[1],v=this.findErrorLocations(y),S=this.findErrorMagnitudes(C,y,v);for(let O=0;O<v.length;O++){let D=e.length-1-this.field.log(v[O]);if(D<0)throw M.getChecksumInstance();e[D]=this.field.subtract(e[D],S[O])}return v.length}runEuclideanAlgorithm(e,t,r){if(e.getDegree()<t.getDegree()){let v=e;e=t,t=v}let i=e,a=t,l=this.field.getZero(),d=this.field.getOne();for(;a.getDegree()>=Math.round(r/2);){let v=i,S=l;if(i=a,l=d,i.isZero())throw M.getChecksumInstance();a=v;let O=this.field.getZero(),D=i.getCoefficient(i.getDegree()),P=this.field.inverse(D);for(;a.getDegree()>=i.getDegree()&&!a.isZero();){let Z=a.getDegree()-i.getDegree(),J=this.field.multiply(a.getCoefficient(a.getDegree()),P);O=O.add(this.field.buildMonomial(Z,J)),a=a.subtract(i.multiplyByMonomial(Z,J))}d=O.multiply(l).subtract(S).negative()}let g=d.getCoefficient(0);if(g===0)throw M.getChecksumInstance();let x=this.field.inverse(g),y=d.multiply(x),C=a.multiply(x);return[y,C]}findErrorLocations(e){let t=e.getDegree(),r=new Int32Array(t),i=0;for(let a=1;a<this.field.getSize()&&i<t;a++)e.evaluateAt(a)===0&&(r[i]=this.field.inverse(a),i++);if(i!==t)throw M.getChecksumInstance();return r}findErrorMagnitudes(e,t,r){let i=t.getDegree(),a=new Int32Array(i);for(let x=1;x<=i;x++)a[i-x]=this.field.multiply(x,t.getCoefficient(x));let l=new xt(this.field,a),d=r.length,g=new Int32Array(d);for(let x=0;x<d;x++){let y=this.field.inverse(r[x]),C=this.field.subtract(0,e.evaluateAt(y)),v=this.field.inverse(l.evaluateAt(y));g[x]=this.field.multiply(C,v)}return g}}class Pn{constructor(e,t,r,i,a){e instanceof Pn?this.constructor_2(e):this.constructor_1(e,t,r,i,a)}constructor_1(e,t,r,i,a){const l=t==null||r==null,d=i==null||a==null;if(l&&d)throw new z;l?(t=new le(0,i.getY()),r=new le(0,a.getY())):d&&(i=new le(e.getWidth()-1,t.getY()),a=new le(e.getWidth()-1,r.getY())),this.image=e,this.topLeft=t,this.bottomLeft=r,this.topRight=i,this.bottomRight=a,this.minX=Math.trunc(Math.min(t.getX(),r.getX())),this.maxX=Math.trunc(Math.max(i.getX(),a.getX())),this.minY=Math.trunc(Math.min(t.getY(),i.getY())),this.maxY=Math.trunc(Math.max(r.getY(),a.getY()))}constructor_2(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()}static merge(e,t){return e==null?t:t==null?e:new Pn(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)}addMissingRows(e,t,r){let i=this.topLeft,a=this.bottomLeft,l=this.topRight,d=this.bottomRight;if(e>0){let g=r?this.topLeft:this.topRight,x=Math.trunc(g.getY()-e);x<0&&(x=0);let y=new le(g.getX(),x);r?i=y:l=y}if(t>0){let g=r?this.bottomLeft:this.bottomRight,x=Math.trunc(g.getY()+t);x>=this.image.getHeight()&&(x=this.image.getHeight()-1);let y=new le(g.getX(),x);r?a=y:d=y}return new Pn(this.image,i,a,l,d)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class xl{constructor(e,t,r,i){this.columnCount=e,this.errorCorrectionLevel=i,this.rowCountUpperPart=t,this.rowCountLowerPart=r,this.rowCount=t+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class gr{constructor(){this.buffer=""}static form(e,t){let r=-1;function i(l,d,g,x,y,C){if(l==="%%")return"%";if(t[++r]===void 0)return;l=x?parseInt(x.substr(1)):void 0;let v=y?parseInt(y.substr(1)):void 0,S;switch(C){case"s":S=t[r];break;case"c":S=t[r][0];break;case"f":S=parseFloat(t[r]).toFixed(l);break;case"p":S=parseFloat(t[r]).toPrecision(l);break;case"e":S=parseFloat(t[r]).toExponential(l);break;case"x":S=parseInt(t[r]).toString(v||16);break;case"d":S=parseFloat(parseInt(t[r],v||10).toPrecision(l)).toFixed(0);break}S=typeof S=="object"?JSON.stringify(S):(+S).toString(v);let O=parseInt(g),D=g&&g[0]+""=="0"?"0":" ";for(;S.length<O;)S=d!==void 0?S+D:D+S;return S}let a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(a,i)}format(e,...t){this.buffer+=gr.form(e,t)}toString(){return this.buffer}}class xr{constructor(e){this.boundingBox=new Pn(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}getCodewordNearby(e){let t=this.getCodeword(e);if(t!=null)return t;for(let r=1;r<xr.MAX_NEARBY_DISTANCE;r++){let i=this.imageRowToCodewordIndex(e)-r;if(i>=0&&(t=this.codewords[i],t!=null)||(i=this.imageRowToCodewordIndex(e)+r,i<this.codewords.length&&(t=this.codewords[i],t!=null)))return t}return null}imageRowToCodewordIndex(e){return e-this.boundingBox.getMinY()}setCodeword(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t}getCodeword(e){return this.codewords[this.imageRowToCodewordIndex(e)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const e=new gr;let t=0;for(const r of this.codewords){if(r==null){e.format("%3d:    |   %n",t++);continue}e.format("%3d: %3d|%3d%n",t++,r.getRowNumber(),r.getValue())}return e.toString()}}xr.MAX_NEARBY_DISTANCE=5;class mr{constructor(){this.values=new Map}setValue(e){e=Math.trunc(e);let t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)}getValue(){let e=-1,t=new Array;for(const[r,i]of this.values.entries()){const a={getKey:()=>r,getValue:()=>i};a.getValue()>e?(e=a.getValue(),t=[],t.push(a.getKey())):a.getValue()===e&&t.push(a.getKey())}return xe.toIntArray(t)}getConfidence(e){return this.values.get(e)}}class Pi extends xr{constructor(e,t){super(e),this._isLeft=t}setRowNumbers(){for(let e of this.getCodewords())e?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(e){let t=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(t,e);let r=this.getBoundingBox(),i=this._isLeft?r.getTopLeft():r.getTopRight(),a=this._isLeft?r.getBottomLeft():r.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(i.getY())),d=this.imageRowToCodewordIndex(Math.trunc(a.getY())),g=-1,x=1,y=0;for(let C=l;C<d;C++){if(t[C]==null)continue;let v=t[C],S=v.getRowNumber()-g;if(S===0)y++;else if(S===1)x=Math.max(x,y),y=1,g=v.getRowNumber();else if(S<0||v.getRowNumber()>=e.getRowCount()||S>C)t[C]=null;else{let O;x>2?O=(x-2)*S:O=S;let D=O>=C;for(let P=1;P<=O&&!D;P++)D=t[C-P]!=null;D?t[C]=null:(g=v.getRowNumber(),y=1)}}}getRowHeights(){let e=this.getBarcodeMetadata();if(e==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(e);let t=new Int32Array(e.getRowCount());for(let r of this.getCodewords())if(r!=null){let i=r.getRowNumber();if(i>=t.length)continue;t[i]++}return t}adjustIncompleteIndicatorColumnRowNumbers(e){let t=this.getBoundingBox(),r=this._isLeft?t.getTopLeft():t.getTopRight(),i=this._isLeft?t.getBottomLeft():t.getBottomRight(),a=this.imageRowToCodewordIndex(Math.trunc(r.getY())),l=this.imageRowToCodewordIndex(Math.trunc(i.getY())),d=this.getCodewords(),g=-1;for(let x=a;x<l;x++){if(d[x]==null)continue;let y=d[x];y.setRowNumberAsRowIndicatorColumn();let C=y.getRowNumber()-g;C===0||(C===1?g=y.getRowNumber():y.getRowNumber()>=e.getRowCount()?d[x]=null:g=y.getRowNumber())}}getBarcodeMetadata(){let e=this.getCodewords(),t=new mr,r=new mr,i=new mr,a=new mr;for(let d of e){if(d==null)continue;d.setRowNumberAsRowIndicatorColumn();let g=d.getValue()%30,x=d.getRowNumber();switch(this._isLeft||(x+=2),x%3){case 0:r.setValue(g*3+1);break;case 1:a.setValue(g/3),i.setValue(g%3);break;case 2:t.setValue(g+1);break}}if(t.getValue().length===0||r.getValue().length===0||i.getValue().length===0||a.getValue().length===0||t.getValue()[0]<1||r.getValue()[0]+i.getValue()[0]<xe.MIN_ROWS_IN_BARCODE||r.getValue()[0]+i.getValue()[0]>xe.MAX_ROWS_IN_BARCODE)return null;let l=new xl(t.getValue()[0],r.getValue()[0],i.getValue()[0],a.getValue()[0]);return this.removeIncorrectCodewords(e,l),l}removeIncorrectCodewords(e,t){for(let r=0;r<e.length;r++){let i=e[r];if(e[r]==null)continue;let a=i.getValue()%30,l=i.getRowNumber();if(l>t.getRowCount()){e[r]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:a*3+1!==t.getRowCountUpperPart()&&(e[r]=null);break;case 1:(Math.trunc(a/3)!==t.getErrorCorrectionLevel()||a%3!==t.getRowCountLowerPart())&&(e[r]=null);break;case 2:a+1!==t.getColumnCount()&&(e[r]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class pr{constructor(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let e=xe.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(e){e?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let e=this.adjustRowNumbersByRow();if(e===0)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let r=this.detectionResultColumns[t].getCodewords();for(let i=0;i<r.length;i++)r[i]!=null&&(r[i].hasValidRowNumber()||this.adjustRowNumbers(t,i,r))}return e}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<e.length;r++)if(e[r]!=null&&t[r]!=null&&e[r].getRowNumber()===t[r].getRowNumber())for(let i=1;i<=this.barcodeColumnCount;i++){let a=this.detectionResultColumns[i].getCodewords()[r];a!=null&&(a.setRowNumber(e[r].getRowNumber()),a.hasValidRowNumber()||(this.detectionResultColumns[i].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<t.length;r++){if(t[r]==null)continue;let i=t[r].getRowNumber(),a=0;for(let l=this.barcodeColumnCount+1;l>0&&a<this.ADJUST_ROW_NUMBER_SKIP;l--){let d=this.detectionResultColumns[l].getCodewords()[r];d!=null&&(a=pr.adjustRowNumberIfValid(i,a,d),d.hasValidRowNumber()||e++)}}return e}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let e=0,t=this.detectionResultColumns[0].getCodewords();for(let r=0;r<t.length;r++){if(t[r]==null)continue;let i=t[r].getRowNumber(),a=0;for(let l=1;l<this.barcodeColumnCount+1&&a<this.ADJUST_ROW_NUMBER_SKIP;l++){let d=this.detectionResultColumns[l].getCodewords()[r];d!=null&&(a=pr.adjustRowNumberIfValid(i,a,d),d.hasValidRowNumber()||e++)}}return e}static adjustRowNumberIfValid(e,t,r){return r==null||r.hasValidRowNumber()||(r.isValidRowNumber(e)?(r.setRowNumber(e),t=0):++t),t}adjustRowNumbers(e,t,r){if(!this.detectionResultColumns[e-1])return;let i=r[t],a=this.detectionResultColumns[e-1].getCodewords(),l=a;this.detectionResultColumns[e+1]!=null&&(l=this.detectionResultColumns[e+1].getCodewords());let d=new Array(14);d[2]=a[t],d[3]=l[t],t>0&&(d[0]=r[t-1],d[4]=a[t-1],d[5]=l[t-1]),t>1&&(d[8]=r[t-2],d[10]=a[t-2],d[11]=l[t-2]),t<r.length-1&&(d[1]=r[t+1],d[6]=a[t+1],d[7]=l[t+1]),t<r.length-2&&(d[9]=r[t+2],d[12]=a[t+2],d[13]=l[t+2]);for(let g of d)if(pr.adjustRowNumber(i,g))return}static adjustRowNumber(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(e){this.boundingBox=e}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(e,t){this.detectionResultColumns[e]=t}getDetectionResultColumn(e){return this.detectionResultColumns[e]}toString(){let e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);let t=new gr;for(let r=0;r<e.getCodewords().length;r++){t.format("CW %3d:",r);for(let i=0;i<this.barcodeColumnCount+2;i++){if(this.detectionResultColumns[i]==null){t.format("    |   ");continue}let a=this.detectionResultColumns[i].getCodewords()[r];if(a==null){t.format("    |   ");continue}t.format(" %3d|%3d",a.getRowNumber(),a.getValue())}t.format("%n")}return t.toString()}}class yr{constructor(e,t,r,i){this.rowNumber=yr.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(r),this.value=Math.trunc(i)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(e){return e!==yr.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(e){this.rowNumber=e}toString(){return this.rowNumber+"|"+this.value}}yr.BARCODE_ROW_UNKNOWN=-1;class St{static initialize(){for(let e=0;e<xe.SYMBOL_TABLE.length;e++){let t=xe.SYMBOL_TABLE[e],r=t&1;for(let i=0;i<xe.BARS_IN_MODULE;i++){let a=0;for(;(t&1)===r;)a+=1,t>>=1;r=t&1,St.RATIOS_TABLE[e]||(St.RATIOS_TABLE[e]=new Array(xe.BARS_IN_MODULE)),St.RATIOS_TABLE[e][xe.BARS_IN_MODULE-i-1]=Math.fround(a/xe.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(e){let t=St.getDecodedCodewordValue(St.sampleBitCounts(e));return t!==-1?t:St.getClosestDecodedValue(e)}static sampleBitCounts(e){let t=Ne.sum(e),r=new Int32Array(xe.BARS_IN_MODULE),i=0,a=0;for(let l=0;l<xe.MODULES_IN_CODEWORD;l++){let d=t/(2*xe.MODULES_IN_CODEWORD)+l*t/xe.MODULES_IN_CODEWORD;a+e[i]<=d&&(a+=e[i],i++),r[i]++}return r}static getDecodedCodewordValue(e){let t=St.getBitValue(e);return xe.getCodeword(t)===-1?-1:t}static getBitValue(e){let t=0;for(let r=0;r<e.length;r++)for(let i=0;i<e[r];i++)t=t<<1|(r%2===0?1:0);return Math.trunc(t)}static getClosestDecodedValue(e){let t=Ne.sum(e),r=new Array(xe.BARS_IN_MODULE);if(t>1)for(let l=0;l<r.length;l++)r[l]=Math.fround(e[l]/t);let i=jr.MAX_VALUE,a=-1;this.bSymbolTableReady||St.initialize();for(let l=0;l<St.RATIOS_TABLE.length;l++){let d=0,g=St.RATIOS_TABLE[l];for(let x=0;x<xe.BARS_IN_MODULE;x++){let y=Math.fround(g[x]-r[x]);if(d+=Math.fround(y*y),d>=i)break}d<i&&(i=d,a=xe.SYMBOL_TABLE[l])}return a}}St.bSymbolTableReady=!1,St.RATIOS_TABLE=new Array(xe.SYMBOL_TABLE.length).map(b=>new Array(xe.BARS_IN_MODULE));class Fi{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(e){this.segmentIndex=e}getFileId(){return this.fileId}setFileId(e){this.fileId=e}getOptionalData(){return this.optionalData}setOptionalData(e){this.optionalData=e}isLastSegment(){return this.lastSegment}setLastSegment(e){this.lastSegment=e}getSegmentCount(){return this.segmentCount}setSegmentCount(e){this.segmentCount=e}getSender(){return this.sender||null}setSender(e){this.sender=e}getAddressee(){return this.addressee||null}setAddressee(e){this.addressee=e}getFileName(){return this.fileName}setFileName(e){this.fileName=e}getFileSize(){return this.fileSize}setFileSize(e){this.fileSize=e}getChecksum(){return this.checksum}setChecksum(e){this.checksum=e}getTimestamp(){return this.timestamp}setTimestamp(e){this.timestamp=e}}class Ui{static parseLong(e,t=void 0){return parseInt(e,t)}}class zi extends p{}zi.kind="NullPointerException";class ml{writeBytes(e){this.writeBytesOffset(e,0,e.length)}writeBytesOffset(e,t,r){if(e==null)throw new zi;if(t<0||t>e.length||r<0||t+r>e.length||t+r<0)throw new j;if(r===0)return;for(let i=0;i<r;i++)this.write(e[t+i])}flush(){}close(){}}class pl extends p{}class yl extends ml{constructor(e=32){if(super(),this.count=0,e<0)throw new N("Negative initial size: "+e);this.buf=new Uint8Array(e)}ensureCapacity(e){e-this.buf.length>0&&this.grow(e)}grow(e){let r=this.buf.length<<1;if(r-e<0&&(r=e),r<0){if(e<0)throw new pl;r=B.MAX_VALUE}this.buf=G.copyOfUint8Array(this.buf,r)}write(e){this.ensureCapacity(this.count+1),this.buf[this.count]=e,this.count+=1}writeBytesOffset(e,t,r){if(t<0||t>e.length||r<0||t+r-e.length>0)throw new j;this.ensureCapacity(this.count+r),k.arraycopy(e,t,this.buf,this.count,r),this.count+=r}writeTo(e){e.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return G.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(e){return e?typeof e=="string"?this.toString_string(e):this.toString_number(e):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(e){return new String(this.buf).toString()}toString_number(e){return new String(this.buf).toString()}close(){}}var De;(function(b){b[b.ALPHA=0]="ALPHA",b[b.LOWER=1]="LOWER",b[b.MIXED=2]="MIXED",b[b.PUNCT=3]="PUNCT",b[b.ALPHA_SHIFT=4]="ALPHA_SHIFT",b[b.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(De||(De={}));function Hi(){if(typeof window<"u")return window.BigInt||null;if(typeof Cr<"u")return Cr.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Ur;function Cn(b){if(typeof Ur>"u"&&(Ur=Hi()),Ur===null)throw new Error("BigInt is not supported!");return Ur(b)}function wl(){let b=[];b[0]=Cn(1);let e=Cn(900);b[1]=e;for(let t=2;t<16;t++)b[t]=b[t-1]*e;return b}class V{static decode(e,t){let r=new te(""),i=L.ISO8859_1;r.enableDecoding(i);let a=1,l=e[a++],d=new Fi;for(;a<e[0];){switch(l){case V.TEXT_COMPACTION_MODE_LATCH:a=V.textCompaction(e,a,r);break;case V.BYTE_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:a=V.byteCompaction(l,e,i,a,r);break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(e[a++]);break;case V.NUMERIC_COMPACTION_MODE_LATCH:a=V.numericCompaction(e,a,r);break;case V.ECI_CHARSET:L.getCharacterSetECIByValue(e[a++]);break;case V.ECI_GENERAL_PURPOSE:a+=2;break;case V.ECI_USER_DEFINED:a++;break;case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:a=V.decodeMacroBlock(e,a,d);break;case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:throw new $;default:a--,a=V.textCompaction(e,a,r);break}if(a<e.length)l=e[a++];else throw $.getFormatInstance()}if(r.length()===0)throw $.getFormatInstance();let g=new Rn(null,r.toString(),null,t);return g.setOther(d),g}static decodeMacroBlock(e,t,r){if(t+V.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw $.getFormatInstance();let i=new Int32Array(V.NUMBER_OF_SEQUENCE_CODEWORDS);for(let d=0;d<V.NUMBER_OF_SEQUENCE_CODEWORDS;d++,t++)i[d]=e[t];r.setSegmentIndex(B.parseInt(V.decodeBase900toBase10(i,V.NUMBER_OF_SEQUENCE_CODEWORDS)));let a=new te;t=V.textCompaction(e,t,a),r.setFileId(a.toString());let l=-1;for(e[t]===V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=t+1);t<e[0];)switch(e[t]){case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case V.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let d=new te;t=V.textCompaction(e,t+1,d),r.setFileName(d.toString());break;case V.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let g=new te;t=V.textCompaction(e,t+1,g),r.setSender(g.toString());break;case V.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let x=new te;t=V.textCompaction(e,t+1,x),r.setAddressee(x.toString());break;case V.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let y=new te;t=V.numericCompaction(e,t+1,y),r.setSegmentCount(B.parseInt(y.toString()));break;case V.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let C=new te;t=V.numericCompaction(e,t+1,C),r.setTimestamp(Ui.parseLong(C.toString()));break;case V.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let v=new te;t=V.numericCompaction(e,t+1,v),r.setChecksum(B.parseInt(v.toString()));break;case V.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let S=new te;t=V.numericCompaction(e,t+1,S),r.setFileSize(Ui.parseLong(S.toString()));break;default:throw $.getFormatInstance()}break;case V.MACRO_PDF417_TERMINATOR:t++,r.setLastSegment(!0);break;default:throw $.getFormatInstance()}if(l!==-1){let d=t-l;r.isLastSegment()&&d--,r.setOptionalData(G.copyOfRange(e,l,l+d))}return t}static textCompaction(e,t,r){let i=new Int32Array((e[0]-t)*2),a=new Int32Array((e[0]-t)*2),l=0,d=!1;for(;t<e[0]&&!d;){let g=e[t++];if(g<V.TEXT_COMPACTION_MODE_LATCH)i[l]=g/30,i[l+1]=g%30,l+=2;else switch(g){case V.TEXT_COMPACTION_MODE_LATCH:i[l++]=V.TEXT_COMPACTION_MODE_LATCH;break;case V.BYTE_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.NUMERIC_COMPACTION_MODE_LATCH:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:t--,d=!0;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i[l]=V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,g=e[t++],a[l]=g,l++;break}}return V.decodeTextCompaction(i,a,l,r),t}static decodeTextCompaction(e,t,r,i){let a=De.ALPHA,l=De.ALPHA,d=0;for(;d<r;){let g=e[d],x="";switch(a){case De.ALPHA:if(g<26)x=String.fromCharCode(65+g);else switch(g){case 26:x=" ";break;case V.LL:a=De.LOWER;break;case V.ML:a=De.MIXED;break;case V.PS:l=a,a=De.PUNCT_SHIFT;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[d]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=De.ALPHA;break}break;case De.LOWER:if(g<26)x=String.fromCharCode(97+g);else switch(g){case 26:x=" ";break;case V.AS:l=a,a=De.ALPHA_SHIFT;break;case V.ML:a=De.MIXED;break;case V.PS:l=a,a=De.PUNCT_SHIFT;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[d]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=De.ALPHA;break}break;case De.MIXED:if(g<V.PL)x=V.MIXED_CHARS[g];else switch(g){case V.PL:a=De.PUNCT;break;case 26:x=" ";break;case V.LL:a=De.LOWER;break;case V.AL:a=De.ALPHA;break;case V.PS:l=a,a=De.PUNCT_SHIFT;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[d]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=De.ALPHA;break}break;case De.PUNCT:if(g<V.PAL)x=V.PUNCT_CHARS[g];else switch(g){case V.PAL:a=De.ALPHA;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[d]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=De.ALPHA;break}break;case De.ALPHA_SHIFT:if(a=l,g<26)x=String.fromCharCode(65+g);else switch(g){case 26:x=" ";break;case V.TEXT_COMPACTION_MODE_LATCH:a=De.ALPHA;break}break;case De.PUNCT_SHIFT:if(a=l,g<V.PAL)x=V.PUNCT_CHARS[g];else switch(g){case V.PAL:a=De.ALPHA;break;case V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[d]);break;case V.TEXT_COMPACTION_MODE_LATCH:a=De.ALPHA;break}break}x!==""&&i.append(x),d++}}static byteCompaction(e,t,r,i,a){let l=new yl,d=0,g=0,x=!1;switch(e){case V.BYTE_COMPACTION_MODE_LATCH:let y=new Int32Array(6),C=t[i++];for(;i<t[0]&&!x;)switch(y[d++]=C,g=900*g+C,C=t[i++],C){case V.TEXT_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH:case V.NUMERIC_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:i--,x=!0;break;default:if(d%5===0&&d>0){for(let v=0;v<6;++v)l.write(Number(Cn(g)>>Cn(8*(5-v))));g=0,d=0}break}i===t[0]&&C<V.TEXT_COMPACTION_MODE_LATCH&&(y[d++]=C);for(let v=0;v<d;v++)l.write(y[v]);break;case V.BYTE_COMPACTION_MODE_LATCH_6:for(;i<t[0]&&!x;){let v=t[i++];if(v<V.TEXT_COMPACTION_MODE_LATCH)d++,g=900*g+v;else switch(v){case V.TEXT_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH:case V.NUMERIC_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:i--,x=!0;break}if(d%5===0&&d>0){for(let S=0;S<6;++S)l.write(Number(Cn(g)>>Cn(8*(5-S))));g=0,d=0}}break}return a.append(R.decode(l.toByteArray(),r)),i}static numericCompaction(e,t,r){let i=0,a=!1,l=new Int32Array(V.MAX_NUMERIC_CODEWORDS);for(;t<e[0]&&!a;){let d=e[t++];if(t===e[0]&&(a=!0),d<V.TEXT_COMPACTION_MODE_LATCH)l[i]=d,i++;else switch(d){case V.TEXT_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH:case V.BYTE_COMPACTION_MODE_LATCH_6:case V.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case V.MACRO_PDF417_TERMINATOR:t--,a=!0;break}(i%V.MAX_NUMERIC_CODEWORDS===0||d===V.NUMERIC_COMPACTION_MODE_LATCH||a)&&i>0&&(r.append(V.decodeBase900toBase10(l,i)),i=0)}return t}static decodeBase900toBase10(e,t){let r=Cn(0);for(let a=0;a<t;a++)r+=V.EXP900[t-a-1]*Cn(e[a]);let i=r.toString();if(i.charAt(0)!=="1")throw new $;return i.substring(1)}}V.TEXT_COMPACTION_MODE_LATCH=900,V.BYTE_COMPACTION_MODE_LATCH=901,V.NUMERIC_COMPACTION_MODE_LATCH=902,V.BYTE_COMPACTION_MODE_LATCH_6=924,V.ECI_USER_DEFINED=925,V.ECI_GENERAL_PURPOSE=926,V.ECI_CHARSET=927,V.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,V.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,V.MACRO_PDF417_TERMINATOR=922,V.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,V.MAX_NUMERIC_CODEWORDS=15,V.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,V.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,V.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,V.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,V.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,V.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,V.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,V.PL=25,V.LL=27,V.AS=27,V.ML=28,V.AL=28,V.PS=29,V.PAL=29,V.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,V.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",V.EXP900=Hi()?wl():[],V.NUMBER_OF_SEQUENCE_CODEWORDS=2;class ye{constructor(){}static decode(e,t,r,i,a,l,d){let g=new Pn(e,t,r,i,a),x=null,y=null,C;for(let O=!0;;O=!1){if(t!=null&&(x=ye.getRowIndicatorColumn(e,g,t,!0,l,d)),i!=null&&(y=ye.getRowIndicatorColumn(e,g,i,!1,l,d)),C=ye.merge(x,y),C==null)throw z.getNotFoundInstance();let D=C.getBoundingBox();if(O&&D!=null&&(D.getMinY()<g.getMinY()||D.getMaxY()>g.getMaxY()))g=D;else break}C.setBoundingBox(g);let v=C.getBarcodeColumnCount()+1;C.setDetectionResultColumn(0,x),C.setDetectionResultColumn(v,y);let S=x!=null;for(let O=1;O<=v;O++){let D=S?O:v-O;if(C.getDetectionResultColumn(D)!==void 0)continue;let P;D===0||D===v?P=new Pi(g,D===0):P=new xr(g),C.setDetectionResultColumn(D,P);let Z=-1,J=Z;for(let ee=g.getMinY();ee<=g.getMaxY();ee++){if(Z=ye.getStartColumn(C,D,ee,S),Z<0||Z>g.getMaxX()){if(J===-1)continue;Z=J}let Q=ye.detectCodeword(e,g.getMinX(),g.getMaxX(),S,Z,ee,l,d);Q!=null&&(P.setCodeword(ee,Q),J=Z,l=Math.min(l,Q.getWidth()),d=Math.max(d,Q.getWidth()))}}return ye.createDecoderResult(C)}static merge(e,t){if(e==null&&t==null)return null;let r=ye.getBarcodeMetadata(e,t);if(r==null)return null;let i=Pn.merge(ye.adjustBoundingBox(e),ye.adjustBoundingBox(t));return new pr(r,i)}static adjustBoundingBox(e){if(e==null)return null;let t=e.getRowHeights();if(t==null)return null;let r=ye.getMax(t),i=0;for(let d of t)if(i+=r-d,d>0)break;let a=e.getCodewords();for(let d=0;i>0&&a[d]==null;d++)i--;let l=0;for(let d=t.length-1;d>=0&&(l+=r-t[d],!(t[d]>0));d--);for(let d=a.length-1;l>0&&a[d]==null;d--)l--;return e.getBoundingBox().addMissingRows(i,l,e.isLeft())}static getMax(e){let t=-1;for(let r of e)t=Math.max(t,r);return t}static getBarcodeMetadata(e,t){let r;if(e==null||(r=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();let i;return t==null||(i=t.getBarcodeMetadata())==null?r:r.getColumnCount()!==i.getColumnCount()&&r.getErrorCorrectionLevel()!==i.getErrorCorrectionLevel()&&r.getRowCount()!==i.getRowCount()?null:r}static getRowIndicatorColumn(e,t,r,i,a,l){let d=new Pi(t,i);for(let g=0;g<2;g++){let x=g===0?1:-1,y=Math.trunc(Math.trunc(r.getX()));for(let C=Math.trunc(Math.trunc(r.getY()));C<=t.getMaxY()&&C>=t.getMinY();C+=x){let v=ye.detectCodeword(e,0,e.getWidth(),i,y,C,a,l);v!=null&&(d.setCodeword(C,v),i?y=v.getStartX():y=v.getEndX())}}return d}static adjustCodewordCount(e,t){let r=t[0][1],i=r.getValue(),a=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-ye.getNumberOfECCodeWords(e.getBarcodeECLevel());if(i.length===0){if(a<1||a>xe.MAX_CODEWORDS_IN_BARCODE)throw z.getNotFoundInstance();r.setValue(a)}else i[0]!==a&&r.setValue(a)}static createDecoderResult(e){let t=ye.createBarcodeMatrix(e);ye.adjustCodewordCount(e,t);let r=new Array,i=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),a=[],l=new Array;for(let g=0;g<e.getBarcodeRowCount();g++)for(let x=0;x<e.getBarcodeColumnCount();x++){let y=t[g][x+1].getValue(),C=g*e.getBarcodeColumnCount()+x;y.length===0?r.push(C):y.length===1?i[C]=y[0]:(l.push(C),a.push(y))}let d=new Array(a.length);for(let g=0;g<d.length;g++)d[g]=a[g];return ye.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),i,xe.toIntArray(r),xe.toIntArray(l),d)}static createDecoderResultFromAmbiguousValues(e,t,r,i,a){let l=new Int32Array(i.length),d=100;for(;d-- >0;){for(let g=0;g<l.length;g++)t[i[g]]=a[g][l[g]];try{return ye.decodeCodewords(t,e,r)}catch(g){if(!(g instanceof M))throw g}if(l.length===0)throw M.getChecksumInstance();for(let g=0;g<l.length;g++)if(l[g]<a[g].length-1){l[g]++;break}else if(l[g]=0,g===l.length-1)throw M.getChecksumInstance()}throw M.getChecksumInstance()}static createBarcodeMatrix(e){let t=Array.from({length:e.getBarcodeRowCount()},()=>new Array(e.getBarcodeColumnCount()+2));for(let i=0;i<t.length;i++)for(let a=0;a<t[i].length;a++)t[i][a]=new mr;let r=0;for(let i of e.getDetectionResultColumns()){if(i!=null){for(let a of i.getCodewords())if(a!=null){let l=a.getRowNumber();if(l>=0){if(l>=t.length)continue;t[l][r].setValue(a.getValue())}}}r++}return t}static isValidBarcodeColumn(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1}static getStartColumn(e,t,r,i){let a=i?1:-1,l=null;if(ye.isValidBarcodeColumn(e,t-a)&&(l=e.getDetectionResultColumn(t-a).getCodeword(r)),l!=null)return i?l.getEndX():l.getStartX();if(l=e.getDetectionResultColumn(t).getCodewordNearby(r),l!=null)return i?l.getStartX():l.getEndX();if(ye.isValidBarcodeColumn(e,t-a)&&(l=e.getDetectionResultColumn(t-a).getCodewordNearby(r)),l!=null)return i?l.getEndX():l.getStartX();let d=0;for(;ye.isValidBarcodeColumn(e,t-a);){t-=a;for(let g of e.getDetectionResultColumn(t).getCodewords())if(g!=null)return(i?g.getEndX():g.getStartX())+a*d*(g.getEndX()-g.getStartX());d++}return i?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()}static detectCodeword(e,t,r,i,a,l,d,g){a=ye.adjustCodewordStartColumn(e,t,r,i,a,l);let x=ye.getModuleBitCount(e,t,r,i,a,l);if(x==null)return null;let y,C=Ne.sum(x);if(i)y=a+C;else{for(let O=0;O<x.length/2;O++){let D=x[O];x[O]=x[x.length-1-O],x[x.length-1-O]=D}y=a,a=y-C}if(!ye.checkCodewordSkew(C,d,g))return null;let v=St.getDecodedValue(x),S=xe.getCodeword(v);return S===-1?null:new yr(a,y,ye.getCodewordBucketNumber(v),S)}static getModuleBitCount(e,t,r,i,a,l){let d=a,g=new Int32Array(8),x=0,y=i?1:-1,C=i;for(;(i?d<r:d>=t)&&x<g.length;)e.get(d,l)===C?(g[x]++,d+=y):(x++,C=!C);return x===g.length||d===(i?r:t)&&x===g.length-1?g:null}static getNumberOfECCodeWords(e){return 2<<e}static adjustCodewordStartColumn(e,t,r,i,a,l){let d=a,g=i?-1:1;for(let x=0;x<2;x++){for(;(i?d>=t:d<r)&&i===e.get(d,l);){if(Math.abs(a-d)>ye.CODEWORD_SKEW_SIZE)return a;d+=g}g=-g,i=!i}return d}static checkCodewordSkew(e,t,r){return t-ye.CODEWORD_SKEW_SIZE<=e&&e<=r+ye.CODEWORD_SKEW_SIZE}static decodeCodewords(e,t,r){if(e.length===0)throw $.getFormatInstance();let i=1<<t+1,a=ye.correctErrors(e,r,i);ye.verifyCodewordCount(e,i);let l=V.decode(e,""+t);return l.setErrorsCorrected(a),l.setErasures(r.length),l}static correctErrors(e,t,r){if(t!=null&&t.length>r/2+ye.MAX_ERRORS||r<0||r>ye.MAX_EC_CODEWORDS)throw M.getChecksumInstance();return ye.errorCorrection.decode(e,r,t)}static verifyCodewordCount(e,t){if(e.length<4)throw $.getFormatInstance();let r=e[0];if(r>e.length)throw $.getFormatInstance();if(r===0)if(t<e.length)e[0]=e.length-t;else throw $.getFormatInstance()}static getBitCountForCodeword(e){let t=new Int32Array(8),r=0,i=t.length-1;for(;!((e&1)!==r&&(r=e&1,i--,i<0));)t[i]++,e>>=1;return t}static getCodewordBucketNumber(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)}static getCodewordBucketNumber_number(e){return ye.getCodewordBucketNumber(ye.getBitCountForCodeword(e))}static getCodewordBucketNumber_Int32Array(e){return(e[0]-e[2]+e[4]-e[6]+9)%9}static toString(e){let t=new gr;for(let r=0;r<e.length;r++){t.format("Row %2d: ",r);for(let i=0;i<e[r].length;i++){let a=e[r][i];a.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",a.getValue()[0],a.getConfidence(a.getValue()[0]))}t.format("%n")}return t.toString()}}ye.CODEWORD_SKEW_SIZE=2,ye.MAX_ERRORS=3,ye.MAX_EC_CODEWORDS=512,ye.errorCorrection=new Bi;class mt{decode(e,t=null){let r=mt.decode(e,t,!1);if(r==null||r.length===0||r[0]==null)throw z.getNotFoundInstance();return r[0]}decodeMultiple(e,t=null){try{return mt.decode(e,t,!0)}catch(r){throw r instanceof $||r instanceof M?z.getNotFoundInstance():r}}static decode(e,t,r){const i=new Array,a=pe.detectMultiple(e,t,r);for(const l of a.getPoints()){const d=ye.decode(a.getBits(),l[4],l[5],l[6],l[7],mt.getMinCodewordWidth(l),mt.getMaxCodewordWidth(l)),g=new it(d.getText(),d.getRawBytes(),void 0,l,oe.PDF_417);g.putMetadata(Fe.ERROR_CORRECTION_LEVEL,d.getECLevel());const x=d.getOther();x!=null&&g.putMetadata(Fe.PDF417_EXTRA_METADATA,x),i.push(g)}return i.map(l=>l)}static getMaxWidth(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMinWidth(e,t){return e==null||t==null?B.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))}static getMaxCodewordWidth(e){return Math.floor(Math.max(Math.max(mt.getMaxWidth(e[0],e[4]),mt.getMaxWidth(e[6],e[2])*xe.MODULES_IN_CODEWORD/xe.MODULES_IN_STOP_PATTERN),Math.max(mt.getMaxWidth(e[1],e[5]),mt.getMaxWidth(e[7],e[3])*xe.MODULES_IN_CODEWORD/xe.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(e){return Math.floor(Math.min(Math.min(mt.getMinWidth(e[0],e[4]),mt.getMinWidth(e[6],e[2])*xe.MODULES_IN_CODEWORD/xe.MODULES_IN_STOP_PATTERN),Math.min(mt.getMinWidth(e[1],e[5]),mt.getMinWidth(e[7],e[3])*xe.MODULES_IN_CODEWORD/xe.MODULES_IN_STOP_PATTERN)))}reset(){}}class zr extends p{}zr.kind="ReaderException";class Vi{constructor(e,t){this.verbose=e===!0,t&&this.setHints(t)}decode(e,t){return t&&this.setHints(t),this.decodeInternal(e)}decodeWithState(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)}setHints(e){this.hints=e;const t=!u(e)&&e.get(re.TRY_HARDER)===!0,r=u(e)?null:e.get(re.POSSIBLE_FORMATS),i=new Array;if(!u(r)){const a=r.some(l=>l===oe.UPC_A||l===oe.UPC_E||l===oe.EAN_13||l===oe.EAN_8||l===oe.CODABAR||l===oe.CODE_39||l===oe.CODE_93||l===oe.CODE_128||l===oe.ITF||l===oe.RSS_14||l===oe.RSS_EXPANDED);a&&!t&&i.push(new Kn(e,this.verbose)),r.includes(oe.QR_CODE)&&i.push(new bn),r.includes(oe.DATA_MATRIX)&&i.push(new wn),r.includes(oe.AZTEC)&&i.push(new kr),r.includes(oe.PDF_417)&&i.push(new mt),a&&t&&i.push(new Kn(e,this.verbose))}i.length===0&&(t||i.push(new Kn(e,this.verbose)),i.push(new bn),i.push(new wn),i.push(new kr),i.push(new mt),t&&i.push(new Kn(e,this.verbose))),this.readers=i}reset(){if(this.readers!==null)for(const e of this.readers)e.reset()}decodeInternal(e){if(this.readers===null)throw new zr("No readers where selected, nothing can be read.");for(const t of this.readers)try{return t.decode(e,this.hints)}catch(r){if(r instanceof zr)continue}throw new z("No MultiFormat Readers were able to detect the code.")}}class bl extends Wt{constructor(e=null,t=500){const r=new Vi;r.setHints(e),super(r,t)}decodeBitmap(e){return this.reader.decodeWithState(e)}}class Cl extends Wt{constructor(e=500){super(new mt,e)}}class Al extends Wt{constructor(e=500){super(new bn,e)}}var Ms;(function(b){b[b.ERROR_CORRECTION=0]="ERROR_CORRECTION",b[b.CHARACTER_SET=1]="CHARACTER_SET",b[b.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",b[b.MIN_SIZE=3]="MIN_SIZE",b[b.MAX_SIZE=4]="MAX_SIZE",b[b.MARGIN=5]="MARGIN",b[b.PDF417_COMPACT=6]="PDF417_COMPACT",b[b.PDF417_COMPACTION=7]="PDF417_COMPACTION",b[b.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",b[b.AZTEC_LAYERS=9]="AZTEC_LAYERS",b[b.QR_VERSION=10]="QR_VERSION"})(Ms||(Ms={}));var lt=Ms;class Ds{constructor(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new ft(e,Int32Array.from([1])))}buildGenerator(e){const t=this.cachedGenerators;if(e>=t.length){let r=t[t.length-1];const i=this.field;for(let a=t.length;a<=e;a++){const l=r.multiply(new ft(i,Int32Array.from([1,i.exp(a-1+i.getGeneratorBase())])));t.push(l),r=l}}return t[e]}encode(e,t){if(t===0)throw new N("No error correction bytes");const r=e.length-t;if(r<=0)throw new N("No data bytes provided");const i=this.buildGenerator(t),a=new Int32Array(r);k.arraycopy(e,0,a,0,r);let l=new ft(this.field,a);l=l.multiplyByMonomial(t,1);const g=l.divide(i)[1].getCoefficients(),x=t-g.length;for(let y=0;y<x;y++)e[r+y]=0;k.arraycopy(g,0,e,r+x,g.length)}}class qe{constructor(){}static applyMaskPenaltyRule1(e){return qe.applyMaskPenaltyRule1Internal(e,!0)+qe.applyMaskPenaltyRule1Internal(e,!1)}static applyMaskPenaltyRule2(e){let t=0;const r=e.getArray(),i=e.getWidth(),a=e.getHeight();for(let l=0;l<a-1;l++){const d=r[l];for(let g=0;g<i-1;g++){const x=d[g];x===d[g+1]&&x===r[l+1][g]&&x===r[l+1][g+1]&&t++}}return qe.N2*t}static applyMaskPenaltyRule3(e){let t=0;const r=e.getArray(),i=e.getWidth(),a=e.getHeight();for(let l=0;l<a;l++)for(let d=0;d<i;d++){const g=r[l];d+6<i&&g[d]===1&&g[d+1]===0&&g[d+2]===1&&g[d+3]===1&&g[d+4]===1&&g[d+5]===0&&g[d+6]===1&&(qe.isWhiteHorizontal(g,d-4,d)||qe.isWhiteHorizontal(g,d+7,d+11))&&t++,l+6<a&&r[l][d]===1&&r[l+1][d]===0&&r[l+2][d]===1&&r[l+3][d]===1&&r[l+4][d]===1&&r[l+5][d]===0&&r[l+6][d]===1&&(qe.isWhiteVertical(r,d,l-4,l)||qe.isWhiteVertical(r,d,l+7,l+11))&&t++}return t*qe.N3}static isWhiteHorizontal(e,t,r){t=Math.max(t,0),r=Math.min(r,e.length);for(let i=t;i<r;i++)if(e[i]===1)return!1;return!0}static isWhiteVertical(e,t,r,i){r=Math.max(r,0),i=Math.min(i,e.length);for(let a=r;a<i;a++)if(e[a][t]===1)return!1;return!0}static applyMaskPenaltyRule4(e){let t=0;const r=e.getArray(),i=e.getWidth(),a=e.getHeight();for(let g=0;g<a;g++){const x=r[g];for(let y=0;y<i;y++)x[y]===1&&t++}const l=e.getHeight()*e.getWidth();return Math.floor(Math.abs(t*2-l)*10/l)*qe.N4}static getDataMaskBit(e,t,r){let i,a;switch(e){case 0:i=r+t&1;break;case 1:i=r&1;break;case 2:i=t%3;break;case 3:i=(r+t)%3;break;case 4:i=Math.floor(r/2)+Math.floor(t/3)&1;break;case 5:a=r*t,i=(a&1)+a%3;break;case 6:a=r*t,i=(a&1)+a%3&1;break;case 7:a=r*t,i=a%3+(r+t&1)&1;break;default:throw new N("Invalid mask pattern: "+e)}return i===0}static applyMaskPenaltyRule1Internal(e,t){let r=0;const i=t?e.getHeight():e.getWidth(),a=t?e.getWidth():e.getHeight(),l=e.getArray();for(let d=0;d<i;d++){let g=0,x=-1;for(let y=0;y<a;y++){const C=t?l[d][y]:l[y][d];C===x?g++:(g>=5&&(r+=qe.N1+(g-5)),g=1,x=C)}g>=5&&(r+=qe.N1+(g-5))}return r}}qe.N1=3,qe.N2=3,qe.N3=40,qe.N4=10;class Hr{constructor(e,t){this.width=e,this.height=t;const r=new Array(t);for(let i=0;i!==t;i++)r[i]=new Uint8Array(e);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(e,t){return this.bytes[t][e]}getArray(){return this.bytes}setNumber(e,t,r){this.bytes[t][e]=r}setBoolean(e,t,r){this.bytes[t][e]=r?1:0}clear(e){for(const t of this.bytes)G.fill(t,e)}equals(e){if(!(e instanceof Hr))return!1;const t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(let r=0,i=this.height;r<i;++r){const a=this.bytes[r],l=t.bytes[r];for(let d=0,g=this.width;d<g;++d)if(a[d]!==l[d])return!1}return!0}toString(){const e=new te;for(let t=0,r=this.height;t<r;++t){const i=this.bytes[t];for(let a=0,l=this.width;a<l;++a)switch(i[a]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()}}class Fn{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const e=new te;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()}setMode(e){this.mode=e}setECLevel(e){this.ecLevel=e}setVersion(e){this.version=e}setMaskPattern(e){this.maskPattern=e}setMatrix(e){this.matrix=e}static isValidMaskPattern(e){return e>=0&&e<Fn.NUM_MASK_PATTERNS}}Fn.NUM_MASK_PATTERNS=8;class Re extends p{}Re.kind="WriterException";class ge{constructor(){}static clearMatrix(e){e.clear(255)}static buildMatrix(e,t,r,i,a){ge.clearMatrix(a),ge.embedBasicPatterns(r,a),ge.embedTypeInfo(t,i,a),ge.maybeEmbedVersionInfo(r,a),ge.embedDataBits(e,i,a)}static embedBasicPatterns(e,t){ge.embedPositionDetectionPatternsAndSeparators(t),ge.embedDarkDotAtLeftBottomCorner(t),ge.maybeEmbedPositionAdjustmentPatterns(e,t),ge.embedTimingPatterns(t)}static embedTypeInfo(e,t,r){const i=new K;ge.makeTypeInfoBits(e,t,i);for(let a=0,l=i.getSize();a<l;++a){const d=i.get(i.getSize()-1-a),g=ge.TYPE_INFO_COORDINATES[a],x=g[0],y=g[1];if(r.setBoolean(x,y,d),a<8){const C=r.getWidth()-a-1;r.setBoolean(C,8,d)}else{const v=r.getHeight()-7+(a-8);r.setBoolean(8,v,d)}}}static maybeEmbedVersionInfo(e,t){if(e.getVersionNumber()<7)return;const r=new K;ge.makeVersionInfoBits(e,r);let i=6*3-1;for(let a=0;a<6;++a)for(let l=0;l<3;++l){const d=r.get(i);i--,t.setBoolean(a,t.getHeight()-11+l,d),t.setBoolean(t.getHeight()-11+l,a,d)}}static embedDataBits(e,t,r){let i=0,a=-1,l=r.getWidth()-1,d=r.getHeight()-1;for(;l>0;){for(l===6&&(l-=1);d>=0&&d<r.getHeight();){for(let g=0;g<2;++g){const x=l-g;if(!ge.isEmpty(r.get(x,d)))continue;let y;i<e.getSize()?(y=e.get(i),++i):y=!1,t!==255&&qe.getDataMaskBit(t,x,d)&&(y=!y),r.setBoolean(x,d,y)}d+=a}a=-a,d+=a,l-=2}if(i!==e.getSize())throw new Re("Not all bits consumed: "+i+"/"+e.getSize())}static findMSBSet(e){return 32-B.numberOfLeadingZeros(e)}static calculateBCHCode(e,t){if(t===0)throw new N("0 polynomial");const r=ge.findMSBSet(t);for(e<<=r-1;ge.findMSBSet(e)>=r;)e^=t<<ge.findMSBSet(e)-r;return e}static makeTypeInfoBits(e,t,r){if(!Fn.isValidMaskPattern(t))throw new Re("Invalid mask pattern");const i=e.getBits()<<3|t;r.appendBits(i,5);const a=ge.calculateBCHCode(i,ge.TYPE_INFO_POLY);r.appendBits(a,10);const l=new K;if(l.appendBits(ge.TYPE_INFO_MASK_PATTERN,15),r.xor(l),r.getSize()!==15)throw new Re("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(e,t){t.appendBits(e.getVersionNumber(),6);const r=ge.calculateBCHCode(e.getVersionNumber(),ge.VERSION_INFO_POLY);if(t.appendBits(r,12),t.getSize()!==18)throw new Re("should not happen but we got: "+t.getSize())}static isEmpty(e){return e===255}static embedTimingPatterns(e){for(let t=8;t<e.getWidth()-8;++t){const r=(t+1)%2;ge.isEmpty(e.get(t,6))&&e.setNumber(t,6,r),ge.isEmpty(e.get(6,t))&&e.setNumber(6,t,r)}}static embedDarkDotAtLeftBottomCorner(e){if(e.get(8,e.getHeight()-8)===0)throw new Re;e.setNumber(8,e.getHeight()-8,1)}static embedHorizontalSeparationPattern(e,t,r){for(let i=0;i<8;++i){if(!ge.isEmpty(r.get(e+i,t)))throw new Re;r.setNumber(e+i,t,0)}}static embedVerticalSeparationPattern(e,t,r){for(let i=0;i<7;++i){if(!ge.isEmpty(r.get(e,t+i)))throw new Re;r.setNumber(e,t+i,0)}}static embedPositionAdjustmentPattern(e,t,r){for(let i=0;i<5;++i){const a=ge.POSITION_ADJUSTMENT_PATTERN[i];for(let l=0;l<5;++l)r.setNumber(e+l,t+i,a[l])}}static embedPositionDetectionPattern(e,t,r){for(let i=0;i<7;++i){const a=ge.POSITION_DETECTION_PATTERN[i];for(let l=0;l<7;++l)r.setNumber(e+l,t+i,a[l])}}static embedPositionDetectionPatternsAndSeparators(e){const t=ge.POSITION_DETECTION_PATTERN[0].length;ge.embedPositionDetectionPattern(0,0,e),ge.embedPositionDetectionPattern(e.getWidth()-t,0,e),ge.embedPositionDetectionPattern(0,e.getWidth()-t,e);const r=8;ge.embedHorizontalSeparationPattern(0,r-1,e),ge.embedHorizontalSeparationPattern(e.getWidth()-r,r-1,e),ge.embedHorizontalSeparationPattern(0,e.getWidth()-r,e);const i=7;ge.embedVerticalSeparationPattern(i,0,e),ge.embedVerticalSeparationPattern(e.getHeight()-i-1,0,e),ge.embedVerticalSeparationPattern(i,e.getHeight()-i,e)}static maybeEmbedPositionAdjustmentPatterns(e,t){if(e.getVersionNumber()<2)return;const r=e.getVersionNumber()-1,i=ge.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let a=0,l=i.length;a!==l;a++){const d=i[a];if(d>=0)for(let g=0;g!==l;g++){const x=i[g];x>=0&&ge.isEmpty(t.get(x,d))&&ge.embedPositionAdjustmentPattern(x-2,d-2,t)}}}}ge.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),ge.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),ge.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),ge.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),ge.VERSION_INFO_POLY=7973,ge.TYPE_INFO_POLY=1335,ge.TYPE_INFO_MASK_PATTERN=21522;class Nl{constructor(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Ue{constructor(){}static calculateMaskPenalty(e){return qe.applyMaskPenaltyRule1(e)+qe.applyMaskPenaltyRule2(e)+qe.applyMaskPenaltyRule3(e)+qe.applyMaskPenaltyRule4(e)}static encode(e,t,r=null){let i=Ue.DEFAULT_BYTE_MODE_ENCODING;const a=r!==null&&r.get(lt.CHARACTER_SET)!==void 0;a&&(i=r.get(lt.CHARACTER_SET).toString());const l=this.chooseMode(e,i),d=new K;if(l===he.BYTE&&(a||Ue.DEFAULT_BYTE_MODE_ENCODING!==i)){const ee=L.getCharacterSetECIByName(i);ee!==void 0&&this.appendECI(ee,d)}this.appendModeInfo(l,d);const g=new K;this.appendBytes(e,l,g,i);let x;if(r!==null&&r.get(lt.QR_VERSION)!==void 0){const ee=Number.parseInt(r.get(lt.QR_VERSION).toString(),10);x=ue.getVersionForNumber(ee);const Q=this.calculateBitsNeeded(l,d,g,x);if(!this.willFit(Q,x,t))throw new Re("Data too big for requested version")}else x=this.recommendVersion(t,l,d,g);const y=new K;y.appendBitArray(d);const C=l===he.BYTE?g.getSizeInBytes():e.length;this.appendLengthInfo(C,x,l,y),y.appendBitArray(g);const v=x.getECBlocksForLevel(t),S=x.getTotalCodewords()-v.getTotalECCodewords();this.terminateBits(S,y);const O=this.interleaveWithECBytes(y,x.getTotalCodewords(),S,v.getNumBlocks()),D=new Fn;D.setECLevel(t),D.setMode(l),D.setVersion(x);const P=x.getDimensionForVersion(),Z=new Hr(P,P),J=this.chooseMaskPattern(O,t,x,Z);return D.setMaskPattern(J),ge.buildMatrix(O,t,x,J,Z),D.setMatrix(Z),D}static recommendVersion(e,t,r,i){const a=this.calculateBitsNeeded(t,r,i,ue.getVersionForNumber(1)),l=this.chooseVersion(a,e),d=this.calculateBitsNeeded(t,r,i,l);return this.chooseVersion(d,e)}static calculateBitsNeeded(e,t,r,i){return t.getSize()+e.getCharacterCountBits(i)+r.getSize()}static getAlphanumericCode(e){return e<Ue.ALPHANUMERIC_TABLE.length?Ue.ALPHANUMERIC_TABLE[e]:-1}static chooseMode(e,t=null){if(L.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return he.KANJI;let r=!1,i=!1;for(let a=0,l=e.length;a<l;++a){const d=e.charAt(a);if(Ue.isDigit(d))r=!0;else if(this.getAlphanumericCode(d.charCodeAt(0))!==-1)i=!0;else return he.BYTE}return i?he.ALPHANUMERIC:r?he.NUMERIC:he.BYTE}static isOnlyDoubleByteKanji(e){let t;try{t=R.encode(e,L.SJIS)}catch{return!1}const r=t.length;if(r%2!==0)return!1;for(let i=0;i<r;i+=2){const a=t[i]&255;if((a<129||a>159)&&(a<224||a>235))return!1}return!0}static chooseMaskPattern(e,t,r,i){let a=Number.MAX_SAFE_INTEGER,l=-1;for(let d=0;d<Fn.NUM_MASK_PATTERNS;d++){ge.buildMatrix(e,t,r,d,i);let g=this.calculateMaskPenalty(i);g<a&&(a=g,l=d)}return l}static chooseVersion(e,t){for(let r=1;r<=40;r++){const i=ue.getVersionForNumber(r);if(Ue.willFit(e,i,t))return i}throw new Re("Data too big")}static willFit(e,t,r){const i=t.getTotalCodewords(),l=t.getECBlocksForLevel(r).getTotalECCodewords(),d=i-l,g=(e+7)/8;return d>=g}static terminateBits(e,t){const r=e*8;if(t.getSize()>r)throw new Re("data bits cannot fit in the QR Code"+t.getSize()+" > "+r);for(let l=0;l<4&&t.getSize()<r;++l)t.appendBit(!1);const i=t.getSize()&7;if(i>0)for(let l=i;l<8;l++)t.appendBit(!1);const a=e-t.getSizeInBytes();for(let l=0;l<a;++l)t.appendBits(l&1?17:236,8);if(t.getSize()!==r)throw new Re("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(e,t,r,i,a,l){if(i>=r)throw new Re("Block ID too large");const d=e%r,g=r-d,x=Math.floor(e/r),y=x+1,C=Math.floor(t/r),v=C+1,S=x-C,O=y-v;if(S!==O)throw new Re("EC bytes mismatch");if(r!==g+d)throw new Re("RS blocks mismatch");if(e!==(C+S)*g+(v+O)*d)throw new Re("Total bytes mismatch");i<g?(a[0]=C,l[0]=S):(a[0]=v,l[0]=O)}static interleaveWithECBytes(e,t,r,i){if(e.getSizeInBytes()!==r)throw new Re("Number of bits and data bytes does not match");let a=0,l=0,d=0;const g=new Array;for(let y=0;y<i;++y){const C=new Int32Array(1),v=new Int32Array(1);Ue.getNumDataBytesAndNumECBytesForBlockID(t,r,i,y,C,v);const S=C[0],O=new Uint8Array(S);e.toBytes(8*a,O,0,S);const D=Ue.generateECBytes(O,v[0]);g.push(new Nl(O,D)),l=Math.max(l,S),d=Math.max(d,D.length),a+=C[0]}if(r!==a)throw new Re("Data bytes does not match offset");const x=new K;for(let y=0;y<l;++y)for(const C of g){const v=C.getDataBytes();y<v.length&&x.appendBits(v[y],8)}for(let y=0;y<d;++y)for(const C of g){const v=C.getErrorCorrectionBytes();y<v.length&&x.appendBits(v[y],8)}if(t!==x.getSizeInBytes())throw new Re("Interleaving error: "+t+" and "+x.getSizeInBytes()+" differ.");return x}static generateECBytes(e,t){const r=e.length,i=new Int32Array(r+t);for(let l=0;l<r;l++)i[l]=e[l]&255;new Ds(ve.QR_CODE_FIELD_256).encode(i,t);const a=new Uint8Array(t);for(let l=0;l<t;l++)a[l]=i[r+l];return a}static appendModeInfo(e,t){t.appendBits(e.getBits(),4)}static appendLengthInfo(e,t,r,i){const a=r.getCharacterCountBits(t);if(e>=1<<a)throw new Re(e+" is bigger than "+((1<<a)-1));i.appendBits(e,a)}static appendBytes(e,t,r,i){switch(t){case he.NUMERIC:Ue.appendNumericBytes(e,r);break;case he.ALPHANUMERIC:Ue.appendAlphanumericBytes(e,r);break;case he.BYTE:Ue.append8BitBytes(e,r,i);break;case he.KANJI:Ue.appendKanjiBytes(e,r);break;default:throw new Re("Invalid mode: "+t)}}static getDigit(e){return e.charCodeAt(0)-48}static isDigit(e){const t=Ue.getDigit(e);return t>=0&&t<=9}static appendNumericBytes(e,t){const r=e.length;let i=0;for(;i<r;){const a=Ue.getDigit(e.charAt(i));if(i+2<r){const l=Ue.getDigit(e.charAt(i+1)),d=Ue.getDigit(e.charAt(i+2));t.appendBits(a*100+l*10+d,10),i+=3}else if(i+1<r){const l=Ue.getDigit(e.charAt(i+1));t.appendBits(a*10+l,7),i+=2}else t.appendBits(a,4),i++}}static appendAlphanumericBytes(e,t){const r=e.length;let i=0;for(;i<r;){const a=Ue.getAlphanumericCode(e.charCodeAt(i));if(a===-1)throw new Re;if(i+1<r){const l=Ue.getAlphanumericCode(e.charCodeAt(i+1));if(l===-1)throw new Re;t.appendBits(a*45+l,11),i+=2}else t.appendBits(a,6),i++}}static append8BitBytes(e,t,r){let i;try{i=R.encode(e,r)}catch(a){throw new Re(a)}for(let a=0,l=i.length;a!==l;a++){const d=i[a];t.appendBits(d,8)}}static appendKanjiBytes(e,t){let r;try{r=R.encode(e,L.SJIS)}catch(a){throw new Re(a)}const i=r.length;for(let a=0;a<i;a+=2){const l=r[a]&255,d=r[a+1]&255,g=l<<8&4294967295|d;let x=-1;if(g>=33088&&g<=40956?x=g-33088:g>=57408&&g<=60351&&(x=g-49472),x===-1)throw new Re("Invalid byte sequence");const y=(x>>8)*192+(x&255);t.appendBits(y,13)}}static appendECI(e,t){t.appendBits(he.ECI.getBits(),4),t.appendBits(e.getValue(),8)}}Ue.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Ue.DEFAULT_BYTE_MODE_ENCODING=L.UTF8.getName();class Un{write(e,t,r,i=null){if(e.length===0)throw new N("Found empty contents");if(t<0||r<0)throw new N("Requested dimensions are too small: "+t+"x"+r);let a=Be.L,l=Un.QUIET_ZONE_SIZE;i!==null&&(i.get(lt.ERROR_CORRECTION)!==void 0&&(a=Be.fromString(i.get(lt.ERROR_CORRECTION).toString())),i.get(lt.MARGIN)!==void 0&&(l=Number.parseInt(i.get(lt.MARGIN).toString(),10)));const d=Ue.encode(e,a,i);return this.renderResult(d,t,r,l)}writeToDom(e,t,r,i,a=null){typeof e=="string"&&(e=document.querySelector(e));const l=this.write(t,r,i,a);e&&e.appendChild(l)}renderResult(e,t,r,i){const a=e.getMatrix();if(a===null)throw new $t;const l=a.getWidth(),d=a.getHeight(),g=l+i*2,x=d+i*2,y=Math.max(t,g),C=Math.max(r,x),v=Math.min(Math.floor(y/g),Math.floor(C/x)),S=Math.floor((y-l*v)/2),O=Math.floor((C-d*v)/2),D=this.createSVGElement(y,C);for(let P=0,Z=O;P<d;P++,Z+=v)for(let J=0,ee=S;J<l;J++,ee+=v)if(a.get(J,P)===1){const Q=this.createSvgRectElement(ee,Z,v,v);D.appendChild(Q)}return D}createSVGElement(e,t){const r=document.createElementNS(Un.SVG_NS,"svg");return r.setAttributeNS(null,"height",e.toString()),r.setAttributeNS(null,"width",t.toString()),r}createSvgRectElement(e,t,r,i){const a=document.createElementNS(Un.SVG_NS,"rect");return a.setAttributeNS(null,"x",e.toString()),a.setAttributeNS(null,"y",t.toString()),a.setAttributeNS(null,"height",r.toString()),a.setAttributeNS(null,"width",i.toString()),a.setAttributeNS(null,"fill","#000000"),a}}Un.QUIET_ZONE_SIZE=4,Un.SVG_NS="http://www.w3.org/2000/svg";class er{encode(e,t,r,i,a){if(e.length===0)throw new N("Found empty contents");if(t!==oe.QR_CODE)throw new N("Can only encode QR_CODE, but got "+t);if(r<0||i<0)throw new N(`Requested dimensions are too small: ${r}x${i}`);let l=Be.L,d=er.QUIET_ZONE_SIZE;a!==null&&(a.get(lt.ERROR_CORRECTION)!==void 0&&(l=Be.fromString(a.get(lt.ERROR_CORRECTION).toString())),a.get(lt.MARGIN)!==void 0&&(d=Number.parseInt(a.get(lt.MARGIN).toString(),10)));const g=Ue.encode(e,l,a);return er.renderResult(g,r,i,d)}static renderResult(e,t,r,i){const a=e.getMatrix();if(a===null)throw new $t;const l=a.getWidth(),d=a.getHeight(),g=l+i*2,x=d+i*2,y=Math.max(t,g),C=Math.max(r,x),v=Math.min(Math.floor(y/g),Math.floor(C/x)),S=Math.floor((y-l*v)/2),O=Math.floor((C-d*v)/2),D=new ce(y,C);for(let P=0,Z=O;P<d;P++,Z+=v)for(let J=0,ee=S;J<l;J++,ee+=v)a.get(J,P)===1&&D.setRegion(ee,Z,v,v);return D}}er.QUIET_ZONE_SIZE=4;class El{encode(e,t,r,i,a){let l;switch(t){case oe.QR_CODE:l=new er;break;default:throw new N("No encoder available for format "+t)}return l.encode(e,t,r,i,a)}}class en extends on{constructor(e,t,r,i,a,l,d,g){if(super(l,d),this.yuvData=e,this.dataWidth=t,this.dataHeight=r,this.left=i,this.top=a,i+l>t||a+d>r)throw new N("Crop rectangle does not fit within image data.");g&&this.reverseHorizontal(l,d)}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const r=this.getWidth();(t==null||t.length<r)&&(t=new Uint8ClampedArray(r));const i=(e+this.top)*this.dataWidth+this.left;return k.arraycopy(this.yuvData,i,t,0,r),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.yuvData;const r=e*t,i=new Uint8ClampedArray(r);let a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return k.arraycopy(this.yuvData,a,i,0,r),i;for(let l=0;l<t;l++){const d=l*e;k.arraycopy(this.yuvData,a,i,d,e),a+=this.dataWidth}return i}isCropSupported(){return!0}crop(e,t,r,i){return new en(this.yuvData,this.dataWidth,this.dataHeight,this.left+e,this.top+t,r,i,!1)}renderThumbnail(){const e=this.getWidth()/en.THUMBNAIL_SCALE_FACTOR,t=this.getHeight()/en.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(e*t),i=this.yuvData;let a=this.top*this.dataWidth+this.left;for(let l=0;l<t;l++){const d=l*e;for(let g=0;g<e;g++){const x=i[a+g*en.THUMBNAIL_SCALE_FACTOR]&255;r[d+g]=4278190080|x*65793}a+=this.dataWidth*en.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/en.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/en.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(e,t){const r=this.yuvData;for(let i=0,a=this.top*this.dataWidth+this.left;i<t;i++,a+=this.dataWidth){const l=a+e/2;for(let d=a,g=a+e-1;d<l;d++,g--){const x=r[d];r[d]=r[g],r[g]=x}}}invert(){return new Lt(this)}}en.THUMBNAIL_SCALE_FACTOR=2;class js extends on{constructor(e,t,r,i,a,l,d){if(super(t,r),this.dataWidth=i,this.dataHeight=a,this.left=l,this.top=d,e.BYTES_PER_ELEMENT===4){const g=t*r,x=new Uint8ClampedArray(g);for(let y=0;y<g;y++){const C=e[y],v=C>>16&255,S=C>>7&510,O=C&255;x[y]=(v+S+O)/4&255}this.luminances=x}else this.luminances=e;if(i===void 0&&(this.dataWidth=t),a===void 0&&(this.dataHeight=r),l===void 0&&(this.left=0),d===void 0&&(this.top=0),this.left+t>this.dataWidth||this.top+r>this.dataHeight)throw new N("Crop rectangle does not fit within image data.")}getRow(e,t){if(e<0||e>=this.getHeight())throw new N("Requested row is outside the image: "+e);const r=this.getWidth();(t==null||t.length<r)&&(t=new Uint8ClampedArray(r));const i=(e+this.top)*this.dataWidth+this.left;return k.arraycopy(this.luminances,i,t,0,r),t}getMatrix(){const e=this.getWidth(),t=this.getHeight();if(e===this.dataWidth&&t===this.dataHeight)return this.luminances;const r=e*t,i=new Uint8ClampedArray(r);let a=this.top*this.dataWidth+this.left;if(e===this.dataWidth)return k.arraycopy(this.luminances,a,i,0,r),i;for(let l=0;l<t;l++){const d=l*e;k.arraycopy(this.luminances,a,i,d,e),a+=this.dataWidth}return i}isCropSupported(){return!0}crop(e,t,r,i){return new js(this.luminances,r,i,this.dataWidth,this.dataHeight,this.left+e,this.top+t)}invert(){return new Lt(this)}}class Zi extends L{static forName(e){return this.getCharacterSetECIByName(e)}}class Rs{}Rs.ISO_8859_1=L.ISO8859_1;class Wi{isCompact(){return this.compact}setCompact(e){this.compact=e}getSize(){return this.size}setSize(e){this.size=e}getLayers(){return this.layers}setLayers(e){this.layers=e}getCodeWords(){return this.codeWords}setCodeWords(e){this.codeWords=e}getMatrix(){return this.matrix}setMatrix(e){this.matrix=e}}class Gi{static singletonList(e){return[e]}static min(e,t){return e.sort(t)[0]}}class vl{constructor(e){this.previous=e}getPrevious(){return this.previous}}class tr extends vl{constructor(e,t,r){super(e),this.value=t,this.bitCount=r}appendTo(e,t){e.appendBits(this.value,this.bitCount)}add(e,t){return new tr(this,e,t)}addBinaryShift(e,t){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new tr(this,e,t)}toString(){let e=this.value&(1<<this.bitCount)-1;return e|=1<<this.bitCount,"<"+B.toBinaryString(e|1<<this.bitCount).substring(1)+">"}}class ks extends tr{constructor(e,t,r){super(e,0,0),this.binaryShiftStart=t,this.binaryShiftByteCount=r}appendTo(e,t){for(let r=0;r<this.binaryShiftByteCount;r++)(r===0||r===31&&this.binaryShiftByteCount<=62)&&(e.appendBits(31,5),this.binaryShiftByteCount>62?e.appendBits(this.binaryShiftByteCount-31,16):r===0?e.appendBits(Math.min(this.binaryShiftByteCount,31),5):e.appendBits(this.binaryShiftByteCount-31,5)),e.appendBits(t[this.binaryShiftStart+r],8)}addBinaryShift(e,t){return new ks(this,e,t)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function _l(b,e,t){return new ks(b,e,t)}function wr(b,e,t){return new tr(b,e,t)}const Sl=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],An=0,Vr=1,Ut=2,Yi=3,tn=4,Il=new tr(null,0,0),Ls=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Tl(b){for(let e of b)G.fill(e,-1);return b[An][tn]=0,b[Vr][tn]=0,b[Vr][An]=28,b[Yi][tn]=0,b[Ut][tn]=0,b[Ut][An]=15,b}const Xi=Tl(G.createInt32Array(6,6));class nn{constructor(e,t,r,i){this.token=e,this.mode=t,this.binaryShiftByteCount=r,this.bitCount=i}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(e,t){let r=this.bitCount,i=this.token;if(e!==this.mode){let l=Ls[this.mode][e];i=wr(i,l&65535,l>>16),r+=l>>16}let a=e===Ut?4:5;return i=wr(i,t,a),new nn(i,e,0,r+a)}shiftAndAppend(e,t){let r=this.token,i=this.mode===Ut?4:5;return r=wr(r,Xi[this.mode][e],i),r=wr(r,t,5),new nn(r,this.mode,0,this.bitCount+i+5)}addBinaryShiftChar(e){let t=this.token,r=this.mode,i=this.bitCount;if(this.mode===tn||this.mode===Ut){let d=Ls[r][An];t=wr(t,d&65535,d>>16),i+=d>>16,r=An}let a=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new nn(t,r,this.binaryShiftByteCount+1,i+a);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(e+1)),l}endBinaryShift(e){if(this.binaryShiftByteCount===0)return this;let t=this.token;return t=_l(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new nn(t,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(e){let t=this.bitCount+(Ls[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=nn.calculateBinaryShiftCost(e)-nn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount}toBitArray(e){let t=[];for(let i=this.endBinaryShift(e.length).token;i!==null;i=i.getPrevious())t.unshift(i);let r=new K;for(const i of t)i.appendTo(r,e);return r}toString(){return X.format("%s bits=%d bytes=%d",Sl[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0}}nn.INITIAL_STATE=new nn(Il,An,0,0);function Ol(b){const e=X.getCharCode(" "),t=X.getCharCode("."),r=X.getCharCode(",");b[An][e]=1;const i=X.getCharCode("Z"),a=X.getCharCode("A");for(let v=a;v<=i;v++)b[An][v]=v-a+2;b[Vr][e]=1;const l=X.getCharCode("z"),d=X.getCharCode("a");for(let v=d;v<=l;v++)b[Vr][v]=v-d+2;b[Ut][e]=1;const g=X.getCharCode("9"),x=X.getCharCode("0");for(let v=x;v<=g;v++)b[Ut][v]=v-x+2;b[Ut][r]=12,b[Ut][t]=13;const y=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let v=0;v<y.length;v++)b[Yi][X.getCharCode(y[v])]=v;const C=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let v=0;v<C.length;v++)X.getCharCode(C[v])>0&&(b[tn][X.getCharCode(C[v])]=v);return b}const Bs=Ol(G.createInt32Array(5,256));class br{constructor(e){this.text=e}encode(){const e=X.getCharCode(" "),t=X.getCharCode(`
`);let r=Gi.singletonList(nn.INITIAL_STATE);for(let a=0;a<this.text.length;a++){let l,d=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case X.getCharCode("\r"):l=d===t?2:0;break;case X.getCharCode("."):l=d===e?3:0;break;case X.getCharCode(","):l=d===e?4:0;break;case X.getCharCode(":"):l=d===e?5:0;break;default:l=0}l>0?(r=br.updateStateListForPair(r,a,l),a++):r=this.updateStateListForChar(r,a)}return Gi.min(r,(a,l)=>a.getBitCount()-l.getBitCount()).toBitArray(this.text)}updateStateListForChar(e,t){const r=[];for(let i of e)this.updateStateForChar(i,t,r);return br.simplifyStates(r)}updateStateForChar(e,t,r){let i=this.text[t]&255,a=Bs[e.getMode()][i]>0,l=null;for(let d=0;d<=tn;d++){let g=Bs[d][i];if(g>0){if(l==null&&(l=e.endBinaryShift(t)),!a||d===e.getMode()||d===Ut){const x=l.latchAndAppend(d,g);r.push(x)}if(!a&&Xi[e.getMode()][d]>=0){const x=l.shiftAndAppend(d,g);r.push(x)}}}if(e.getBinaryShiftByteCount()>0||Bs[e.getMode()][i]===0){let d=e.addBinaryShiftChar(t);r.push(d)}}static updateStateListForPair(e,t,r){const i=[];for(let a of e)this.updateStateForPair(a,t,r,i);return this.simplifyStates(i)}static updateStateForPair(e,t,r,i){let a=e.endBinaryShift(t);if(i.push(a.latchAndAppend(tn,r)),e.getMode()!==tn&&i.push(a.shiftAndAppend(tn,r)),r===3||r===4){let l=a.latchAndAppend(Ut,16-r).latchAndAppend(Ut,1);i.push(l)}if(e.getBinaryShiftByteCount()>0){let l=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);i.push(l)}}static simplifyStates(e){let t=[];for(const r of e){let i=!0;for(const a of t){if(a.isBetterThanOrEqualTo(r)){i=!1;break}r.isBetterThanOrEqualTo(a)&&(t=t.filter(l=>l!==a))}i&&t.push(r)}return t}}class Ee{constructor(){}static encodeBytes(e){return Ee.encode(e,Ee.DEFAULT_EC_PERCENT,Ee.DEFAULT_AZTEC_LAYERS)}static encode(e,t,r){let i=new br(e).encode(),a=B.truncDivision(i.getSize()*t,100)+11,l=i.getSize()+a,d,g,x,y,C;if(r!==Ee.DEFAULT_AZTEC_LAYERS){if(d=r<0,g=Math.abs(r),g>(d?Ee.MAX_NB_BITS_COMPACT:Ee.MAX_NB_BITS))throw new N(X.format("Illegal value %s for layers",r));x=Ee.totalBitsInLayer(g,d),y=Ee.WORD_SIZE[g];let Q=x-x%y;if(C=Ee.stuffBits(i,y),C.getSize()+a>Q)throw new N("Data to large for user specified layer");if(d&&C.getSize()>y*64)throw new N("Data to large for user specified layer")}else{y=0,C=null;for(let Q=0;;Q++){if(Q>Ee.MAX_NB_BITS)throw new N("Data too large for an Aztec code");if(d=Q<=3,g=d?Q+1:Q,x=Ee.totalBitsInLayer(g,d),l>x)continue;(C==null||y!==Ee.WORD_SIZE[g])&&(y=Ee.WORD_SIZE[g],C=Ee.stuffBits(i,y));let be=x-x%y;if(!(d&&C.getSize()>y*64)&&C.getSize()+a<=be)break}}let v=Ee.generateCheckWords(C,x,y),S=C.getSize()/y,O=Ee.generateModeMessage(d,g,S),D=(d?11:14)+g*4,P=new Int32Array(D),Z;if(d){Z=D;for(let Q=0;Q<P.length;Q++)P[Q]=Q}else{Z=D+1+2*B.truncDivision(B.truncDivision(D,2)-1,15);let Q=B.truncDivision(D,2),be=B.truncDivision(Z,2);for(let me=0;me<Q;me++){let It=me+B.truncDivision(me,15);P[Q-me-1]=be-It-1,P[Q+me]=be+It+1}}let J=new ce(Z);for(let Q=0,be=0;Q<g;Q++){let me=(g-Q)*4+(d?9:12);for(let It=0;It<me;It++){let Xt=It*2;for(let Tt=0;Tt<2;Tt++)v.get(be+Xt+Tt)&&J.set(P[Q*2+Tt],P[Q*2+It]),v.get(be+me*2+Xt+Tt)&&J.set(P[Q*2+It],P[D-1-Q*2-Tt]),v.get(be+me*4+Xt+Tt)&&J.set(P[D-1-Q*2-Tt],P[D-1-Q*2-It]),v.get(be+me*6+Xt+Tt)&&J.set(P[D-1-Q*2-It],P[Q*2+Tt])}be+=me*8}if(Ee.drawModeMessage(J,d,Z,O),d)Ee.drawBullsEye(J,B.truncDivision(Z,2),5);else{Ee.drawBullsEye(J,B.truncDivision(Z,2),7);for(let Q=0,be=0;Q<B.truncDivision(D,2)-1;Q+=15,be+=16)for(let me=B.truncDivision(Z,2)&1;me<Z;me+=2)J.set(B.truncDivision(Z,2)-be,me),J.set(B.truncDivision(Z,2)+be,me),J.set(me,B.truncDivision(Z,2)-be),J.set(me,B.truncDivision(Z,2)+be)}let ee=new Wi;return ee.setCompact(d),ee.setSize(Z),ee.setLayers(g),ee.setCodeWords(S),ee.setMatrix(J),ee}static drawBullsEye(e,t,r){for(let i=0;i<r;i+=2)for(let a=t-i;a<=t+i;a++)e.set(a,t-i),e.set(a,t+i),e.set(t-i,a),e.set(t+i,a);e.set(t-r,t-r),e.set(t-r+1,t-r),e.set(t-r,t-r+1),e.set(t+r,t-r),e.set(t+r,t-r+1),e.set(t+r,t+r-1)}static generateModeMessage(e,t,r){let i=new K;return e?(i.appendBits(t-1,2),i.appendBits(r-1,6),i=Ee.generateCheckWords(i,28,4)):(i.appendBits(t-1,5),i.appendBits(r-1,11),i=Ee.generateCheckWords(i,40,4)),i}static drawModeMessage(e,t,r,i){let a=B.truncDivision(r,2);if(t)for(let l=0;l<7;l++){let d=a-3+l;i.get(l)&&e.set(d,a-5),i.get(l+7)&&e.set(a+5,d),i.get(20-l)&&e.set(d,a+5),i.get(27-l)&&e.set(a-5,d)}else for(let l=0;l<10;l++){let d=a-5+l+B.truncDivision(l,5);i.get(l)&&e.set(d,a-7),i.get(l+10)&&e.set(a+7,d),i.get(29-l)&&e.set(d,a+7),i.get(39-l)&&e.set(a-7,d)}}static generateCheckWords(e,t,r){let i=e.getSize()/r,a=new Ds(Ee.getGF(r)),l=B.truncDivision(t,r),d=Ee.bitsToWords(e,r,l);a.encode(d,l-i);let g=t%r,x=new K;x.appendBits(0,g);for(const y of Array.from(d))x.appendBits(y,r);return x}static bitsToWords(e,t,r){let i=new Int32Array(r),a,l;for(a=0,l=e.getSize()/t;a<l;a++){let d=0;for(let g=0;g<t;g++)d|=e.get(a*t+g)?1<<t-g-1:0;i[a]=d}return i}static getGF(e){switch(e){case 4:return ve.AZTEC_PARAM;case 6:return ve.AZTEC_DATA_6;case 8:return ve.AZTEC_DATA_8;case 10:return ve.AZTEC_DATA_10;case 12:return ve.AZTEC_DATA_12;default:throw new N("Unsupported word size "+e)}}static stuffBits(e,t){let r=new K,i=e.getSize(),a=(1<<t)-2;for(let l=0;l<i;l+=t){let d=0;for(let g=0;g<t;g++)(l+g>=i||e.get(l+g))&&(d|=1<<t-1-g);(d&a)===a?(r.appendBits(d&a,t),l--):d&a?r.appendBits(d,t):(r.appendBits(d|1,t),l--)}return r}static totalBitsInLayer(e,t){return((t?88:112)+16*e)*e}}Ee.DEFAULT_EC_PERCENT=33,Ee.DEFAULT_AZTEC_LAYERS=0,Ee.MAX_NB_BITS=32,Ee.MAX_NB_BITS_COMPACT=4,Ee.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Zr{encode(e,t,r,i){return this.encodeWithHints(e,t,r,i,null)}encodeWithHints(e,t,r,i,a){let l=Rs.ISO_8859_1,d=Ee.DEFAULT_EC_PERCENT,g=Ee.DEFAULT_AZTEC_LAYERS;return a!=null&&(a.has(lt.CHARACTER_SET)&&(l=Zi.forName(a.get(lt.CHARACTER_SET).toString())),a.has(lt.ERROR_CORRECTION)&&(d=B.parseInt(a.get(lt.ERROR_CORRECTION).toString())),a.has(lt.AZTEC_LAYERS)&&(g=B.parseInt(a.get(lt.AZTEC_LAYERS).toString()))),Zr.encodeLayers(e,t,r,i,l,d,g)}static encodeLayers(e,t,r,i,a,l,d){if(t!==oe.AZTEC)throw new N("Can only encode AZTEC, but got "+t);let g=Ee.encode(X.getBytes(e,a),l,d);return Zr.renderResult(g,r,i)}static renderResult(e,t,r){let i=e.getMatrix();if(i==null)throw new $t;let a=i.getWidth(),l=i.getHeight(),d=Math.max(t,a),g=Math.max(r,l),x=Math.min(d/a,g/l),y=(d-a*x)/2,C=(g-l*x)/2,v=new ce(d,g);for(let S=0,O=C;S<l;S++,O+=x)for(let D=0,P=y;D<a;D++,P+=x)i.get(D,S)&&v.setRegion(P,O,x,x);return v}}o.AbstractExpandedDecoder=As,o.ArgumentException=A,o.ArithmeticException=Dr,o.AztecCode=Wi,o.AztecCodeReader=kr,o.AztecCodeWriter=Zr,o.AztecDecoder=Le,o.AztecDetector=Mi,o.AztecDetectorResult=Ti,o.AztecEncoder=Ee,o.AztecHighLevelEncoder=br,o.AztecPoint=Ct,o.BarcodeFormat=oe,o.Binarizer=H,o.BinaryBitmap=I,o.BitArray=K,o.BitMatrix=ce,o.BitSource=_s,o.BrowserAztecCodeReader=nl,o.BrowserBarcodeReader=ol,o.BrowserCodeReader=Wt,o.BrowserDatamatrixCodeReader=cl,o.BrowserMultiFormatReader=bl,o.BrowserPDF417Reader=Cl,o.BrowserQRCodeReader=Al,o.BrowserQRCodeSvgWriter=Un,o.CharacterSetECI=L,o.ChecksumException=M,o.Code128Reader=se,o.Code39Reader=at,o.DataMatrixDecodedBitStreamParser=yn,o.DataMatrixReader=wn,o.DecodeHintType=re,o.DecoderResult=Rn,o.DefaultGridSampler=Oi,o.DetectorResult=Rr,o.EAN13Reader=kn,o.EncodeHintType=lt,o.Exception=p,o.FormatException=$,o.GenericGF=ve,o.GenericGFPoly=ft,o.GlobalHistogramBinarizer=Me,o.GridSampler=ys,o.GridSamplerInstance=mn,o.HTMLCanvasElementLuminanceSource=Et,o.HybridBinarizer=de,o.ITFReader=je,o.IllegalArgumentException=N,o.IllegalStateException=$t,o.InvertedLuminanceSource=Lt,o.LuminanceSource=on,o.MathUtils=Ne,o.MultiFormatOneDReader=Kn,o.MultiFormatReader=Vi,o.MultiFormatWriter=El,o.NotFoundException=z,o.OneDReader=rt,o.PDF417DecodedBitStreamParser=V,o.PDF417DecoderErrorCorrection=Bi,o.PDF417Reader=mt,o.PDF417ResultMetadata=Fi,o.PerspectiveTransform=Gt,o.PlanarYUVLuminanceSource=en,o.QRCodeByteMatrix=Hr,o.QRCodeDataMask=Pt,o.QRCodeDecodedBitStreamParser=We,o.QRCodeDecoderErrorCorrectionLevel=Be,o.QRCodeDecoderFormatInformation=wt,o.QRCodeEncoder=Ue,o.QRCodeEncoderQRCode=Fn,o.QRCodeMaskUtil=qe,o.QRCodeMatrixUtil=ge,o.QRCodeMode=he,o.QRCodeReader=bn,o.QRCodeVersion=ue,o.QRCodeWriter=er,o.RGBLuminanceSource=js,o.RSS14Reader=Xe,o.RSSExpandedReader=q,o.ReaderException=zr,o.ReedSolomonDecoder=dr,o.ReedSolomonEncoder=Ds,o.ReedSolomonException=Xn,o.Result=it,o.ResultMetadataType=Fe,o.ResultPoint=le,o.StringUtils=X,o.UnsupportedOperationException=Oe,o.VideoInputDevice=gn,o.WhiteRectangleDetector=ln,o.WriterException=Re,o.ZXingArrays=G,o.ZXingCharset=Zi,o.ZXingInteger=B,o.ZXingStandardCharsets=Rs,o.ZXingStringBuilder=te,o.ZXingStringEncoding=R,o.ZXingSystem=k,o.createAbstractExpandedDecoder=ki,Object.defineProperty(o,"__esModule",{value:!0})})})(si,si.exports);var ze=si.exports;const Rd=kl(ze),kd=lc({__proto__:null,default:Rd},[ze]);var xa=function(){function n(s,o,u){if(this.formatMap=new Map([[ae.QR_CODE,ze.BarcodeFormat.QR_CODE],[ae.AZTEC,ze.BarcodeFormat.AZTEC],[ae.CODABAR,ze.BarcodeFormat.CODABAR],[ae.CODE_39,ze.BarcodeFormat.CODE_39],[ae.CODE_93,ze.BarcodeFormat.CODE_93],[ae.CODE_128,ze.BarcodeFormat.CODE_128],[ae.DATA_MATRIX,ze.BarcodeFormat.DATA_MATRIX],[ae.MAXICODE,ze.BarcodeFormat.MAXICODE],[ae.ITF,ze.BarcodeFormat.ITF],[ae.EAN_13,ze.BarcodeFormat.EAN_13],[ae.EAN_8,ze.BarcodeFormat.EAN_8],[ae.PDF_417,ze.BarcodeFormat.PDF_417],[ae.RSS_14,ze.BarcodeFormat.RSS_14],[ae.RSS_EXPANDED,ze.BarcodeFormat.RSS_EXPANDED],[ae.UPC_A,ze.BarcodeFormat.UPC_A],[ae.UPC_E,ze.BarcodeFormat.UPC_E],[ae.UPC_EAN_EXTENSION,ze.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!kd)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=o,this.logger=u;var h=this.createZXingFormats(s),f=new Map;f.set(ze.DecodeHintType.POSSIBLE_FORMATS,h),f.set(ze.DecodeHintType.TRY_HARDER,!1),this.hints=f}return n.prototype.decodeAsync=function(s){var o=this;return new Promise(function(u,h){try{u(o.decode(s))}catch(f){h(f)}})},n.prototype.decode=function(s){var o=new ze.MultiFormatReader(this.verbose,this.hints),u=new ze.HTMLCanvasElementLuminanceSource(s),h=new ze.BinaryBitmap(new ze.HybridBinarizer(u)),f=o.decode(h);return{text:f.text,format:No.create(this.toHtml5QrcodeSupportedFormats(f.format)),debugData:this.createDebugData()}},n.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(o,u,h){s.set(o,u)}),s},n.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},n.prototype.createZXingFormats=function(s){for(var o=[],u=0,h=s;u<h.length;u++){var f=h[u];this.formatMap.has(f)?o.push(this.formatMap.get(f)):this.logger.logError("".concat(f," is not supported by")+"ZXingHtml5QrcodeShim")}return o},n.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},n}(),Ld=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},Bd=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},ma=function(){function n(s,o,u){if(this.formatMap=new Map([[ae.QR_CODE,"qr_code"],[ae.AZTEC,"aztec"],[ae.CODABAR,"codabar"],[ae.CODE_39,"code_39"],[ae.CODE_93,"code_93"],[ae.CODE_128,"code_128"],[ae.DATA_MATRIX,"data_matrix"],[ae.ITF,"itf"],[ae.EAN_13,"ean_13"],[ae.EAN_8,"ean_8"],[ae.PDF_417,"pdf417"],[ae.UPC_A,"upc_a"],[ae.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!n.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=o,this.logger=u;var h=this.createBarcodeDetectorFormats(s);if(this.detector=new BarcodeDetector(h),!this.detector)throw"BarcodeDetector detector not supported"}return n.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var s=new BarcodeDetector({formats:["qr_code"]});return typeof s<"u"},n.prototype.decodeAsync=function(s){return Ld(this,void 0,void 0,function(){var o,u;return Bd(this,function(h){switch(h.label){case 0:return[4,this.detector.detect(s)];case 1:if(o=h.sent(),!o||o.length===0)throw"No barcode or QR code detected.";return u=this.selectLargestBarcode(o),[2,{text:u.rawValue,format:No.create(this.toHtml5QrcodeSupportedFormats(u.format)),debugData:this.createDebugData()}]}})})},n.prototype.selectLargestBarcode=function(s){for(var o=null,u=0,h=0,f=s;h<f.length;h++){var m=f[h],w=m.boundingBox.width*m.boundingBox.height;w>u&&(u=w,o=m)}if(!o)throw"No largest barcode found";return o},n.prototype.createBarcodeDetectorFormats=function(s){for(var o=[],u=0,h=s;u<h.length;u++){var f=h[u];this.formatMap.has(f)?o.push(this.formatMap.get(f)):this.logger.warn("".concat(f," is not supported by")+"BarcodeDetectorDelegate")}return{formats:o}},n.prototype.toHtml5QrcodeSupportedFormats=function(s){if(!this.reverseFormatMap.has(s))throw"reverseFormatMap doesn't have ".concat(s);return this.reverseFormatMap.get(s)},n.prototype.createReverseFormatMap=function(){var s=new Map;return this.formatMap.forEach(function(o,u,h){s.set(o,u)}),s},n.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},n}(),pa=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},ya=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Pd=function(){function n(s,o,u,h){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=u,o&&ma.isSupported()?(this.primaryDecoder=new ma(s,u,h),this.secondaryDecoder=new xa(s,u,h)):this.primaryDecoder=new xa(s,u,h)}return n.prototype.decodeAsync=function(s){return pa(this,void 0,void 0,function(){var o;return ya(this,function(u){switch(u.label){case 0:o=performance.now(),u.label=1;case 1:return u.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(s)];case 2:return[2,u.sent()];case 3:return this.possiblyLogPerformance(o),[7];case 4:return[2]}})})},n.prototype.decodeRobustlyAsync=function(s){return pa(this,void 0,void 0,function(){var o,u;return ya(this,function(h){switch(h.label){case 0:o=performance.now(),h.label=1;case 1:return h.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(s)];case 2:return[2,h.sent()];case 3:if(u=h.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(s)];throw u;case 4:return this.possiblyLogPerformance(o),[7];case 5:return[2]}})})},n.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},n.prototype.possiblyLogPerformance=function(s){if(this.verbose){var o=performance.now()-s;this.executionResults.push(o),this.executions++,this.possiblyFlushPerformanceReport()}},n.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var s=0,o=0,u=this.executionResults;o<u.length;o++){var h=u[o];s+=h}var f=s/this.executionResults.length;console.log("".concat(f," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},n}(),mi=function(){var n=function(s,o){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(u[f]=h[f])},n(s,o)};return function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(s,o);function u(){this.constructor=s}s.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}(),ns=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},rs=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},So=function(){function n(s,o){this.name=s,this.track=o}return n.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},n.prototype.apply=function(s){var o={};o[this.name]=s;var u={advanced:[o]};return this.track.applyConstraints(u)},n.prototype.value=function(){var s=this.track.getSettings();if(this.name in s){var o=s[this.name];return o}return null},n}(),Fd=function(n){mi(s,n);function s(o,u){return n.call(this,o,u)||this}return s.prototype.min=function(){return this.getCapabilities().min},s.prototype.max=function(){return this.getCapabilities().max},s.prototype.step=function(){return this.getCapabilities().step},s.prototype.apply=function(o){var u={};u[this.name]=o;var h={advanced:[u]};return this.track.applyConstraints(h)},s.prototype.getCapabilities=function(){this.failIfNotSupported();var o=this.track.getCapabilities(),u=o[this.name];return{min:u.min,max:u.max,step:u.step}},s.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},s}(So),Ud=function(n){mi(s,n);function s(o){return n.call(this,"zoom",o)||this}return s}(Fd),zd=function(n){mi(s,n);function s(o){return n.call(this,"torch",o)||this}return s}(So),Hd=function(){function n(s){this.track=s}return n.prototype.zoomFeature=function(){return new Ud(this.track)},n.prototype.torchFeature=function(){return new zd(this.track)},n}(),Vd=function(){function n(s,o,u){this.isClosed=!1,this.parentElement=s,this.mediaStream=o,this.callbacks=u,this.surface=this.createVideoElement(this.parentElement.clientWidth),s.append(this.surface)}return n.prototype.createVideoElement=function(s){var o=document.createElement("video");return o.style.width="".concat(s,"px"),o.style.display="block",o.muted=!0,o.setAttribute("muted","true"),o.playsInline=!0,o},n.prototype.setupSurface=function(){var s=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var o=function(){var u=s.surface.clientWidth,h=s.surface.clientHeight;s.callbacks.onRenderSurfaceReady(u,h),s.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.srcObject=this.mediaStream,this.surface.play()},n.create=function(s,o,u,h){return ns(this,void 0,void 0,function(){var f,m;return rs(this,function(w){switch(w.label){case 0:return f=new n(s,o,h),u.aspectRatio?(m={aspectRatio:u.aspectRatio},[4,f.getFirstTrackOrFail().applyConstraints(m)]):[3,2];case 1:w.sent(),w.label=2;case 2:return f.setupSurface(),[2,f]}})})},n.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},n.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},n.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},n.prototype.resume=function(s){this.failIfClosed();var o=this,u=function(){setTimeout(s,200),o.surface.removeEventListener("playing",u)};this.surface.addEventListener("playing",u),this.surface.play()},n.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},n.prototype.getSurface=function(){return this.failIfClosed(),this.surface},n.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},n.prototype.applyVideoConstraints=function(s){return ns(this,void 0,void 0,function(){return rs(this,function(o){if("aspectRatio"in s)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(s)]})})},n.prototype.close=function(){if(this.isClosed)return Promise.resolve();var s=this;return new Promise(function(o,u){var h=s.mediaStream.getVideoTracks(),f=h.length,m=0;s.mediaStream.getVideoTracks().forEach(function(w){s.mediaStream.removeTrack(w),w.stop(),++m,m>=f&&(s.isClosed=!0,s.parentElement.removeChild(s.surface),o())})})},n.prototype.getCapabilities=function(){return new Hd(this.getFirstTrackOrFail())},n}(),Zd=function(){function n(s){this.mediaStream=s}return n.prototype.render=function(s,o,u){return ns(this,void 0,void 0,function(){return rs(this,function(h){return[2,Vd.create(s,this.mediaStream,o,u)]})})},n.create=function(s){return ns(this,void 0,void 0,function(){var o,u;return rs(this,function(h){switch(h.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return o={audio:!1,video:s},[4,navigator.mediaDevices.getUserMedia(o)];case 1:return u=h.sent(),[2,new n(u)]}})})},n}(),wa=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},ba=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Wd=function(){function n(){}return n.failIfNotSupported=function(){return wa(this,void 0,void 0,function(){return ba(this,function(s){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new n]})})},n.prototype.create=function(s){return wa(this,void 0,void 0,function(){return ba(this,function(o){return[2,Zd.create(s)]})})},n}(),Gd=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},Yd=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Xd=function(){function n(){}return n.retrieve=function(){if(navigator.mediaDevices)return n.getCamerasFromMediaDevices();var s=MediaStreamTrack;return MediaStreamTrack&&s.getSources?n.getCamerasFromMediaStreamTrack():n.rejectWithError()},n.rejectWithError=function(){var s=sr.unableToQuerySupportedDevices();return n.isHttpsOrLocalhost()||(s=sr.insecureContextCameraQueryError()),Promise.reject(s)},n.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var s=location.host.split(":")[0];return s==="127.0.0.1"||s==="localhost"},n.getCamerasFromMediaDevices=function(){return Gd(this,void 0,void 0,function(){var s,o,u,h,f,m,w;return Yd(this,function(E){switch(E.label){case 0:return s=function(p){for(var A=p.getVideoTracks(),N=0,I=A;N<I.length;N++){var M=I[N];M.enabled=!1,M.stop(),p.removeTrack(M)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return o=E.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(u=E.sent(),h=[],f=0,m=u;f<m.length;f++)w=m[f],w.kind==="videoinput"&&h.push({id:w.deviceId,label:w.label});return s(o),[2,h]}})})},n.getCamerasFromMediaStreamTrack=function(){return new Promise(function(s,o){var u=function(f){for(var m=[],w=0,E=f;w<E.length;w++){var p=E[w];p.kind==="video"&&m.push({id:p.id,label:p.label})}s(m)},h=MediaStreamTrack;h.getSources(u)})},n}(),$e;(function(n){n[n.UNKNOWN=0]="UNKNOWN",n[n.NOT_STARTED=1]="NOT_STARTED",n[n.SCANNING=2]="SCANNING",n[n.PAUSED=3]="PAUSED"})($e||($e={}));var qd=function(){function n(){this.state=$e.NOT_STARTED,this.onGoingTransactionNewState=$e.UNKNOWN}return n.prototype.directTransition=function(s){this.failIfTransitionOngoing(),this.validateTransition(s),this.state=s},n.prototype.startTransition=function(s){return this.failIfTransitionOngoing(),this.validateTransition(s),this.onGoingTransactionNewState=s,this},n.prototype.execute=function(){if(this.onGoingTransactionNewState===$e.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var s=this.onGoingTransactionNewState;this.onGoingTransactionNewState=$e.UNKNOWN,this.directTransition(s)},n.prototype.cancel=function(){if(this.onGoingTransactionNewState===$e.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=$e.UNKNOWN},n.prototype.getState=function(){return this.state},n.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==$e.UNKNOWN)throw"Cannot transition to a new state, already under transition"},n.prototype.validateTransition=function(s){switch(this.state){case $e.UNKNOWN:throw"Transition from unknown is not allowed";case $e.NOT_STARTED:this.failIfNewStateIs(s,[$e.PAUSED]);break;case $e.SCANNING:break;case $e.PAUSED:break}},n.prototype.failIfNewStateIs=function(s,o){for(var u=0,h=o;u<h.length;u++){var f=h[u];if(s===f)throw"Cannot transition from ".concat(this.state," to ").concat(s)}},n}(),$d=function(){function n(s){this.stateManager=s}return n.prototype.startTransition=function(s){return this.stateManager.startTransition(s)},n.prototype.directTransition=function(s){this.stateManager.directTransition(s)},n.prototype.getState=function(){return this.stateManager.getState()},n.prototype.canScanFile=function(){return this.stateManager.getState()===$e.NOT_STARTED},n.prototype.isScanning=function(){return this.stateManager.getState()!==$e.NOT_STARTED},n.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===$e.SCANNING},n.prototype.isPaused=function(){return this.stateManager.getState()===$e.PAUSED},n}(),Qd=function(){function n(){}return n.create=function(){return new $d(new qd)},n}(),Kd=function(){var n=function(s,o){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,h){u.__proto__=h}||function(u,h){for(var f in h)Object.prototype.hasOwnProperty.call(h,f)&&(u[f]=h[f])},n(s,o)};return function(s,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");n(s,o);function u(){this.constructor=s}s.prototype=o===null?Object.create(o):(u.prototype=o.prototype,new u)}}(),jt=function(n){Kd(s,n);function s(){return n!==null&&n.apply(this,arguments)||this}return s.DEFAULT_WIDTH=300,s.DEFAULT_WIDTH_OFFSET=2,s.FILE_SCAN_MIN_HEIGHT=300,s.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,s.MIN_QR_BOX_SIZE=50,s.SHADED_LEFT=1,s.SHADED_RIGHT=2,s.SHADED_TOP=3,s.SHADED_BOTTOM=4,s.SHADED_REGION_ELEMENT_ID="qr-shaded-region",s.VERBOSE=!1,s.BORDER_SHADER_DEFAULT_COLOR="#ffffff",s.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",s}(qt),Jd=function(){function n(s,o){this.logger=o,this.fps=jt.SCAN_DEFAULT_FPS,s?(s.fps&&(this.fps=s.fps),this.disableFlip=s.disableFlip===!0,this.qrbox=s.qrbox,this.aspectRatio=s.aspectRatio,this.videoConstraints=s.videoConstraints):this.disableFlip=jt.DEFAULT_DISABLE_FLIP}return n.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?_o.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},n.prototype.isShadedBoxEnabled=function(){return!rn(this.qrbox)},n.create=function(s,o){return new n(s,o)},n}(),Ca=function(){function n(s,o){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.elementId=s,this.verbose=!1;var u;typeof o=="boolean"?this.verbose=o===!0:o&&(u=o,this.verbose=u.verbose===!0,u.experimentalFeatures),this.logger=new vo(this.verbose),this.qrcode=new Pd(this.getSupportedFormats(o),this.getUseBarCodeDetectorIfSupported(u),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=Qd.create()}return n.prototype.start=function(s,o,u,h){var f=this;if(!s)throw"cameraIdOrConfig is required";if(!u||typeof u!="function")throw"qrCodeSuccessCallback is required and should be a function.";var m;h?m=h:m=this.verbose?this.logger.log:function(){};var w=Jd.create(o,this.logger);this.clearElement();var E=!1;w.videoConstraints&&(w.isMediaStreamConstraintsValid()?E=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var p=E,A=document.getElementById(this.elementId);A.clientWidth?A.clientWidth:jt.DEFAULT_WIDTH,A.style.position="relative",this.shouldScan=!0,this.element=A;var N=this,I=this.stateManagerProxy.startTransition($e.SCANNING);return new Promise(function(M,H){var k=p?w.videoConstraints:N.createVideoConstraints(s);if(!k){I.cancel(),H("videoConstraints should be defined");return}var j={};(!p||w.aspectRatio)&&(j.aspectRatio=w.aspectRatio);var W={onRenderSurfaceReady:function(G,B){N.setupUi(G,B,w),N.isScanning=!0,N.foreverScan(w,u,m)}};Wd.failIfNotSupported().then(function(G){G.create(k).then(function(B){return B.render(f.element,j,W).then(function(K){N.renderedCamera=K,I.execute(),M(null)}).catch(function(K){I.cancel(),H(K)})}).catch(function(B){I.cancel(),H(sr.errorGettingUserMedia(B))})}).catch(function(G){I.cancel(),H(sr.cameraStreamingNotSupported())})})},n.prototype.pause=function(s){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition($e.PAUSED),this.showPausedState(),(rn(s)||s!==!0)&&(s=!1),s&&this.renderedCamera&&this.renderedCamera.pause()},n.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var s=this,o=function(){s.stateManagerProxy.directTransition($e.SCANNING),s.hidePausedState()};if(!this.renderedCamera.isPaused()){o();return}this.renderedCamera.resume(function(){o()})},n.prototype.getState=function(){return this.stateManagerProxy.getState()},n.prototype.stop=function(){var s=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var o=this.stateManagerProxy.startTransition($e.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var u=function(){if(s.element){var f=document.getElementById(jt.SHADED_REGION_ELEMENT_ID);f&&s.element.removeChild(f)}},h=this;return this.renderedCamera.close().then(function(){return h.renderedCamera=null,h.element&&(h.element.removeChild(h.canvasElement),h.canvasElement=null),u(),h.qrRegion&&(h.qrRegion=null),h.context&&(h.context=null),o.execute(),h.hidePausedState(),h.isScanning=!1,Promise.resolve()})},n.prototype.scanFile=function(s,o){return this.scanFileV2(s,o).then(function(u){return u.decodedText})},n.prototype.scanFileV2=function(s,o){var u=this;if(!s||!(s instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(rn(o)&&(o=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(h,f){u.possiblyCloseLastScanImageFile(),u.clearElement(),u.lastScanImageFile=URL.createObjectURL(s);var m=new Image;m.onload=function(){var w=m.width,E=m.height,p=document.getElementById(u.elementId),A=p.clientWidth?p.clientWidth:jt.DEFAULT_WIDTH,N=Math.max(p.clientHeight?p.clientHeight:E,jt.FILE_SCAN_MIN_HEIGHT),I=u.computeCanvasDrawConfig(w,E,A,N);if(o){var M=u.createCanvasElement(A,N,"qr-canvas-visible");M.style.display="inline-block",p.appendChild(M);var H=M.getContext("2d");if(!H)throw"Unable to get 2d context from canvas";H.canvas.width=A,H.canvas.height=N,H.drawImage(m,0,0,w,E,I.x,I.y,I.width,I.height)}var k=jt.FILE_SCAN_HIDDEN_CANVAS_PADDING,j=Math.max(m.width,I.width),W=Math.max(m.height,I.height),G=j+2*k,B=W+2*k,K=u.createCanvasElement(G,B);p.appendChild(K);var we=K.getContext("2d");if(!we)throw"Unable to get 2d context from canvas";we.canvas.width=G,we.canvas.height=B,we.drawImage(m,0,0,w,E,k,k,j,W);try{u.qrcode.decodeRobustlyAsync(K).then(function(re){h(fa.createFromQrcodeResult(re))}).catch(f)}catch(re){f("QR code parse error, error = ".concat(re))}},m.onerror=f,m.onabort=f,m.onstalled=f,m.onsuspend=f,m.src=URL.createObjectURL(s)})},n.prototype.clear=function(){this.clearElement()},n.getCameras=function(){return Xd.retrieve()},n.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},n.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},n.prototype.applyVideoConstraints=function(s){if(s){if(!_o.isMediaStreamConstraintsValid(s,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(s)},n.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},n.prototype.getSupportedFormats=function(s){var o=[ae.QR_CODE,ae.AZTEC,ae.CODABAR,ae.CODE_39,ae.CODE_93,ae.CODE_128,ae.DATA_MATRIX,ae.MAXICODE,ae.ITF,ae.EAN_13,ae.EAN_8,ae.PDF_417,ae.RSS_14,ae.RSS_EXPANDED,ae.UPC_A,ae.UPC_E,ae.UPC_EAN_EXTENSION];if(!s||typeof s=="boolean"||!s.formatsToSupport)return o;if(!Array.isArray(s.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(s.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var u=[],h=0,f=s.formatsToSupport;h<f.length;h++){var m=f[h];Dd(m)?u.push(m):this.logger.warn("Invalid format: ".concat(m," passed in config, ignoring."))}if(u.length===0)throw"None of formatsToSupport match supported values.";return u},n.prototype.getUseBarCodeDetectorIfSupported=function(s){if(rn(s))return!0;if(!rn(s.useBarCodeDetectorIfSupported))return s.useBarCodeDetectorIfSupported!==!1;if(rn(s.experimentalFeatures))return!0;var o=s.experimentalFeatures;return rn(o.useBarCodeDetectorIfSupported)?!0:o.useBarCodeDetectorIfSupported!==!1},n.prototype.validateQrboxSize=function(s,o,u){var h=this,f=u.qrbox;this.validateQrboxConfig(f);var m=this.toQrdimensions(s,o,f),w=function(p){if(p<jt.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(jt.MIN_QR_BOX_SIZE,"px.")},E=function(p){return p>s&&(h.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),p=s),p};w(m.width),w(m.height),m.width=E(m.width)},n.prototype.validateQrboxConfig=function(s){if(typeof s!="number"&&typeof s!="function"&&(s.width===void 0||s.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},n.prototype.toQrdimensions=function(s,o,u){if(typeof u=="number")return{width:u,height:u};if(typeof u=="function")try{return u(s,o)}catch(h){throw new Error("qrbox config was passed as a function but it failed with unknown error"+h)}return u},n.prototype.setupUi=function(s,o,u){u.isShadedBoxEnabled()&&this.validateQrboxSize(s,o,u);var h=rn(u.qrbox)?{width:s,height:o}:u.qrbox;this.validateQrboxConfig(h);var f=this.toQrdimensions(s,o,h);f.height>o&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var m=u.isShadedBoxEnabled()&&f.height<=o,w={x:0,y:0,width:s,height:o},E=m?this.getShadedRegionBounds(s,o,f):w,p=this.createCanvasElement(E.width,E.height),A={willReadFrequently:!0},N=p.getContext("2d",A);N.canvas.width=E.width,N.canvas.height=E.height,this.element.append(p),m&&this.possiblyInsertShadingElement(this.element,s,o,f),this.createScannerPausedUiElement(this.element),this.qrRegion=E,this.context=N,this.canvasElement=p},n.prototype.createScannerPausedUiElement=function(s){var o=document.createElement("div");o.innerText=sr.scannerPaused(),o.style.display="none",o.style.position="absolute",o.style.top="0px",o.style.zIndex="1",o.style.background="rgba(9, 9, 9, 0.46)",o.style.color="#FFECEC",o.style.textAlign="center",o.style.width="100%",s.appendChild(o),this.scannerPausedUiElement=o},n.prototype.scanContext=function(s,o){var u=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(h){return s(h.text,fa.createFromQrcodeResult(h)),u.possiblyUpdateShaders(!0),!0}).catch(function(h){u.possiblyUpdateShaders(!1);var f=sr.codeParseError(h);return o(f,Eo.createFrom(f)),!1})},n.prototype.foreverScan=function(s,o,u){var h=this;if(this.shouldScan&&this.renderedCamera){var f=this.renderedCamera.getSurface(),m=f.videoWidth/f.clientWidth,w=f.videoHeight/f.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var E=this.qrRegion.width*m,p=this.qrRegion.height*w,A=this.qrRegion.x*m,N=this.qrRegion.y*w;this.context.drawImage(f,A,N,E,p,0,0,this.qrRegion.width,this.qrRegion.height);var I=function(){h.foreverScanTimeout=setTimeout(function(){h.foreverScan(s,o,u)},h.getTimeoutFps(s.fps))};this.scanContext(o,u).then(function(M){!M&&s.disableFlip!==!0?(h.context.translate(h.context.canvas.width,0),h.context.scale(-1,1),h.scanContext(o,u).finally(function(){I()})):I()}).catch(function(M){h.logger.logError("Error happend while scanning context",M),I()})}},n.prototype.createVideoConstraints=function(s){if(typeof s=="string")return{deviceId:{exact:s}};if(typeof s=="object"){var o="facingMode",u="deviceId",h={user:!0,environment:!0},f="exact",m=function(H){if(H in h)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(H,"'")},w=Object.keys(s);if(w.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(w.length," keys");var E=Object.keys(s)[0];if(E!==o&&E!==u)throw"Only '".concat(o,"' and '").concat(u,"' ")+" are supported for 'cameraIdOrConfig'";if(E===o){var p=s.facingMode;if(typeof p=="string"){if(m(p))return{facingMode:p}}else if(typeof p=="object")if(f in p){if(m(p["".concat(f)]))return{facingMode:{exact:p["".concat(f)]}}}else throw"'facingMode' should be string or object with"+" ".concat(f," as key.");else{var A=typeof p;throw"Invalid type of 'facingMode' = ".concat(A)}}else{var N=s.deviceId;if(typeof N=="string")return{deviceId:N};if(typeof N=="object"){if(f in N)return{deviceId:{exact:N["".concat(f)]}};throw"'deviceId' should be string or object with"+" ".concat(f," as key.")}else{var I=typeof N;throw"Invalid type of 'deviceId' = ".concat(I)}}}var M=typeof s;throw"Invalid type of 'cameraIdOrConfig' = ".concat(M)},n.prototype.computeCanvasDrawConfig=function(s,o,u,h){if(s<=u&&o<=h){var f=(u-s)/2,m=(h-o)/2;return{x:f,y:m,width:s,height:o}}else{var w=s,E=o;return s>u&&(o=u/s*o,s=u),o>h&&(s=h/o*s,o=h),this.logger.log("Image downsampled from "+"".concat(w,"X").concat(E)+" to ".concat(s,"X").concat(o,".")),this.computeCanvasDrawConfig(s,o,u,h)}},n.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var s=document.getElementById(this.elementId);s&&(s.innerHTML="")},n.prototype.possiblyUpdateShaders=function(s){this.qrMatch!==s&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(o){o.style.backgroundColor=s?jt.BORDER_SHADER_MATCH_COLOR:jt.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=s)},n.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},n.prototype.createCanvasElement=function(s,o,u){var h=s,f=o,m=document.createElement("canvas");return m.style.width="".concat(h,"px"),m.style.height="".concat(f,"px"),m.style.display="none",m.id=rn(u)?"qr-canvas":u,m},n.prototype.getShadedRegionBounds=function(s,o,u){if(u.width>s||u.height>o)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(s-u.width)/2,y:(o-u.height)/2,width:u.width,height:u.height}},n.prototype.possiblyInsertShadingElement=function(s,o,u,h){if(!(o-h.width<1||u-h.height<1)){var f=document.createElement("div");f.style.position="absolute";var m=(o-h.width)/2,w=(u-h.height)/2;if(f.style.borderLeft="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderRight="".concat(m,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderTop="".concat(w,"px solid rgba(0, 0, 0, 0.48)"),f.style.borderBottom="".concat(w,"px solid rgba(0, 0, 0, 0.48)"),f.style.boxSizing="border-box",f.style.top="0px",f.style.bottom="0px",f.style.left="0px",f.style.right="0px",f.id="".concat(jt.SHADED_REGION_ELEMENT_ID),o-h.width<11||u-h.height<11)this.hasBorderShaders=!1;else{var E=5,p=40;this.insertShaderBorders(f,p,E,-E,null,0,!0),this.insertShaderBorders(f,p,E,-E,null,0,!1),this.insertShaderBorders(f,p,E,null,-E,0,!0),this.insertShaderBorders(f,p,E,null,-E,0,!1),this.insertShaderBorders(f,E,p+E,-E,null,-E,!0),this.insertShaderBorders(f,E,p+E,null,-E,-E,!0),this.insertShaderBorders(f,E,p+E,-E,null,-E,!1),this.insertShaderBorders(f,E,p+E,null,-E,-E,!1),this.hasBorderShaders=!0}s.append(f)}},n.prototype.insertShaderBorders=function(s,o,u,h,f,m,w){var E=document.createElement("div");E.style.position="absolute",E.style.backgroundColor=jt.BORDER_SHADER_DEFAULT_COLOR,E.style.width="".concat(o,"px"),E.style.height="".concat(u,"px"),h!==null&&(E.style.top="".concat(h,"px")),f!==null&&(E.style.bottom="".concat(f,"px")),w?E.style.left="".concat(m,"px"):E.style.right="".concat(m,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(E),s.appendChild(E)},n.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},n.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},n.prototype.getTimeoutFps=function(s){return 1e3/s},n}(),pi="data:image/svg+xml;base64,",e0=pi+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",t0=pi+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",Aa=pi+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",n0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",Na=function(){function n(){}return n.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},n}(),r0=function(){function n(){this.data=Na.createDefault();var s=localStorage.getItem(n.LOCAL_STORAGE_KEY);s?this.data=JSON.parse(s):this.reset()}return n.prototype.hasCameraPermissions=function(){return this.data.hasPermission},n.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},n.prototype.setHasPermission=function(s){this.data.hasPermission=s,this.flush()},n.prototype.setLastUsedCameraId=function(s){this.data.lastUsedCameraId=s,this.flush()},n.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},n.prototype.reset=function(){this.data=Na.createDefault(),this.flush()},n.prototype.flush=function(){localStorage.setItem(n.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},n.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",n}(),s0=function(){function n(){this.infoDiv=document.createElement("div")}return n.prototype.renderInto=function(s){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=ga.poweredBy();var o=document.createElement("a");o.innerText="ScanApp",o.href="https://scanapp.org",o.target="new",o.style.color="white",this.infoDiv.appendChild(o);var u=document.createElement("br"),h=document.createElement("br");this.infoDiv.appendChild(u),this.infoDiv.appendChild(h);var f=document.createElement("a");f.innerText=ga.reportIssues(),f.href="https://github.com/mebjas/html5-qrcode/issues",f.target="new",f.style.color="white",this.infoDiv.appendChild(f),s.appendChild(this.infoDiv)},n.prototype.show=function(){this.infoDiv.style.display="block"},n.prototype.hide=function(){this.infoDiv.style.display="none"},n}(),i0=function(){function n(s,o){this.isShowingInfoIcon=!0,this.onTapIn=s,this.onTapOut=o,this.infoIcon=document.createElement("img")}return n.prototype.renderInto=function(s){var o=this;this.infoIcon.alt="Info icon",this.infoIcon.src=Aa,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(u){return o.onHoverIn()},this.infoIcon.onmouseout=function(u){return o.onHoverOut()},this.infoIcon.onclick=function(u){return o.onClick()},s.appendChild(this.infoIcon)},n.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},n.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},n.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=n0,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=Aa,this.infoIcon.style.opacity="0.6")},n}(),a0=function(){function n(){var s=this;this.infoDiv=new s0,this.infoIcon=new i0(function(){s.infoDiv.show()},function(){s.infoDiv.hide()})}return n.prototype.renderInto=function(s){this.infoDiv.renderInto(s),this.infoIcon.renderInto(s)},n}(),o0=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},l0=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},Ea=function(){function n(){}return n.hasPermissions=function(){return o0(this,void 0,void 0,function(){var s,o,u,h;return l0(this,function(f){switch(f.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(s=f.sent(),o=0,u=s;o<u.length;o++)if(h=u[o],h.kind==="videoinput"&&h.label)return[2,!0];return[2,!1]}})})},n}(),Nn=function(){function n(s){this.supportedScanTypes=this.validateAndReturnScanTypes(s)}return n.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},n.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},n.prototype.isCameraScanRequired=function(){for(var s=0,o=this.supportedScanTypes;s<o.length;s++){var u=o[s];if(n.isCameraScanType(u))return!0}return!1},n.isCameraScanType=function(s){return s===Tn.SCAN_TYPE_CAMERA},n.isFileScanType=function(s){return s===Tn.SCAN_TYPE_FILE},n.prototype.validateAndReturnScanTypes=function(s){if(!s||s.length===0)return qt.DEFAULT_SUPPORTED_SCAN_TYPE;var o=qt.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(s.length>o)throw"Max ".concat(o," values expected for ")+"supportedScanTypes";for(var u=0,h=s;u<h.length;u++){var f=h[u];if(!qt.DEFAULT_SUPPORTED_SCAN_TYPE.includes(f))throw"Unsupported scan type ".concat(f)}return s},n}(),kt=function(){function n(){}return n.ALL_ELEMENT_CLASS="html5-qrcode-element",n.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",n.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",n.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",n.TORCH_BUTTON_ID="html5-qrcode-button-torch",n.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",n.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",n.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",n.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",n.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",n.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",n}(),un=function(){function n(){}return n.createElement=function(s,o){var u=document.createElement(s);return u.id=o,u.classList.add(kt.ALL_ELEMENT_CLASS),s==="button"&&u.setAttribute("type","button"),u},n}(),Io=function(n,s,o,u){function h(f){return f instanceof o?f:new o(function(m){m(f)})}return new(o||(o=Promise))(function(f,m){function w(A){try{p(u.next(A))}catch(N){m(N)}}function E(A){try{p(u.throw(A))}catch(N){m(N)}}function p(A){A.done?f(A.value):h(A.value).then(w,E)}p((u=u.apply(n,s||[])).next())})},To=function(n,s){var o={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},u,h,f,m;return m={next:w(0),throw:w(1),return:w(2)},typeof Symbol=="function"&&(m[Symbol.iterator]=function(){return this}),m;function w(p){return function(A){return E([p,A])}}function E(p){if(u)throw new TypeError("Generator is already executing.");for(;m&&(m=0,p[0]&&(o=0)),o;)try{if(u=1,h&&(f=p[0]&2?h.return:p[0]?h.throw||((f=h.return)&&f.call(h),0):h.next)&&!(f=f.call(h,p[1])).done)return f;switch(h=0,f&&(p=[p[0]&2,f.value]),p[0]){case 0:case 1:f=p;break;case 4:return o.label++,{value:p[1],done:!1};case 5:o.label++,h=p[1],p=[0];continue;case 7:p=o.ops.pop(),o.trys.pop();continue;default:if(f=o.trys,!(f=f.length>0&&f[f.length-1])&&(p[0]===6||p[0]===2)){o=0;continue}if(p[0]===3&&(!f||p[1]>f[0]&&p[1]<f[3])){o.label=p[1];break}if(p[0]===6&&o.label<f[1]){o.label=f[1],f=p;break}if(f&&o.label<f[2]){o.label=f[2],o.ops.push(p);break}f[2]&&o.ops.pop(),o.trys.pop();continue}p=s.call(n,o)}catch(A){p=[6,A],h=0}finally{u=f=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}},va=function(){function n(s,o,u){this.isTorchOn=!1,this.torchCapability=s,this.buttonController=o,this.onTorchActionFailureCallback=u}return n.prototype.isTorchEnabled=function(){return this.isTorchOn},n.prototype.flipState=function(){return Io(this,void 0,void 0,function(){var s,o;return To(this,function(u){switch(u.label){case 0:this.buttonController.disable(),s=!this.isTorchOn,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,this.torchCapability.apply(s)];case 2:return u.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),s),[3,4];case 3:return o=u.sent(),this.propagateFailure(s,o),this.buttonController.enable(),[3,4];case 4:return[2]}})})},n.prototype.updateUiBasedOnLatestSettings=function(s,o){s===o?(this.buttonController.setText(o?Te.torchOffButton():Te.torchOnButton()),this.isTorchOn=o):this.propagateFailure(o),this.buttonController.enable()},n.prototype.propagateFailure=function(s,o){var u=s?Te.torchOnFailedMessage():Te.torchOffFailedMessage();o&&(u+="; Error = "+o),this.onTorchActionFailureCallback(u)},n.prototype.reset=function(){this.isTorchOn=!1},n}(),c0=function(){function n(s,o){this.onTorchActionFailureCallback=o,this.torchButton=un.createElement("button",kt.TORCH_BUTTON_ID),this.torchController=new va(s,this,o)}return n.prototype.render=function(s,o){var u=this;this.torchButton.innerText=Te.torchOnButton(),this.torchButton.style.display=o.display,this.torchButton.style.marginLeft=o.marginLeft;var h=this;this.torchButton.addEventListener("click",function(f){return Io(u,void 0,void 0,function(){return To(this,function(m){switch(m.label){case 0:return[4,h.torchController.flipState()];case 1:return m.sent(),h.torchController.isTorchEnabled()?(h.torchButton.classList.remove(kt.TORCH_BUTTON_CLASS_TORCH_OFF),h.torchButton.classList.add(kt.TORCH_BUTTON_CLASS_TORCH_ON)):(h.torchButton.classList.remove(kt.TORCH_BUTTON_CLASS_TORCH_ON),h.torchButton.classList.add(kt.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),s.appendChild(this.torchButton)},n.prototype.updateTorchCapability=function(s){this.torchController=new va(s,this,this.onTorchActionFailureCallback)},n.prototype.getTorchButton=function(){return this.torchButton},n.prototype.hide=function(){this.torchButton.style.display="none"},n.prototype.show=function(){this.torchButton.style.display="inline-block"},n.prototype.disable=function(){this.torchButton.disabled=!0},n.prototype.enable=function(){this.torchButton.disabled=!1},n.prototype.setText=function(s){this.torchButton.innerText=s},n.prototype.reset=function(){this.torchButton.innerText=Te.torchOnButton(),this.torchController.reset()},n.create=function(s,o,u,h){var f=new n(o,h);return f.render(s,u),f},n}(),u0=function(){function n(s,o,u){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=o?"block":"none",s.appendChild(this.fileBasedScanRegion);var h=document.createElement("label");h.setAttribute("for",this.getFileScanInputId()),h.style.display="inline-block",this.fileBasedScanRegion.appendChild(h),this.fileSelectionButton=un.createElement("button",kt.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(w){h.click()}),h.append(this.fileSelectionButton),this.fileScanInput=un.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",h.appendChild(this.fileScanInput);var f=this;this.fileScanInput.addEventListener("change",function(w){if(!(w==null||w.target==null)){var E=w.target;if(!(E.files&&E.files.length===0)){var p=E.files,A=p[0],N=A.name;f.setImageNameToButton(N),u(A)}}});var m=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(m),this.fileBasedScanRegion.addEventListener("dragenter",function(w){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),w.stopPropagation(),w.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(w){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder(),w.stopPropagation(),w.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(w){f.fileBasedScanRegion.style.border=f.fileBasedScanRegionActiveBorder(),w.stopPropagation(),w.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(w){w.stopPropagation(),w.preventDefault(),f.fileBasedScanRegion.style.border=f.fileBasedScanRegionDefaultBorder();var E=w.dataTransfer;if(E){var p=E.files;if(!p||p.length===0)return;for(var A=!1,N=0;N<p.length;++N){var I=p.item(N);if(I){var M=/image.*/;if(I.type.match(M)){A=!0;var H=I.name;f.setImageNameToButton(H),u(I),m.innerText=Te.dragAndDropMessage();break}}}A||(m.innerText=Te.dragAndDropMessageOnlyImages())}})}return n.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},n.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},n.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},n.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},n.prototype.createFileBasedScanRegion=function(){var s=document.createElement("div");return s.style.textAlign="center",s.style.margin="auto",s.style.width="80%",s.style.maxWidth="600px",s.style.border=this.fileBasedScanRegionDefaultBorder(),s.style.padding="10px",s.style.marginBottom="10px",s},n.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},n.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},n.prototype.createDragAndDropMessage=function(){var s=document.createElement("div");return s.innerText=Te.dragAndDropMessage(),s.style.fontWeight="400",s},n.prototype.setImageNameToButton=function(s){var o=20;if(s.length>o){var u=s.substring(0,8),h=s.length,f=s.substring(h-8,h);s="".concat(u,"....").concat(f)}var m=Te.fileSelectionChooseAnother()+" - "+s;this.fileSelectionButton.innerText=m},n.prototype.setInitialValueToButton=function(){var s=Te.fileSelectionChooseImage()+" - "+Te.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=s},n.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},n.create=function(s,o,u){var h=new n(s,o,u);return h},n}(),d0=function(){function n(s){this.selectElement=un.createElement("select",kt.CAMERA_SELECTION_SELECT_ID),this.cameras=s,this.options=[]}return n.prototype.render=function(s){var o=document.createElement("span");o.style.marginRight="10px";var u=this.cameras.length;if(u===0)throw new Error("No cameras found");if(u===1)o.style.display="none";else{var h=Te.selectCamera();o.innerText="".concat(h," (").concat(this.cameras.length,")  ")}for(var f=1,m=0,w=this.cameras;m<w.length;m++){var E=w[m],p=E.id,A=E.label==null?p:E.label;(!A||A==="")&&(A=[Te.anonymousCameraPrefix(),f++].join(" "));var N=document.createElement("option");N.value=p,N.innerText=A,this.options.push(N),this.selectElement.appendChild(N)}o.appendChild(this.selectElement),s.appendChild(o)},n.prototype.disable=function(){this.selectElement.disabled=!0},n.prototype.isDisabled=function(){return this.selectElement.disabled===!0},n.prototype.enable=function(){this.selectElement.disabled=!1},n.prototype.getValue=function(){return this.selectElement.value},n.prototype.hasValue=function(s){for(var o=0,u=this.options;o<u.length;o++){var h=u[o];if(h.value===s)return!0}return!1},n.prototype.setValue=function(s){if(!this.hasValue(s))throw new Error("".concat(s," is not present in the camera list."));this.selectElement.value=s},n.prototype.hasSingleItem=function(){return this.cameras.length===1},n.prototype.numCameras=function(){return this.cameras.length},n.create=function(s,o){var u=new n(o);return u.render(s),u},n}(),h0=function(){function n(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=un.createElement("input",kt.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return n.prototype.render=function(s,o){this.zoomElementContainer.style.display=o?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",s.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var u=Te.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(u),this.rangeText.style.marginRight="10px";var h=this;this.rangeInput.addEventListener("input",function(){return h.onValueChange()}),this.rangeInput.addEventListener("change",function(){return h.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},n.prototype.onValueChange=function(){var s=Te.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(s),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},n.prototype.setValues=function(s,o,u,h){this.rangeInput.min=s.toString(),this.rangeInput.max=o.toString(),this.rangeInput.step=h.toString(),this.rangeInput.value=u.toString(),this.onValueChange()},n.prototype.show=function(){this.zoomElementContainer.style.display="block"},n.prototype.hide=function(){this.zoomElementContainer.style.display="none"},n.prototype.setOnCameraZoomValueChangeCallback=function(s){this.onChangeCallback=s},n.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},n.create=function(s,o){var u=new n;return u.render(s,o),u},n}(),Rt;(function(n){n[n.STATUS_DEFAULT=0]="STATUS_DEFAULT",n[n.STATUS_SUCCESS=1]="STATUS_SUCCESS",n[n.STATUS_WARNING=2]="STATUS_WARNING",n[n.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Rt||(Rt={}));function f0(n){return{fps:n.fps,qrbox:n.qrbox,aspectRatio:n.aspectRatio,disableFlip:n.disableFlip,videoConstraints:n.videoConstraints}}function g0(n,s){return{formatsToSupport:n.formatsToSupport,useBarCodeDetectorIfSupported:n.useBarCodeDetectorIfSupported,experimentalFeatures:n.experimentalFeatures,verbose:s}}var x0=function(){function n(s,o,u){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=s,this.config=this.createConfig(o),this.verbose=u===!0,!document.getElementById(s))throw"HTML Element with id=".concat(s," not found");this.scanTypeSelector=new Nn(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new vo(this.verbose),this.persistedDataManager=new r0,o.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return n.prototype.render=function(s,o){var u=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(f,m){if(s)s(f,m);else{if(u.lastMatchFound===f)return;u.lastMatchFound=f,u.setHeaderMessage(Te.lastMatch(f),Rt.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(f,m){o&&o(f,m)};var h=document.getElementById(this.elementId);if(!h)throw"HTML Element with id=".concat(this.elementId," not found");h.innerHTML="",this.createBasicLayout(h),this.html5Qrcode=new Ca(this.getScanRegionId(),g0(this.config,this.verbose))},n.prototype.pause=function(s){(rn(s)||s!==!0)&&(s=!1),this.getHtml5QrcodeOrFail().pause(s)},n.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},n.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},n.prototype.clear=function(){var s=this,o=function(){var u=document.getElementById(s.elementId);u&&(u.innerHTML="",s.resetBasicLayout(u))};return this.html5Qrcode?new Promise(function(u,h){if(!s.html5Qrcode){u();return}s.html5Qrcode.isScanning?s.html5Qrcode.stop().then(function(f){if(!s.html5Qrcode){u();return}s.html5Qrcode.clear(),o(),u()}).catch(function(f){s.verbose&&s.logger.logError("Unable to stop qrcode scanner",f),h(f)}):(s.html5Qrcode.clear(),o(),u())}):Promise.resolve()},n.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},n.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},n.prototype.applyVideoConstraints=function(s){return this.getHtml5QrcodeOrFail().applyVideoConstraints(s)},n.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},n.prototype.createConfig=function(s){return s?(s.fps||(s.fps=qt.SCAN_DEFAULT_FPS),s.rememberLastUsedCamera!==!qt.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(s.rememberLastUsedCamera=qt.DEFAULT_REMEMBER_LAST_CAMERA_USED),s.supportedScanTypes||(s.supportedScanTypes=qt.DEFAULT_SUPPORTED_SCAN_TYPE),s):{fps:qt.SCAN_DEFAULT_FPS,rememberLastUsedCamera:qt.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:qt.DEFAULT_SUPPORTED_SCAN_TYPE}},n.prototype.createBasicLayout=function(s){s.style.position="relative",s.style.padding="0px",s.style.border="1px solid silver",this.createHeader(s);var o=document.createElement("div"),u=this.getScanRegionId();o.id=u,o.style.width="100%",o.style.minHeight="100px",o.style.textAlign="center",s.appendChild(o),Nn.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var h=document.createElement("div"),f=this.getDashboardId();h.id=f,h.style.width="100%",s.appendChild(h),this.setupInitialDashboard(h)},n.prototype.resetBasicLayout=function(s){s.style.border="none"},n.prototype.setupInitialDashboard=function(s){this.createSection(s),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},n.prototype.createHeader=function(s){var o=document.createElement("div");o.style.textAlign="left",o.style.margin="0px",s.appendChild(o);var u=new a0;u.renderInto(o);var h=document.createElement("div");h.id=this.getHeaderMessageContainerId(),h.style.display="none",h.style.textAlign="center",h.style.fontSize="14px",h.style.padding="2px 10px",h.style.margin="4px",h.style.borderTop="1px solid #f6f6f6",o.appendChild(h)},n.prototype.createSection=function(s){var o=document.createElement("div");o.id=this.getDashboardSectionId(),o.style.width="100%",o.style.padding="10px 0px 10px 0px",o.style.textAlign="left",s.appendChild(o)},n.prototype.createCameraListUi=function(s,o,u){var h=this;h.showHideScanTypeSwapLink(!1),h.setHeaderMessage(Te.cameraPermissionRequesting());var f=function(){u||h.createPermissionButton(s,o)};Ca.getCameras().then(function(m){h.persistedDataManager.setHasPermission(!0),h.showHideScanTypeSwapLink(!0),h.resetHeaderMessage(),m&&m.length>0?(s.removeChild(o),h.renderCameraSelection(m)):(h.setHeaderMessage(Te.noCameraFound(),Rt.STATUS_WARNING),f())}).catch(function(m){h.persistedDataManager.setHasPermission(!1),u?u.disabled=!1:f(),h.setHeaderMessage(m,Rt.STATUS_WARNING),h.showHideScanTypeSwapLink(!0)})},n.prototype.createPermissionButton=function(s,o){var u=this,h=un.createElement("button",this.getCameraPermissionButtonId());h.innerText=Te.cameraPermissionTitle(),h.addEventListener("click",function(){h.disabled=!0,u.createCameraListUi(s,o,h)}),o.appendChild(h)},n.prototype.createPermissionsUi=function(s,o){var u=this;if(Nn.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){Ea.hasPermissions().then(function(h){h?u.createCameraListUi(s,o):(u.persistedDataManager.setHasPermission(!1),u.createPermissionButton(s,o))}).catch(function(h){u.persistedDataManager.setHasPermission(!1),u.createPermissionButton(s,o)});return}this.createPermissionButton(s,o)},n.prototype.createSectionControlPanel=function(){var s=document.getElementById(this.getDashboardSectionId()),o=document.createElement("div");s.appendChild(o);var u=document.createElement("div");u.id=this.getDashboardSectionCameraScanRegionId(),u.style.display=Nn.isCameraScanType(this.currentScanType)?"block":"none",o.appendChild(u);var h=document.createElement("div");h.style.textAlign="center",u.appendChild(h),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(u,h),this.renderFileScanUi(o)},n.prototype.renderFileScanUi=function(s){var o=Nn.isFileScanType(this.currentScanType),u=this,h=function(f){if(!u.html5Qrcode)throw"html5Qrcode not defined";Nn.isFileScanType(u.currentScanType)&&(u.setHeaderMessage(Te.loadingImage()),u.html5Qrcode.scanFileV2(f,!0).then(function(m){u.resetHeaderMessage(),u.qrCodeSuccessCallback(m.decodedText,m)}).catch(function(m){u.setHeaderMessage(m,Rt.STATUS_WARNING),u.qrCodeErrorCallback(m,Eo.createFrom(m))}))};this.fileSelectionUi=u0.create(s,o,h)},n.prototype.renderCameraSelection=function(s){var o=this,u=this,h=document.getElementById(this.getDashboardSectionCameraScanRegionId());h.style.textAlign="center";var f=h0.create(h,!1),m=function(k){var j=k.zoomFeature();if(j.isSupported()){f.setOnCameraZoomValueChangeCallback(function(G){j.apply(G)});var W=1;o.config.defaultZoomValueIfSupported&&(W=o.config.defaultZoomValueIfSupported),W=jd(W,j.min(),j.max()),f.setValues(j.min(),j.max(),W,j.step()),f.show()}},w=d0.create(h,s),E=document.createElement("span"),p=un.createElement("button",kt.CAMERA_START_BUTTON_ID);p.innerText=Te.scanButtonStartScanningText(),E.appendChild(p);var A=un.createElement("button",kt.CAMERA_STOP_BUTTON_ID);A.innerText=Te.scanButtonStopScanningText(),A.style.display="none",A.disabled=!0,E.appendChild(A);var N,I=function(k){if(!k.torchFeature().isSupported()){N&&N.hide();return}N?N.updateTorchCapability(k.torchFeature()):N=c0.create(E,k.torchFeature(),{display:"none",marginLeft:"5px"},function(j){u.setHeaderMessage(j,Rt.STATUS_WARNING)}),N.show()};h.appendChild(E);var M=function(k){k||(p.style.display="none"),p.innerText=Te.scanButtonStartScanningText(),p.style.opacity="1",p.disabled=!1,k&&(p.style.display="inline-block")};if(p.addEventListener("click",function(k){p.innerText=Te.scanButtonScanningStarting(),w.disable(),p.disabled=!0,p.style.opacity="0.5",o.scanTypeSelector.hasMoreThanOneScanType()&&u.showHideScanTypeSwapLink(!1),u.resetHeaderMessage();var j=w.getValue();u.persistedDataManager.setLastUsedCameraId(j),u.html5Qrcode.start(j,f0(u.config),u.qrCodeSuccessCallback,u.qrCodeErrorCallback).then(function(W){A.disabled=!1,A.style.display="inline-block",M(!1);var G=u.html5Qrcode.getRunningTrackCameraCapabilities();o.config.showTorchButtonIfSupported===!0&&I(G),o.config.showZoomSliderIfSupported===!0&&m(G)}).catch(function(W){u.showHideScanTypeSwapLink(!0),w.enable(),M(!0),u.setHeaderMessage(W,Rt.STATUS_WARNING)})}),w.hasSingleItem()&&p.click(),A.addEventListener("click",function(k){if(!u.html5Qrcode)throw"html5Qrcode not defined";A.disabled=!0,u.html5Qrcode.stop().then(function(j){o.scanTypeSelector.hasMoreThanOneScanType()&&u.showHideScanTypeSwapLink(!0),w.enable(),p.disabled=!1,A.style.display="none",p.style.display="inline-block",N&&(N.reset(),N.hide()),f.removeOnCameraZoomValueChangeCallback(),f.hide(),u.insertCameraScanImageToScanRegion()}).catch(function(j){A.disabled=!1,u.setHeaderMessage(j,Rt.STATUS_WARNING)})}),u.persistedDataManager.getLastUsedCameraId()){var H=u.persistedDataManager.getLastUsedCameraId();w.hasValue(H)?(w.setValue(H),p.click()):u.persistedDataManager.resetLastUsedCameraId()}},n.prototype.createSectionSwap=function(){var s=this,o=Te.textIfCameraScanSelected(),u=Te.textIfFileScanSelected(),h=document.getElementById(this.getDashboardSectionId()),f=document.createElement("div");f.style.textAlign="center";var m=un.createElement("span",this.getDashboardSectionSwapLinkId());m.style.textDecoration="underline",m.style.cursor="pointer",m.innerText=Nn.isCameraScanType(this.currentScanType)?o:u,m.addEventListener("click",function(){if(!s.sectionSwapAllowed){s.verbose&&s.logger.logError("Section swap called when not allowed");return}s.resetHeaderMessage(),s.fileSelectionUi.resetValue(),s.sectionSwapAllowed=!1,Nn.isCameraScanType(s.currentScanType)?(s.clearScanRegion(),s.getCameraScanRegion().style.display="none",s.fileSelectionUi.show(),m.innerText=u,s.currentScanType=Tn.SCAN_TYPE_FILE,s.insertFileScanImageToScanRegion()):(s.clearScanRegion(),s.getCameraScanRegion().style.display="block",s.fileSelectionUi.hide(),m.innerText=o,s.currentScanType=Tn.SCAN_TYPE_CAMERA,s.insertCameraScanImageToScanRegion(),s.startCameraScanIfPermissionExistsOnSwap()),s.sectionSwapAllowed=!0}),f.appendChild(m),h.appendChild(f)},n.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var s=this,o=this;if(this.persistedDataManager.hasCameraPermissions()){Ea.hasPermissions().then(function(u){if(u){var h=document.getElementById(o.getCameraPermissionButtonId());if(!h)throw s.logger.logError("Permission button not found, fail;"),"Permission button not found";h.click()}else o.persistedDataManager.setHasPermission(!1)}).catch(function(u){o.persistedDataManager.setHasPermission(!1)});return}},n.prototype.resetHeaderMessage=function(){var s=document.getElementById(this.getHeaderMessageContainerId());s.style.display="none"},n.prototype.setHeaderMessage=function(s,o){o||(o=Rt.STATUS_DEFAULT);var u=this.getHeaderMessageDiv();switch(u.innerText=s,u.style.display="block",o){case Rt.STATUS_SUCCESS:u.style.background="rgba(106, 175, 80, 0.26)",u.style.color="#477735";break;case Rt.STATUS_WARNING:u.style.background="rgba(203, 36, 49, 0.14)",u.style.color="#cb2431";break;case Rt.STATUS_DEFAULT:default:u.style.background="rgba(0, 0, 0, 0)",u.style.color="rgb(17, 17, 17)";break}},n.prototype.showHideScanTypeSwapLink=function(s){this.scanTypeSelector.hasMoreThanOneScanType()&&(s!==!0&&(s=!1),this.sectionSwapAllowed=s,this.getDashboardSectionSwapLink().style.display=s?"inline-block":"none")},n.prototype.insertCameraScanImageToScanRegion=function(){var s=this,o=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){o.innerHTML="<br>",o.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(u){o.innerHTML="<br>",o.appendChild(s.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=e0,this.cameraScanImage.alt=Te.cameraScanAltText()},n.prototype.insertFileScanImageToScanRegion=function(){var s=this,o=document.getElementById(this.getScanRegionId());if(this.fileScanImage){o.innerHTML="<br>",o.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(u){o.innerHTML="<br>",o.appendChild(s.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=t0,this.fileScanImage.alt=Te.fileScanAltText()},n.prototype.clearScanRegion=function(){var s=document.getElementById(this.getScanRegionId());s.innerHTML=""},n.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},n.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},n.prototype.getDashboardSectionSwapLinkId=function(){return kt.SCAN_TYPE_CHANGE_ANCHOR_ID},n.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},n.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},n.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},n.prototype.getCameraPermissionButtonId=function(){return kt.CAMERA_PERMISSION_BUTTON_ID},n.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},n.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},n.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},n}();function m0({isOpen:n,onClose:s,onScan:o}){const u=T.useRef(null),[h,f]=T.useState(null);T.useEffect(()=>{if(n&&!u.current){const w=new x0("qr-reader",{fps:10,qrbox:{width:250,height:250},aspectRatio:1},!1);w.render(E=>{o(E),m()},E=>{console.warn("QR Code scan error:",E),f("Unable to scan. Please try again or check camera permissions.")}),u.current=w}return()=>{m()}},[n,o]);const m=()=>{u.current&&(u.current.clear().catch(console.error),u.current=null),f(null)};return n?c.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:c.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[c.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:s}),c.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Qa,{className:"h-6 w-6 text-green-600 mr-2"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Scan Item"})]}),c.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-500",children:c.jsx(On,{className:"h-6 w-6"})})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Position the QR code or barcode within the camera view to scan."}),h&&c.jsxs("div",{className:"flex items-center p-3 text-sm text-red-700 bg-red-100 rounded-lg",children:[c.jsx(li,{className:"h-4 w-4 mr-2"}),h]}),c.jsx("div",{id:"qr-reader",className:"w-full"}),c.jsx("div",{className:"flex gap-2",children:c.jsx("button",{onClick:s,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200",children:"Cancel"})})]})]})]})}):null}function Y(n,s,o){function u(w,E){var p;Object.defineProperty(w,"_zod",{value:w._zod??{},enumerable:!1}),(p=w._zod).traits??(p.traits=new Set),w._zod.traits.add(n),s(w,E);for(const A in m.prototype)A in w||Object.defineProperty(w,A,{value:m.prototype[A].bind(w)});w._zod.constr=m,w._zod.def=E}const h=o?.Parent??Object;class f extends h{}Object.defineProperty(f,"name",{value:n});function m(w){var E;const p=o?.Parent?new f:this;u(p,w),(E=p._zod).deferred??(E.deferred=[]);for(const A of p._zod.deferred)A();return p}return Object.defineProperty(m,"init",{value:u}),Object.defineProperty(m,Symbol.hasInstance,{value:w=>o?.Parent&&w instanceof o.Parent?!0:w?._zod?.traits?.has(n)}),Object.defineProperty(m,"name",{value:n}),m}class or extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Oo extends Error{constructor(s){super(`Encountered unidirectional transform during encode: ${s}`),this.name="ZodEncodeError"}}const Mo={};function Zn(n){return Mo}function p0(n){const s=Object.values(n).filter(u=>typeof u=="number");return Object.entries(n).filter(([u,h])=>s.indexOf(+u)===-1).map(([u,h])=>h)}function ii(n,s){return typeof s=="bigint"?s.toString():s}function yi(n){return{get value(){{const s=n();return Object.defineProperty(this,"value",{value:s}),s}}}}function wi(n){return n==null}function bi(n){const s=n.startsWith("^")?1:0,o=n.endsWith("$")?n.length-1:n.length;return n.slice(s,o)}function y0(n,s){const o=(n.toString().split(".")[1]||"").length,u=s.toString();let h=(u.split(".")[1]||"").length;if(h===0&&/\d?e-\d?/.test(u)){const E=u.match(/\d?e-(\d?)/);E?.[1]&&(h=Number.parseInt(E[1]))}const f=o>h?o:h,m=Number.parseInt(n.toFixed(f).replace(".","")),w=Number.parseInt(s.toFixed(f).replace(".",""));return m%w/10**f}const _a=Symbol("evaluating");function Pe(n,s,o){let u;Object.defineProperty(n,s,{get(){if(u!==_a)return u===void 0&&(u=_a,u=o()),u},set(h){Object.defineProperty(n,s,{value:h})},configurable:!0})}function Gn(n,s,o){Object.defineProperty(n,s,{value:o,writable:!0,enumerable:!0,configurable:!0})}function Yn(...n){const s={};for(const o of n){const u=Object.getOwnPropertyDescriptors(o);Object.assign(s,u)}return Object.defineProperties({},s)}function Sa(n){return JSON.stringify(n)}const Do="captureStackTrace"in Error?Error.captureStackTrace:(...n)=>{};function ss(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}const w0=yi(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const n=Function;return new n(""),!0}catch{return!1}});function Sr(n){if(ss(n)===!1)return!1;const s=n.constructor;if(s===void 0)return!0;const o=s.prototype;return!(ss(o)===!1||Object.prototype.hasOwnProperty.call(o,"isPrototypeOf")===!1)}function jo(n){return Sr(n)?{...n}:Array.isArray(n)?[...n]:n}const b0=new Set(["string","number","symbol"]);function fs(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function jn(n,s,o){const u=new n._zod.constr(s??n._zod.def);return(!s||o?.parent)&&(u._zod.parent=n),u}function fe(n){const s=n;if(!s)return{};if(typeof s=="string")return{error:()=>s};if(s?.message!==void 0){if(s?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");s.error=s.message}return delete s.message,typeof s.error=="string"?{...s,error:()=>s.error}:s}function C0(n){return Object.keys(n).filter(s=>n[s]._zod.optin==="optional"&&n[s]._zod.optout==="optional")}const A0={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function N0(n,s){const o=n._zod.def,u=Yn(n._zod.def,{get shape(){const h={};for(const f in s){if(!(f in o.shape))throw new Error(`Unrecognized key: "${f}"`);s[f]&&(h[f]=o.shape[f])}return Gn(this,"shape",h),h},checks:[]});return jn(n,u)}function E0(n,s){const o=n._zod.def,u=Yn(n._zod.def,{get shape(){const h={...n._zod.def.shape};for(const f in s){if(!(f in o.shape))throw new Error(`Unrecognized key: "${f}"`);s[f]&&delete h[f]}return Gn(this,"shape",h),h},checks:[]});return jn(n,u)}function v0(n,s){if(!Sr(s))throw new Error("Invalid input to extend: expected a plain object");const o=n._zod.def.checks;if(o&&o.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const h=Yn(n._zod.def,{get shape(){const f={...n._zod.def.shape,...s};return Gn(this,"shape",f),f},checks:[]});return jn(n,h)}function _0(n,s){if(!Sr(s))throw new Error("Invalid input to safeExtend: expected a plain object");const o={...n._zod.def,get shape(){const u={...n._zod.def.shape,...s};return Gn(this,"shape",u),u},checks:n._zod.def.checks};return jn(n,o)}function S0(n,s){const o=Yn(n._zod.def,{get shape(){const u={...n._zod.def.shape,...s._zod.def.shape};return Gn(this,"shape",u),u},get catchall(){return s._zod.def.catchall},checks:[]});return jn(n,o)}function I0(n,s,o){const u=Yn(s._zod.def,{get shape(){const h=s._zod.def.shape,f={...h};if(o)for(const m in o){if(!(m in h))throw new Error(`Unrecognized key: "${m}"`);o[m]&&(f[m]=n?new n({type:"optional",innerType:h[m]}):h[m])}else for(const m in h)f[m]=n?new n({type:"optional",innerType:h[m]}):h[m];return Gn(this,"shape",f),f},checks:[]});return jn(s,u)}function T0(n,s,o){const u=Yn(s._zod.def,{get shape(){const h=s._zod.def.shape,f={...h};if(o)for(const m in o){if(!(m in f))throw new Error(`Unrecognized key: "${m}"`);o[m]&&(f[m]=new n({type:"nonoptional",innerType:h[m]}))}else for(const m in h)f[m]=new n({type:"nonoptional",innerType:h[m]});return Gn(this,"shape",f),f},checks:[]});return jn(s,u)}function ir(n,s=0){if(n.aborted===!0)return!0;for(let o=s;o<n.issues.length;o++)if(n.issues[o]?.continue!==!0)return!0;return!1}function Ro(n,s){return s.map(o=>{var u;return(u=o).path??(u.path=[]),o.path.unshift(n),o})}function Gr(n){return typeof n=="string"?n:n?.message}function Wn(n,s,o){const u={...n,path:n.path??[]};if(!n.message){const h=Gr(n.inst?._zod.def?.error?.(n))??Gr(s?.error?.(n))??Gr(o.customError?.(n))??Gr(o.localeError?.(n))??"Invalid input";u.message=h}return delete u.inst,delete u.continue,s?.reportInput||delete u.input,u}function Ci(n){return Array.isArray(n)?"array":typeof n=="string"?"string":"unknown"}function Ir(...n){const[s,o,u]=n;return typeof s=="string"?{message:s,code:"custom",input:o,inst:u}:{...s}}const ko=(n,s)=>{n.name="$ZodError",Object.defineProperty(n,"_zod",{value:n._zod,enumerable:!1}),Object.defineProperty(n,"issues",{value:s,enumerable:!1}),n.message=JSON.stringify(s,ii,2),Object.defineProperty(n,"toString",{value:()=>n.message,enumerable:!1})},Lo=Y("$ZodError",ko),Bo=Y("$ZodError",ko,{Parent:Error});function O0(n,s=o=>o.message){const o={},u=[];for(const h of n.issues)h.path.length>0?(o[h.path[0]]=o[h.path[0]]||[],o[h.path[0]].push(s(h))):u.push(s(h));return{formErrors:u,fieldErrors:o}}function M0(n,s=o=>o.message){const o={_errors:[]},u=h=>{for(const f of h.issues)if(f.code==="invalid_union"&&f.errors.length)f.errors.map(m=>u({issues:m}));else if(f.code==="invalid_key")u({issues:f.issues});else if(f.code==="invalid_element")u({issues:f.issues});else if(f.path.length===0)o._errors.push(s(f));else{let m=o,w=0;for(;w<f.path.length;){const E=f.path[w];w===f.path.length-1?(m[E]=m[E]||{_errors:[]},m[E]._errors.push(s(f))):m[E]=m[E]||{_errors:[]},m=m[E],w++}}};return u(n),o}const Ai=n=>(s,o,u,h)=>{const f=u?Object.assign(u,{async:!1}):{async:!1},m=s._zod.run({value:o,issues:[]},f);if(m instanceof Promise)throw new or;if(m.issues.length){const w=new(h?.Err??n)(m.issues.map(E=>Wn(E,f,Zn())));throw Do(w,h?.callee),w}return m.value},Ni=n=>async(s,o,u,h)=>{const f=u?Object.assign(u,{async:!0}):{async:!0};let m=s._zod.run({value:o,issues:[]},f);if(m instanceof Promise&&(m=await m),m.issues.length){const w=new(h?.Err??n)(m.issues.map(E=>Wn(E,f,Zn())));throw Do(w,h?.callee),w}return m.value},gs=n=>(s,o,u)=>{const h=u?{...u,async:!1}:{async:!1},f=s._zod.run({value:o,issues:[]},h);if(f instanceof Promise)throw new or;return f.issues.length?{success:!1,error:new(n??Lo)(f.issues.map(m=>Wn(m,h,Zn())))}:{success:!0,data:f.value}},D0=gs(Bo),xs=n=>async(s,o,u)=>{const h=u?Object.assign(u,{async:!0}):{async:!0};let f=s._zod.run({value:o,issues:[]},h);return f instanceof Promise&&(f=await f),f.issues.length?{success:!1,error:new n(f.issues.map(m=>Wn(m,h,Zn())))}:{success:!0,data:f.value}},j0=xs(Bo),R0=n=>(s,o,u)=>{const h=u?Object.assign(u,{direction:"backward"}):{direction:"backward"};return Ai(n)(s,o,h)},k0=n=>(s,o,u)=>Ai(n)(s,o,u),L0=n=>async(s,o,u)=>{const h=u?Object.assign(u,{direction:"backward"}):{direction:"backward"};return Ni(n)(s,o,h)},B0=n=>async(s,o,u)=>Ni(n)(s,o,u),P0=n=>(s,o,u)=>{const h=u?Object.assign(u,{direction:"backward"}):{direction:"backward"};return gs(n)(s,o,h)},F0=n=>(s,o,u)=>gs(n)(s,o,u),U0=n=>async(s,o,u)=>{const h=u?Object.assign(u,{direction:"backward"}):{direction:"backward"};return xs(n)(s,o,h)},z0=n=>async(s,o,u)=>xs(n)(s,o,u),H0=/^[cC][^\s-]{8,}$/,V0=/^[0-9a-z]+$/,Z0=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,W0=/^[0-9a-vA-V]{20}$/,G0=/^[A-Za-z0-9]{27}$/,Y0=/^[a-zA-Z0-9_-]{21}$/,X0=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,q0=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Ia=n=>n?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${n}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,$0=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Q0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function K0(){return new RegExp(Q0,"u")}const J0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,eh=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,th=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,nh=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,rh=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Po=/^[A-Za-z0-9_-]*$/,sh=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,ih=/^\+(?:[0-9]){6,14}[0-9]$/,Fo="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",ah=new RegExp(`^${Fo}$`);function Uo(n){const s="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof n.precision=="number"?n.precision===-1?`${s}`:n.precision===0?`${s}:[0-5]\\d`:`${s}:[0-5]\\d\\.\\d{${n.precision}}`:`${s}(?::[0-5]\\d(?:\\.\\d+)?)?`}function oh(n){return new RegExp(`^${Uo(n)}$`)}function lh(n){const s=Uo({precision:n.precision}),o=["Z"];n.local&&o.push(""),n.offset&&o.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const u=`${s}(?:${o.join("|")})`;return new RegExp(`^${Fo}T(?:${u})$`)}const ch=n=>{const s=n?`[\\s\\S]{${n?.minimum??0},${n?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${s}$`)},uh=/^-?\d+$/,dh=/^-?\d+(?:\.\d+)?/,hh=/^[^A-Z]*$/,fh=/^[^a-z]*$/,Ot=Y("$ZodCheck",(n,s)=>{var o;n._zod??(n._zod={}),n._zod.def=s,(o=n._zod).onattach??(o.onattach=[])}),zo={number:"number",bigint:"bigint",object:"date"},Ho=Y("$ZodCheckLessThan",(n,s)=>{Ot.init(n,s);const o=zo[typeof s.value];n._zod.onattach.push(u=>{const h=u._zod.bag,f=(s.inclusive?h.maximum:h.exclusiveMaximum)??Number.POSITIVE_INFINITY;s.value<f&&(s.inclusive?h.maximum=s.value:h.exclusiveMaximum=s.value)}),n._zod.check=u=>{(s.inclusive?u.value<=s.value:u.value<s.value)||u.issues.push({origin:o,code:"too_big",maximum:s.value,input:u.value,inclusive:s.inclusive,inst:n,continue:!s.abort})}}),Vo=Y("$ZodCheckGreaterThan",(n,s)=>{Ot.init(n,s);const o=zo[typeof s.value];n._zod.onattach.push(u=>{const h=u._zod.bag,f=(s.inclusive?h.minimum:h.exclusiveMinimum)??Number.NEGATIVE_INFINITY;s.value>f&&(s.inclusive?h.minimum=s.value:h.exclusiveMinimum=s.value)}),n._zod.check=u=>{(s.inclusive?u.value>=s.value:u.value>s.value)||u.issues.push({origin:o,code:"too_small",minimum:s.value,input:u.value,inclusive:s.inclusive,inst:n,continue:!s.abort})}}),gh=Y("$ZodCheckMultipleOf",(n,s)=>{Ot.init(n,s),n._zod.onattach.push(o=>{var u;(u=o._zod.bag).multipleOf??(u.multipleOf=s.value)}),n._zod.check=o=>{if(typeof o.value!=typeof s.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof o.value=="bigint"?o.value%s.value===BigInt(0):y0(o.value,s.value)===0)||o.issues.push({origin:typeof o.value,code:"not_multiple_of",divisor:s.value,input:o.value,inst:n,continue:!s.abort})}}),xh=Y("$ZodCheckNumberFormat",(n,s)=>{Ot.init(n,s),s.format=s.format||"float64";const o=s.format?.includes("int"),u=o?"int":"number",[h,f]=A0[s.format];n._zod.onattach.push(m=>{const w=m._zod.bag;w.format=s.format,w.minimum=h,w.maximum=f,o&&(w.pattern=uh)}),n._zod.check=m=>{const w=m.value;if(o){if(!Number.isInteger(w)){m.issues.push({expected:u,format:s.format,code:"invalid_type",continue:!1,input:w,inst:n});return}if(!Number.isSafeInteger(w)){w>0?m.issues.push({input:w,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:u,continue:!s.abort}):m.issues.push({input:w,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:n,origin:u,continue:!s.abort});return}}w<h&&m.issues.push({origin:"number",input:w,code:"too_small",minimum:h,inclusive:!0,inst:n,continue:!s.abort}),w>f&&m.issues.push({origin:"number",input:w,code:"too_big",maximum:f,inst:n})}}),mh=Y("$ZodCheckMaxLength",(n,s)=>{var o;Ot.init(n,s),(o=n._zod.def).when??(o.when=u=>{const h=u.value;return!wi(h)&&h.length!==void 0}),n._zod.onattach.push(u=>{const h=u._zod.bag.maximum??Number.POSITIVE_INFINITY;s.maximum<h&&(u._zod.bag.maximum=s.maximum)}),n._zod.check=u=>{const h=u.value;if(h.length<=s.maximum)return;const m=Ci(h);u.issues.push({origin:m,code:"too_big",maximum:s.maximum,inclusive:!0,input:h,inst:n,continue:!s.abort})}}),ph=Y("$ZodCheckMinLength",(n,s)=>{var o;Ot.init(n,s),(o=n._zod.def).when??(o.when=u=>{const h=u.value;return!wi(h)&&h.length!==void 0}),n._zod.onattach.push(u=>{const h=u._zod.bag.minimum??Number.NEGATIVE_INFINITY;s.minimum>h&&(u._zod.bag.minimum=s.minimum)}),n._zod.check=u=>{const h=u.value;if(h.length>=s.minimum)return;const m=Ci(h);u.issues.push({origin:m,code:"too_small",minimum:s.minimum,inclusive:!0,input:h,inst:n,continue:!s.abort})}}),yh=Y("$ZodCheckLengthEquals",(n,s)=>{var o;Ot.init(n,s),(o=n._zod.def).when??(o.when=u=>{const h=u.value;return!wi(h)&&h.length!==void 0}),n._zod.onattach.push(u=>{const h=u._zod.bag;h.minimum=s.length,h.maximum=s.length,h.length=s.length}),n._zod.check=u=>{const h=u.value,f=h.length;if(f===s.length)return;const m=Ci(h),w=f>s.length;u.issues.push({origin:m,...w?{code:"too_big",maximum:s.length}:{code:"too_small",minimum:s.length},inclusive:!0,exact:!0,input:u.value,inst:n,continue:!s.abort})}}),ms=Y("$ZodCheckStringFormat",(n,s)=>{var o,u;Ot.init(n,s),n._zod.onattach.push(h=>{const f=h._zod.bag;f.format=s.format,s.pattern&&(f.patterns??(f.patterns=new Set),f.patterns.add(s.pattern))}),s.pattern?(o=n._zod).check??(o.check=h=>{s.pattern.lastIndex=0,!s.pattern.test(h.value)&&h.issues.push({origin:"string",code:"invalid_format",format:s.format,input:h.value,...s.pattern?{pattern:s.pattern.toString()}:{},inst:n,continue:!s.abort})}):(u=n._zod).check??(u.check=()=>{})}),wh=Y("$ZodCheckRegex",(n,s)=>{ms.init(n,s),n._zod.check=o=>{s.pattern.lastIndex=0,!s.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:"regex",input:o.value,pattern:s.pattern.toString(),inst:n,continue:!s.abort})}}),bh=Y("$ZodCheckLowerCase",(n,s)=>{s.pattern??(s.pattern=hh),ms.init(n,s)}),Ch=Y("$ZodCheckUpperCase",(n,s)=>{s.pattern??(s.pattern=fh),ms.init(n,s)}),Ah=Y("$ZodCheckIncludes",(n,s)=>{Ot.init(n,s);const o=fs(s.includes),u=new RegExp(typeof s.position=="number"?`^.{${s.position}}${o}`:o);s.pattern=u,n._zod.onattach.push(h=>{const f=h._zod.bag;f.patterns??(f.patterns=new Set),f.patterns.add(u)}),n._zod.check=h=>{h.value.includes(s.includes,s.position)||h.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:s.includes,input:h.value,inst:n,continue:!s.abort})}}),Nh=Y("$ZodCheckStartsWith",(n,s)=>{Ot.init(n,s);const o=new RegExp(`^${fs(s.prefix)}.*`);s.pattern??(s.pattern=o),n._zod.onattach.push(u=>{const h=u._zod.bag;h.patterns??(h.patterns=new Set),h.patterns.add(o)}),n._zod.check=u=>{u.value.startsWith(s.prefix)||u.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:s.prefix,input:u.value,inst:n,continue:!s.abort})}}),Eh=Y("$ZodCheckEndsWith",(n,s)=>{Ot.init(n,s);const o=new RegExp(`.*${fs(s.suffix)}$`);s.pattern??(s.pattern=o),n._zod.onattach.push(u=>{const h=u._zod.bag;h.patterns??(h.patterns=new Set),h.patterns.add(o)}),n._zod.check=u=>{u.value.endsWith(s.suffix)||u.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:s.suffix,input:u.value,inst:n,continue:!s.abort})}}),vh=Y("$ZodCheckOverwrite",(n,s)=>{Ot.init(n,s),n._zod.check=o=>{o.value=s.tx(o.value)}});class _h{constructor(s=[]){this.content=[],this.indent=0,this&&(this.args=s)}indented(s){this.indent+=1,s(this),this.indent-=1}write(s){if(typeof s=="function"){s(this,{execution:"sync"}),s(this,{execution:"async"});return}const u=s.split(`
`).filter(m=>m),h=Math.min(...u.map(m=>m.length-m.trimStart().length)),f=u.map(m=>m.slice(h)).map(m=>" ".repeat(this.indent*2)+m);for(const m of f)this.content.push(m)}compile(){const s=Function,o=this?.args,h=[...(this?.content??[""]).map(f=>`  ${f}`)];return new s(...o,h.join(`
`))}}const Sh={major:4,minor:1,patch:12},st=Y("$ZodType",(n,s)=>{var o;n??(n={}),n._zod.def=s,n._zod.bag=n._zod.bag||{},n._zod.version=Sh;const u=[...n._zod.def.checks??[]];n._zod.traits.has("$ZodCheck")&&u.unshift(n);for(const h of u)for(const f of h._zod.onattach)f(n);if(u.length===0)(o=n._zod).deferred??(o.deferred=[]),n._zod.deferred?.push(()=>{n._zod.run=n._zod.parse});else{const h=(m,w,E)=>{let p=ir(m),A;for(const N of w){if(N._zod.def.when){if(!N._zod.def.when(m))continue}else if(p)continue;const I=m.issues.length,M=N._zod.check(m);if(M instanceof Promise&&E?.async===!1)throw new or;if(A||M instanceof Promise)A=(A??Promise.resolve()).then(async()=>{await M,m.issues.length!==I&&(p||(p=ir(m,I)))});else{if(m.issues.length===I)continue;p||(p=ir(m,I))}}return A?A.then(()=>m):m},f=(m,w,E)=>{if(ir(m))return m.aborted=!0,m;const p=h(w,u,E);if(p instanceof Promise){if(E.async===!1)throw new or;return p.then(A=>n._zod.parse(A,E))}return n._zod.parse(p,E)};n._zod.run=(m,w)=>{if(w.skipChecks)return n._zod.parse(m,w);if(w.direction==="backward"){const p=n._zod.parse({value:m.value,issues:[]},{...w,skipChecks:!0});return p instanceof Promise?p.then(A=>f(A,m,w)):f(p,m,w)}const E=n._zod.parse(m,w);if(E instanceof Promise){if(w.async===!1)throw new or;return E.then(p=>h(p,u,w))}return h(E,u,w)}}n["~standard"]={validate:h=>{try{const f=D0(n,h);return f.success?{value:f.data}:{issues:f.error?.issues}}catch{return j0(n,h).then(m=>m.success?{value:m.data}:{issues:m.error?.issues})}},vendor:"zod",version:1}}),Ei=Y("$ZodString",(n,s)=>{st.init(n,s),n._zod.pattern=[...n?._zod.bag?.patterns??[]].pop()??ch(n._zod.bag),n._zod.parse=(o,u)=>{if(s.coerce)try{o.value=String(o.value)}catch{}return typeof o.value=="string"||o.issues.push({expected:"string",code:"invalid_type",input:o.value,inst:n}),o}}),Ze=Y("$ZodStringFormat",(n,s)=>{ms.init(n,s),Ei.init(n,s)}),Ih=Y("$ZodGUID",(n,s)=>{s.pattern??(s.pattern=q0),Ze.init(n,s)}),Th=Y("$ZodUUID",(n,s)=>{if(s.version){const u={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[s.version];if(u===void 0)throw new Error(`Invalid UUID version: "${s.version}"`);s.pattern??(s.pattern=Ia(u))}else s.pattern??(s.pattern=Ia());Ze.init(n,s)}),Oh=Y("$ZodEmail",(n,s)=>{s.pattern??(s.pattern=$0),Ze.init(n,s)}),Mh=Y("$ZodURL",(n,s)=>{Ze.init(n,s),n._zod.check=o=>{try{const u=o.value.trim(),h=new URL(u);s.hostname&&(s.hostname.lastIndex=0,s.hostname.test(h.hostname)||o.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:sh.source,input:o.value,inst:n,continue:!s.abort})),s.protocol&&(s.protocol.lastIndex=0,s.protocol.test(h.protocol.endsWith(":")?h.protocol.slice(0,-1):h.protocol)||o.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:s.protocol.source,input:o.value,inst:n,continue:!s.abort})),s.normalize?o.value=h.href:o.value=u;return}catch{o.issues.push({code:"invalid_format",format:"url",input:o.value,inst:n,continue:!s.abort})}}}),Dh=Y("$ZodEmoji",(n,s)=>{s.pattern??(s.pattern=K0()),Ze.init(n,s)}),jh=Y("$ZodNanoID",(n,s)=>{s.pattern??(s.pattern=Y0),Ze.init(n,s)}),Rh=Y("$ZodCUID",(n,s)=>{s.pattern??(s.pattern=H0),Ze.init(n,s)}),kh=Y("$ZodCUID2",(n,s)=>{s.pattern??(s.pattern=V0),Ze.init(n,s)}),Lh=Y("$ZodULID",(n,s)=>{s.pattern??(s.pattern=Z0),Ze.init(n,s)}),Bh=Y("$ZodXID",(n,s)=>{s.pattern??(s.pattern=W0),Ze.init(n,s)}),Ph=Y("$ZodKSUID",(n,s)=>{s.pattern??(s.pattern=G0),Ze.init(n,s)}),Fh=Y("$ZodISODateTime",(n,s)=>{s.pattern??(s.pattern=lh(s)),Ze.init(n,s)}),Uh=Y("$ZodISODate",(n,s)=>{s.pattern??(s.pattern=ah),Ze.init(n,s)}),zh=Y("$ZodISOTime",(n,s)=>{s.pattern??(s.pattern=oh(s)),Ze.init(n,s)}),Hh=Y("$ZodISODuration",(n,s)=>{s.pattern??(s.pattern=X0),Ze.init(n,s)}),Vh=Y("$ZodIPv4",(n,s)=>{s.pattern??(s.pattern=J0),Ze.init(n,s),n._zod.onattach.push(o=>{const u=o._zod.bag;u.format="ipv4"})}),Zh=Y("$ZodIPv6",(n,s)=>{s.pattern??(s.pattern=eh),Ze.init(n,s),n._zod.onattach.push(o=>{const u=o._zod.bag;u.format="ipv6"}),n._zod.check=o=>{try{new URL(`http://[${o.value}]`)}catch{o.issues.push({code:"invalid_format",format:"ipv6",input:o.value,inst:n,continue:!s.abort})}}}),Wh=Y("$ZodCIDRv4",(n,s)=>{s.pattern??(s.pattern=th),Ze.init(n,s)}),Gh=Y("$ZodCIDRv6",(n,s)=>{s.pattern??(s.pattern=nh),Ze.init(n,s),n._zod.check=o=>{const u=o.value.split("/");try{if(u.length!==2)throw new Error;const[h,f]=u;if(!f)throw new Error;const m=Number(f);if(`${m}`!==f)throw new Error;if(m<0||m>128)throw new Error;new URL(`http://[${h}]`)}catch{o.issues.push({code:"invalid_format",format:"cidrv6",input:o.value,inst:n,continue:!s.abort})}}});function Zo(n){if(n==="")return!0;if(n.length%4!==0)return!1;try{return atob(n),!0}catch{return!1}}const Yh=Y("$ZodBase64",(n,s)=>{s.pattern??(s.pattern=rh),Ze.init(n,s),n._zod.onattach.push(o=>{o._zod.bag.contentEncoding="base64"}),n._zod.check=o=>{Zo(o.value)||o.issues.push({code:"invalid_format",format:"base64",input:o.value,inst:n,continue:!s.abort})}});function Xh(n){if(!Po.test(n))return!1;const s=n.replace(/[-_]/g,u=>u==="-"?"+":"/"),o=s.padEnd(Math.ceil(s.length/4)*4,"=");return Zo(o)}const qh=Y("$ZodBase64URL",(n,s)=>{s.pattern??(s.pattern=Po),Ze.init(n,s),n._zod.onattach.push(o=>{o._zod.bag.contentEncoding="base64url"}),n._zod.check=o=>{Xh(o.value)||o.issues.push({code:"invalid_format",format:"base64url",input:o.value,inst:n,continue:!s.abort})}}),$h=Y("$ZodE164",(n,s)=>{s.pattern??(s.pattern=ih),Ze.init(n,s)});function Qh(n,s=null){try{const o=n.split(".");if(o.length!==3)return!1;const[u]=o;if(!u)return!1;const h=JSON.parse(atob(u));return!("typ"in h&&h?.typ!=="JWT"||!h.alg||s&&(!("alg"in h)||h.alg!==s))}catch{return!1}}const Kh=Y("$ZodJWT",(n,s)=>{Ze.init(n,s),n._zod.check=o=>{Qh(o.value,s.alg)||o.issues.push({code:"invalid_format",format:"jwt",input:o.value,inst:n,continue:!s.abort})}}),Wo=Y("$ZodNumber",(n,s)=>{st.init(n,s),n._zod.pattern=n._zod.bag.pattern??dh,n._zod.parse=(o,u)=>{if(s.coerce)try{o.value=Number(o.value)}catch{}const h=o.value;if(typeof h=="number"&&!Number.isNaN(h)&&Number.isFinite(h))return o;const f=typeof h=="number"?Number.isNaN(h)?"NaN":Number.isFinite(h)?void 0:"Infinity":void 0;return o.issues.push({expected:"number",code:"invalid_type",input:h,inst:n,...f?{received:f}:{}}),o}}),Jh=Y("$ZodNumber",(n,s)=>{xh.init(n,s),Wo.init(n,s)}),e1=Y("$ZodUnknown",(n,s)=>{st.init(n,s),n._zod.parse=o=>o}),t1=Y("$ZodNever",(n,s)=>{st.init(n,s),n._zod.parse=(o,u)=>(o.issues.push({expected:"never",code:"invalid_type",input:o.value,inst:n}),o)});function Ta(n,s,o){n.issues.length&&s.issues.push(...Ro(o,n.issues)),s.value[o]=n.value}const n1=Y("$ZodArray",(n,s)=>{st.init(n,s),n._zod.parse=(o,u)=>{const h=o.value;if(!Array.isArray(h))return o.issues.push({expected:"array",code:"invalid_type",input:h,inst:n}),o;o.value=Array(h.length);const f=[];for(let m=0;m<h.length;m++){const w=h[m],E=s.element._zod.run({value:w,issues:[]},u);E instanceof Promise?f.push(E.then(p=>Ta(p,o,m))):Ta(E,o,m)}return f.length?Promise.all(f).then(()=>o):o}});function is(n,s,o,u){n.issues.length&&s.issues.push(...Ro(o,n.issues)),n.value===void 0?o in u&&(s.value[o]=void 0):s.value[o]=n.value}function Go(n){const s=Object.keys(n.shape);for(const u of s)if(!n.shape?.[u]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${u}": expected a Zod schema`);const o=C0(n.shape);return{...n,keys:s,keySet:new Set(s),numKeys:s.length,optionalKeys:new Set(o)}}function Yo(n,s,o,u,h,f){const m=[],w=h.keySet,E=h.catchall._zod,p=E.def.type;for(const A of Object.keys(s)){if(w.has(A))continue;if(p==="never"){m.push(A);continue}const N=E.run({value:s[A],issues:[]},u);N instanceof Promise?n.push(N.then(I=>is(I,o,A,s))):is(N,o,A,s)}return m.length&&o.issues.push({code:"unrecognized_keys",keys:m,input:s,inst:f}),n.length?Promise.all(n).then(()=>o):o}const r1=Y("$ZodObject",(n,s)=>{if(st.init(n,s),!Object.getOwnPropertyDescriptor(s,"shape")?.get){const w=s.shape;Object.defineProperty(s,"shape",{get:()=>{const E={...w};return Object.defineProperty(s,"shape",{value:E}),E}})}const u=yi(()=>Go(s));Pe(n._zod,"propValues",()=>{const w=s.shape,E={};for(const p in w){const A=w[p]._zod;if(A.values){E[p]??(E[p]=new Set);for(const N of A.values)E[p].add(N)}}return E});const h=ss,f=s.catchall;let m;n._zod.parse=(w,E)=>{m??(m=u.value);const p=w.value;if(!h(p))return w.issues.push({expected:"object",code:"invalid_type",input:p,inst:n}),w;w.value={};const A=[],N=m.shape;for(const I of m.keys){const H=N[I]._zod.run({value:p[I],issues:[]},E);H instanceof Promise?A.push(H.then(k=>is(k,w,I,p))):is(H,w,I,p)}return f?Yo(A,p,w,E,u.value,n):A.length?Promise.all(A).then(()=>w):w}}),s1=Y("$ZodObjectJIT",(n,s)=>{r1.init(n,s);const o=n._zod.parse,u=yi(()=>Go(s)),h=I=>{const M=new _h(["shape","payload","ctx"]),H=u.value,k=B=>{const K=Sa(B);return`shape[${K}]._zod.run({ value: input[${K}], issues: [] }, ctx)`};M.write("const input = payload.value;");const j=Object.create(null);let W=0;for(const B of H.keys)j[B]=`key_${W++}`;M.write("const newResult = {};");for(const B of H.keys){const K=j[B],we=Sa(B);M.write(`const ${K} = ${k(B)};`),M.write(`
        if (${K}.issues.length) {
          payload.issues = payload.issues.concat(${K}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${we}, ...iss.path] : [${we}]
          })));
        }
        
        
        if (${K}.value === undefined) {
          if (${we} in input) {
            newResult[${we}] = undefined;
          }
        } else {
          newResult[${we}] = ${K}.value;
        }
        
      `)}M.write("payload.value = newResult;"),M.write("return payload;");const G=M.compile();return(B,K)=>G(I,B,K)};let f;const m=ss,w=!Mo.jitless,p=w&&w0.value,A=s.catchall;let N;n._zod.parse=(I,M)=>{N??(N=u.value);const H=I.value;return m(H)?w&&p&&M?.async===!1&&M.jitless!==!0?(f||(f=h(s.shape)),I=f(I,M),A?Yo([],H,I,M,N,n):I):o(I,M):(I.issues.push({expected:"object",code:"invalid_type",input:H,inst:n}),I)}});function Oa(n,s,o,u){for(const f of n)if(f.issues.length===0)return s.value=f.value,s;const h=n.filter(f=>!ir(f));return h.length===1?(s.value=h[0].value,h[0]):(s.issues.push({code:"invalid_union",input:s.value,inst:o,errors:n.map(f=>f.issues.map(m=>Wn(m,u,Zn())))}),s)}const i1=Y("$ZodUnion",(n,s)=>{st.init(n,s),Pe(n._zod,"optin",()=>s.options.some(h=>h._zod.optin==="optional")?"optional":void 0),Pe(n._zod,"optout",()=>s.options.some(h=>h._zod.optout==="optional")?"optional":void 0),Pe(n._zod,"values",()=>{if(s.options.every(h=>h._zod.values))return new Set(s.options.flatMap(h=>Array.from(h._zod.values)))}),Pe(n._zod,"pattern",()=>{if(s.options.every(h=>h._zod.pattern)){const h=s.options.map(f=>f._zod.pattern);return new RegExp(`^(${h.map(f=>bi(f.source)).join("|")})$`)}});const o=s.options.length===1,u=s.options[0]._zod.run;n._zod.parse=(h,f)=>{if(o)return u(h,f);let m=!1;const w=[];for(const E of s.options){const p=E._zod.run({value:h.value,issues:[]},f);if(p instanceof Promise)w.push(p),m=!0;else{if(p.issues.length===0)return p;w.push(p)}}return m?Promise.all(w).then(E=>Oa(E,h,n,f)):Oa(w,h,n,f)}}),a1=Y("$ZodIntersection",(n,s)=>{st.init(n,s),n._zod.parse=(o,u)=>{const h=o.value,f=s.left._zod.run({value:h,issues:[]},u),m=s.right._zod.run({value:h,issues:[]},u);return f instanceof Promise||m instanceof Promise?Promise.all([f,m]).then(([E,p])=>Ma(o,E,p)):Ma(o,f,m)}});function ai(n,s){if(n===s)return{valid:!0,data:n};if(n instanceof Date&&s instanceof Date&&+n==+s)return{valid:!0,data:n};if(Sr(n)&&Sr(s)){const o=Object.keys(s),u=Object.keys(n).filter(f=>o.indexOf(f)!==-1),h={...n,...s};for(const f of u){const m=ai(n[f],s[f]);if(!m.valid)return{valid:!1,mergeErrorPath:[f,...m.mergeErrorPath]};h[f]=m.data}return{valid:!0,data:h}}if(Array.isArray(n)&&Array.isArray(s)){if(n.length!==s.length)return{valid:!1,mergeErrorPath:[]};const o=[];for(let u=0;u<n.length;u++){const h=n[u],f=s[u],m=ai(h,f);if(!m.valid)return{valid:!1,mergeErrorPath:[u,...m.mergeErrorPath]};o.push(m.data)}return{valid:!0,data:o}}return{valid:!1,mergeErrorPath:[]}}function Ma(n,s,o){if(s.issues.length&&n.issues.push(...s.issues),o.issues.length&&n.issues.push(...o.issues),ir(n))return n;const u=ai(s.value,o.value);if(!u.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(u.mergeErrorPath)}`);return n.value=u.data,n}const o1=Y("$ZodEnum",(n,s)=>{st.init(n,s);const o=p0(s.entries),u=new Set(o);n._zod.values=u,n._zod.pattern=new RegExp(`^(${o.filter(h=>b0.has(typeof h)).map(h=>typeof h=="string"?fs(h):h.toString()).join("|")})$`),n._zod.parse=(h,f)=>{const m=h.value;return u.has(m)||h.issues.push({code:"invalid_value",values:o,input:m,inst:n}),h}}),l1=Y("$ZodTransform",(n,s)=>{st.init(n,s),n._zod.parse=(o,u)=>{if(u.direction==="backward")throw new Oo(n.constructor.name);const h=s.transform(o.value,o);if(u.async)return(h instanceof Promise?h:Promise.resolve(h)).then(m=>(o.value=m,o));if(h instanceof Promise)throw new or;return o.value=h,o}});function Da(n,s){return n.issues.length&&s===void 0?{issues:[],value:void 0}:n}const c1=Y("$ZodOptional",(n,s)=>{st.init(n,s),n._zod.optin="optional",n._zod.optout="optional",Pe(n._zod,"values",()=>s.innerType._zod.values?new Set([...s.innerType._zod.values,void 0]):void 0),Pe(n._zod,"pattern",()=>{const o=s.innerType._zod.pattern;return o?new RegExp(`^(${bi(o.source)})?$`):void 0}),n._zod.parse=(o,u)=>{if(s.innerType._zod.optin==="optional"){const h=s.innerType._zod.run(o,u);return h instanceof Promise?h.then(f=>Da(f,o.value)):Da(h,o.value)}return o.value===void 0?o:s.innerType._zod.run(o,u)}}),u1=Y("$ZodNullable",(n,s)=>{st.init(n,s),Pe(n._zod,"optin",()=>s.innerType._zod.optin),Pe(n._zod,"optout",()=>s.innerType._zod.optout),Pe(n._zod,"pattern",()=>{const o=s.innerType._zod.pattern;return o?new RegExp(`^(${bi(o.source)}|null)$`):void 0}),Pe(n._zod,"values",()=>s.innerType._zod.values?new Set([...s.innerType._zod.values,null]):void 0),n._zod.parse=(o,u)=>o.value===null?o:s.innerType._zod.run(o,u)}),d1=Y("$ZodDefault",(n,s)=>{st.init(n,s),n._zod.optin="optional",Pe(n._zod,"values",()=>s.innerType._zod.values),n._zod.parse=(o,u)=>{if(u.direction==="backward")return s.innerType._zod.run(o,u);if(o.value===void 0)return o.value=s.defaultValue,o;const h=s.innerType._zod.run(o,u);return h instanceof Promise?h.then(f=>ja(f,s)):ja(h,s)}});function ja(n,s){return n.value===void 0&&(n.value=s.defaultValue),n}const h1=Y("$ZodPrefault",(n,s)=>{st.init(n,s),n._zod.optin="optional",Pe(n._zod,"values",()=>s.innerType._zod.values),n._zod.parse=(o,u)=>(u.direction==="backward"||o.value===void 0&&(o.value=s.defaultValue),s.innerType._zod.run(o,u))}),f1=Y("$ZodNonOptional",(n,s)=>{st.init(n,s),Pe(n._zod,"values",()=>{const o=s.innerType._zod.values;return o?new Set([...o].filter(u=>u!==void 0)):void 0}),n._zod.parse=(o,u)=>{const h=s.innerType._zod.run(o,u);return h instanceof Promise?h.then(f=>Ra(f,n)):Ra(h,n)}});function Ra(n,s){return!n.issues.length&&n.value===void 0&&n.issues.push({code:"invalid_type",expected:"nonoptional",input:n.value,inst:s}),n}const g1=Y("$ZodCatch",(n,s)=>{st.init(n,s),Pe(n._zod,"optin",()=>s.innerType._zod.optin),Pe(n._zod,"optout",()=>s.innerType._zod.optout),Pe(n._zod,"values",()=>s.innerType._zod.values),n._zod.parse=(o,u)=>{if(u.direction==="backward")return s.innerType._zod.run(o,u);const h=s.innerType._zod.run(o,u);return h instanceof Promise?h.then(f=>(o.value=f.value,f.issues.length&&(o.value=s.catchValue({...o,error:{issues:f.issues.map(m=>Wn(m,u,Zn()))},input:o.value}),o.issues=[]),o)):(o.value=h.value,h.issues.length&&(o.value=s.catchValue({...o,error:{issues:h.issues.map(f=>Wn(f,u,Zn()))},input:o.value}),o.issues=[]),o)}}),x1=Y("$ZodPipe",(n,s)=>{st.init(n,s),Pe(n._zod,"values",()=>s.in._zod.values),Pe(n._zod,"optin",()=>s.in._zod.optin),Pe(n._zod,"optout",()=>s.out._zod.optout),Pe(n._zod,"propValues",()=>s.in._zod.propValues),n._zod.parse=(o,u)=>{if(u.direction==="backward"){const f=s.out._zod.run(o,u);return f instanceof Promise?f.then(m=>Yr(m,s.in,u)):Yr(f,s.in,u)}const h=s.in._zod.run(o,u);return h instanceof Promise?h.then(f=>Yr(f,s.out,u)):Yr(h,s.out,u)}});function Yr(n,s,o){return n.issues.length?(n.aborted=!0,n):s._zod.run({value:n.value,issues:n.issues},o)}const m1=Y("$ZodReadonly",(n,s)=>{st.init(n,s),Pe(n._zod,"propValues",()=>s.innerType._zod.propValues),Pe(n._zod,"values",()=>s.innerType._zod.values),Pe(n._zod,"optin",()=>s.innerType._zod.optin),Pe(n._zod,"optout",()=>s.innerType._zod.optout),n._zod.parse=(o,u)=>{if(u.direction==="backward")return s.innerType._zod.run(o,u);const h=s.innerType._zod.run(o,u);return h instanceof Promise?h.then(ka):ka(h)}});function ka(n){return n.value=Object.freeze(n.value),n}const p1=Y("$ZodCustom",(n,s)=>{Ot.init(n,s),st.init(n,s),n._zod.parse=(o,u)=>o,n._zod.check=o=>{const u=o.value,h=s.fn(u);if(h instanceof Promise)return h.then(f=>La(f,o,u,n));La(h,o,u,n)}});function La(n,s,o,u){if(!n){const h={code:"custom",input:o,inst:u,path:[...u._zod.def.path??[]],continue:!u._zod.def.abort};u._zod.def.params&&(h.params=u._zod.def.params),s.issues.push(Ir(h))}}class y1{constructor(){this._map=new WeakMap,this._idmap=new Map}add(s,...o){const u=o[0];if(this._map.set(s,u),u&&typeof u=="object"&&"id"in u){if(this._idmap.has(u.id))throw new Error(`ID ${u.id} already exists in the registry`);this._idmap.set(u.id,s)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(s){const o=this._map.get(s);return o&&typeof o=="object"&&"id"in o&&this._idmap.delete(o.id),this._map.delete(s),this}get(s){const o=s._zod.parent;if(o){const u={...this.get(o)??{}};delete u.id;const h={...u,...this._map.get(s)};return Object.keys(h).length?h:void 0}return this._map.get(s)}has(s){return this._map.has(s)}}function w1(){return new y1}const Xr=w1();function b1(n,s){return new n({type:"string",...fe(s)})}function C1(n,s){return new n({type:"string",format:"email",check:"string_format",abort:!1,...fe(s)})}function Ba(n,s){return new n({type:"string",format:"guid",check:"string_format",abort:!1,...fe(s)})}function A1(n,s){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,...fe(s)})}function N1(n,s){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...fe(s)})}function E1(n,s){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...fe(s)})}function v1(n,s){return new n({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...fe(s)})}function _1(n,s){return new n({type:"string",format:"url",check:"string_format",abort:!1,...fe(s)})}function S1(n,s){return new n({type:"string",format:"emoji",check:"string_format",abort:!1,...fe(s)})}function I1(n,s){return new n({type:"string",format:"nanoid",check:"string_format",abort:!1,...fe(s)})}function T1(n,s){return new n({type:"string",format:"cuid",check:"string_format",abort:!1,...fe(s)})}function O1(n,s){return new n({type:"string",format:"cuid2",check:"string_format",abort:!1,...fe(s)})}function M1(n,s){return new n({type:"string",format:"ulid",check:"string_format",abort:!1,...fe(s)})}function D1(n,s){return new n({type:"string",format:"xid",check:"string_format",abort:!1,...fe(s)})}function j1(n,s){return new n({type:"string",format:"ksuid",check:"string_format",abort:!1,...fe(s)})}function R1(n,s){return new n({type:"string",format:"ipv4",check:"string_format",abort:!1,...fe(s)})}function k1(n,s){return new n({type:"string",format:"ipv6",check:"string_format",abort:!1,...fe(s)})}function L1(n,s){return new n({type:"string",format:"cidrv4",check:"string_format",abort:!1,...fe(s)})}function B1(n,s){return new n({type:"string",format:"cidrv6",check:"string_format",abort:!1,...fe(s)})}function P1(n,s){return new n({type:"string",format:"base64",check:"string_format",abort:!1,...fe(s)})}function F1(n,s){return new n({type:"string",format:"base64url",check:"string_format",abort:!1,...fe(s)})}function U1(n,s){return new n({type:"string",format:"e164",check:"string_format",abort:!1,...fe(s)})}function z1(n,s){return new n({type:"string",format:"jwt",check:"string_format",abort:!1,...fe(s)})}function H1(n,s){return new n({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...fe(s)})}function V1(n,s){return new n({type:"string",format:"date",check:"string_format",...fe(s)})}function Z1(n,s){return new n({type:"string",format:"time",check:"string_format",precision:null,...fe(s)})}function W1(n,s){return new n({type:"string",format:"duration",check:"string_format",...fe(s)})}function G1(n,s){return new n({type:"number",coerce:!0,checks:[],...fe(s)})}function Y1(n,s){return new n({type:"number",check:"number_format",abort:!1,format:"safeint",...fe(s)})}function X1(n){return new n({type:"unknown"})}function q1(n,s){return new n({type:"never",...fe(s)})}function Pa(n,s){return new Ho({check:"less_than",...fe(s),value:n,inclusive:!1})}function Gs(n,s){return new Ho({check:"less_than",...fe(s),value:n,inclusive:!0})}function Fa(n,s){return new Vo({check:"greater_than",...fe(s),value:n,inclusive:!1})}function Ys(n,s){return new Vo({check:"greater_than",...fe(s),value:n,inclusive:!0})}function Ua(n,s){return new gh({check:"multiple_of",...fe(s),value:n})}function Xo(n,s){return new mh({check:"max_length",...fe(s),maximum:n})}function as(n,s){return new ph({check:"min_length",...fe(s),minimum:n})}function qo(n,s){return new yh({check:"length_equals",...fe(s),length:n})}function $1(n,s){return new wh({check:"string_format",format:"regex",...fe(s),pattern:n})}function Q1(n){return new bh({check:"string_format",format:"lowercase",...fe(n)})}function K1(n){return new Ch({check:"string_format",format:"uppercase",...fe(n)})}function J1(n,s){return new Ah({check:"string_format",format:"includes",...fe(s),includes:n})}function ef(n,s){return new Nh({check:"string_format",format:"starts_with",...fe(s),prefix:n})}function tf(n,s){return new Eh({check:"string_format",format:"ends_with",...fe(s),suffix:n})}function Mr(n){return new vh({check:"overwrite",tx:n})}function nf(n){return Mr(s=>s.normalize(n))}function rf(){return Mr(n=>n.trim())}function sf(){return Mr(n=>n.toLowerCase())}function af(){return Mr(n=>n.toUpperCase())}function of(n,s,o){return new n({type:"array",element:s,...fe(o)})}function lf(n,s,o){return new n({type:"custom",check:"custom",fn:s,...fe(o)})}function cf(n){const s=uf(o=>(o.addIssue=u=>{if(typeof u=="string")o.issues.push(Ir(u,o.value,s._zod.def));else{const h=u;h.fatal&&(h.continue=!1),h.code??(h.code="custom"),h.input??(h.input=o.value),h.inst??(h.inst=s),h.continue??(h.continue=!s._zod.def.abort),o.issues.push(Ir(h))}},n(o.value,o)));return s}function uf(n,s){const o=new Ot({check:"custom",...fe(s)});return o._zod.check=n,o}const df=Y("ZodISODateTime",(n,s)=>{Fh.init(n,s),Ge.init(n,s)});function hf(n){return H1(df,n)}const ff=Y("ZodISODate",(n,s)=>{Uh.init(n,s),Ge.init(n,s)});function gf(n){return V1(ff,n)}const xf=Y("ZodISOTime",(n,s)=>{zh.init(n,s),Ge.init(n,s)});function mf(n){return Z1(xf,n)}const pf=Y("ZodISODuration",(n,s)=>{Hh.init(n,s),Ge.init(n,s)});function yf(n){return W1(pf,n)}const $o=(n,s)=>{Lo.init(n,s),n.name="ZodError",Object.defineProperties(n,{format:{value:o=>M0(n,o)},flatten:{value:o=>O0(n,o)},addIssue:{value:o=>{n.issues.push(o),n.message=JSON.stringify(n.issues,ii,2)}},addIssues:{value:o=>{n.issues.push(...o),n.message=JSON.stringify(n.issues,ii,2)}},isEmpty:{get(){return n.issues.length===0}}})},wf=Y("ZodError",$o),Zt=Y("ZodError",$o,{Parent:Error}),bf=Ai(Zt),Cf=Ni(Zt),Af=gs(Zt),Nf=xs(Zt),Ef=R0(Zt),vf=k0(Zt),_f=L0(Zt),Sf=B0(Zt),If=P0(Zt),Tf=F0(Zt),Of=U0(Zt),Mf=z0(Zt),ut=Y("ZodType",(n,s)=>(st.init(n,s),n.def=s,n.type=s.type,Object.defineProperty(n,"_def",{value:s}),n.check=(...o)=>n.clone(Yn(s,{checks:[...s.checks??[],...o.map(u=>typeof u=="function"?{_zod:{check:u,def:{check:"custom"},onattach:[]}}:u)]})),n.clone=(o,u)=>jn(n,o,u),n.brand=()=>n,n.register=(o,u)=>(o.add(n,u),n),n.parse=(o,u)=>bf(n,o,u,{callee:n.parse}),n.safeParse=(o,u)=>Af(n,o,u),n.parseAsync=async(o,u)=>Cf(n,o,u,{callee:n.parseAsync}),n.safeParseAsync=async(o,u)=>Nf(n,o,u),n.spa=n.safeParseAsync,n.encode=(o,u)=>Ef(n,o,u),n.decode=(o,u)=>vf(n,o,u),n.encodeAsync=async(o,u)=>_f(n,o,u),n.decodeAsync=async(o,u)=>Sf(n,o,u),n.safeEncode=(o,u)=>If(n,o,u),n.safeDecode=(o,u)=>Tf(n,o,u),n.safeEncodeAsync=async(o,u)=>Of(n,o,u),n.safeDecodeAsync=async(o,u)=>Mf(n,o,u),n.refine=(o,u)=>n.check(bg(o,u)),n.superRefine=o=>n.check(Cg(o)),n.overwrite=o=>n.check(Mr(o)),n.optional=()=>Za(n),n.nullable=()=>Wa(n),n.nullish=()=>Za(Wa(n)),n.nonoptional=o=>fg(n,o),n.array=()=>Jo(n),n.or=o=>rg([n,o]),n.and=o=>ig(n,o),n.transform=o=>Ga(n,og(o)),n.default=o=>ug(n,o),n.prefault=o=>hg(n,o),n.catch=o=>xg(n,o),n.pipe=o=>Ga(n,o),n.readonly=()=>yg(n),n.describe=o=>{const u=n.clone();return Xr.add(u,{description:o}),u},Object.defineProperty(n,"description",{get(){return Xr.get(n)?.description},configurable:!0}),n.meta=(...o)=>{if(o.length===0)return Xr.get(n);const u=n.clone();return Xr.add(u,o[0]),u},n.isOptional=()=>n.safeParse(void 0).success,n.isNullable=()=>n.safeParse(null).success,n)),Qo=Y("_ZodString",(n,s)=>{Ei.init(n,s),ut.init(n,s);const o=n._zod.bag;n.format=o.format??null,n.minLength=o.minimum??null,n.maxLength=o.maximum??null,n.regex=(...u)=>n.check($1(...u)),n.includes=(...u)=>n.check(J1(...u)),n.startsWith=(...u)=>n.check(ef(...u)),n.endsWith=(...u)=>n.check(tf(...u)),n.min=(...u)=>n.check(as(...u)),n.max=(...u)=>n.check(Xo(...u)),n.length=(...u)=>n.check(qo(...u)),n.nonempty=(...u)=>n.check(as(1,...u)),n.lowercase=u=>n.check(Q1(u)),n.uppercase=u=>n.check(K1(u)),n.trim=()=>n.check(rf()),n.normalize=(...u)=>n.check(nf(...u)),n.toLowerCase=()=>n.check(sf()),n.toUpperCase=()=>n.check(af())}),Df=Y("ZodString",(n,s)=>{Ei.init(n,s),Qo.init(n,s),n.email=o=>n.check(C1(jf,o)),n.url=o=>n.check(_1(Rf,o)),n.jwt=o=>n.check(z1(qf,o)),n.emoji=o=>n.check(S1(kf,o)),n.guid=o=>n.check(Ba(za,o)),n.uuid=o=>n.check(A1(qr,o)),n.uuidv4=o=>n.check(N1(qr,o)),n.uuidv6=o=>n.check(E1(qr,o)),n.uuidv7=o=>n.check(v1(qr,o)),n.nanoid=o=>n.check(I1(Lf,o)),n.guid=o=>n.check(Ba(za,o)),n.cuid=o=>n.check(T1(Bf,o)),n.cuid2=o=>n.check(O1(Pf,o)),n.ulid=o=>n.check(M1(Ff,o)),n.base64=o=>n.check(P1(Gf,o)),n.base64url=o=>n.check(F1(Yf,o)),n.xid=o=>n.check(D1(Uf,o)),n.ksuid=o=>n.check(j1(zf,o)),n.ipv4=o=>n.check(R1(Hf,o)),n.ipv6=o=>n.check(k1(Vf,o)),n.cidrv4=o=>n.check(L1(Zf,o)),n.cidrv6=o=>n.check(B1(Wf,o)),n.e164=o=>n.check(U1(Xf,o)),n.datetime=o=>n.check(hf(o)),n.date=o=>n.check(gf(o)),n.time=o=>n.check(mf(o)),n.duration=o=>n.check(yf(o))});function bt(n){return b1(Df,n)}const Ge=Y("ZodStringFormat",(n,s)=>{Ze.init(n,s),Qo.init(n,s)}),jf=Y("ZodEmail",(n,s)=>{Oh.init(n,s),Ge.init(n,s)}),za=Y("ZodGUID",(n,s)=>{Ih.init(n,s),Ge.init(n,s)}),qr=Y("ZodUUID",(n,s)=>{Th.init(n,s),Ge.init(n,s)}),Rf=Y("ZodURL",(n,s)=>{Mh.init(n,s),Ge.init(n,s)}),kf=Y("ZodEmoji",(n,s)=>{Dh.init(n,s),Ge.init(n,s)}),Lf=Y("ZodNanoID",(n,s)=>{jh.init(n,s),Ge.init(n,s)}),Bf=Y("ZodCUID",(n,s)=>{Rh.init(n,s),Ge.init(n,s)}),Pf=Y("ZodCUID2",(n,s)=>{kh.init(n,s),Ge.init(n,s)}),Ff=Y("ZodULID",(n,s)=>{Lh.init(n,s),Ge.init(n,s)}),Uf=Y("ZodXID",(n,s)=>{Bh.init(n,s),Ge.init(n,s)}),zf=Y("ZodKSUID",(n,s)=>{Ph.init(n,s),Ge.init(n,s)}),Hf=Y("ZodIPv4",(n,s)=>{Vh.init(n,s),Ge.init(n,s)}),Vf=Y("ZodIPv6",(n,s)=>{Zh.init(n,s),Ge.init(n,s)}),Zf=Y("ZodCIDRv4",(n,s)=>{Wh.init(n,s),Ge.init(n,s)}),Wf=Y("ZodCIDRv6",(n,s)=>{Gh.init(n,s),Ge.init(n,s)}),Gf=Y("ZodBase64",(n,s)=>{Yh.init(n,s),Ge.init(n,s)}),Yf=Y("ZodBase64URL",(n,s)=>{qh.init(n,s),Ge.init(n,s)}),Xf=Y("ZodE164",(n,s)=>{$h.init(n,s),Ge.init(n,s)}),qf=Y("ZodJWT",(n,s)=>{Kh.init(n,s),Ge.init(n,s)}),Ko=Y("ZodNumber",(n,s)=>{Wo.init(n,s),ut.init(n,s),n.gt=(u,h)=>n.check(Fa(u,h)),n.gte=(u,h)=>n.check(Ys(u,h)),n.min=(u,h)=>n.check(Ys(u,h)),n.lt=(u,h)=>n.check(Pa(u,h)),n.lte=(u,h)=>n.check(Gs(u,h)),n.max=(u,h)=>n.check(Gs(u,h)),n.int=u=>n.check(Ha(u)),n.safe=u=>n.check(Ha(u)),n.positive=u=>n.check(Fa(0,u)),n.nonnegative=u=>n.check(Ys(0,u)),n.negative=u=>n.check(Pa(0,u)),n.nonpositive=u=>n.check(Gs(0,u)),n.multipleOf=(u,h)=>n.check(Ua(u,h)),n.step=(u,h)=>n.check(Ua(u,h)),n.finite=()=>n;const o=n._zod.bag;n.minValue=Math.max(o.minimum??Number.NEGATIVE_INFINITY,o.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,n.maxValue=Math.min(o.maximum??Number.POSITIVE_INFINITY,o.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,n.isInt=(o.format??"").includes("int")||Number.isSafeInteger(o.multipleOf??.5),n.isFinite=!0,n.format=o.format??null}),$f=Y("ZodNumberFormat",(n,s)=>{Jh.init(n,s),Ko.init(n,s)});function Ha(n){return Y1($f,n)}const Qf=Y("ZodUnknown",(n,s)=>{e1.init(n,s),ut.init(n,s)});function Va(){return X1(Qf)}const Kf=Y("ZodNever",(n,s)=>{t1.init(n,s),ut.init(n,s)});function Jf(n){return q1(Kf,n)}const eg=Y("ZodArray",(n,s)=>{n1.init(n,s),ut.init(n,s),n.element=s.element,n.min=(o,u)=>n.check(as(o,u)),n.nonempty=o=>n.check(as(1,o)),n.max=(o,u)=>n.check(Xo(o,u)),n.length=(o,u)=>n.check(qo(o,u)),n.unwrap=()=>n.element});function Jo(n,s){return of(eg,n,s)}const tg=Y("ZodObject",(n,s)=>{s1.init(n,s),ut.init(n,s),Pe(n,"shape",()=>s.shape),n.keyof=()=>os(Object.keys(n._zod.def.shape)),n.catchall=o=>n.clone({...n._zod.def,catchall:o}),n.passthrough=()=>n.clone({...n._zod.def,catchall:Va()}),n.loose=()=>n.clone({...n._zod.def,catchall:Va()}),n.strict=()=>n.clone({...n._zod.def,catchall:Jf()}),n.strip=()=>n.clone({...n._zod.def,catchall:void 0}),n.extend=o=>v0(n,o),n.safeExtend=o=>_0(n,o),n.merge=o=>S0(n,o),n.pick=o=>N0(n,o),n.omit=o=>E0(n,o),n.partial=(...o)=>I0(el,n,o[0]),n.required=(...o)=>T0(tl,n,o[0])});function vi(n,s){const o={type:"object",shape:n??{},...fe(s)};return new tg(o)}const ng=Y("ZodUnion",(n,s)=>{i1.init(n,s),ut.init(n,s),n.options=s.options});function rg(n,s){return new ng({type:"union",options:n,...fe(s)})}const sg=Y("ZodIntersection",(n,s)=>{a1.init(n,s),ut.init(n,s)});function ig(n,s){return new sg({type:"intersection",left:n,right:s})}const oi=Y("ZodEnum",(n,s)=>{o1.init(n,s),ut.init(n,s),n.enum=s.entries,n.options=Object.values(s.entries);const o=new Set(Object.keys(s.entries));n.extract=(u,h)=>{const f={};for(const m of u)if(o.has(m))f[m]=s.entries[m];else throw new Error(`Key ${m} not found in enum`);return new oi({...s,checks:[],...fe(h),entries:f})},n.exclude=(u,h)=>{const f={...s.entries};for(const m of u)if(o.has(m))delete f[m];else throw new Error(`Key ${m} not found in enum`);return new oi({...s,checks:[],...fe(h),entries:f})}});function os(n,s){const o=Array.isArray(n)?Object.fromEntries(n.map(u=>[u,u])):n;return new oi({type:"enum",entries:o,...fe(s)})}const ag=Y("ZodTransform",(n,s)=>{l1.init(n,s),ut.init(n,s),n._zod.parse=(o,u)=>{if(u.direction==="backward")throw new Oo(n.constructor.name);o.addIssue=f=>{if(typeof f=="string")o.issues.push(Ir(f,o.value,s));else{const m=f;m.fatal&&(m.continue=!1),m.code??(m.code="custom"),m.input??(m.input=o.value),m.inst??(m.inst=n),o.issues.push(Ir(m))}};const h=s.transform(o.value,o);return h instanceof Promise?h.then(f=>(o.value=f,o)):(o.value=h,o)}});function og(n){return new ag({type:"transform",transform:n})}const el=Y("ZodOptional",(n,s)=>{c1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType});function Za(n){return new el({type:"optional",innerType:n})}const lg=Y("ZodNullable",(n,s)=>{u1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType});function Wa(n){return new lg({type:"nullable",innerType:n})}const cg=Y("ZodDefault",(n,s)=>{d1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType,n.removeDefault=n.unwrap});function ug(n,s){return new cg({type:"default",innerType:n,get defaultValue(){return typeof s=="function"?s():jo(s)}})}const dg=Y("ZodPrefault",(n,s)=>{h1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType});function hg(n,s){return new dg({type:"prefault",innerType:n,get defaultValue(){return typeof s=="function"?s():jo(s)}})}const tl=Y("ZodNonOptional",(n,s)=>{f1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType});function fg(n,s){return new tl({type:"nonoptional",innerType:n,...fe(s)})}const gg=Y("ZodCatch",(n,s)=>{g1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType,n.removeCatch=n.unwrap});function xg(n,s){return new gg({type:"catch",innerType:n,catchValue:typeof s=="function"?s:()=>s})}const mg=Y("ZodPipe",(n,s)=>{x1.init(n,s),ut.init(n,s),n.in=s.in,n.out=s.out});function Ga(n,s){return new mg({type:"pipe",in:n,out:s})}const pg=Y("ZodReadonly",(n,s)=>{m1.init(n,s),ut.init(n,s),n.unwrap=()=>n._zod.def.innerType});function yg(n){return new pg({type:"readonly",innerType:n})}const wg=Y("ZodCustom",(n,s)=>{p1.init(n,s),ut.init(n,s)});function bg(n,s={}){return lf(wg,n,s)}function Cg(n){return cf(n)}function _i(n){return G1(Ko,n)}const Xs=n=>_i().min(0,`${n} must be 0 or greater`),Ag=vi({sku:bt().trim().min(1,"SKU is required"),name:bt().trim().min(1,"Item name is required"),category:bt().trim().min(1,"Category is required"),current_stock:Xs("Current stock"),min_stock:Xs("Minimum stock"),max_stock:Xs("Maximum stock"),unit:bt().trim().min(1,"Unit is required"),location:bt().trim().min(1,"Location is required")}),Ng=vi({title:bt().trim().min(1,"Title is required"),description:bt().trim().min(1,"Description is required"),priority:os(["low","medium","high"]),assigned_to:bt().trim().min(1,"Assigned to is required"),location:bt().trim().min(1,"Location is required"),estimated_hours:_i().min(1,"Estimated hours must be at least 1"),due_date:bt().min(1,"Due date is required"),tags:Jo(bt()).default([])}),Eg=vi({equipment_name:bt().trim().min(1,"Equipment name is required"),defect_tag:bt().trim().min(1,"Defect tag is required"),priority:os(["low","medium","high"]),description:bt().trim().min(1,"Description is required"),estimated_cost:_i().min(0,"Estimated cost must be 0 or greater"),assigned_technician:bt().trim().min(1,"Assigned technician is required"),warranty_status:os(["in_warranty","out_of_warranty","extended"]),estimated_completion:bt().min(1,"Estimated completion date is required")}),Si=(n,s)=>{try{return{success:!0,data:n.parse(s)}}catch(o){return o instanceof wf?{success:!1,errors:o.issues.reduce((h,f)=>{const m=f.path.join(".");return h[m]=f.message,h},{})}:{success:!1,errors:{general:"Validation failed"}}}};function Qe({label:n,name:s,type:o="text",placeholder:u,required:h=!1,error:f,value:m,onChange:w,className:E=""}){const p=A=>{const N=o==="number"?parseFloat(A.target.value)||0:A.target.value;w?.(N)};return c.jsxs("div",{className:`space-y-1 ${E}`,children:[c.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700",children:[n,h&&c.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),c.jsx("input",{id:s,name:s,type:o,value:m??"",onChange:p,placeholder:u,required:h,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors ${f?"border-red-300 focus:ring-red-500":"border-gray-300 hover:border-gray-400"}`}),f&&c.jsx("p",{className:"text-sm text-red-600 mt-1",children:f})]})}function In({label:n,name:s,value:o,onChange:u,options:h,placeholder:f="Select an option",required:m=!1,error:w,className:E=""}){const p=A=>{u?.(A.target.value)};return c.jsxs("div",{className:`space-y-1 ${E}`,children:[c.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700",children:[n,m&&c.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("select",{id:s,name:s,value:o||"",onChange:p,required:m,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors appearance-none pr-10 ${w?"border-red-300 focus:ring-red-500":"border-gray-300 hover:border-gray-400"}`,children:[c.jsx("option",{value:"",children:f}),h.map(A=>c.jsx("option",{value:A.value,children:A.label},A.value))]}),c.jsx(Kl,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),w&&c.jsx("p",{className:"text-sm text-red-600 mt-1",children:w})]})}function ps({size:n="md",color:s="primary",className:o=""}){const u={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"},h={primary:"border-green-600",secondary:"border-gray-600",white:"border-white"};return c.jsx("div",{className:`animate-spin rounded-full border-2 border-t-transparent ${u[n]} ${h[s]} ${o}`,role:"status","aria-label":"Loading",children:c.jsx("span",{className:"sr-only",children:"Loading..."})})}const vg=[{value:"Fluids",label:"Fluids"},{value:"Filters",label:"Filters"},{value:"Engine Parts",label:"Engine Parts"},{value:"Tires",label:"Tires"},{value:"Tools",label:"Tools"},{value:"Safety Equipment",label:"Safety Equipment"},{value:"Electrical",label:"Electrical"},{value:"Hardware",label:"Hardware"}],_g=[{value:"Units",label:"Units"},{value:"Liters",label:"Liters"},{value:"Sets",label:"Sets"},{value:"Boxes",label:"Boxes"},{value:"Meters",label:"Meters"},{value:"Kilograms",label:"Kilograms"}];function Sg({isOpen:n,onClose:s,onSubmit:o,item:u,loading:h=!1}){const f=()=>({sku:"",name:"",category:"",current_stock:0,min_stock:0,max_stock:100,unit:"",location:""}),[m,w]=T.useState(()=>f()),[E,p]=T.useState({});T.useEffect(()=>{w(u?{sku:u.sku,name:u.name,category:u.category,current_stock:u.current_stock,min_stock:u.min_stock,max_stock:u.max_stock,unit:u.unit,location:u.location}:f()),p({})},[u,n]);const A=I=>{I.preventDefault();const M=Si(Ag,m);if(!M.success||!M.data){p(M.errors??{});return}const H=M.data;if(H.min_stock>=H.max_stock){p({min_stock:"Min stock must be less than max stock"});return}(async()=>{try{await o(H),s()}catch(k){console.error("Failed to submit form:",k)}})()},N=(I,M)=>{const H=M;w(k=>({...k,[I]:H})),E[I]&&p(k=>({...k,[I]:void 0}))};return c.jsx(Or,{isOpen:n,onClose:s,title:c.jsxs("div",{className:"flex items-center",children:[c.jsx(Ht,{className:"h-6 w-6 text-green-600 mr-2"}),u?"Edit Inventory Item":"Add New Inventory Item"]}),size:"lg",children:c.jsxs("form",{onSubmit:A,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(Qe,{label:"SKU",name:"sku",value:m.sku,onChange:I=>N("sku",I),placeholder:"e.g., HYD-001",required:!0,error:E.sku}),c.jsx(Qe,{label:"Item Name",name:"name",value:m.name,onChange:I=>N("name",I),placeholder:"e.g., Hydraulic Fluid - Premium Grade",required:!0,error:E.name}),c.jsx(In,{label:"Category",name:"category",value:m.category,onChange:I=>N("category",I),options:vg,required:!0,error:E.category}),c.jsx(In,{label:"Unit",name:"unit",value:m.unit,onChange:I=>N("unit",I),options:_g,required:!0,error:E.unit}),c.jsx(Qe,{label:"Current Stock",name:"current_stock",type:"number",value:m.current_stock,onChange:I=>N("current_stock",I),required:!0,error:E.current_stock}),c.jsx(Qe,{label:"Location",name:"location",value:m.location,onChange:I=>N("location",I),placeholder:"e.g., Warehouse A-1",required:!0,error:E.location}),c.jsx(Qe,{label:"Minimum Stock",name:"min_stock",type:"number",value:m.min_stock,onChange:I=>N("min_stock",I),required:!0,error:E.min_stock}),c.jsx(Qe,{label:"Maximum Stock",name:"max_stock",type:"number",value:m.max_stock,onChange:I=>N("max_stock",I),required:!0,error:E.max_stock})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:s,disabled:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),c.jsxs("button",{type:"submit",disabled:h,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:opacity-50",children:[h&&c.jsx(ps,{size:"sm",color:"white",className:"mr-2"}),u?"Update Item":"Create Item"]})]})]})})}function Ig(){const{items:n,loading:s,create:o,update:u,delete:h,refresh:f}=an("inventory_items"),[m,w]=T.useState(""),[E,p]=T.useState("all"),[A,N]=T.useState(!1),[I,M]=T.useState(!1),[H,k]=T.useState(null);T.useEffect(()=>{f()},[f]);const j=n.filter(U=>{const L=U.name.toLowerCase().includes(m.toLowerCase())||U.sku.toLowerCase().includes(m.toLowerCase()),Oe=E==="all"||U.category===E;return L&&Oe}),W=["all",...Array.from(new Set(n.map(U=>U.category)))],G=async U=>{if(H)await u(H.id,U);else{const L=U.current_stock===0?"out_of_stock":U.current_stock<=U.min_stock?"low_stock":"in_stock";await o({...U,supplier:U.supplier||null,unit_cost:U.unit_cost??null,status:L,last_updated:new Date().toISOString()})}await f()},B=U=>{k(U),M(!0)},K=async U=>{confirm("Are you sure you want to delete this item?")&&await h(U)},we=()=>{M(!1),k(null)},re=U=>{switch(U){case"in_stock":return"text-green-600 bg-green-100";case"low_stock":return"text-yellow-600 bg-yellow-100";case"out_of_stock":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},$=U=>{switch(U){case"in_stock":return c.jsx(ls,{className:"h-4 w-4"});case"low_stock":return c.jsx(Hn,{className:"h-4 w-4"});case"out_of_stock":return c.jsx(Ht,{className:"h-4 w-4"});default:return c.jsx(Ht,{className:"h-4 w-4"})}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search inventory...",value:m,onChange:U=>w(U.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:()=>N(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[c.jsx(Jl,{className:"h-5 w-5 mr-2"}),"Scan Item"]}),c.jsxs("button",{onClick:()=>M(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Add Item"]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx(ec,{className:"h-5 w-5 text-gray-400"}),c.jsx("select",{value:E,onChange:U=>p(U.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:W.map(U=>c.jsx("option",{value:U,children:U==="all"?"All Categories":U},U))})]}),s?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading inventory..."})]})}):j.length===0?c.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[c.jsx(Ht,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No inventory items found"}),c.jsx("p",{className:"text-gray-400 text-sm mt-2",children:m||E!=="all"?"Try adjusting your filters":"Add your first inventory item to get started"})]}):c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:j.map((U,L)=>c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:L*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:U.name}),c.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",U.sku]})]}),c.jsxs("div",{className:`flex items-center px-2 py-1 rounded-full text-xs font-medium ${re(U.status)}`,children:[$(U.status),c.jsx("span",{className:"ml-1 capitalize",children:U.status.replace("_"," ")})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Current Stock:"}),c.jsxs("span",{className:"text-sm font-medium",children:[U.current_stock," ",U.unit]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Min Stock:"}),c.jsxs("span",{className:"text-sm font-medium",children:[U.min_stock," ",U.unit]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Location:"}),c.jsx("span",{className:"text-sm font-medium",children:U.location})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${U.current_stock===0?"bg-red-500":U.current_stock<=U.min_stock?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(U.current_stock/U.max_stock*100,100)}%`}})})]}),c.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 flex gap-2",children:[c.jsx("button",{onClick:()=>B(U),className:"flex-1 text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>{K(U.id)},className:"flex-1 text-red-600 hover:text-red-700 text-sm font-medium",children:"Delete"})]})]},U.id))}),A&&c.jsx(m0,{isOpen:A,onClose:()=>N(!1),onScan:U=>{console.log("Scanned:",U),N(!1)}}),c.jsx(Sg,{isOpen:I,onClose:we,onSubmit:G,item:H,loading:s})]})}function Tg({jobs:n,columns:s}){const o=f=>{switch(f){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},u=f=>new Date(f)<new Date,h=f=>n.filter(m=>m.status===f);return c.jsx("div",{className:"flex gap-6 overflow-x-auto pb-4",children:s.map((f,m)=>{const w=h(f.id);return c.jsx(tt.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:m*.1},className:"flex-shrink-0 w-80",children:c.jsxs("div",{className:`rounded-lg p-4 ${f.color}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:f.title}),c.jsx("span",{className:"px-2 py-1 bg-white bg-opacity-70 text-gray-700 text-sm rounded-full",children:w.length})]}),c.jsxs("div",{className:"space-y-3",children:[w.map((E,p)=>c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:m*.1+p*.05},className:"bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsx("h4",{className:"font-medium text-gray-900 text-sm leading-tight",children:E.title}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${o(E.priority)}`,children:E.priority}),u(E.dueDate)&&E.status!=="completed"&&c.jsx("div",{className:"flex items-center px-1 py-1 bg-red-100 text-red-800 rounded-full",children:c.jsx(Hn,{className:"h-3 w-3"})})]})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:E.description}),c.jsxs("div",{className:"space-y-2 mb-3",children:[c.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[c.jsx(ci,{className:"h-3 w-3 mr-1"}),E.assignedTo]}),c.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[c.jsx(Ka,{className:"h-3 w-3 mr-1"}),E.location]}),c.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[c.jsx(Vn,{className:"h-3 w-3 mr-1"}),E.estimatedHours,"h â¢ Due ",new Date(E.dueDate).toLocaleDateString()]})]}),c.jsxs("div",{className:"flex flex-wrap gap-1",children:[E.tags.slice(0,2).map(A=>c.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:A},A)),E.tags.length>2&&c.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",E.tags.length-2]})]})]},E.id)),w.length===0&&c.jsx("div",{className:"text-center py-8 text-gray-500",children:c.jsx("p",{className:"text-sm",children:"No jobs in this column"})})]})]})},f.id)})})}function Ii({label:n,name:s,value:o="",onChange:u,placeholder:h,required:f=!1,error:m,rows:w=3,maxLength:E,autoResize:p=!1,className:A=""}){const N=T.useRef(null),I=M=>{u?.(M.target.value)};return T.useEffect(()=>{if(p&&N.current){const M=N.current;M.style.height="auto",M.style.height=`${M.scrollHeight}px`}},[o,p]),c.jsxs("div",{className:`space-y-1 ${A}`,children:[c.jsxs("label",{htmlFor:s,className:"block text-sm font-medium text-gray-700",children:[n,f&&c.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),c.jsx("textarea",{ref:N,id:s,name:s,value:o,onChange:I,placeholder:h,required:f,rows:p?1:w,maxLength:E,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors resize-none ${m?"border-red-300 focus:ring-red-500":"border-gray-300 hover:border-gray-400"}`,style:p?{minHeight:`${w*1.5}rem`}:{}}),c.jsxs("div",{className:"flex justify-between items-center",children:[m&&c.jsx("p",{className:"text-sm text-red-600",children:m}),E&&c.jsxs("p",{className:"text-sm text-gray-500 ml-auto",children:[o.length,"/",E]})]})]})}const Og=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];function Mg({isOpen:n,onClose:s,onSubmit:o,item:u,loading:h=!1}){const[f,m]=T.useState({title:"",description:"",priority:"medium",assigned_to:"",location:"",estimated_hours:1,due_date:"",tags:[]}),[w,E]=T.useState({}),[p,A]=T.useState("");T.useEffect(()=>{m(u?{title:u.title,description:u.description,priority:u.priority,assigned_to:u.assigned_to,location:u.location,estimated_hours:u.estimated_hours,due_date:u.due_date?.split("T")[0]||"",tags:u.tags||[]}:{title:"",description:"",priority:"medium",assigned_to:"",location:"",estimated_hours:1,due_date:"",tags:[]}),E({}),A("")},[u,n]);const N=j=>{j.preventDefault();const W=Si(Ng,{...f,due_date:f.due_date+"T23:59:59Z"});if(!W.success){E(W.errors||{});return}o(W.data).then(()=>s()).catch(G=>{console.error("Failed to submit form:",G)})},I=(j,W)=>{m(G=>({...G,[j]:W})),w[j]&&E(G=>({...G,[j]:""}))},M=()=>{p.trim()&&!f.tags?.includes(p.trim())&&(I("tags",[...f.tags||[],p.trim()]),A(""))},H=j=>{I("tags",f.tags?.filter(W=>W!==j)||[])},k=j=>{j.key==="Enter"&&(j.preventDefault(),M())};return c.jsx(Or,{isOpen:n,onClose:s,title:c.jsxs("div",{className:"flex items-center",children:[c.jsx(tc,{className:"h-6 w-6 text-blue-600 mr-2"}),u?"Edit Job Card":"Add New Job Card"]}),size:"lg",children:c.jsxs("form",{onSubmit:N,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx("div",{className:"md:col-span-2",children:c.jsx(Qe,{label:"Job Title",name:"title",value:f.title,onChange:j=>I("title",j),placeholder:"e.g., Replace hydraulic pump",required:!0,error:w.title})}),c.jsx(In,{label:"Priority",name:"priority",value:f.priority,onChange:j=>I("priority",j),options:Og,required:!0,error:w.priority}),c.jsx(Qe,{label:"Assigned To",name:"assigned_to",value:f.assigned_to,onChange:j=>I("assigned_to",j),placeholder:"e.g., John Smith",required:!0,error:w.assigned_to}),c.jsx(Qe,{label:"Location",name:"location",value:f.location,onChange:j=>I("location",j),placeholder:"e.g., Field A, Workshop",required:!0,error:w.location}),c.jsx(Qe,{label:"Estimated Hours",name:"estimated_hours",type:"number",value:f.estimated_hours,onChange:j=>I("estimated_hours",j),required:!0,error:w.estimated_hours}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(Qe,{label:"Due Date",name:"due_date",type:"date",value:f.due_date,onChange:j=>I("due_date",j),required:!0,error:w.due_date})})]}),c.jsx(Ii,{label:"Description",name:"description",value:f.description,onChange:j=>I("description",j),placeholder:"Describe the job requirements and steps...",required:!0,rows:4,maxLength:1e3,error:w.description||void 0}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tags (Optional)"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"text",value:p,onChange:j=>A(j.target.value),onKeyPress:k,placeholder:"Add a tag...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),c.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add"})]}),f.tags&&f.tags.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2",children:f.tags.map((j,W)=>c.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[j,c.jsx("button",{type:"button",onClick:()=>H(j),className:"ml-1 text-blue-600 hover:text-blue-800",children:c.jsx(On,{className:"h-3 w-3"})})]},W))})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:s,disabled:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),c.jsxs("button",{type:"submit",disabled:h,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[h&&c.jsx(ps,{size:"sm",color:"white",className:"mr-2"}),u?"Update Job":"Create Job"]})]})]})})}const Dg=[{id:"todo",title:"To Do",color:"bg-gray-100"},{id:"in_progress",title:"In Progress",color:"bg-blue-100"},{id:"review",title:"Review",color:"bg-yellow-100"},{id:"completed",title:"Completed",color:"bg-green-100"}];function jg(){const{items:n,loading:s,create:o,update:u,delete:h,refresh:f}=an("job_cards"),[m,w]=T.useState(""),[E,p]=T.useState("all"),[A,N]=T.useState("all"),[I,M]=T.useState("kanban"),[H,k]=T.useState(!1),[j,W]=T.useState(null);T.useEffect(()=>{f()},[f]);const G=n.filter(R=>{const X=R.title.toLowerCase().includes(m.toLowerCase())||R.description.toLowerCase().includes(m.toLowerCase())||R.location.toLowerCase().includes(m.toLowerCase()),te=E==="all"||R.priority===E,ce=A==="all"||R.assigned_to===A;return X&&te&&ce}),B=Array.from(new Set(n.map(R=>R.assigned_to))),K=async R=>{confirm("Are you sure you want to delete this job?")&&await h(R)},we=async(R,X)=>{await u(R,{status:X})},re=async R=>{j?await u(j.id,R):await o({...R,status:"todo",actual_hours:R.actual_hours??null,notes:R.notes??null,completed_date:null}),await f()},$=R=>{W(R),k(!0)},U=()=>{k(!1),W(null)},L=R=>{switch(R){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},Oe=R=>new Date(R)<new Date;return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search jobs...",value:m,onChange:R=>w(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[c.jsx("button",{onClick:()=>M("kanban"),className:`px-4 py-2 text-sm font-medium ${I==="kanban"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Kanban"}),c.jsx("button",{onClick:()=>M("list"),className:`px-4 py-2 text-sm font-medium ${I==="list"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"List"})]}),c.jsxs("button",{onClick:()=>k(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"New Job"]})]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4",children:[c.jsxs("select",{value:E,onChange:R=>p(R.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Priorities"}),c.jsx("option",{value:"low",children:"Low Priority"}),c.jsx("option",{value:"medium",children:"Medium Priority"}),c.jsx("option",{value:"high",children:"High Priority"})]}),c.jsxs("select",{value:A,onChange:R=>N(R.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Assignees"}),B.map(R=>c.jsx("option",{value:R,children:R},R))]})]}),s?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading jobs..."})]})}):G.length===0?c.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[c.jsx("p",{className:"text-gray-500 text-lg",children:"No jobs found"}),c.jsx("p",{className:"text-gray-400 text-sm mt-2",children:m||E!=="all"||A!=="all"?"Try adjusting your filters":"Create your first job to get started"})]}):I==="kanban"?c.jsx(Tg,{jobs:G.map(R=>({id:R.id,title:R.title,description:R.description,priority:R.priority,status:R.status,assignedTo:R.assigned_to,location:R.location,estimatedHours:R.estimated_hours,dueDate:R.due_date,tags:R.tags})),columns:Dg}):c.jsx("div",{className:"space-y-4",children:G.map((R,X)=>c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:X*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[c.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-4",children:c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:R.title}),c.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(R.priority)}`,children:R.priority}),Oe(R.due_date)&&R.status!=="completed"&&c.jsxs("div",{className:"flex items-center px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:[c.jsx(Hn,{className:"h-3 w-3 mr-1"}),"Overdue"]})]}),c.jsx("p",{className:"text-gray-600 mb-3",children:R.description})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(ci,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsx("span",{className:"text-sm text-gray-600",children:R.assigned_to})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(Ka,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsx("span",{className:"text-sm text-gray-600",children:R.location})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(Vn,{className:"h-4 w-4 text-gray-400 mr-2"}),c.jsxs("span",{className:"text-sm text-gray-600",children:[R.estimated_hours,"h estimated"]})]}),c.jsx("div",{className:"flex items-center",children:c.jsxs("span",{className:"text-sm text-gray-600",children:["Due: ",new Date(R.due_date).toLocaleDateString()]})})]}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:R.tags.map(te=>c.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:te},te))}),c.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Status: ",c.jsx("span",{className:"font-medium capitalize",children:R.status.replace("_"," ")})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>$(R),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>{const te=R.status==="todo"?"in_progress":R.status==="in_progress"?"review":R.status==="review"?"completed":"todo";we(R.id,te)},className:"px-3 py-1 text-sm text-green-600 hover:text-green-700 font-medium",children:"Update Status"}),c.jsx("button",{onClick:()=>{K(R.id)},className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 font-medium",children:"Delete"})]})]})]},R.id))}),c.jsx(Mg,{isOpen:H,onClose:U,onSubmit:re,item:j,loading:s})]})}function Rg({maintenanceItems:n}){const[s,o]=T.useState(new Date),u=k=>new Date(k.getFullYear(),k.getMonth()+1,0).getDate(),h=k=>new Date(k.getFullYear(),k.getMonth(),1).getDay(),f=k=>{const j=new Date(s.getFullYear(),s.getMonth(),k);return n.filter(W=>new Date(W.scheduledDate).toDateString()===j.toDateString())},m=k=>{const j=new Date(s);k==="prev"?j.setMonth(s.getMonth()-1):j.setMonth(s.getMonth()+1),o(j)},w=k=>{switch(k){case"low":return"bg-green-500";case"medium":return"bg-yellow-500";case"high":return"bg-red-500";default:return"bg-gray-500"}},E=k=>{switch(k){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"upcoming":return"bg-orange-100 text-orange-800";default:return"bg-blue-100 text-blue-800"}},p=u(s),A=h(s),N=Array.from({length:p},(k,j)=>j+1),I=Array.from({length:A},(k,j)=>j),M=["January","February","March","April","May","June","July","August","September","October","November","December"],H=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[c.jsx(dn,{className:"h-6 w-6 mr-2 text-green-600"}),M[s.getMonth()]," ",s.getFullYear()]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>m("prev"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(nc,{className:"h-5 w-5"})}),c.jsx("button",{onClick:()=>m("next"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(rc,{className:"h-5 w-5"})})]})]}),c.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[H.map(k=>c.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:k},k)),I.map(k=>c.jsx("div",{className:"p-2 h-24"},`empty-${k}`)),N.map(k=>{const j=f(k),W=new Date().toDateString()===new Date(s.getFullYear(),s.getMonth(),k).toDateString();return c.jsxs(tt.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:k*.01},className:`p-2 h-24 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors ${W?"bg-green-50 border-green-200":""}`,children:[c.jsx("div",{className:`text-sm font-medium mb-1 ${W?"text-green-600":"text-gray-900"}`,children:k}),c.jsxs("div",{className:"space-y-1",children:[j.slice(0,2).map(G=>c.jsx("div",{className:`text-xs p-1 rounded text-center truncate ${E(G.status)}`,title:`${G.equipmentName} - ${G.maintenanceType}`,children:c.jsxs("div",{className:"flex items-center justify-center",children:[c.jsx("div",{className:`w-2 h-2 rounded-full mr-1 ${w(G.priority)}`}),c.jsx("span",{className:"truncate",children:G.maintenanceType})]})},G.id)),j.length>2&&c.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",j.length-2," more"]})]})]},k)})]}),c.jsxs("div",{className:"mt-6 flex flex-wrap gap-4 text-sm",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-2"}),c.jsx("span",{className:"text-gray-600",children:"High Priority"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),c.jsx("span",{className:"text-gray-600",children:"Medium Priority"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),c.jsx("span",{className:"text-gray-600",children:"Low Priority"})]})]})]})}const kg=[{value:"preventive",label:"Preventive"},{value:"predictive",label:"Predictive"},{value:"corrective",label:"Corrective"},{value:"routine",label:"Routine"},{value:"emergency",label:"Emergency"}],Lg=[{value:"hours",label:"Hours"},{value:"calendar",label:"Calendar"}],Bg=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];function Pg({isOpen:n,onClose:s,onSubmit:o,item:u,loading:h=!1}){const[f,m]=T.useState({equipment_name:"",maintenance_type:"preventive",interval_type:"hours",interval_value:100,current_hours:void 0,next_due_date:"",priority:"medium",assigned_technician:"",estimated_cost:void 0,notes:void 0}),[w,E]=T.useState({});T.useEffect(()=>{m(u?{equipment_name:u.equipment_name,maintenance_type:u.maintenance_type,interval_type:u.interval_type,interval_value:u.interval_value,current_hours:u.current_hours!==null?u.current_hours:void 0,next_due_date:u.next_due_date?.split("T")[0]||"",priority:u.priority,assigned_technician:u.assigned_technician,estimated_cost:u.estimated_cost!==null?u.estimated_cost:void 0,notes:u.notes!==null?u.notes:void 0}:{equipment_name:"",maintenance_type:"preventive",interval_type:"hours",interval_value:100,current_hours:void 0,next_due_date:"",priority:"medium",assigned_technician:"",estimated_cost:void 0,notes:void 0}),E({})},[u,n]);const p=N=>{N.preventDefault(),(async()=>{const I={};if(f.equipment_name.trim()||(I.equipment_name="Equipment name is required"),f.assigned_technician.trim()||(I.assigned_technician="Assigned technician is required"),f.next_due_date||(I.next_due_date="Next due date is required"),f.interval_value<=0&&(I.interval_value="Interval value must be greater than 0"),Object.keys(I).length>0){E(I);return}try{await o({...f,next_due_date:f.next_due_date+"T00:00:00Z"}),s()}catch(M){console.error("Failed to submit form:",M)}})()},A=(N,I)=>{m(M=>({...M,[N]:I})),w[N]&&E(M=>({...M,[N]:""}))};return c.jsx(Or,{isOpen:n,onClose:s,title:c.jsxs("div",{className:"flex items-center",children:[c.jsx(dn,{className:"h-6 w-6 text-green-600 mr-2"}),u?"Edit Maintenance Schedule":"Schedule New Maintenance"]}),size:"lg",children:c.jsxs("form",{onSubmit:p,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx("div",{className:"md:col-span-2",children:c.jsx(Qe,{label:"Equipment Name",name:"equipment_name",value:f.equipment_name,onChange:N=>A("equipment_name",N),placeholder:"e.g., John Deere 8370R Tractor",required:!0,error:w.equipment_name})}),c.jsx(In,{label:"Maintenance Type",name:"maintenance_type",value:f.maintenance_type,onChange:N=>A("maintenance_type",N),options:kg,required:!0,error:w.maintenance_type}),c.jsx(In,{label:"Priority",name:"priority",value:f.priority,onChange:N=>A("priority",N),options:Bg,required:!0,error:w.priority}),c.jsx(In,{label:"Interval Type",name:"interval_type",value:f.interval_type,onChange:N=>A("interval_type",N),options:Lg,required:!0,error:w.interval_type}),c.jsx(Qe,{label:"Interval Value",name:"interval_value",type:"number",value:f.interval_value,onChange:N=>A("interval_value",N),placeholder:"e.g., 250",required:!0,error:w.interval_value}),f.interval_type==="hours"&&c.jsx(Qe,{label:"Current Hours",name:"current_hours",type:"number",value:f.current_hours||0,onChange:N=>A("current_hours",N),placeholder:"e.g., 240",error:w.current_hours}),c.jsx(Qe,{label:"Next Due Date",name:"next_due_date",type:"date",value:f.next_due_date,onChange:N=>A("next_due_date",N),required:!0,error:w.next_due_date}),c.jsx(Qe,{label:"Assigned Technician",name:"assigned_technician",value:f.assigned_technician,onChange:N=>A("assigned_technician",N),placeholder:"e.g., Mike Johnson",required:!0,error:w.assigned_technician}),c.jsx(Qe,{label:"Estimated Cost",name:"estimated_cost",type:"number",value:f.estimated_cost||0,onChange:N=>A("estimated_cost",N),placeholder:"e.g., 500",error:w.estimated_cost})]}),c.jsx(Ii,{label:"Notes (Optional)",name:"notes",value:f.notes||"",onChange:N=>A("notes",N),placeholder:"Additional maintenance notes...",rows:3,error:w.notes}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:s,disabled:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),c.jsxs("button",{type:"submit",disabled:h,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:opacity-50",children:[h&&c.jsx(ps,{size:"sm",color:"white",className:"mr-2"}),u?"Update Schedule":"Create Schedule"]})]})]})})}function Fg(){const{items:n,loading:s,create:o,update:u,delete:h,refresh:f}=an("maintenance_schedules"),[m,w]=T.useState(""),[E,p]=T.useState("all"),[A,N]=T.useState("list"),[I,M]=T.useState(!1),[H,k]=T.useState(null);T.useEffect(()=>{f()},[f]);const j=n.filter(R=>{const X=R.equipment_name.toLowerCase().includes(m.toLowerCase())||R.maintenance_type.toLowerCase().includes(m.toLowerCase()),te=E==="all"||R.status===E;return X&&te}),W=n.filter(R=>R.failure_probability&&R.failure_probability>=40).map(R=>({equipmentId:R.id,equipmentName:R.equipment_name,component:R.maintenance_type,failureProbability:R.failure_probability/100,predictedFailureDate:R.next_due_date,recommendedAction:R.failure_probability>=70?"Schedule preventive maintenance":"Monitor closely",confidenceLevel:.85})),G=async R=>{H?await u(H.id,R):await o({...R,status:"scheduled",failure_probability:0}),await f()},B=async R=>{await G({...R,current_hours:R.current_hours!==void 0?R.current_hours:null,estimated_cost:R.estimated_cost!==void 0?R.estimated_cost:null,notes:R.notes!==void 0?R.notes:null})},K=R=>{k(R),M(!0)},we=async R=>{confirm("Are you sure you want to delete this maintenance schedule?")&&await h(R)},re=async R=>{await u(R.id,{status:"completed"})},$=()=>{M(!1),k(null)},U=R=>{switch(R){case"scheduled":return"text-blue-600 bg-blue-100";case"upcoming":return"text-orange-600 bg-orange-100";case"in_progress":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"overdue":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},L=R=>{switch(R){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},Oe=R=>R>=.7?"text-red-600 bg-red-100":R>=.4?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100";return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search maintenance...",value:m,onChange:R=>w(R.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[c.jsx("button",{onClick:()=>N("list"),className:`px-4 py-2 text-sm font-medium ${A==="list"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"List"}),c.jsx("button",{onClick:()=>N("calendar"),className:`px-4 py-2 text-sm font-medium ${A==="calendar"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Calendar"})]}),c.jsxs("button",{onClick:()=>M(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"Schedule Maintenance"]})]})]}),c.jsx("div",{className:"flex gap-4",children:c.jsxs("select",{value:E,onChange:R=>p(R.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Statuses"}),c.jsx("option",{value:"scheduled",children:"Scheduled"}),c.jsx("option",{value:"upcoming",children:"Upcoming"}),c.jsx("option",{value:"in_progress",children:"In Progress"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"overdue",children:"Overdue"})]})}),s?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading maintenance schedules..."})]})}):j.length===0?c.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[c.jsx("p",{className:"text-gray-500 text-lg",children:"No maintenance schedules found"}),c.jsx("p",{className:"text-gray-400 text-sm mt-2",children:m||E!=="all"?"Try adjusting your filters":"Schedule your first maintenance to get started"})]}):A==="calendar"?c.jsx(Rg,{maintenanceItems:j.map(R=>({id:R.id,equipmentName:R.equipment_name,maintenanceType:R.maintenance_type,scheduledDate:R.next_due_date,priority:R.priority,status:R.status}))}):c.jsxs("div",{className:"space-y-6",children:[W.length>0&&c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[c.jsx(ui,{className:"h-5 w-5 mr-2 text-blue-600"}),"Predictive Maintenance Alerts"]}),c.jsx("div",{className:"space-y-4",children:W.map((R,X)=>c.jsxs(tt.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:X*.1},className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h4",{className:"font-medium text-gray-900",children:R.equipmentName}),c.jsx("p",{className:"text-sm text-gray-600",children:R.component}),c.jsx("p",{className:"text-sm text-gray-500",children:R.recommendedAction})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${Oe(R.failureProbability)}`,children:[Math.round(R.failureProbability*100),"% Risk"]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Predicted: ",new Date(R.predictedFailureDate).toLocaleDateString()]})]})]},R.equipmentId))})]}),c.jsx("div",{className:"space-y-4",children:j.map((R,X)=>c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:X*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[c.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-4",children:c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:R.maintenance_type}),c.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${U(R.status)}`,children:R.status.replace("_"," ").charAt(0).toUpperCase()+R.status.replace("_"," ").slice(1)}),c.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(R.priority)}`,children:R.priority})]}),c.jsx("p",{className:"text-gray-600",children:R.equipment_name})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Next Due:"}),c.jsx("p",{className:"font-medium",children:new Date(R.next_due_date).toLocaleDateString()})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Assigned To:"}),c.jsx("p",{className:"font-medium",children:R.assigned_technician})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Interval:"}),c.jsxs("p",{className:"font-medium",children:[R.interval_value," ",R.interval_type]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:R.interval_type==="hours"?"Current Hours:":"Type:"}),c.jsx("p",{className:"font-medium",children:R.interval_type==="hours"?R.current_hours||0:R.interval_type})]})]}),R.interval_type==="hours"&&R.current_hours!==void 0&&c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[c.jsx("span",{children:"Progress to next service"}),c.jsxs("span",{children:[R.current_hours??0,"/",R.interval_value," hours"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${(R.current_hours??0)/R.interval_value>=.9?"bg-red-500":(R.current_hours??0)/R.interval_value>=.7?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min((R.current_hours??0)/R.interval_value*100,100)}%`}})})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[c.jsxs("div",{className:"text-sm text-gray-500",children:["Status: ",R.status.replace("_"," ")]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>K(R),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Edit"}),R.status!=="completed"&&c.jsx("button",{onClick:()=>{re(R)},className:"px-3 py-1 text-sm text-green-600 hover:text-green-700 font-medium",children:"Mark Complete"}),c.jsx("button",{onClick:()=>{we(R.id)},className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 font-medium",children:"Delete"})]})]})]},R.id))})]}),c.jsx(Pg,{isOpen:I,onClose:$,onSubmit:B,item:H,loading:s})]})}const Ug=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],zg=[{value:"in_warranty",label:"In Warranty"},{value:"out_of_warranty",label:"Out of Warranty"},{value:"extended",label:"Extended Warranty"}];function Hg({isOpen:n,onClose:s,onSubmit:o,item:u,loading:h=!1}){const[f,m]=T.useState({equipment_name:"",defect_tag:"",priority:"medium",description:"",estimated_cost:0,assigned_technician:"",warranty_status:"out_of_warranty",estimated_completion:""}),[w,E]=T.useState({});T.useEffect(()=>{m(u?{equipment_name:u.equipment_name,defect_tag:u.defect_tag,priority:u.priority,description:u.description,estimated_cost:u.estimated_cost,assigned_technician:u.assigned_technician,warranty_status:u.warranty_status,estimated_completion:u.estimated_completion?.split("T")[0]??""}:{equipment_name:"",defect_tag:"",priority:"medium",description:"",estimated_cost:0,assigned_technician:"",warranty_status:"out_of_warranty",estimated_completion:""}),E({})},[u,n]);const p=N=>{N.preventDefault(),(async()=>{const I=Si(Eg,{...f,estimated_completion:f.estimated_completion+"T00:00:00Z"});if(!I.success){E(I.errors||{});return}try{await o(I.data),s()}catch(M){console.error("Failed to submit form:",M)}})()},A=(N,I)=>{m(M=>({...M,[N]:I})),w[N]&&E(M=>{const H={...M};return delete H[N],H})};return c.jsx(Or,{isOpen:n,onClose:s,title:c.jsxs("div",{className:"flex items-center",children:[c.jsx(ar,{className:"h-6 w-6 text-orange-600 mr-2"}),u?"Edit Repair Item":"Add New Repair Item"]}),size:"lg",children:c.jsxs("form",{onSubmit:p,className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsx(Qe,{label:"Equipment Name",name:"equipment_name",value:f.equipment_name,onChange:N=>A("equipment_name",N),placeholder:"e.g., John Deere 6120",required:!0,error:w.equipment_name}),c.jsx(Qe,{label:"Defect Tag",name:"defect_tag",value:f.defect_tag,onChange:N=>A("defect_tag",N),placeholder:"e.g., DEF-001",required:!0,error:w.defect_tag}),c.jsx(In,{label:"Priority",name:"priority",value:f.priority,onChange:N=>A("priority",N),options:Ug,required:!0,error:w.priority}),c.jsx(Qe,{label:"Assigned Technician",name:"assigned_technician",value:f.assigned_technician,onChange:N=>A("assigned_technician",N),placeholder:"e.g., John Smith",required:!0,error:w.assigned_technician}),c.jsx(Qe,{label:"Estimated Cost",name:"estimated_cost",type:"number",value:f.estimated_cost,onChange:N=>A("estimated_cost",N),required:!0,error:w.estimated_cost}),c.jsx(In,{label:"Warranty Status",name:"warranty_status",value:f.warranty_status,onChange:N=>A("warranty_status",N),options:zg,required:!0,error:w.warranty_status}),c.jsx("div",{className:"md:col-span-2",children:c.jsx(Qe,{label:"Estimated Completion",name:"estimated_completion",type:"date",value:f.estimated_completion,onChange:N=>A("estimated_completion",N),required:!0,error:w.estimated_completion})})]}),c.jsx(Ii,{label:"Description",name:"description",value:f.description,onChange:N=>A("description",N),placeholder:"Describe the issue and required repairs...",required:!0,rows:4,maxLength:500,error:w.description}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[c.jsx("button",{type:"button",onClick:s,disabled:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),c.jsxs("button",{type:"submit",disabled:h,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-orange-600 rounded-lg hover:bg-orange-700 disabled:opacity-50",children:[h&&c.jsx(ps,{size:"sm",color:"white",className:"mr-2"}),u?"Update Repair":"Create Repair"]})]})]})})}function Vg(){const{items:n,loading:s,create:o,update:u,delete:h,refresh:f}=an("repair_items"),[m,w]=T.useState(""),[E,p]=T.useState("all"),[A,N]=T.useState("all"),[I,M]=T.useState(!1),[H,k]=T.useState(null);T.useEffect(()=>{f()},[f]);const j=n.filter(L=>{const Oe=L.equipment_name.toLowerCase().includes(m.toLowerCase())||L.defect_tag.toLowerCase().includes(m.toLowerCase())||L.description.toLowerCase().includes(m.toLowerCase()),R=E==="all"||L.status===E,X=A==="all"||L.priority===A;return Oe&&R&&X}),W=async L=>{if(H)await u(H.id,L);else{const Oe={equipment_name:L.equipment_name,defect_tag:L.defect_tag,priority:L.priority,status:"pending",description:L.description,estimated_cost:L.estimated_cost,actual_cost:L.actual_cost??null,assigned_technician:L.assigned_technician,photo_urls:[],warranty_status:L.warranty_status,estimated_completion:L.estimated_completion||new Date().toISOString(),completed_date:null};await o(Oe)}await f()},G=async L=>{confirm("Are you sure you want to delete this repair?")&&await h(L)},B=async(L,Oe)=>{await u(L,{status:Oe})},K=L=>{k(L),M(!0)},we=()=>{M(!1),k(null)},re=L=>{switch(L){case"pending":return"text-yellow-600 bg-yellow-100";case"in_progress":return"text-blue-600 bg-blue-100";case"completed":return"text-green-600 bg-green-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},$=L=>{switch(L){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},U=L=>{switch(L){case"pending":return c.jsx(Vn,{className:"h-4 w-4"});case"in_progress":return c.jsx(ar,{className:"h-4 w-4"});case"completed":return c.jsx(ls,{className:"h-4 w-4"});case"cancelled":return c.jsx(li,{className:"h-4 w-4"});default:return c.jsx(Vn,{className:"h-4 w-4"})}};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[c.jsx("div",{className:"flex-1 max-w-lg",children:c.jsxs("div",{className:"relative",children:[c.jsx(_n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search repairs...",value:m,onChange:L=>w(L.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),c.jsxs("button",{onClick:()=>M(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5 mr-2"}),"New Repair"]})]}),c.jsxs("div",{className:"flex flex-wrap gap-4",children:[c.jsxs("select",{value:E,onChange:L=>p(L.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Statuses"}),c.jsx("option",{value:"pending",children:"Pending"}),c.jsx("option",{value:"in_progress",children:"In Progress"}),c.jsx("option",{value:"completed",children:"Completed"}),c.jsx("option",{value:"cancelled",children:"Cancelled"})]}),c.jsxs("select",{value:A,onChange:L=>N(L.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"all",children:"All Priorities"}),c.jsx("option",{value:"low",children:"Low Priority"}),c.jsx("option",{value:"medium",children:"Medium Priority"}),c.jsx("option",{value:"high",children:"High Priority"})]})]}),c.jsx("div",{className:"space-y-4",children:s?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading repairs..."})]})}):j.length===0?c.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[c.jsx("p",{className:"text-gray-500 text-lg",children:"No repairs found"}),c.jsx("p",{className:"text-gray-400 text-sm mt-2",children:m||E!=="all"||A!=="all"?"Try adjusting your filters":"Create your first repair to get started"})]}):j.map((L,Oe)=>c.jsxs(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:Oe*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[c.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:L.equipment_name}),c.jsxs("span",{className:"text-sm text-gray-500",children:["#",L.defect_tag]}),L.warranty_status==="in_warranty"&&c.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Under Warranty"})]}),c.jsx("p",{className:"text-gray-600 mb-3",children:L.description})]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${re(L.status)}`,children:[U(L.status),c.jsx("span",{className:"ml-1 capitalize",children:L.status.replace("_"," ")})]}),c.jsx("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${$(L.priority)}`,children:c.jsx("span",{className:"capitalize",children:L.priority})})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Assigned To:"}),c.jsx("p",{className:"font-medium",children:L.assigned_technician||"Unassigned"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Created:"}),c.jsx("p",{className:"font-medium",children:new Date(L.created_at).toLocaleDateString()})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm text-gray-500",children:"Est. Completion:"}),c.jsx("p",{className:"font-medium",children:L.estimated_completion?new Date(L.estimated_completion).toLocaleDateString():"TBD"})]})]}),L.photo_urls&&L.photo_urls.length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Photos:"}),c.jsxs("div",{className:"flex gap-2",children:[L.photo_urls.map((R,X)=>c.jsx("img",{src:R,alt:`Repair photo ${X+1}`,className:"h-16 w-16 object-cover rounded-lg border border-gray-200"},X)),c.jsx("button",{className:"h-16 w-16 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-gray-400 transition-colors",children:c.jsx(Qa,{className:"h-6 w-6 text-gray-400"})})]})]}),c.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[c.jsx("div",{className:"text-sm text-gray-500",children:L.estimated_cost>0&&c.jsxs("span",{children:["Estimated Cost: ",c.jsxs("span",{className:"font-medium text-gray-900",children:["$",L.estimated_cost.toFixed(2)]})]})}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>K(L),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>{const R=L.status==="pending"?"in_progress":L.status==="in_progress"?"completed":"pending";B(L.id,R)},className:"px-3 py-1 text-sm text-green-600 hover:text-green-700 font-medium",children:"Update Status"}),c.jsx("button",{onClick:()=>{G(L.id)},className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 font-medium",children:"Delete"})]})]})]},L.id))}),c.jsx(Hg,{isOpen:I,onClose:we,onSubmit:W,item:H})]})}const Ya=[{id:"general",title:"General Settings",icon:Xa,description:"Basic application settings and preferences"},{id:"notifications",title:"Notifications",icon:sc,description:"Configure alerts and notification preferences"},{id:"security",title:"Security",icon:Qr,description:"Security settings and access controls"},{id:"data",title:"Data Management",icon:ic,description:"Data backup and synchronization settings"},{id:"users",title:"User Management",icon:$a,description:"Manage users and permissions"}];function Zg(){const[n,s]=T.useState("general"),[o,u]=T.useState({general:{farmName:"Green Valley Farm",timezone:"America/New_York",language:"en",theme:"light",autoSave:!0},notifications:{emailNotifications:!0,pushNotifications:!0,maintenanceAlerts:!0,inventoryAlerts:!0,jobReminders:!0,inspectionReminders:!0},security:{twoFactorAuth:!1,sessionTimeout:30,passwordExpiry:90,loginAttempts:5},data:{autoBackup:!0,backupFrequency:"daily",offlineSync:!0,dataRetention:365}}),h=(N,I,M)=>{u(H=>({...H,[N]:{...H[N],[I]:M}}))},f=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Farm Name"}),c.jsx("input",{type:"text",value:o.general.farmName,onChange:N=>h("general","farmName",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),c.jsxs("select",{value:o.general.timezone,onChange:N=>h("general","timezone",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"America/New_York",children:"Eastern Time"}),c.jsx("option",{value:"America/Chicago",children:"Central Time"}),c.jsx("option",{value:"America/Denver",children:"Mountain Time"}),c.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),c.jsxs("select",{value:o.general.language,onChange:N=>h("general","language",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"en",children:"English"}),c.jsx("option",{value:"es",children:"Spanish"}),c.jsx("option",{value:"fr",children:"French"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Theme"}),c.jsxs("select",{value:o.general.theme,onChange:N=>h("general","theme",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[c.jsx("option",{value:"light",children:"Light"}),c.jsx("option",{value:"dark",children:"Dark"}),c.jsx("option",{value:"auto",children:"Auto"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"autoSave",checked:o.general.autoSave,onChange:N=>h("general","autoSave",N.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"autoSave",className:"ml-2 block text-sm text-gray-700",children:"Enable auto-save"})]})]}),m=()=>c.jsx("div",{className:"space-y-6",children:Object.entries(o.notifications).map(([N,I])=>c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:N.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase())}),c.jsxs("p",{className:"text-sm text-gray-500",children:[N==="emailNotifications"&&"Receive notifications via email",N==="pushNotifications"&&"Receive push notifications in browser",N==="maintenanceAlerts"&&"Get alerts for upcoming maintenance",N==="inventoryAlerts"&&"Get alerts for low stock items",N==="jobReminders"&&"Receive reminders for scheduled jobs",N==="inspectionReminders"&&"Receive inspection reminders"]})]}),c.jsx("input",{type:"checkbox",checked:I,onChange:M=>h("notifications",N,M.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]},N))}),w=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Two-Factor Authentication"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),c.jsx("input",{type:"checkbox",checked:o.security.twoFactorAuth,onChange:N=>h("security","twoFactorAuth",N.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (minutes)"}),c.jsx("input",{type:"number",value:o.security.sessionTimeout,onChange:N=>h("security","sessionTimeout",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"5",max:"480"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Expiry (days)"}),c.jsx("input",{type:"number",value:o.security.passwordExpiry,onChange:N=>h("security","passwordExpiry",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"30",max:"365"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Login Attempts"}),c.jsx("input",{type:"number",value:o.security.loginAttempts,onChange:N=>h("security","loginAttempts",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"3",max:"10"})]})]}),E=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Automatic Backup"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Automatically backup your data to cloud storage"})]}),c.jsx("input",{type:"checkbox",checked:o.data.autoBackup,onChange:N=>h("data","autoBackup",N.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backup Frequency"}),c.jsxs("select",{value:o.data.backupFrequency,onChange:N=>h("data","backupFrequency",N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:!o.data.autoBackup,children:[c.jsx("option",{value:"hourly",children:"Hourly"}),c.jsx("option",{value:"daily",children:"Daily"}),c.jsx("option",{value:"weekly",children:"Weekly"})]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Offline Sync"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Sync data when connection is restored"})]}),c.jsx("input",{type:"checkbox",checked:o.data.offlineSync,onChange:N=>h("data","offlineSync",N.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Retention (days)"}),c.jsx("input",{type:"number",value:o.data.dataRetention,onChange:N=>h("data","dataRetention",parseInt(N.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"30",max:"3650"})]})]}),p=()=>c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current User"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Name: Farm Manager"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Role: Administrator"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Email: manager@greenvaleyfarm.com"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"User Roles"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-200 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Administrator"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Full system access"})]}),c.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Active"})]}),c.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-200 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Supervisor"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Can manage jobs and inspections"})]}),c.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"Available"})]}),c.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-200 rounded-lg",children:[c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Operator"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Can view and update assigned tasks"})]}),c.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"Available"})]})]})]})]}),A=()=>{switch(n){case"general":return f();case"notifications":return m();case"security":return w();case"data":return E();case"users":return p();default:return f()}};return c.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[c.jsx("div",{className:"lg:w-1/3",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Settings"}),c.jsx("nav",{className:"space-y-2",children:Ya.map((N,I)=>{const M=N.icon;return c.jsx(tt.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:I*.1},onClick:()=>s(N.id),className:`w-full text-left p-3 rounded-lg transition-colors ${n===N.id?"bg-green-100 text-green-900":"hover:bg-gray-50 text-gray-700"}`,children:c.jsxs("div",{className:"flex items-center",children:[c.jsx(M,{className:`h-5 w-5 mr-3 ${n===N.id?"text-green-600":"text-gray-400"}`}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium",children:N.title}),c.jsx("p",{className:"text-sm opacity-75",children:N.description})]})]})},N.id)})})]})}),c.jsx("div",{className:"lg:w-2/3",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Ya.find(N=>N.id===n)?.title}),c.jsxs("button",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[c.jsx(ac,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}),c.jsx(tt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:A()},n)]})})]})}function Wg({isOpen:n,onClose:s,onSubmit:o,editingItem:u}){const[h,f]=T.useState({item_name:"",category:"spare_parts",quantity:0,unit:"pieces",location:"",status:"available",reorder_point:0,reorder_quantity:0,unit_price:0,supplier:"",last_restocked:"",expiry_date:""}),[m,w]=T.useState({});T.useEffect(()=>{f(u?{item_name:u.item_name,category:u.category||"spare_parts",quantity:u.quantity,unit:u.unit||"pieces",location:u.location,status:u.status||"available",reorder_point:u.reorder_point,reorder_quantity:u.reorder_quantity,unit_price:u.unit_price,supplier:u.supplier,last_restocked:u.last_restocked||"",expiry_date:u.expiry_date||""}:{item_name:"",category:"spare_parts",quantity:0,unit:"pieces",location:"",status:"available",reorder_point:0,reorder_quantity:0,unit_price:0,supplier:"",last_restocked:"",expiry_date:""}),w({})},[u,n]);const E=()=>{const A={};return h.item_name.trim()||(A.item_name="Item name is required"),h.location.trim()||(A.location="Location is required"),h.quantity<0&&(A.quantity="Quantity cannot be negative"),h.reorder_point<0&&(A.reorder_point="Reorder point cannot be negative"),h.reorder_quantity<0&&(A.reorder_quantity="Reorder quantity cannot be negative"),h.unit_price<0&&(A.unit_price="Unit price cannot be negative"),h.supplier.trim()||(A.supplier="Supplier is required"),w(A),Object.keys(A).length===0},p=A=>{if(A.preventDefault(),E()){const N={...h,last_restocked:h.last_restocked||null,expiry_date:h.expiry_date||null};o(N),s()}};return n?c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsx("h2",{className:"text-xl font-semibold",children:u?"Edit Stock Item":"Add Stock Item"}),c.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(On,{className:"h-5 w-5"})})]}),c.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Name *"}),c.jsx("input",{type:"text",value:h.item_name,onChange:A=>f({...h,item_name:A.target.value}),className:`w-full px-3 py-2 border rounded-lg ${m.item_name?"border-red-500":"border-gray-300"}`}),m.item_name&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.item_name})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),c.jsxs("select",{value:h.category,onChange:A=>f({...h,category:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[c.jsx("option",{value:"raw_materials",children:"Raw Materials"}),c.jsx("option",{value:"finished_goods",children:"Finished Goods"}),c.jsx("option",{value:"spare_parts",children:"Spare Parts"}),c.jsx("option",{value:"consumables",children:"Consumables"}),c.jsx("option",{value:"tools",children:"Tools"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),c.jsx("input",{type:"number",value:h.quantity,onChange:A=>f({...h,quantity:Number(A.target.value)}),className:`w-full px-3 py-2 border rounded-lg ${m.quantity?"border-red-500":"border-gray-300"}`}),m.quantity&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.quantity})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit *"}),c.jsxs("select",{value:h.unit,onChange:A=>f({...h,unit:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[c.jsx("option",{value:"pieces",children:"Pieces"}),c.jsx("option",{value:"kg",children:"Kilograms"}),c.jsx("option",{value:"liters",children:"Liters"}),c.jsx("option",{value:"boxes",children:"Boxes"}),c.jsx("option",{value:"pallets",children:"Pallets"}),c.jsx("option",{value:"meters",children:"Meters"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location *"}),c.jsx("input",{type:"text",value:h.location,onChange:A=>f({...h,location:A.target.value}),className:`w-full px-3 py-2 border rounded-lg ${m.location?"border-red-500":"border-gray-300"}`}),m.location&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.location})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),c.jsxs("select",{value:h.status,onChange:A=>f({...h,status:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[c.jsx("option",{value:"available",children:"Available"}),c.jsx("option",{value:"reserved",children:"Reserved"}),c.jsx("option",{value:"low_stock",children:"Low Stock"}),c.jsx("option",{value:"out_of_stock",children:"Out of Stock"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reorder Point *"}),c.jsx("input",{type:"number",value:h.reorder_point,onChange:A=>f({...h,reorder_point:Number(A.target.value)}),className:`w-full px-3 py-2 border rounded-lg ${m.reorder_point?"border-red-500":"border-gray-300"}`}),m.reorder_point&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.reorder_point})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reorder Quantity *"}),c.jsx("input",{type:"number",value:h.reorder_quantity,onChange:A=>f({...h,reorder_quantity:Number(A.target.value)}),className:`w-full px-3 py-2 border rounded-lg ${m.reorder_quantity?"border-red-500":"border-gray-300"}`}),m.reorder_quantity&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.reorder_quantity})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unit Price *"}),c.jsx("input",{type:"number",step:"0.01",value:h.unit_price,onChange:A=>f({...h,unit_price:Number(A.target.value)}),className:`w-full px-3 py-2 border rounded-lg ${m.unit_price?"border-red-500":"border-gray-300"}`}),m.unit_price&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.unit_price})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier *"}),c.jsx("input",{type:"text",value:h.supplier,onChange:A=>f({...h,supplier:A.target.value}),className:`w-full px-3 py-2 border rounded-lg ${m.supplier?"border-red-500":"border-gray-300"}`}),m.supplier&&c.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.supplier})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Restocked"}),c.jsx("input",{type:"date",value:h.last_restocked,onChange:A=>f({...h,last_restocked:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),c.jsx("input",{type:"date",value:h.expiry_date,onChange:A=>f({...h,expiry_date:A.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),c.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:u?"Update":"Create"})]})]})]})}):null}function Gg(){const{items:n,loading:s,error:o,create:u,update:h,delete:f}=an("stock_items"),[m,w]=T.useState(!1),[E,p]=T.useState(null),A=async B=>{try{E?await h(E.id,B):await u(B),w(!1),p(null)}catch(K){console.error("Error saving stock item:",K)}},N=B=>{p(B),w(!0)},I=B=>{confirm("Are you sure you want to delete this stock item?")&&f(B).catch(K=>{console.error("Error deleting stock item:",K)})},M=()=>{w(!1),p(null)},H=B=>{if(!B)return"bg-gray-100 text-gray-800";const K={available:"bg-green-100 text-green-800",reserved:"bg-blue-100 text-blue-800",low_stock:"bg-yellow-100 text-yellow-800",out_of_stock:"bg-red-100 text-red-800"};return K[B]||K.available},k=B=>{if(!B)return"bg-gray-100 text-gray-800";const K={raw_materials:"bg-purple-100 text-purple-800",finished_goods:"bg-green-100 text-green-800",spare_parts:"bg-blue-100 text-blue-800",consumables:"bg-orange-100 text-orange-800",tools:"bg-gray-100 text-gray-800"};return K[B]||K.spare_parts},j=B=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(B);if(s)return c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});if(o)return c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:["Error loading stock items: ",o]});const W=n.filter(B=>B.quantity<=B.reorder_point),G=n.reduce((B,K)=>B+K.quantity*K.unit_price,0);return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Stock Items"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your stock inventory and supplies"})]}),c.jsxs("button",{onClick:()=>w(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[c.jsx(Vt,{className:"h-5 w-5"}),"Add Stock Item"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Items"}),c.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:n.length})]}),c.jsx(Ht,{className:"h-8 w-8 text-blue-600"})]})}),c.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Low Stock"}),c.jsx("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:W.length})]}),c.jsx(Hn,{className:"h-8 w-8 text-yellow-600"})]})}),c.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Total Value"}),c.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:j(G)})]}),c.jsx(Ht,{className:"h-8 w-8 text-green-600"})]})}),c.jsx("div",{className:"bg-white rounded-lg p-6 shadow-sm border border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Categories"}),c.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:new Set(n.map(B=>B.category)).size})]}),c.jsx(Ht,{className:"h-8 w-8 text-gray-600"})]})})]}),W.length>0&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Hn,{className:"h-5 w-5 text-yellow-600"}),c.jsx("h3",{className:"font-semibold text-yellow-900",children:"Low Stock Alert"})]}),c.jsxs("p",{className:"text-yellow-800 mt-1",children:[W.length," item",W.length!==1?"s":""," need restocking"]})]}),c.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Supplier"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.length===0?c.jsx("tr",{children:c.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center text-gray-500",children:[c.jsx(Ht,{className:"h-12 w-12 mx-auto mb-3 text-gray-400"}),c.jsx("p",{className:"text-lg font-medium",children:"No stock items yet"}),c.jsx("p",{className:"text-sm mt-1",children:"Get started by adding your first stock item"})]})}):n.map(B=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsxs("td",{className:"px-6 py-4",children:[c.jsx("div",{className:"font-medium text-gray-900",children:B.item_name}),B.expiry_date&&c.jsxs("div",{className:"text-sm text-gray-500",children:["Expires: ",new Date(B.expiry_date).toLocaleDateString()]})]}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${k(B.category)}`,children:B.category?B.category.replace("_"," "):"N/A"})}),c.jsxs("td",{className:"px-6 py-4",children:[c.jsxs("div",{className:"text-sm text-gray-900",children:[B.quantity," ",B.unit]}),B.quantity<=B.reorder_point&&c.jsxs("div",{className:"text-xs text-yellow-600 flex items-center gap-1 mt-1",children:[c.jsx(Hn,{className:"h-3 w-3"}),"Reorder at ",B.reorder_point]})]}),c.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:B.location}),c.jsx("td",{className:"px-6 py-4",children:c.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${H(B.status)}`,children:B.status?B.status.replace("_"," "):"N/A"})}),c.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:j(B.unit_price)}),c.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:B.supplier}),c.jsx("td",{className:"px-6 py-4 text-right text-sm font-medium",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:()=>N(B),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",children:c.jsx(oc,{className:"h-4 w-4"})}),c.jsx("button",{onClick:()=>I(B.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:c.jsx($s,{className:"h-4 w-4"})})]})})]},B.id))})]})})}),c.jsx(Wg,{isOpen:m,onClose:M,onSubmit:B=>void A(B),editingItem:E})]})}function Yg(){const n=pd();return c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n&&c.jsx("div",{className:"bg-red-500 text-white text-center py-2 text-sm",children:"You're currently offline. Data will sync when connection is restored."}),c.jsx(Qu,{children:c.jsxs(zt,{path:"/",element:c.jsx(md,{}),children:[c.jsx(zt,{index:!0,element:c.jsx(Xu,{to:"/dashboard",replace:!0})}),c.jsx(zt,{path:"dashboard",element:c.jsx(wd,{})}),c.jsx(zt,{path:"inventory",element:c.jsx(Ig,{})}),c.jsx(zt,{path:"stock-items",element:c.jsx(Gg,{})}),c.jsx(zt,{path:"repairs",element:c.jsx(Vg,{})}),c.jsx(zt,{path:"jobs",element:c.jsx(jg,{})}),c.jsx(zt,{path:"inspections",element:c.jsx(Md,{})}),c.jsx(zt,{path:"maintenance",element:c.jsx(Fg,{})}),c.jsx(zt,{path:"fuel-management",element:c.jsx(Id,{})}),c.jsx(zt,{path:"settings",element:c.jsx(Zg,{})})]})}),c.jsx(nu,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})}function Xg(){return c.jsx(sd,{children:c.jsx(fd,{children:c.jsx(Yg,{})})})}const qg=new Pl({defaultOptions:{queries:{staleTime:1e3*60*5,retry:(n,s)=>s instanceof Error&&"status"in s&&typeof s.status=="number"&&s.status>=400&&s.status<500?!1:n<3}}});Qs.createRoot(document.getElementById("root")).render(c.jsx(Ll.StrictMode,{children:c.jsx(Fl,{client:qg,children:c.jsx(Xg,{})})}));
