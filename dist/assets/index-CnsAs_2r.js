import{r as Y,a as im,b as om,c as yi,d as cm,R as lm}from"./vendor-CKV-ivK8.js";import{c as um,Q as fm,a as dm}from"./data-F_giidh4.js";import{m as nr,L as su,S as Bl,C as to,a as hm,b as xm,P as Ha,W as Xs,c as mm,d as qn,F as Po,e as xd,A as md,X as ua,M as gm,f as Wc,U as iu,g as pm,h as ml,T as oc,i as gd,j as Ga,k as cc,l as Qs,n as pd,o as vd,D as vm,p as wd,q as Ul,r as xs,s as Ri,t as Pn,u as Mi,v as wm,R as ym,w as _m,x as Wa,y as gl,z as Li,B as yd,E as bm,G as _d,H as lc,I as Em,J as Am,K as Cm,N as Sm,O as Tm,Q as Nm,V as Im,Y as km}from"./ui-D46s0UnL.js";function Fm(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(n,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var bd={exports:{}},uc={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm=Y,Om=Symbol.for("react.element"),Rm=Symbol.for("react.fragment"),Mm=Object.prototype.hasOwnProperty,Lm=Dm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jm={key:!0,ref:!0,__self:!0,__source:!0};function Ed(e,t,r){var n,a={},o=null,l=null;r!==void 0&&(o=""+r),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(n in t)Mm.call(t,n)&&!jm.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:Om,type:e,key:o,ref:l,props:a,_owner:Lm.current}}uc.Fragment=Rm;uc.jsx=Ed;uc.jsxs=Ed;bd.exports=uc;var f=bd.exports,pl={},ou=im;pl.createRoot=ou.createRoot,pl.hydrateRoot=ou.hydrateRoot;let Pm={data:""},Bm=e=>{if(typeof window=="object"){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||Pm},Um=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,zm=/\/\*[^]*?\*\/|  +/g,cu=/\n+/g,Pa=(e,t)=>{let r="",n="",a="";for(let o in e){let l=e[o];o[0]=="@"?o[1]=="i"?r=o+" "+l+";":n+=o[1]=="f"?Pa(l,o):o+"{"+Pa(l,o[1]=="k"?"":t)+"}":typeof l=="object"?n+=Pa(l,t?t.replace(/([^,])+/g,h=>o.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,g=>/&/.test(g)?g.replace(/&/g,h):h?h+" "+g:g)):o):l!=null&&(o=/^--/.test(o)?o:o.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Pa.p?Pa.p(o,l):o+":"+l+";")}return r+(t&&a?t+"{"+a+"}":a)+n},ma={},Ad=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+Ad(e[r]);return t}return e},Hm=(e,t,r,n,a)=>{let o=Ad(e),l=ma[o]||(ma[o]=(g=>{let m=0,p=11;for(;m<g.length;)p=101*p+g.charCodeAt(m++)>>>0;return"go"+p})(o));if(!ma[l]){let g=o!==e?e:(m=>{let p,w,E=[{}];for(;p=Um.exec(m.replace(zm,""));)p[4]?E.shift():p[3]?(w=p[3].replace(cu," ").trim(),E.unshift(E[0][w]=E[0][w]||{})):E[0][p[1]]=p[2].replace(cu," ").trim();return E[0]})(e);ma[l]=Pa(a?{["@keyframes "+l]:g}:g,r?"":"."+l)}let h=r&&ma.g?ma.g:null;return r&&(ma.g=ma[l]),((g,m,p,w)=>{w?m.data=m.data.replace(w,g):m.data.indexOf(g)===-1&&(m.data=p?g+m.data:m.data+g)})(ma[l],t,n,h),l},Wm=(e,t,r)=>e.reduce((n,a,o)=>{let l=t[o];if(l&&l.call){let h=l(r),g=h&&h.props&&h.props.className||/^go/.test(h)&&h;l=g?"."+g:h&&typeof h=="object"?h.props?"":Pa(h,""):h===!1?"":h}return n+a+(l??"")},"");function fc(e){let t=this||{},r=e.call?e(t.p):e;return Hm(r.unshift?r.raw?Wm(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,Bm(t.target),t.g,t.o,t.k)}let Cd,vl,wl;fc.bind({g:1});let _a=fc.bind({k:1});function Vm(e,t,r,n){Pa.p=t,Cd=e,vl=r,wl=n}function Ka(e,t){let r=this||{};return function(){let n=arguments;function a(o,l){let h=Object.assign({},o),g=h.className||a.className;r.p=Object.assign({theme:vl&&vl()},h),r.o=/ *go\d+/.test(g),h.className=fc.apply(r,n)+(g?" "+g:"");let m=e;return e[0]&&(m=h.as||e,delete h.as),wl&&m[0]&&wl(h),Cd(m,h)}return a}}var Gm=e=>typeof e=="function",Bo=(e,t)=>Gm(e)?e(t):e,Xm=(()=>{let e=0;return()=>(++e).toString()})(),Sd=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Ym=20,zl="default",Td=(e,t)=>{let{toastLimit:r}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(l=>l.id===t.toast.id?{...l,...t.toast}:l)};case 2:let{toast:n}=t;return Td(e,{type:e.toasts.find(l=>l.id===n.id)?1:0,toast:n});case 3:let{toastId:a}=t;return{...e,toasts:e.toasts.map(l=>l.id===a||a===void 0?{...l,dismissed:!0,visible:!1}:l)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(l=>l.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let o=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(l=>({...l,pauseDuration:l.pauseDuration+o}))}}},jo=[],Nd={toasts:[],pausedAt:void 0,settings:{toastLimit:Ym}},oa={},Id=(e,t=zl)=>{oa[t]=Td(oa[t]||Nd,e),jo.forEach(([r,n])=>{r===t&&n(oa[t])})},kd=e=>Object.keys(oa).forEach(t=>Id(e,t)),Zm=e=>Object.keys(oa).find(t=>oa[t].toasts.some(r=>r.id===e)),dc=(e=zl)=>t=>{Id(t,e)},$m={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},qm=(e={},t=zl)=>{let[r,n]=Y.useState(oa[t]||Nd),a=Y.useRef(oa[t]);Y.useEffect(()=>(a.current!==oa[t]&&n(oa[t]),jo.push([t,n]),()=>{let l=jo.findIndex(([h])=>h===t);l>-1&&jo.splice(l,1)}),[t]);let o=r.toasts.map(l=>{var h,g,m;return{...e,...e[l.type],...l,removeDelay:l.removeDelay||((h=e[l.type])==null?void 0:h.removeDelay)||e?.removeDelay,duration:l.duration||((g=e[l.type])==null?void 0:g.duration)||e?.duration||$m[l.type],style:{...e.style,...(m=e[l.type])==null?void 0:m.style,...l.style}}});return{...r,toasts:o}},Km=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:r?.id||Xm()}),ro=e=>(t,r)=>{let n=Km(t,e,r);return dc(n.toasterId||Zm(n.id))({type:2,toast:n}),n.id},Cr=(e,t)=>ro("blank")(e,t);Cr.error=ro("error");Cr.success=ro("success");Cr.loading=ro("loading");Cr.custom=ro("custom");Cr.dismiss=(e,t)=>{let r={type:3,toastId:e};t?dc(t)(r):kd(r)};Cr.dismissAll=e=>Cr.dismiss(void 0,e);Cr.remove=(e,t)=>{let r={type:4,toastId:e};t?dc(t)(r):kd(r)};Cr.removeAll=e=>Cr.remove(void 0,e);Cr.promise=(e,t,r)=>{let n=Cr.loading(t.loading,{...r,...r?.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let o=t.success?Bo(t.success,a):void 0;return o?Cr.success(o,{id:n,...r,...r?.success}):Cr.dismiss(n),a}).catch(a=>{let o=t.error?Bo(t.error,a):void 0;o?Cr.error(o,{id:n,...r,...r?.error}):Cr.dismiss(n)}),e};var Qm=1e3,Jm=(e,t="default")=>{let{toasts:r,pausedAt:n}=qm(e,t),a=Y.useRef(new Map).current,o=Y.useCallback((w,E=Qm)=>{if(a.has(w))return;let A=setTimeout(()=>{a.delete(w),l({type:4,toastId:w})},E);a.set(w,A)},[]);Y.useEffect(()=>{if(n)return;let w=Date.now(),E=r.map(A=>{if(A.duration===1/0)return;let T=(A.duration||0)+A.pauseDuration-(w-A.createdAt);if(T<0){A.visible&&Cr.dismiss(A.id);return}return setTimeout(()=>Cr.dismiss(A.id,t),T)});return()=>{E.forEach(A=>A&&clearTimeout(A))}},[r,n,t]);let l=Y.useCallback(dc(t),[t]),h=Y.useCallback(()=>{l({type:5,time:Date.now()})},[l]),g=Y.useCallback((w,E)=>{l({type:1,toast:{id:w,height:E}})},[l]),m=Y.useCallback(()=>{n&&l({type:6,time:Date.now()})},[n,l]),p=Y.useCallback((w,E)=>{let{reverseOrder:A=!1,gutter:T=8,defaultPosition:_}=E||{},C=r.filter(N=>(N.position||_)===(w.position||_)&&N.height),S=C.findIndex(N=>N.id===w.id),k=C.filter((N,F)=>F<S&&N.visible).length;return C.filter(N=>N.visible).slice(...A?[k+1]:[0,k]).reduce((N,F)=>N+(F.height||0)+T,0)},[r]);return Y.useEffect(()=>{r.forEach(w=>{if(w.dismissed)o(w.id,w.removeDelay);else{let E=a.get(w.id);E&&(clearTimeout(E),a.delete(w.id))}})},[r,o]),{toasts:r,handlers:{updateHeight:g,startPause:h,endPause:m,calculateOffset:p}}},eg=_a`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,tg=_a`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,rg=_a`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,ng=Ka("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${eg} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${tg} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${rg} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,ag=_a`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,sg=Ka("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${ag} 1s linear infinite;
`,ig=_a`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,og=_a`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,cg=Ka("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ig} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${og} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,lg=Ka("div")`
  position: absolute;
`,ug=Ka("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,fg=_a`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,dg=Ka("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${fg} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,hg=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?Y.createElement(dg,null,t):t:r==="blank"?null:Y.createElement(ug,null,Y.createElement(sg,{...n}),r!=="loading"&&Y.createElement(lg,null,r==="error"?Y.createElement(ng,{...n}):Y.createElement(cg,{...n})))},xg=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,mg=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,gg="0%{opacity:0;} 100%{opacity:1;}",pg="0%{opacity:1;} 100%{opacity:0;}",vg=Ka("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,wg=Ka("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,yg=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=Sd()?[gg,pg]:[xg(r),mg(r)];return{animation:t?`${_a(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${_a(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},_g=Y.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?yg(e.position||t||"top-center",e.visible):{opacity:0},o=Y.createElement(hg,{toast:e}),l=Y.createElement(wg,{...e.ariaProps},Bo(e.message,e));return Y.createElement(vg,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:o,message:l}):Y.createElement(Y.Fragment,null,o,l))});Vm(Y.createElement);var bg=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let o=Y.useCallback(l=>{if(l){let h=()=>{let g=l.getBoundingClientRect().height;n(e,g)};h(),new MutationObserver(h).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return Y.createElement("div",{ref:o,className:t,style:r},a)},Eg=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Sd()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},Ag=fc`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,_o=16,Cg=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,toasterId:o,containerStyle:l,containerClassName:h})=>{let{toasts:g,handlers:m}=Jm(r,o);return Y.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:_o,left:_o,right:_o,bottom:_o,pointerEvents:"none",...l},className:h,onMouseEnter:m.startPause,onMouseLeave:m.endPause},g.map(p=>{let w=p.position||t,E=m.calculateOffset(p,{reverseOrder:e,gutter:n,defaultPosition:t}),A=Eg(w,E);return Y.createElement(bg,{id:p.id,key:p.id,onHeightUpdate:m.updateHeight,className:p.visible?Ag:"",style:A},p.type==="custom"?Bo(p.message,p):a?a(p):Y.createElement(_g,{toast:p,position:w}))}))},dr=Cr;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ji(){return ji=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ji.apply(this,arguments)}var Ba;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Ba||(Ba={}));const lu="popstate";function Sg(e){e===void 0&&(e={});function t(n,a){let{pathname:o,search:l,hash:h}=n.location;return yl("",{pathname:o,search:l,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Uo(a)}return Ng(t,r,null,e)}function mr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Fd(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Tg(){return Math.random().toString(36).substr(2,8)}function uu(e,t){return{usr:e.state,key:e.key,idx:t}}function yl(e,t,r,n){return r===void 0&&(r=null),ji({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?ri(t):t,{state:r,key:t&&t.key||n||Tg()})}function Uo(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ri(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Ng(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:o=!1}=n,l=a.history,h=Ba.Pop,g=null,m=p();m==null&&(m=0,l.replaceState(ji({},l.state,{idx:m}),""));function p(){return(l.state||{idx:null}).idx}function w(){h=Ba.Pop;let C=p(),S=C==null?null:C-m;m=C,g&&g({action:h,location:_.location,delta:S})}function E(C,S){h=Ba.Push;let k=yl(_.location,C,S);m=p()+1;let N=uu(k,m),F=_.createHref(k);try{l.pushState(N,"",F)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;a.location.assign(F)}o&&g&&g({action:h,location:_.location,delta:1})}function A(C,S){h=Ba.Replace;let k=yl(_.location,C,S);m=p();let N=uu(k,m),F=_.createHref(k);l.replaceState(N,"",F),o&&g&&g({action:h,location:_.location,delta:0})}function T(C){let S=a.location.origin!=="null"?a.location.origin:a.location.href,k=typeof C=="string"?C:Uo(C);return k=k.replace(/ $/,"%20"),mr(S,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,S)}let _={get action(){return h},get location(){return e(a,l)},listen(C){if(g)throw new Error("A history only accepts one active listener");return a.addEventListener(lu,w),g=C,()=>{a.removeEventListener(lu,w),g=null}},createHref(C){return t(a,C)},createURL:T,encodeLocation(C){let S=T(C);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:E,replace:A,go(C){return l.go(C)}};return _}var fu;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(fu||(fu={}));function Ig(e,t,r){return r===void 0&&(r="/"),kg(e,t,r)}function kg(e,t,r,n){let a=typeof t=="string"?ri(t):t,o=Hl(a.pathname||"/",r);if(o==null)return null;let l=Dd(e);Fg(l);let h=null;for(let g=0;h==null&&g<l.length;++g){let m=Wg(o);h=Ug(l[g],m)}return h}function Dd(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(o,l,h)=>{let g={relativePath:h===void 0?o.path||"":h,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};g.relativePath.startsWith("/")&&(mr(g.relativePath.startsWith(n),'Absolute route path "'+g.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),g.relativePath=g.relativePath.slice(n.length));let m=Va([n,g.relativePath]),p=r.concat(g);o.children&&o.children.length>0&&(mr(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),Dd(o.children,t,p,m)),!(o.path==null&&!o.index)&&t.push({path:m,score:Pg(m,o.index),routesMeta:p})};return e.forEach((o,l)=>{var h;if(o.path===""||!((h=o.path)!=null&&h.includes("?")))a(o,l);else for(let g of Od(o.path))a(o,l,g)}),t}function Od(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let l=Od(n.join("/")),h=[];return h.push(...l.map(g=>g===""?o:[o,g].join("/"))),a&&h.push(...l),h.map(g=>e.startsWith("/")&&g===""?"/":g)}function Fg(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Bg(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Dg=/^:[\w-]+$/,Og=3,Rg=2,Mg=1,Lg=10,jg=-2,du=e=>e==="*";function Pg(e,t){let r=e.split("/"),n=r.length;return r.some(du)&&(n+=jg),t&&(n+=Rg),r.filter(a=>!du(a)).reduce((a,o)=>a+(Dg.test(o)?Og:o===""?Mg:Lg),n)}function Bg(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function Ug(e,t,r){let{routesMeta:n}=e,a={},o="/",l=[];for(let h=0;h<n.length;++h){let g=n[h],m=h===n.length-1,p=o==="/"?t:t.slice(o.length)||"/",w=zg({path:g.relativePath,caseSensitive:g.caseSensitive,end:m},p),E=g.route;if(!w)return null;Object.assign(a,w.params),l.push({params:a,pathname:Va([o,w.pathname]),pathnameBase:Yg(Va([o,w.pathnameBase])),route:E}),w.pathnameBase!=="/"&&(o=Va([o,w.pathnameBase]))}return l}function zg(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Hg(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:n.reduce((m,p,w)=>{let{paramName:E,isOptional:A}=p;if(E==="*"){let _=h[w]||"";l=o.slice(0,o.length-_.length).replace(/(.)\/+$/,"$1")}const T=h[w];return A&&!T?m[E]=void 0:m[E]=(T||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:l,pattern:e}}function Hg(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Fd(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,g)=>(n.push({paramName:h,isOptional:g!=null}),g?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function Wg(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Fd(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Hl(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Vg(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?ri(e):e;return{pathname:r?r.startsWith("/")?r:Gg(r,t):t,search:Zg(n),hash:$g(a)}}function Gg(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Vc(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Xg(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Wl(e,t){let r=Xg(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Vl(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=ri(e):(a=ji({},e),mr(!a.pathname||!a.pathname.includes("?"),Vc("?","pathname","search",a)),mr(!a.pathname||!a.pathname.includes("#"),Vc("#","pathname","hash",a)),mr(!a.search||!a.search.includes("#"),Vc("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,h;if(l==null)h=r;else{let w=t.length-1;if(!n&&l.startsWith("..")){let E=l.split("/");for(;E[0]==="..";)E.shift(),w-=1;a.pathname=E.join("/")}h=w>=0?t[w]:"/"}let g=Vg(a,h),m=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&r.endsWith("/");return!g.pathname.endsWith("/")&&(m||p)&&(g.pathname+="/"),g}const Va=e=>e.join("/").replace(/\/\/+/g,"/"),Yg=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Zg=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,$g=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function qg(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Rd=["post","put","patch","delete"];new Set(Rd);const Kg=["get",...Rd];new Set(Kg);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pi(){return Pi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pi.apply(this,arguments)}const Gl=Y.createContext(null),Qg=Y.createContext(null),Qa=Y.createContext(null),hc=Y.createContext(null),Ea=Y.createContext({outlet:null,matches:[],isDataRoute:!1}),Md=Y.createContext(null);function Jg(e,t){let{relative:r}=t===void 0?{}:t;ni()||mr(!1);let{basename:n,navigator:a}=Y.useContext(Qa),{hash:o,pathname:l,search:h}=Pd(e,{relative:r}),g=l;return n!=="/"&&(g=l==="/"?n:Va([n,l])),a.createHref({pathname:g,search:h,hash:o})}function ni(){return Y.useContext(hc)!=null}function ai(){return ni()||mr(!1),Y.useContext(hc).location}function Ld(e){Y.useContext(Qa).static||Y.useLayoutEffect(e)}function jd(){let{isDataRoute:e}=Y.useContext(Ea);return e?xp():ep()}function ep(){ni()||mr(!1);let e=Y.useContext(Gl),{basename:t,future:r,navigator:n}=Y.useContext(Qa),{matches:a}=Y.useContext(Ea),{pathname:o}=ai(),l=JSON.stringify(Wl(a,r.v7_relativeSplatPath)),h=Y.useRef(!1);return Ld(()=>{h.current=!0}),Y.useCallback(function(m,p){if(p===void 0&&(p={}),!h.current)return;if(typeof m=="number"){n.go(m);return}let w=Vl(m,JSON.parse(l),o,p.relative==="path");e==null&&t!=="/"&&(w.pathname=w.pathname==="/"?t:Va([t,w.pathname])),(p.replace?n.replace:n.push)(w,p.state,p)},[t,n,l,o,e])}const tp=Y.createContext(null);function rp(e){let t=Y.useContext(Ea).outlet;return t&&Y.createElement(tp.Provider,{value:e},t)}function Pd(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=Y.useContext(Qa),{matches:a}=Y.useContext(Ea),{pathname:o}=ai(),l=JSON.stringify(Wl(a,n.v7_relativeSplatPath));return Y.useMemo(()=>Vl(e,JSON.parse(l),o,r==="path"),[e,l,o,r])}function np(e,t){return ap(e,t)}function ap(e,t,r,n){ni()||mr(!1);let{navigator:a}=Y.useContext(Qa),{matches:o}=Y.useContext(Ea),l=o[o.length-1],h=l?l.params:{};l&&l.pathname;let g=l?l.pathnameBase:"/";l&&l.route;let m=ai(),p;if(t){var w;let C=typeof t=="string"?ri(t):t;g==="/"||(w=C.pathname)!=null&&w.startsWith(g)||mr(!1),p=C}else p=m;let E=p.pathname||"/",A=E;if(g!=="/"){let C=g.replace(/^\//,"").split("/");A="/"+E.replace(/^\//,"").split("/").slice(C.length).join("/")}let T=Ig(e,{pathname:A}),_=lp(T&&T.map(C=>Object.assign({},C,{params:Object.assign({},h,C.params),pathname:Va([g,a.encodeLocation?a.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?g:Va([g,a.encodeLocation?a.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),o,r,n);return t&&_?Y.createElement(hc.Provider,{value:{location:Pi({pathname:"/",search:"",hash:"",state:null,key:"default"},p),navigationType:Ba.Pop}},_):_}function sp(){let e=hp(),t=qg(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Y.createElement(Y.Fragment,null,Y.createElement("h2",null,"Unexpected Application Error!"),Y.createElement("h3",{style:{fontStyle:"italic"}},t),r?Y.createElement("pre",{style:a},r):null,null)}const ip=Y.createElement(sp,null);class op extends Y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?Y.createElement(Ea.Provider,{value:this.props.routeContext},Y.createElement(Md.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function cp(e){let{routeContext:t,match:r,children:n}=e,a=Y.useContext(Gl);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),Y.createElement(Ea.Provider,{value:t},n)}function lp(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var o;if(!r)return null;if(r.errors)e=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let l=e,h=(a=r)==null?void 0:a.errors;if(h!=null){let p=l.findIndex(w=>w.route.id&&h?.[w.route.id]!==void 0);p>=0||mr(!1),l=l.slice(0,Math.min(l.length,p+1))}let g=!1,m=-1;if(r&&n&&n.v7_partialHydration)for(let p=0;p<l.length;p++){let w=l[p];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(m=p),w.route.id){let{loaderData:E,errors:A}=r,T=w.route.loader&&E[w.route.id]===void 0&&(!A||A[w.route.id]===void 0);if(w.route.lazy||T){g=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}return l.reduceRight((p,w,E)=>{let A,T=!1,_=null,C=null;r&&(A=h&&w.route.id?h[w.route.id]:void 0,_=w.route.errorElement||ip,g&&(m<0&&E===0?(mp("route-fallback"),T=!0,C=null):m===E&&(T=!0,C=w.route.hydrateFallbackElement||null)));let S=t.concat(l.slice(0,E+1)),k=()=>{let N;return A?N=_:T?N=C:w.route.Component?N=Y.createElement(w.route.Component,null):w.route.element?N=w.route.element:N=p,Y.createElement(cp,{match:w,routeContext:{outlet:p,matches:S,isDataRoute:r!=null},children:N})};return r&&(w.route.ErrorBoundary||w.route.errorElement||E===0)?Y.createElement(op,{location:r.location,revalidation:r.revalidation,component:_,error:A,children:k(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):k()},null)}var Bd=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Bd||{}),Ud=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ud||{});function up(e){let t=Y.useContext(Gl);return t||mr(!1),t}function fp(e){let t=Y.useContext(Qg);return t||mr(!1),t}function dp(e){let t=Y.useContext(Ea);return t||mr(!1),t}function zd(e){let t=dp(),r=t.matches[t.matches.length-1];return r.route.id||mr(!1),r.route.id}function hp(){var e;let t=Y.useContext(Md),r=fp(),n=zd();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function xp(){let{router:e}=up(Bd.UseNavigateStable),t=zd(Ud.UseNavigateStable),r=Y.useRef(!1);return Ld(()=>{r.current=!0}),Y.useCallback(function(a,o){o===void 0&&(o={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Pi({fromRouteId:t},o)))},[e,t])}const hu={};function mp(e,t,r){hu[e]||(hu[e]=!0)}function gp(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function Gc(e){let{to:t,replace:r,state:n,relative:a}=e;ni()||mr(!1);let{future:o,static:l}=Y.useContext(Qa),{matches:h}=Y.useContext(Ea),{pathname:g}=ai(),m=jd(),p=Vl(t,Wl(h,o.v7_relativeSplatPath),g,a==="path"),w=JSON.stringify(p);return Y.useEffect(()=>m(JSON.parse(w),{replace:r,state:n,relative:a}),[m,w,a,r,n]),null}function pp(e){return rp(e.context)}function vn(e){mr(!1)}function vp(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Ba.Pop,navigator:o,static:l=!1,future:h}=e;ni()&&mr(!1);let g=t.replace(/^\/*/,"/"),m=Y.useMemo(()=>({basename:g,navigator:o,static:l,future:Pi({v7_relativeSplatPath:!1},h)}),[g,h,o,l]);typeof n=="string"&&(n=ri(n));let{pathname:p="/",search:w="",hash:E="",state:A=null,key:T="default"}=n,_=Y.useMemo(()=>{let C=Hl(p,g);return C==null?null:{location:{pathname:C,search:w,hash:E,state:A,key:T},navigationType:a}},[g,p,w,E,A,T,a]);return _==null?null:Y.createElement(Qa.Provider,{value:m},Y.createElement(hc.Provider,{children:r,value:_}))}function wp(e){let{children:t,location:r}=e;return np(_l(t),r)}new Promise(()=>{});function _l(e,t){t===void 0&&(t=[]);let r=[];return Y.Children.forEach(e,(n,a)=>{if(!Y.isValidElement(n))return;let o=[...t,a];if(n.type===Y.Fragment){r.push.apply(r,_l(n.props.children,o));return}n.type!==vn&&mr(!1),!n.props.index||!n.props.children||mr(!1);let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=_l(n.props.children,o)),r.push(l)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bl(){return bl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bl.apply(this,arguments)}function yp(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,o;for(o=0;o<n.length;o++)a=n[o],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function _p(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function bp(e,t){return e.button===0&&(!t||t==="_self")&&!_p(e)}const Ep=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ap="6";try{window.__reactRouterVersion=Ap}catch{}const Cp="startTransition",xu=om[Cp];function Sp(e){let{basename:t,children:r,future:n,window:a}=e,o=Y.useRef();o.current==null&&(o.current=Sg({window:a,v5Compat:!0}));let l=o.current,[h,g]=Y.useState({action:l.action,location:l.location}),{v7_startTransition:m}=n||{},p=Y.useCallback(w=>{m&&xu?xu(()=>g(w)):g(w)},[g,m]);return Y.useLayoutEffect(()=>l.listen(p),[l,p]),Y.useEffect(()=>gp(n),[n]),Y.createElement(vp,{basename:t,children:r,location:h.location,navigationType:h.action,navigator:l,future:n})}const Tp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Np=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ip=Y.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:o,replace:l,state:h,target:g,to:m,preventScrollReset:p,viewTransition:w}=t,E=yp(t,Ep),{basename:A}=Y.useContext(Qa),T,_=!1;if(typeof m=="string"&&Np.test(m)&&(T=m,Tp))try{let N=new URL(window.location.href),F=m.startsWith("//")?new URL(N.protocol+m):new URL(m),W=Hl(F.pathname,A);F.origin===N.origin&&W!=null?m=W+F.search+F.hash:_=!0}catch{}let C=Jg(m,{relative:a}),S=kp(m,{replace:l,state:h,target:g,preventScrollReset:p,relative:a,viewTransition:w});function k(N){n&&n(N),N.defaultPrevented||S(N)}return Y.createElement("a",bl({},E,{href:T||C,onClick:_||o?n:k,ref:r,target:g}))});var mu;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(mu||(mu={}));var gu;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gu||(gu={}));function kp(e,t){let{target:r,replace:n,state:a,preventScrollReset:o,relative:l,viewTransition:h}=t===void 0?{}:t,g=jd(),m=ai(),p=Pd(e,{relative:l});return Y.useCallback(w=>{if(bp(w,r)){w.preventDefault();let E=n!==void 0?n:Uo(m)===Uo(p);g(e,{replace:E,state:a,preventScrollReset:o,relative:l,viewTransition:h})}},[m,g,p,n,a,r,e,o,l,h])}const Fp="https://xcaoevypackelcstdieu.supabase.co",Dp="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhjYW9ldnlwYWNrZWxjc3RkaWV1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5MDU5NTcsImV4cCI6MjA3NTQ4MTk1N30.gVJxR1-DXXmXyZ7_2bqr-R_JP7P2CpnLFMkS1ExFB5w";let Xc=null;function Op(){return Xc||(console.log("Initializing Supabase client..."),Xc=um(Fp,Dp,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:"sb-auth-token"},realtime:{params:{eventsPerSecond:10}}})),Xc}const Ct=Op(),en={INVENTORY_ITEMS:"inventory_items",REPAIR_ITEMS:"repair_items",JOB_CARDS:"job_cards",INSPECTIONS:"inspections",MAINTENANCE_SCHEDULES:"maintenance_schedules",MAINTENANCE_ALERTS:"maintenance_alerts",ASSETS:"assets",FUEL_RECORDS:"fuel_records",FUEL_PRICES:"fuel_prices",OPERATING_SESSIONS:"operating_sessions"};async function Yc(e){try{console.log(`Fetching role for user: ${e}`);const t=Date.now(),{data:r,error:n}=await Ct.from("user_roles").select("role").eq("user_id",e).maybeSingle(),a=Date.now()-t;if(console.log(`Role query completed in ${a}ms`),n)return console.error("Role Fetch Error:",n),"USER";const o=r?.role;if(console.log(`Role fetched: ${o||"USER (default)"}`),!r){console.log("No role found - creating default USER role");const{error:l}=await Ct.from("user_roles").insert({user_id:e,role:"USER"});return l&&console.error("Error creating default role:",l),"USER"}return o??"USER"}catch(t){return console.error("Role Fetch Error:",t),t instanceof Error&&console.error("Error details:",t.message),"USER"}}function Rp(){const[e,t]=Y.useState(null),[r,n]=Y.useState(null),[a,o]=Y.useState(!0),[l,h]=Y.useState(null);Y.useEffect(()=>{let p=!0,w;(async()=>{try{console.log("Fetching initial session..."),console.log("Supabase URL:","https://xcaoevypackelcstdieu.supabase.co");const T=new Promise(k=>{w=setTimeout(()=>{console.warn("Session fetch taking longer than expected - proceeding as logged out"),k({data:{session:null},error:null})},8e3)}),_=Ct.auth.getSession(),{data:{session:C},error:S}=await Promise.race([_,T]);if(clearTimeout(w),S){console.error("Session Fetch Error:",S),p&&(t(null),n(null));return}if(!p)return;if(console.log("Initial Session:",C?"Found":"Not Found"),C?.user){console.log("User authenticated, fetching role..."),t(C.user);const k=await Yc(C.user.id);p&&(n(k),console.log("Authentication complete"))}else console.log("No active session"),t(null),n(null)}catch(T){clearTimeout(w),console.error("Initial Session Fetch Error:",T),p&&(t(null),n(null))}finally{p&&(console.log("Setting loading to false"),o(!1))}})();const{data:{subscription:A}}=Ct.auth.onAuthStateChange(async(T,_)=>{if(console.log("Auth State Change Event:",T),!!p)if(t(_?.user??null),_?.user)try{const C=Yc(_.user.id),S=new Promise(N=>{setTimeout(()=>{console.log("Auth state change: Role fetch timeout - using default"),N("USER")},5e3)}),k=await Promise.race([C,S]);p&&n(k)}catch(C){console.error("Auth state change: Role fetch failed:",C),p&&n("USER")}else n(null)});return()=>{p=!1,clearTimeout(w),A.unsubscribe()}},[]);const g=Y.useCallback(async(p,w)=>{try{o(!0),h(null),console.log("Starting sign-in process...");const{data:E,error:A}=await Ct.auth.signInWithPassword({email:p,password:w});if(A)throw console.error("Sign-in error:",A),A;if(console.log("Sign-in successful, setting user..."),t(E.user),E.user){console.log("Fetching user role...");try{const T=Yc(E.user.id),_=new Promise(S=>{setTimeout(()=>{console.log("Role fetch timeout - using default"),S("USER")},5e3)}),C=await Promise.race([T,_]);n(C),console.log("Sign-in process complete")}catch(T){console.error("Role fetch failed, using default:",T),n("USER")}}}catch(E){console.error("Sign-in Error:",E);const A=E.message||"Sign-in failed";throw h(A),t(null),n(null),E}finally{o(!1)}},[]),m=Y.useCallback(async()=>{try{await Ct.auth.signOut(),t(null),n(null)}catch(p){console.error("Sign-out Error:",p),h(p.message||"Sign-out failed")}},[]);return{user:e,isAuthenticated:!!e,userRole:r,loading:a,error:l,signIn:g,signOut:m}}const Hd=Y.createContext(null);function Wd(){const e=Y.useContext(Hd);if(!e)throw new Error("useAuthContext must be used within AuthProvider");return e}function Mp({children:e}){const t=Rp(),{isAuthenticated:r,loading:n,signIn:a}=t,[o,l]=Y.useState(""),[h,g]=Y.useState(""),[m,p]=Y.useState(null),[w,E]=Y.useState(!1),A=async T=>{T.preventDefault(),p(null),E(!0);try{await a(o,h)}catch(_){p("Invalid login credentials. Please try again."),console.error("Sign in error:",_)}finally{E(!1)}};return n?f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:f.jsxs(nr.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center",children:[f.jsx(su,{className:"h-8 w-8 animate-spin text-blue-600 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-600",children:"Initializing secure session..."})]})}):r?f.jsx(Hd.Provider,{value:t,children:e}):f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:f.jsx(Bl,{className:"h-8 w-8 text-blue-600"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Farm Management System"}),f.jsx("p",{className:"text-gray-600",children:"Secure access required to continue"})]}),f.jsxs("form",{onSubmit:T=>{A(T)},className:"space-y-4",children:[m&&f.jsxs("div",{className:"flex items-center space-x-2 text-red-600 bg-red-50 p-3 rounded-lg",children:[f.jsx(to,{className:"h-4 w-4"}),f.jsx("p",{className:"text-sm",children:m})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{id:"email",type:"email",value:o,onChange:T=>l(T.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),f.jsx("input",{id:"password",type:"password",value:h,onChange:T=>g(T.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),f.jsx(nr.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:w,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2 disabled:opacity-50",children:w?f.jsx(su,{className:"h-5 w-5 animate-spin"}):f.jsxs(f.Fragment,{children:[f.jsx(hm,{className:"h-5 w-5"}),f.jsx("span",{children:"Sign In"})]})})]}),f.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:f.jsx("p",{children:"Secure authentication powered by Supabase"})})]})})}function Lp(){const{isAuthenticated:e,userRole:t}=Wd(),r=l=>e&&t===l,n=l=>e&&t&&l.includes(t),a=()=>r("ADMIN"),o=()=>r("USER");return{isAuthenticated:e,userRole:t,hasRole:r,hasAnyRole:n,isAdmin:a,isUser:o,canDelete:a(),canModifyUsers:a(),canAccessReports:a()||o(),canModifySettings:a(),canViewAuditLog:a()}}const jp=[{name:"Dashboard",href:"/dashboard",icon:xm,requiredRole:null},{name:"Inventory",href:"/inventory",icon:Ha,requiredRole:null},{name:"Repairs",href:"/repairs",icon:Xs,requiredRole:null},{name:"Jobs",href:"/jobs",icon:mm,requiredRole:null},{name:"Inspections",href:"/inspections",icon:qn,requiredRole:null},{name:"Maintenance",href:"/maintenance",icon:qn,requiredRole:null},{name:"Fuel Management",href:"/fuel-management",icon:Po,requiredRole:null},{name:"Settings",href:"/settings",icon:xd,requiredRole:"ADMIN"}];function Pp(){const[e,t]=Y.useState(!1),r=ai(),{user:n,userRole:a,signOut:o}=Wd(),h=Lp().isAdmin(),g=()=>{o().catch(E=>{console.error("Sign out error:",E)})},m=jp.filter(E=>E.requiredRole?E.requiredRole===a:!0),p=({item:E})=>{const A=r.pathname===E.href,T=E.icon;return f.jsxs(Ip,{to:E.href,onClick:()=>t(!1),className:`group flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-all duration-200 ${A?"bg-blue-100 text-blue-700 shadow-sm":"text-gray-700 hover:bg-gray-100 hover:text-gray-900"}`,children:[f.jsx(T,{className:`mr-3 h-5 w-5 transition-colors ${A?"text-blue-500":"text-gray-500 group-hover:text-gray-700"}`}),E.name,E.requiredRole==="ADMIN"&&f.jsx(Wc,{className:"ml-auto h-4 w-4 text-red-500"})]})},w=()=>f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center px-4 py-6 border-b border-gray-200",children:[f.jsx(Bl,{className:"h-8 w-8 text-blue-600 mr-3"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Farm Management"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Secure System"})]})]}),f.jsx("div",{className:"px-4 py-4 bg-gray-50 border-b border-gray-200",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${h?"bg-red-100":"bg-blue-100"}`,children:h?f.jsx(Wc,{className:"h-5 w-5 text-red-600"}):f.jsx(iu,{className:"h-5 w-5 text-blue-600"})}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:n?.email?.split("@")[0]??"Guest"}),f.jsxs("p",{className:`text-xs truncate ${h?"text-red-600":"text-blue-600"}`,children:[a??"USER"," Access"]})]})]})}),f.jsx("nav",{className:"flex-1 px-4 py-4 space-y-1 overflow-y-auto",children:m.map(E=>f.jsx(p,{item:E},E.name))}),f.jsxs("div",{className:"px-4 py-4 border-t border-gray-200",children:[f.jsxs("button",{onClick:g,className:"w-full flex items-center justify-center gap-2 px-4 py-2 text-sm font-medium text-red-700 bg-red-50 rounded-md hover:bg-red-100 transition-colors",children:[f.jsx(pm,{className:"w-4 h-4"}),"Sign Out"]}),f.jsxs("div",{className:"text-xs text-gray-500 text-center mt-3",children:[f.jsx("p",{children:"Secured by Supabase"}),f.jsx("p",{className:"mt-1",children:"Â© 2024 Farm Management System"})]})]})]});return f.jsxs("div",{className:"flex h-screen bg-gray-50",children:[f.jsx("div",{className:"hidden lg:flex lg:w-64 lg:flex-col lg:fixed lg:inset-y-0",children:f.jsx("div",{className:"bg-white shadow-sm border-r border-gray-200",children:f.jsx(w,{})})}),f.jsx(md,{children:e&&f.jsxs(f.Fragment,{children:[f.jsx(nr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 lg:hidden",onClick:()=>t(!1),children:f.jsx("div",{className:"absolute inset-0 bg-gray-600 opacity-75"})}),f.jsxs(nr.div,{initial:{x:-320},animate:{x:0},exit:{x:-320},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-xl lg:hidden",children:[f.jsx("div",{className:"absolute top-0 right-0 -mr-12 pt-2",children:f.jsx("button",{onClick:()=>t(!1),className:"ml-1 flex items-center justify-center h-10 w-10 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",children:f.jsx(ua,{className:"h-6 w-6 text-white"})})}),f.jsx(w,{})]})]})}),f.jsxs("div",{className:"lg:pl-64 flex flex-col flex-1 min-h-0",children:[f.jsx("div",{className:"lg:hidden bg-white shadow-sm border-b border-gray-200 px-4 py-3",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("button",{onClick:()=>t(!0),className:"p-2 rounded-md text-gray-500 hover:text-gray-900 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",children:f.jsx(gm,{className:"h-6 w-6"})}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"text-sm font-medium text-gray-900",children:n?.email?.split("@")[0]??"Guest"}),f.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${h?"bg-red-100":"bg-blue-100"}`,children:h?f.jsx(Wc,{className:"h-3 w-3 text-red-600"}):f.jsx(iu,{className:"h-3 w-3 text-blue-600"})})]})]})}),f.jsx("main",{className:"flex-1 overflow-y-auto focus:outline-none",children:f.jsx("div",{className:"py-6",children:f.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:f.jsx(pp,{})})})})]})]})}function Bp(){const[e,t]=Y.useState(!navigator.onLine);return Y.useEffect(()=>{const r=()=>t(!1),n=()=>t(!0);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),e}const Vd=()=>{const[e,t]=Y.useState([]),r=Y.useCallback(g=>{const m=Math.random().toString(36).substr(2,9);t(p=>[...p,{...g,id:m}])},[]),n=Y.useCallback(g=>{t(m=>m.filter(p=>p.id!==g))},[]),a=Y.useCallback((g,m="")=>{r({type:"success",title:g,message:m})},[r]),o=Y.useCallback((g,m="")=>{r({type:"error",title:g,message:m})},[r]),l=Y.useCallback((g,m="")=>{r({type:"warning",title:g,message:m})},[r]),h=Y.useCallback((g,m="")=>{r({type:"info",title:g,message:m})},[r]);return{toasts:e,addToast:r,removeToast:n,success:a,error:o,warning:l,info:h}};function ca(e,t=!0){const[r,n]=Y.useState({items:[],loading:!0,error:null,creating:!1,updating:!1,deleting:!1}),{success:a,error:o}=Vd(),l=en[e.toUpperCase()]||e,h=Y.useCallback(async()=>{try{n(S=>({...S,loading:!0,error:null})),console.log(`useSupabaseCRUD: Fetching items from table: ${l}`);const{data:_,error:C}=await Ct.from(l).select("*").order("created_at",{ascending:!1});if(C)throw console.error(`useSupabaseCRUD: Error fetching from ${l}:`,C),C;console.log(`useSupabaseCRUD: Fetched ${_?.length||0} items from ${l}`,_),n(S=>({...S,items:_||[],loading:!1}))}catch(_){const C=_ instanceof Error?_.message:"Failed to fetch items";n(S=>({...S,error:C,loading:!1})),o("Error",C)}},[l,o]),g=Y.useCallback(async _=>{try{n(k=>({...k,creating:!0,error:null})),console.log(`useSupabaseCRUD: Creating item in ${l}:`,_);const{data:C,error:S}=await Ct.from(l).insert([_]).select().single();if(S)throw console.error(`useSupabaseCRUD: Error creating in ${l}:`,S),S;return console.log(`useSupabaseCRUD: Created item in ${l}:`,C),n(k=>({...k,items:[C,...k.items],creating:!1})),a("Success","Item created successfully"),C}catch(C){const S=C instanceof Error?C.message:"Failed to create item";return n(k=>({...k,error:S,creating:!1})),o("Error",S),null}},[l,a,o]),m=Y.useCallback(async(_,C)=>{try{n(N=>({...N,updating:!0,error:null}));const{data:S,error:k}=await Ct.from(l).update({...C,updated_at:new Date().toISOString()}).eq("id",_).select().single();if(k)throw k;return n(N=>({...N,items:N.items.map(F=>F.id===_?S:F),updating:!1})),a("Success","Item updated successfully"),S}catch(S){const k=S instanceof Error?S.message:"Failed to update item";return n(N=>({...N,error:k,updating:!1})),o("Error",k),null}},[l,a,o]),p=Y.useCallback(async _=>{try{n(S=>({...S,deleting:!0,error:null}));const{error:C}=await Ct.from(l).delete().eq("id",_);if(C)throw C;return n(S=>({...S,items:S.items.filter(k=>k.id!==_),deleting:!1})),a("Success","Item deleted successfully"),!0}catch(C){const S=C instanceof Error?C.message:"Failed to delete item";return n(k=>({...k,error:S,deleting:!1})),o("Error",S),!1}},[l,a,o]),w=Y.useCallback(_=>r.items.find(C=>C.id===_),[r.items]),E=Y.useCallback((_,C)=>{if(!_.trim())return r.items;const S=_.toLowerCase();return r.items.filter(k=>C.some(N=>{const F=k[N];return F&&String(F).toLowerCase().includes(S)}))},[r.items]),A=Y.useCallback(_=>r.items.filter(_),[r.items]),T=Y.useCallback(async()=>{await h()},[h]);return Y.useEffect(()=>{if(h(),t){const _=Ct.channel(`${l}_changes`).on("postgres_changes",{event:"*",schema:"public",table:l},C=>{switch(C.eventType){case"INSERT":n(S=>({...S,items:[C.new,...S.items]}));break;case"UPDATE":n(S=>({...S,items:S.items.map(k=>k.id===C.new.id?C.new:k)}));break;case"DELETE":n(S=>({...S,items:S.items.filter(k=>k.id!==C.old.id)}));break}}).subscribe();return()=>{_.unsubscribe()}}},[h,l,t]),{...r,create:g,update:m,delete:p,refresh:T,getById:w,search:E,filter:A}}function Up(){const{items:e,loading:t}=ca("inventory_items"),{items:r,loading:n}=ca("repair_items"),{items:a,loading:o}=ca("job_cards"),{items:l,loading:h}=ca("maintenance_schedules"),[g,m]=Y.useState([{name:"Total Inventory Items",value:"0",change:"+0%",changeType:"increase",icon:Ha},{name:"Active Repairs",value:"0",change:"+0%",changeType:"increase",icon:Xs},{name:"Pending Jobs",value:"0",change:"+0%",changeType:"increase",icon:qn},{name:"Scheduled Maintenance",value:"0",change:"+0%",changeType:"increase",icon:ml}]),[p,w]=Y.useState([]),E=t||n||o||h;Y.useEffect(()=>{if(!E){const T=e.length,_=r.filter(B=>B.status==="in_progress"||B.status==="pending").length,C=a.filter(B=>B.status==="todo"||B.status==="in_progress").length,S=l.filter(B=>B.status==="scheduled"||B.status==="in_progress").length;m([{name:"Total Inventory Items",value:T.toString(),change:"+0%",changeType:"increase",icon:Ha},{name:"Active Repairs",value:_.toString(),change:"+0%",changeType:"increase",icon:Xs},{name:"Pending Jobs",value:C.toString(),change:"+0%",changeType:"increase",icon:qn},{name:"Scheduled Maintenance",value:S.toString(),change:"+0%",changeType:"increase",icon:ml}]);const k=[];e.filter(B=>B.status==="low_stock"||B.status==="out_of_stock").slice(0,2).forEach(B=>{k.push({id:`inv-${B.id}`,type:"inventory",message:`${B.status==="out_of_stock"?"Out of stock":"Low stock"}: ${B.name}`,time:A(B.updated_at),status:(B.status==="out_of_stock","warning")})}),r.filter(B=>B.status==="completed").sort((B,R)=>new Date(R.updated_at).getTime()-new Date(B.updated_at).getTime()).slice(0,2).forEach(B=>{k.push({id:`rep-${B.id}`,type:"repair",message:`Repair completed: ${B.equipment_name}`,time:A(B.updated_at),status:"success"})}),l.filter(B=>B.status==="scheduled").sort((B,R)=>new Date(B.next_due_date).getTime()-new Date(R.next_due_date).getTime()).slice(0,2).forEach(B=>{const R=Math.ceil((new Date(B.next_due_date).getTime()-Date.now())/864e5);k.push({id:`mnt-${B.id}`,type:"maintenance",message:`${B.maintenance_type} scheduled for ${B.equipment_name} in ${R} days`,time:A(B.updated_at),status:"info"})}),w(k.slice(0,6))}},[e,r,a,l,E]);const A=T=>{const _=new Date(T),S=new Date().getTime()-_.getTime(),k=Math.floor(S/(1e3*60*60)),N=Math.floor(k/24);return k<1?"Just now":k<24?`${k} hour${k>1?"s":""} ago`:N===1?"1 day ago":N<7?`${N} days ago`:_.toLocaleDateString()};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:[f.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Welcome to Farm Management"}),f.jsx("p",{className:"text-green-100",children:"Monitor your farm operations, track equipment, and manage resources efficiently."})]}),E?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"Loading dashboard data..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:g.map((T,_)=>{const C=T.icon;return f.jsx(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:_*.1},className:"bg-white rounded-lg shadow p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx(C,{className:"h-8 w-8 text-green-600"})}),f.jsx("div",{className:"ml-5 w-0 flex-1",children:f.jsxs("dl",{children:[f.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:T.name}),f.jsxs("dd",{className:"flex items-baseline",children:[f.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:T.value}),f.jsxs("div",{className:`
                        ml-2 flex items-baseline text-sm font-semibold
                        ${T.changeType==="increase"?"text-green-600":"text-red-600"}
                      `,children:[T.changeType==="increase"?f.jsx(oc,{className:"h-4 w-4 flex-shrink-0"}):f.jsx(gd,{className:"h-4 w-4 flex-shrink-0"}),f.jsx("span",{className:"ml-1",children:T.change})]})]})]})})]})},T.name)})}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(nr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-white rounded-lg shadow",children:f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Recent Activities"}),p.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx("p",{children:"No recent activities"}),f.jsx("p",{className:"text-sm mt-2",children:"Activity will appear here as you use the system"})]}):f.jsx("div",{className:"flow-root",children:f.jsx("ul",{className:"-mb-8",children:p.map((T,_)=>f.jsx("li",{children:f.jsxs("div",{className:"relative pb-8",children:[_!==p.length-1?f.jsx("span",{className:"absolute top-5 left-5 -ml-px h-full w-0.5 bg-gray-200","aria-hidden":"true"}):null,f.jsxs("div",{className:"relative flex items-start space-x-3",children:[f.jsx("div",{children:f.jsx("div",{className:`
                            relative px-1 py-1 rounded-full flex items-center justify-center
                            ${T.status==="success"?"bg-green-500":T.status==="warning"?"bg-yellow-500":"bg-blue-500"}
                          `,children:T.status==="success"?f.jsx(Ga,{className:"h-5 w-5 text-white"}):T.status==="warning"?f.jsx(cc,{className:"h-5 w-5 text-white"}):f.jsx(Qs,{className:"h-5 w-5 text-white"})})}),f.jsx("div",{className:"min-w-0 flex-1",children:f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-900",children:T.message}),f.jsx("p",{className:"mt-0.5 text-sm text-gray-500",children:T.time})]})})]})]})},T.id))})})]})}),f.jsx(nr.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-white rounded-lg shadow",children:f.jsxs("div",{className:"p-6",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(Ha,{className:"h-8 w-8 text-green-600 mb-2"}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Add Inventory"})]}),f.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(Xs,{className:"h-8 w-8 text-blue-600 mb-2"}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Create Repair"})]}),f.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(qn,{className:"h-8 w-8 text-purple-600 mb-2"}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Schedule Job"})]}),f.jsxs("button",{className:"flex flex-col items-center p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[f.jsx(Qs,{className:"h-8 w-8 text-orange-600 mb-2"}),f.jsx("span",{className:"text-sm font-medium text-gray-900",children:"View Reports"})]})]})]})})]})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zo={};zo.version="0.18.5";var Gd=1252,zp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Xl={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Yl=function(e){zp.indexOf(e)!=-1&&(Gd=Xl[0]=e)};function Hp(){Yl(1252)}var Zn=function(e){Yl(e)};function Zl(){Zn(1200),Hp()}function pu(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Wp(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Xd(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ei=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Wp(e.slice(2)):t==254&&r==255?Xd(e.slice(2)):t==65279?e.slice(1):e},bo=function(t){return String.fromCharCode(t)},vu=function(t){return String.fromCharCode(t)},Bi,Ua="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ui(e){for(var t="",r=0,n=0,a=0,o=0,l=0,h=0,g=0,m=0;m<e.length;)r=e.charCodeAt(m++),o=r>>2,n=e.charCodeAt(m++),l=(r&3)<<4|n>>4,a=e.charCodeAt(m++),h=(n&15)<<2|a>>6,g=a&63,isNaN(n)?h=g=64:isNaN(a)&&(g=64),t+=Ua.charAt(o)+Ua.charAt(l)+Ua.charAt(h)+Ua.charAt(g);return t}function Sn(e){var t="",r=0,n=0,a=0,o=0,l=0,h=0,g=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<e.length;)o=Ua.indexOf(e.charAt(m++)),l=Ua.indexOf(e.charAt(m++)),r=o<<2|l>>4,t+=String.fromCharCode(r),h=Ua.indexOf(e.charAt(m++)),n=(l&15)<<4|h>>2,h!==64&&(t+=String.fromCharCode(n)),g=Ua.indexOf(e.charAt(m++)),a=(h&3)<<6|g,g!==64&&(t+=String.fromCharCode(a));return t}var yt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Aa=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Xa(e){return yt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wu(e){return yt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var En=function(t){return yt?Aa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function xc(e){if(typeof ArrayBuffer>"u")return En(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ja(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Vp(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function $l(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return $l(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Or=yt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Aa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Gp(e){for(var t=[],r=0,n=e.length+250,a=Xa(e.length+255),o=0;o<e.length;++o){var l=e.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var h=e.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|h>>6&15|(l&3)<<4,a[r++]=128|h&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Xa(65535),n=65530)}return t.push(a.slice(0,r)),Or(t)}var nn=/\u0000/g,Ai=/[\u0001-\u0006]/g;function Ys(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $n(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}function ql(e,t){var r=""+e;return r.length>=t?r:cr(" ",t-r.length)+r}function Ho(e,t){var r=""+e;return r.length>=t?r:r+cr(" ",t-r.length)}function Xp(e,t){var r=""+Math.round(e);return r.length>=t?r:cr("0",t-r.length)+r}function Yp(e,t){var r=""+e;return r.length>=t?r:cr("0",t-r.length)+r}var yu=Math.pow(2,32);function Ps(e,t){if(e>yu||e<-yu)return Xp(e,t);var r=Math.round(e);return Yp(r,t)}function Wo(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var _u=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Zc=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Zp(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "',e}var Je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "'},bu={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$p={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Vo(e,t,r){for(var n=e<0?-1:1,a=e*n,o=0,l=1,h=0,g=1,m=0,p=0,w=Math.floor(a);m<t&&(w=Math.floor(a),h=w*l+o,p=w*m+g,!(a-w<5e-8));)a=1/(a-w),o=l,l=h,g=m,m=p;if(p>t&&(m>t?(p=g,h=o):(p=m,h=l)),!r)return[0,n*h,p];var E=Math.floor(n*h/p);return[E,n*h-E*p,p]}function ls(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),o=0,l=[],h={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),t&&t.date1904&&(n+=1462),h.u>.9999&&(h.u=0,++a==86400&&(h.T=a=0,++n,++h.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var g=new Date(1900,0,1);g.setDate(g.getDate()+n-1),l=[g.getFullYear(),g.getMonth()+1,g.getDate()],o=g.getDay(),n<60&&(o=(o+6)%7),r&&(o=t2(g,l))}return h.y=l[0],h.m=l[1],h.d=l[2],h.S=a%60,a=Math.floor(a/60),h.M=a%60,a=Math.floor(a/60),h.H=a,h.q=o,h}var Yd=new Date(1899,11,31,0,0,0),qp=Yd.getTime(),Kp=new Date(1900,2,1,0,0,0);function Zd(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Kp&&(r+=24*60*60*1e3),(r-(qp+(e.getTimezoneOffset()-Yd.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Kl(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Qp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Jp(e){var t=e<0?12:11,r=Kl(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function e2(e){var t=Kl(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function zi(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Jp(e):t===10?r=e.toFixed(10).substr(0,12):r=e2(e),Kl(Qp(r.toUpperCase()))}function ms(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zi(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Un(14,Zd(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function t2(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function r2(e,t,r,n){var a="",o=0,l=0,h=r.y,g,m=0;switch(e){case 98:h=r.y+543;case 121:switch(t.length){case 1:case 2:g=h%100,m=2;break;default:g=h%1e4,m=4;break}break;case 109:switch(t.length){case 1:case 2:g=r.m,m=t.length;break;case 3:return Zc[r.m-1][1];case 5:return Zc[r.m-1][0];default:return Zc[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:g=r.d,m=t.length;break;case 3:return _u[r.q][0];default:return _u[r.q][1]}break;case 104:switch(t.length){case 1:case 2:g=1+(r.H+11)%12,m=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:g=r.H,m=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:g=r.M,m=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?$n(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),t==="s"?o===0?"0":""+o/l:(a=$n(o,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":g=r.D*24+r.H;break;case"[m]":case"[mm]":g=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":g=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}m=t.length===3?1:2;break;case 101:g=h,m=1;break}var p=m>0?$n(g,m):"";return p}function za(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var $d=/%/g;function n2(e,t,r){var n=t.replace($d,""),a=t.length-n.length;return va(e,n,r*Math.pow(10,2*a))+cr("%",a)}function a2(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return va(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function qd(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qd(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,m,p){return g+m+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Kd=/# (\?+)( ?)\/( ?)(\d+)/;function s2(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),o=Math.floor(a/n),l=a-o*n,h=n;return r+(o===0?"":""+o)+" "+(l===0?cr(" ",e[1].length+1+e[4].length):ql(l,e[1].length)+e[2]+"/"+e[3]+$n(h,e[4].length))}function i2(e,t,r){return r+(t===0?"":""+t)+cr(" ",e[1].length+2+e[4].length)}var Qd=/^#*0*\.([0#]+)/,Jd=/\).*[0#]/,eh=/\(###\) ###\\?-####/;function tn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Eu(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Au(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function o2(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function c2(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function On(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Jd)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?On("n",n,r):"("+On("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return a2(e,t,r);if(t.indexOf("%")!==-1)return n2(e,t,r);if(t.indexOf("E")!==-1)return qd(t,r);if(t.charCodeAt(0)===36)return"$"+On(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,l,h,g=Math.abs(r),m=r<0?"-":"";if(t.match(/^00+$/))return m+Ps(g,t.length);if(t.match(/^[#?]+$/))return a=Ps(r,0),a==="0"&&(a=""),a.length>t.length?a:tn(t.substr(0,t.length-a.length))+a;if(o=t.match(Kd))return s2(o,g,m);if(t.match(/^#+0+$/))return m+Ps(g,t.length-t.indexOf("0"));if(o=t.match(Qd))return a=Eu(r,o[1].length).replace(/^([^\.]+)$/,"$1."+tn(o[1])).replace(/\.$/,"."+tn(o[1])).replace(/\.(\d*)$/,function(T,_){return"."+_+cr("0",tn(o[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return m+Eu(g,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return m+za(Ps(g,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+On(e,t,-r):za(""+(Math.floor(r)+o2(r,o[1].length)))+"."+$n(Au(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return On(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ys(On(e,t.replace(/[\\-]/g,""),r)),l=0,Ys(Ys(t.replace(/\\/g,"")).replace(/[0#]/g,function(T){return l<a.length?a.charAt(l++):T==="0"?"0":""}));if(t.match(eh))return a=On(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),h=Vo(g,Math.pow(10,l)-1,!1),a=""+m,p=va("n",o[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Ho(h[2],l),p.length<o[4].length&&(p=tn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),h=Vo(g,Math.pow(10,l)-1,!0),m+(h[0]||(h[1]?"":"0"))+" "+(h[1]?ql(h[1],l)+o[2]+"/"+o[3]+Ho(h[2],l):cr(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=Ps(r,0),t.length<=a.length?a:tn(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var w=t.indexOf(".")-l,E=t.length-a.length-w;return tn(t.substr(0,w)+a+t.substr(t.length-E))}if(o=t.match(/^00,000\.([#0]*0)$/))return l=Au(r,o[1].length),r<0?"-"+On(e,t,-r):za(c2(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?$n(0,3-T.length):"")+T})+"."+$n(l,o[1].length);switch(t){case"###,##0.00":return On(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var A=za(Ps(g,0));return A!=="0"?m+A:"";case"###,###.00":return On(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return On(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function l2(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return va(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function u2(e,t,r){var n=t.replace($d,""),a=t.length-n.length;return va(e,n,r*Math.pow(10,2*a))+cr("%",a)}function th(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+th(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(t/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,g,m,p){return g+m+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Jd)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?aa("n",n,r):"("+aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return l2(e,t,r);if(t.indexOf("%")!==-1)return u2(e,t,r);if(t.indexOf("E")!==-1)return th(t,r);if(t.charCodeAt(0)===36)return"$"+aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,o,l,h,g=Math.abs(r),m=r<0?"-":"";if(t.match(/^00+$/))return m+$n(g,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:tn(t.substr(0,t.length-a.length))+a;if(o=t.match(Kd))return i2(o,g,m);if(t.match(/^#+0+$/))return m+$n(g,t.length-t.indexOf("0"));if(o=t.match(Qd))return a=(""+r).replace(/^([^\.]+)$/,"$1."+tn(o[1])).replace(/\.$/,"."+tn(o[1])),a=a.replace(/\.(\d*)$/,function(T,_){return"."+_+cr("0",tn(o[1]).length-_.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return m+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return m+za(""+g);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+aa(e,t,-r):za(""+r)+"."+cr("0",o[1].length);if(o=t.match(/^#,#*,#0/))return aa(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ys(aa(e,t.replace(/[\\-]/g,""),r)),l=0,Ys(Ys(t.replace(/\\/g,"")).replace(/[0#]/g,function(T){return l<a.length?a.charAt(l++):T==="0"?"0":""}));if(t.match(eh))return a=aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),h=Vo(g,Math.pow(10,l)-1,!1),a=""+m,p=va("n",o[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Ho(h[2],l),p.length<o[4].length&&(p=tn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),h=Vo(g,Math.pow(10,l)-1,!0),m+(h[0]||(h[1]?"":"0"))+" "+(h[1]?ql(h[1],l)+o[2]+"/"+o[3]+Ho(h[2],l):cr(" ",2*l+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:tn(t.substr(0,t.length-a.length))+a;if(o=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var w=t.indexOf(".")-l,E=t.length-a.length-w;return tn(t.substr(0,w)+a+t.substr(t.length-E))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+aa(e,t,-r):za(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(T){return"00,"+(T.length<3?$n(0,3-T.length):"")+T})+"."+$n(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var A=za(""+g);return A!=="0"?m+A:"";default:if(t.match(/\.[0#?]*$/))return aa(e,t.slice(0,t.lastIndexOf(".")),r)+tn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function va(e,t,r){return(r|0)===r?aa(e,t,r):On(e,t,r)}function f2(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rh=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function si(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Wo(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="ä¸å/ä¸å")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(rh))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function d2(e,t,r,n){for(var a=[],o="",l=0,h="",g="t",m,p,w,E="H";l<e.length;)switch(h=e.charAt(l)){case"G":if(!Wo(e,l))throw new Error("unrecognized character "+h+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(w=e.charCodeAt(++l))!==34&&l<e.length;)o+=String.fromCharCode(w);a[a.length]={t:"t",v:o},++l;break;case"\\":var A=e.charAt(++l),T=A==="("||A===")"?A:"t";a[a.length]={t:T,v:A},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(m==null&&(m=ls(t,r,e.charAt(l+1)==="2"),m==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},g=h,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||m==null&&(m=ls(t,r),m==null))return"";for(o=h;++l<e.length&&e.charAt(l).toLowerCase()===h;)o+=h;h==="m"&&g.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=E),a[a.length]={t:h,v:o},g=h;break;case"A":case"a":case"ä¸":var _={t:h,v:h};if(m==null&&(m=ls(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(m!=null&&(_.v=m.H>=12?"P":"A"),_.t="T",E="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(m!=null&&(_.v=m.H>=12?"PM":"AM"),_.t="T",l+=5,E="h"):e.substr(l,5).toUpperCase()==="ä¸å/ä¸å"?(m!=null&&(_.v=m.H>=12?"ä¸å":"ä¸å"),_.t="T",l+=5,E="h"):(_.t="t",++l),m==null&&_.t==="T")return"";a[a.length]=_,g=h;break;case"[":for(o=h;e.charAt(l++)!=="]"&&l<e.length;)o+=e.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(rh)){if(m==null&&(m=ls(t,r),m==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},g=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",si(e)||(a[a.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=h;++l<e.length&&(h=e.charAt(l))==="0";)o+=h;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=h;++l<e.length&&"0#?.,E+-%".indexOf(h=e.charAt(l))>-1;)o+=h;a[a.length]={t:"n",v:o};break;case"?":for(o=h;e.charAt(++l)===h;)o+=h;a[a.length]={t:h,v:o},g=h;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":h,v:h},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=h;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)o+=e.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:h,v:h},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=â¬acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+e);a[a.length]={t:"t",v:h},++l;break}var C=0,S=0,k;for(l=a.length-1,g="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=E,g="h",C<1&&(C=1);break;case"s":(k=a[l].v.match(/\.0+$/))&&(S=Math.max(S,k[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":g=a[l].t;break;case"m":g==="s"&&(a[l].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[l].v.match(/[Hh]/)&&(C=1),C<2&&a[l].v.match(/[Mm]/)&&(C=2),C<3&&a[l].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var N="",F;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=r2(a[l].t.charCodeAt(0),a[l].v,m,S),a[l].t="t";break;case"n":case"?":for(F=l+1;a[F]!=null&&((h=a[F].t)==="?"||h==="D"||(h===" "||h==="t")&&a[F+1]!=null&&(a[F+1].t==="?"||a[F+1].t==="t"&&a[F+1].v==="/")||a[l].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(a[F].v==="/"||a[F].v===" "&&a[F+1]!=null&&a[F+1].t=="?"));)a[l].v+=a[F].v,a[F]={v:"",t:";"},++F;N+=a[l].v,l=F-1;break;case"G":a[l].t="t",a[l].v=ms(t,r);break}var W="",B,R;if(N.length>0){N.charCodeAt(0)==40?(B=t<0&&N.charCodeAt(0)===45?-t:t,R=va("n",N,B)):(B=t<0&&n>1?-t:t,R=va("n",N,B),B<0&&a[0]&&a[0].t=="t"&&(R=R.substr(1),a[0].v="-"+a[0].v)),F=R.length-1;var z=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){z=l;break}var U=a.length;if(z===a.length&&R.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(F>=a[l].v.length-1?(F-=a[l].v.length,a[l].v=R.substr(F+1,a[l].v.length)):F<0?a[l].v="":(a[l].v=R.substr(0,F+1),F=-1),a[l].t="t",U=l);F>=0&&U<a.length&&(a[U].v=R.substr(0,F+1)+a[U].v)}else if(z!==a.length&&R.indexOf("E")===-1){for(F=R.indexOf(".")-1,l=z;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===z?a[l].v.indexOf(".")-1:a[l].v.length-1,W=a[l].v.substr(p+1);p>=0;--p)F>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(W=R.charAt(F--)+W);a[l].v=W,a[l].t="t",U=l}for(F>=0&&U<a.length&&(a[U].v=R.substr(0,F+1)+a[U].v),F=R.indexOf(".")+1,l=z;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==z)){for(p=a[l].v.indexOf(".")>-1&&l===z?a[l].v.indexOf(".")+1:0,W=a[l].v.substr(0,p);p<a[l].v.length;++p)F<R.length&&(W+=R.charAt(F++));a[l].v=W,a[l].t="t",U=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(B=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=va(a[l].t,a[l].v,B),a[l].t="t");var fe="";for(l=0;l!==a.length;++l)a[l]!=null&&(fe+=a[l].v);return fe}var Cu=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Su(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function h2(e,t){var r=f2(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(Cu),h=r[1].match(Cu);return Su(t,l)?[n,r[0]]:Su(t,h)?[n,r[1]]:[n,r[l!=null&&h!=null?2:1]]}return[n,o]}function Un(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Je)[e],n==null&&(n=r.table&&r.table[bu[e]]||Je[bu[e]]),n==null&&(n=$p[e]||"General");break}if(Wo(n,0))return ms(t,r);t instanceof Date&&(t=Zd(t,r.date1904));var a=h2(n,t);if(Wo(a[1]))return ms(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return d2(a[1],t,r,a[0])}function wa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Je[r]==null){t<0&&(t=r);continue}if(Je[r]==e){t=r;break}}t<0&&(t=391)}return Je[t]=e,t}function mc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&wa(e[t],t)}function ii(){Je=Zp()}var x2={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},nh=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function m2(e){var t=typeof e=="number"?Je[e]:e;return t=t.replace(nh,"(\\d+)"),new RegExp("^"+t+"$")}function g2(e,t,r){var n=-1,a=-1,o=-1,l=-1,h=-1,g=-1;(t.match(nh)||[]).forEach(function(w,E){var A=parseInt(r[E+1],10);switch(w.toLowerCase().charAt(0)){case"y":n=A;break;case"d":o=A;break;case"h":l=A;break;case"s":g=A;break;case"m":l>=0?h=A:a=A;break}}),g>=0&&h==-1&&a>=0&&(h=a,a=-1);var m=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return l==-1&&h==-1&&g==-1?m:n==-1&&a==-1&&o==-1?p:m+"T"+p}var p2=function(){var e={};e.version="1.2.0";function t(){for(var R=0,z=new Array(256),U=0;U!=256;++U)R=U,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,z[U]=R;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function n(R){var z=0,U=0,fe=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(fe=0;fe!=256;++fe)M[fe]=R[fe];for(fe=0;fe!=256;++fe)for(U=R[fe],z=256+fe;z<4096;z+=256)U=M[z]=U>>>8^R[U&255];var V=[];for(fe=1;fe!=16;++fe)V[fe-1]=typeof Int32Array<"u"?M.subarray(fe*256,fe*256+256):M.slice(fe*256,fe*256+256);return V}var a=n(r),o=a[0],l=a[1],h=a[2],g=a[3],m=a[4],p=a[5],w=a[6],E=a[7],A=a[8],T=a[9],_=a[10],C=a[11],S=a[12],k=a[13],N=a[14];function F(R,z){for(var U=z^-1,fe=0,M=R.length;fe<M;)U=U>>>8^r[(U^R.charCodeAt(fe++))&255];return~U}function W(R,z){for(var U=z^-1,fe=R.length-15,M=0;M<fe;)U=N[R[M++]^U&255]^k[R[M++]^U>>8&255]^S[R[M++]^U>>16&255]^C[R[M++]^U>>>24]^_[R[M++]]^T[R[M++]]^A[R[M++]]^E[R[M++]]^w[R[M++]]^p[R[M++]]^m[R[M++]]^g[R[M++]]^h[R[M++]]^l[R[M++]]^o[R[M++]]^r[R[M++]];for(fe+=15;M<fe;)U=U>>>8^r[(U^R[M++])&255];return~U}function B(R,z){for(var U=z^-1,fe=0,M=R.length,V=0,ne=0;fe<M;)V=R.charCodeAt(fe++),V<128?U=U>>>8^r[(U^V)&255]:V<2048?(U=U>>>8^r[(U^(192|V>>6&31))&255],U=U>>>8^r[(U^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,ne=R.charCodeAt(fe++)&1023,U=U>>>8^r[(U^(240|V>>8&7))&255],U=U>>>8^r[(U^(128|V>>2&63))&255],U=U>>>8^r[(U^(128|ne>>6&15|(V&3)<<4))&255],U=U>>>8^r[(U^(128|ne&63))&255]):(U=U>>>8^r[(U^(224|V>>12&15))&255],U=U>>>8^r[(U^(128|V>>6&63))&255],U=U>>>8^r[(U^(128|V&63))&255]);return~U}return e.table=r,e.bstr=F,e.buf=W,e.str=B,e}(),$e=function(){var t={};t.version="1.2.1";function r(L,P){for(var H=L.split("/"),G=P.split("/"),Z=0,K=0,xe=Math.min(H.length,G.length);Z<xe;++Z){if(K=H[Z].length-G[Z].length)return K;if(H[Z]!=G[Z])return H[Z]<G[Z]?-1:1}return H.length-G.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var P=L.lastIndexOf("/");return P===-1?L:L.slice(0,P+1)}function a(L){if(L.charAt(L.length-1)=="/")return a(L.slice(0,-1));var P=L.lastIndexOf("/");return P===-1?L:L.slice(P+1)}function o(L,P){typeof P=="string"&&(P=new Date(P));var H=P.getHours();H=H<<6|P.getMinutes(),H=H<<5|P.getSeconds()>>>1,L.write_shift(2,H);var G=P.getFullYear()-1980;G=G<<4|P.getMonth()+1,G=G<<5|P.getDate(),L.write_shift(2,G)}function l(L){var P=L.read_shift(2)&65535,H=L.read_shift(2)&65535,G=new Date,Z=H&31;H>>>=5;var K=H&15;H>>>=4,G.setMilliseconds(0),G.setFullYear(H+1980),G.setMonth(K-1),G.setDate(Z);var xe=P&31;P>>>=5;var Ee=P&63;return P>>>=6,G.setHours(P),G.setMinutes(Ee),G.setSeconds(xe<<1),G}function h(L){Ur(L,0);for(var P={},H=0;L.l<=L.length-4;){var G=L.read_shift(2),Z=L.read_shift(2),K=L.l+Z,xe={};switch(G){case 21589:H=L.read_shift(1),H&1&&(xe.mtime=L.read_shift(4)),Z>5&&(H&2&&(xe.atime=L.read_shift(4)),H&4&&(xe.ctime=L.read_shift(4))),xe.mtime&&(xe.mt=new Date(xe.mtime*1e3));break}L.l=K,P[G]=xe}return P}var g;function m(){return g||(g={})}function p(L,P){if(L[0]==80&&L[1]==75)return li(L,P);if((L[0]|32)==109&&(L[1]|32)==105)return Ds(L,P);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var H=3,G=512,Z=0,K=0,xe=0,Ee=0,le=0,ge=[],pe=L.slice(0,512);Ur(pe,0);var ke=w(pe);switch(H=ke[0],H){case 3:G=512;break;case 4:G=4096;break;case 0:if(ke[1]==0)return li(L,P);default:throw new Error("Major Version: Expected 3 or 4 saw "+H)}G!==512&&(pe=L.slice(0,G),Ur(pe,28));var De=L.slice(0,G);E(pe,H);var Re=pe.read_shift(4,"i");if(H===3&&Re!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Re);pe.l+=4,xe=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),Ee=pe.read_shift(4,"i"),Z=pe.read_shift(4,"i"),le=pe.read_shift(4,"i"),K=pe.read_shift(4,"i");for(var Le=-1,ze=0;ze<109&&(Le=pe.read_shift(4,"i"),!(Le<0));++ze)ge[ze]=Le;var st=A(L,G);C(le,K,st,G,ge);var _e=k(st,xe,ge,G);_e[xe].name="!Directory",Z>0&&Ee!==ne&&(_e[Ee].name="!MiniFAT"),_e[ge[0]].name="!FAT",_e.fat_addrs=ge,_e.ssz=G;var Vt={},gt=[],Nn=[],as=[];N(xe,_e,st,gt,Z,Vt,Nn,Ee),T(Nn,as,gt),gt.shift();var Et={FileIndex:Nn,FullPaths:as};return P&&P.raw&&(Et.raw={header:De,sectors:st}),Et}function w(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(me,"Header Signature: "),L.l+=16;var P=L.read_shift(2,"u");return[L.read_shift(2,"u"),P]}function E(L,P){var H=9;switch(L.l+=2,H=L.read_shift(2)){case 9:if(P!=3)throw new Error("Sector Shift: Expected 9 saw "+H);break;case 12:if(P!=4)throw new Error("Sector Shift: Expected 12 saw "+H);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+H)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function A(L,P){for(var H=Math.ceil(L.length/P)-1,G=[],Z=1;Z<H;++Z)G[Z-1]=L.slice(Z*P,(Z+1)*P);return G[H-1]=L.slice(H*P),G}function T(L,P,H){for(var G=0,Z=0,K=0,xe=0,Ee=0,le=H.length,ge=[],pe=[];G<le;++G)ge[G]=pe[G]=G,P[G]=H[G];for(;Ee<pe.length;++Ee)G=pe[Ee],Z=L[G].L,K=L[G].R,xe=L[G].C,ge[G]===G&&(Z!==-1&&ge[Z]!==Z&&(ge[G]=ge[Z]),K!==-1&&ge[K]!==K&&(ge[G]=ge[K])),xe!==-1&&(ge[xe]=G),Z!==-1&&G!=ge[G]&&(ge[Z]=ge[G],pe.lastIndexOf(Z)<Ee&&pe.push(Z)),K!==-1&&G!=ge[G]&&(ge[K]=ge[G],pe.lastIndexOf(K)<Ee&&pe.push(K));for(G=1;G<le;++G)ge[G]===G&&(K!==-1&&ge[K]!==K?ge[G]=ge[K]:Z!==-1&&ge[Z]!==Z&&(ge[G]=ge[Z]));for(G=1;G<le;++G)if(L[G].type!==0){if(Ee=G,Ee!=ge[Ee])do Ee=ge[Ee],P[G]=P[Ee]+"/"+P[G];while(Ee!==0&&ge[Ee]!==-1&&Ee!=ge[Ee]);ge[G]=-1}for(P[0]+="/",G=1;G<le;++G)L[G].type!==2&&(P[G]+="/")}function _(L,P,H){for(var G=L.start,Z=L.size,K=[],xe=G;H&&Z>0&&xe>=0;)K.push(P.slice(xe*V,xe*V+V)),Z-=V,xe=cs(H,xe*4);return K.length===0?be(0):Or(K).slice(0,L.size)}function C(L,P,H,G,Z){var K=ne;if(L===ne){if(P!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var xe=H[L],Ee=(G>>>2)-1;if(!xe)return;for(var le=0;le<Ee&&(K=cs(xe,le*4))!==ne;++le)Z.push(K);C(cs(xe,G-4),P-1,H,G,Z)}}function S(L,P,H,G,Z){var K=[],xe=[];Z||(Z=[]);var Ee=G-1,le=0,ge=0;for(le=P;le>=0;){Z[le]=!0,K[K.length]=le,xe.push(L[le]);var pe=H[Math.floor(le*4/G)];if(ge=le*4&Ee,G<4+ge)throw new Error("FAT boundary crossed: "+le+" 4 "+G);if(!L[pe])break;le=cs(L[pe],ge)}return{nodes:K,data:Pu([xe])}}function k(L,P,H,G){var Z=L.length,K=[],xe=[],Ee=[],le=[],ge=G-1,pe=0,ke=0,De=0,Re=0;for(pe=0;pe<Z;++pe)if(Ee=[],De=pe+P,De>=Z&&(De-=Z),!xe[De]){le=[];var Le=[];for(ke=De;ke>=0;){Le[ke]=!0,xe[ke]=!0,Ee[Ee.length]=ke,le.push(L[ke]);var ze=H[Math.floor(ke*4/G)];if(Re=ke*4&ge,G<4+Re)throw new Error("FAT boundary crossed: "+ke+" 4 "+G);if(!L[ze]||(ke=cs(L[ze],Re),Le[ke]))break}K[De]={nodes:Ee,data:Pu([le])}}return K}function N(L,P,H,G,Z,K,xe,Ee){for(var le=0,ge=G.length?2:0,pe=P[L].data,ke=0,De=0,Re;ke<pe.length;ke+=128){var Le=pe.slice(ke,ke+128);Ur(Le,64),De=Le.read_shift(2),Re=a0(Le,0,De-ge),G.push(Re);var ze={name:Re,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},st=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);st!==0&&(ze.ct=F(Le,Le.l-8));var _e=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);_e!==0&&(ze.mt=F(Le,Le.l-8)),ze.start=Le.read_shift(4,"i"),ze.size=Le.read_shift(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=ne,ze.name=""),ze.type===5?(le=ze.start,Z>0&&le!==ne&&(P[le].name="!StreamData")):ze.size>=4096?(ze.storage="fat",P[ze.start]===void 0&&(P[ze.start]=S(H,ze.start,P.fat_addrs,P.ssz)),P[ze.start].name=ze.name,ze.content=P[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:le!==ne&&ze.start!==ne&&P[le]&&(ze.content=_(ze,P[le].data,(P[Ee]||{}).data))),ze.content&&Ur(ze.content,0),K[Re]=ze,xe.push(ze)}}function F(L,P){return new Date((bn(L,P+4)/1e7*Math.pow(2,32)+bn(L,P)/1e7-11644473600)*1e3)}function W(L,P){return m(),p(g.readFileSync(L),P)}function B(L,P){var H=P&&P.type;switch(H||yt&&Buffer.isBuffer(L)&&(H="buffer"),H||"base64"){case"file":return W(L,P);case"base64":return p(En(Sn(L)),P);case"binary":return p(En(L),P)}return p(L,P)}function R(L,P){var H=P||{},G=H.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=G+"/",L.FileIndex[0]={name:G,type:5}),H.CLSID&&(L.FileIndex[0].clsid=H.CLSID),z(L)}function z(L){var P="Sh33tJ5";if(!$e.find(L,"/"+P)){var H=be(4);H[0]=55,H[1]=H[3]=50,H[2]=54,L.FileIndex.push({name:P,type:2,content:H,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+P),U(L)}}function U(L,P){R(L);for(var H=!1,G=!1,Z=L.FullPaths.length-1;Z>=0;--Z){var K=L.FileIndex[Z];switch(K.type){case 0:G?H=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:G=!0,isNaN(K.R*K.L*K.C)&&(H=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(H=!0);break;default:H=!0;break}}if(!(!H&&!P)){var xe=new Date(1987,1,19),Ee=0,le=Object.create?Object.create(null):{},ge=[];for(Z=0;Z<L.FullPaths.length;++Z)le[L.FullPaths[Z]]=!0,L.FileIndex[Z].type!==0&&ge.push([L.FullPaths[Z],L.FileIndex[Z]]);for(Z=0;Z<ge.length;++Z){var pe=n(ge[Z][0]);G=le[pe],G||(ge.push([pe,{name:a(pe).replace("/",""),type:1,clsid:Ce,ct:xe,mt:xe,content:null}]),le[pe]=!0)}for(ge.sort(function(Re,Le){return r(Re[0],Le[0])}),L.FullPaths=[],L.FileIndex=[],Z=0;Z<ge.length;++Z)L.FullPaths[Z]=ge[Z][0],L.FileIndex[Z]=ge[Z][1];for(Z=0;Z<ge.length;++Z){var ke=L.FileIndex[Z],De=L.FullPaths[Z];if(ke.name=a(De).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||Ce,Z===0)ke.C=ge.length>1?1:-1,ke.size=0,ke.type=5;else if(De.slice(-1)=="/"){for(Ee=Z+1;Ee<ge.length&&n(L.FullPaths[Ee])!=De;++Ee);for(ke.C=Ee>=ge.length?-1:Ee,Ee=Z+1;Ee<ge.length&&n(L.FullPaths[Ee])!=n(De);++Ee);ke.R=Ee>=ge.length?-1:Ee,ke.type=1}else n(L.FullPaths[Z+1]||"")==n(De)&&(ke.R=Z+1),ke.type=2}}}function fe(L,P){var H=P||{};if(H.fileType=="mad")return Tn(L,H);switch(U(L),H.fileType){case"zip":return ha(L,H)}var G=function(Re){for(var Le=0,ze=0,st=0;st<Re.FileIndex.length;++st){var _e=Re.FileIndex[st];if(_e.content){var Vt=_e.content.length;Vt>0&&(Vt<4096?Le+=Vt+63>>6:ze+=Vt+511>>9)}}for(var gt=Re.FullPaths.length+3>>2,Nn=Le+7>>3,as=Le+127>>7,Et=Nn+ze+gt+as,pt=Et+127>>7,vt=pt<=109?0:Math.ceil((pt-109)/127);Et+pt+vt+127>>7>pt;)vt=++pt<=109?0:Math.ceil((pt-109)/127);var gn=[1,vt,pt,as,gt,ze,Le,0];return Re.FileIndex[0].size=Le<<6,gn[7]=(Re.FileIndex[0].start=gn[0]+gn[1]+gn[2]+gn[3]+gn[4]+gn[5])+(gn[6]+7>>3),gn}(L),Z=be(G[7]<<9),K=0,xe=0;{for(K=0;K<8;++K)Z.write_shift(1,J[K]);for(K=0;K<8;++K)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),K=0;K<3;++K)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,G[2]),Z.write_shift(4,G[0]+G[1]+G[2]+G[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,G[3]?G[0]+G[1]+G[2]-1:ne),Z.write_shift(4,G[3]),Z.write_shift(-4,G[1]?G[0]-1:ne),Z.write_shift(4,G[1]),K=0;K<109;++K)Z.write_shift(-4,K<G[2]?G[1]+K:-1)}if(G[1])for(xe=0;xe<G[1];++xe){for(;K<236+xe*127;++K)Z.write_shift(-4,K<G[2]?G[1]+K:-1);Z.write_shift(-4,xe===G[1]-1?ne:xe+1)}var Ee=function(Re){for(xe+=Re;K<xe-1;++K)Z.write_shift(-4,K+1);Re&&(++K,Z.write_shift(-4,ne))};for(xe=K=0,xe+=G[1];K<xe;++K)Z.write_shift(-4,Ae.DIFSECT);for(xe+=G[2];K<xe;++K)Z.write_shift(-4,Ae.FATSECT);Ee(G[3]),Ee(G[4]);for(var le=0,ge=0,pe=L.FileIndex[0];le<L.FileIndex.length;++le)pe=L.FileIndex[le],pe.content&&(ge=pe.content.length,!(ge<4096)&&(pe.start=xe,Ee(ge+511>>9)));for(Ee(G[6]+7>>3);Z.l&511;)Z.write_shift(-4,Ae.ENDOFCHAIN);for(xe=K=0,le=0;le<L.FileIndex.length;++le)pe=L.FileIndex[le],pe.content&&(ge=pe.content.length,!(!ge||ge>=4096)&&(pe.start=xe,Ee(ge+63>>6)));for(;Z.l&511;)Z.write_shift(-4,Ae.ENDOFCHAIN);for(K=0;K<G[4]<<2;++K){var ke=L.FullPaths[K];if(!ke||ke.length===0){for(le=0;le<17;++le)Z.write_shift(4,0);for(le=0;le<3;++le)Z.write_shift(4,-1);for(le=0;le<12;++le)Z.write_shift(4,0);continue}pe=L.FileIndex[K],K===0&&(pe.start=pe.size?pe.start-1:ne);var De=K===0&&H.root||pe.name;if(ge=2*(De.length+1),Z.write_shift(64,De,"utf16le"),Z.write_shift(2,ge),Z.write_shift(1,pe.type),Z.write_shift(1,pe.color),Z.write_shift(-4,pe.L),Z.write_shift(-4,pe.R),Z.write_shift(-4,pe.C),pe.clsid)Z.write_shift(16,pe.clsid,"hex");else for(le=0;le<4;++le)Z.write_shift(4,0);Z.write_shift(4,pe.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,pe.start),Z.write_shift(4,pe.size),Z.write_shift(4,0)}for(K=1;K<L.FileIndex.length;++K)if(pe=L.FileIndex[K],pe.size>=4096)if(Z.l=pe.start+1<<9,yt&&Buffer.isBuffer(pe.content))pe.content.copy(Z,Z.l,0,pe.size),Z.l+=pe.size+511&-512;else{for(le=0;le<pe.size;++le)Z.write_shift(1,pe.content[le]);for(;le&511;++le)Z.write_shift(1,0)}for(K=1;K<L.FileIndex.length;++K)if(pe=L.FileIndex[K],pe.size>0&&pe.size<4096)if(yt&&Buffer.isBuffer(pe.content))pe.content.copy(Z,Z.l,0,pe.size),Z.l+=pe.size+63&-64;else{for(le=0;le<pe.size;++le)Z.write_shift(1,pe.content[le]);for(;le&63;++le)Z.write_shift(1,0)}if(yt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function M(L,P){var H=L.FullPaths.map(function(le){return le.toUpperCase()}),G=H.map(function(le){var ge=le.split("/");return ge[ge.length-(le.slice(-1)=="/"?2:1)]}),Z=!1;P.charCodeAt(0)===47?(Z=!0,P=H[0].slice(0,-1)+P):Z=P.indexOf("/")!==-1;var K=P.toUpperCase(),xe=Z===!0?H.indexOf(K):G.indexOf(K);if(xe!==-1)return L.FileIndex[xe];var Ee=!K.match(Ai);for(K=K.replace(nn,""),Ee&&(K=K.replace(Ai,"!")),xe=0;xe<H.length;++xe)if((Ee?H[xe].replace(Ai,"!"):H[xe]).replace(nn,"")==K||(Ee?G[xe].replace(Ai,"!"):G[xe]).replace(nn,"")==K)return L.FileIndex[xe];return null}var V=64,ne=-2,me="d0cf11e0a1b11ae1",J=[208,207,17,224,161,177,26,225],Ce="00000000000000000000000000000000",Ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:me,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function at(L,P,H){m();var G=fe(L,H);g.writeFileSync(P,G)}function he(L){for(var P=new Array(L.length),H=0;H<L.length;++H)P[H]=String.fromCharCode(L[H]);return P.join("")}function Ve(L,P){var H=fe(L,P);switch(P&&P.type||"buffer"){case"file":return m(),g.writeFileSync(P.filename,H),H;case"binary":return typeof H=="string"?H:he(H);case"base64":return Ui(typeof H=="string"?H:he(H));case"buffer":if(yt)return Buffer.isBuffer(H)?H:Aa(H);case"array":return typeof H=="string"?En(H):H}return H}var Xe;function Q(L){try{var P=L.InflateRaw,H=new P;if(H._processChunk(new Uint8Array([3,0]),H._finishFlushFlag),H.bytesRead)Xe=L;else throw new Error("zlib does not expose bytesRead")}catch(G){console.error("cannot use native zlib: "+(G.message||G))}}function oe(L,P){if(!Xe)return Na(L,P);var H=Xe.InflateRaw,G=new H,Z=G._processChunk(L.slice(L.l),G._finishFlushFlag);return L.l+=G.bytesRead,Z}function te(L){return Xe?Xe.deflateRawSync(L):dt(L)}var se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ye(L){var P=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(P>>16|P>>8|P)&255}for(var Se=typeof Uint8Array<"u",Ne=Se?new Uint8Array(256):[],Ye=0;Ye<256;++Ye)Ne[Ye]=ye(Ye);function ee(L,P){var H=Ne[L&255];return P<=8?H>>>8-P:(H=H<<8|Ne[L>>8&255],P<=16?H>>>16-P:(H=H<<8|Ne[L>>16&255],H>>>24-P))}function Ge(L,P){var H=P&7,G=P>>>3;return(L[G]|(H<=6?0:L[G+1]<<8))>>>H&3}function ft(L,P){var H=P&7,G=P>>>3;return(L[G]|(H<=5?0:L[G+1]<<8))>>>H&7}function _t(L,P){var H=P&7,G=P>>>3;return(L[G]|(H<=4?0:L[G+1]<<8))>>>H&15}function ot(L,P){var H=P&7,G=P>>>3;return(L[G]|(H<=3?0:L[G+1]<<8))>>>H&31}function Oe(L,P){var H=P&7,G=P>>>3;return(L[G]|(H<=1?0:L[G+1]<<8))>>>H&127}function rt(L,P,H){var G=P&7,Z=P>>>3,K=(1<<H)-1,xe=L[Z]>>>G;return H<8-G||(xe|=L[Z+1]<<8-G,H<16-G)||(xe|=L[Z+2]<<16-G,H<24-G)||(xe|=L[Z+3]<<24-G),xe&K}function it(L,P,H){var G=P&7,Z=P>>>3;return G<=5?L[Z]|=(H&7)<<G:(L[Z]|=H<<G&255,L[Z+1]=(H&7)>>8-G),P+3}function Jr(L,P,H){var G=P&7,Z=P>>>3;return H=(H&1)<<G,L[Z]|=H,P+1}function He(L,P,H){var G=P&7,Z=P>>>3;return H<<=G,L[Z]|=H&255,H>>>=8,L[Z+1]=H,P+8}function Jn(L,P,H){var G=P&7,Z=P>>>3;return H<<=G,L[Z]|=H&255,H>>>=8,L[Z+1]=H&255,L[Z+2]=H>>>8,P+16}function Wn(L,P){var H=L.length,G=2*H>P?2*H:P+5,Z=0;if(H>=P)return L;if(yt){var K=wu(G);if(L.copy)L.copy(K);else for(;Z<L.length;++Z)K[Z]=L[Z];return K}else if(Se){var xe=new Uint8Array(G);if(xe.set)xe.set(L);else for(;Z<H;++Z)xe[Z]=L[Z];return xe}return L.length=G,L}function Jt(L){for(var P=new Array(L),H=0;H<L;++H)P[H]=0;return P}function xn(L,P,H){var G=1,Z=0,K=0,xe=0,Ee=0,le=L.length,ge=Se?new Uint16Array(32):Jt(32);for(K=0;K<32;++K)ge[K]=0;for(K=le;K<H;++K)L[K]=0;le=L.length;var pe=Se?new Uint16Array(le):Jt(le);for(K=0;K<le;++K)ge[Z=L[K]]++,G<Z&&(G=Z),pe[K]=0;for(ge[0]=0,K=1;K<=G;++K)ge[K+16]=Ee=Ee+ge[K-1]<<1;for(K=0;K<le;++K)Ee=L[K],Ee!=0&&(pe[K]=ge[Ee+16]++);var ke=0;for(K=0;K<le;++K)if(ke=L[K],ke!=0)for(Ee=ee(pe[K],G)>>G-ke,xe=(1<<G+4-ke)-1;xe>=0;--xe)P[Ee|xe<<ke]=ke&15|K<<4;return G}var vr=Se?new Uint16Array(512):Jt(512),Ta=Se?new Uint16Array(32):Jt(32);if(!Se){for(var qt=0;qt<512;++qt)vr[qt]=0;for(qt=0;qt<32;++qt)Ta[qt]=0}(function(){for(var L=[],P=0;P<32;P++)L.push(5);xn(L,Ta,32);var H=[];for(P=0;P<=143;P++)H.push(8);for(;P<=255;P++)H.push(9);for(;P<=279;P++)H.push(7);for(;P<=287;P++)H.push(8);xn(H,vr,288)})();var Ut=function(){for(var P=Se?new Uint8Array(32768):[],H=0,G=0;H<ie.length-1;++H)for(;G<ie[H+1];++G)P[G]=H;for(;G<32768;++G)P[G]=29;var Z=Se?new Uint8Array(259):[];for(H=0,G=0;H<ce.length-1;++H)for(;G<ce[H+1];++G)Z[G]=H;function K(Ee,le){for(var ge=0;ge<Ee.length;){var pe=Math.min(65535,Ee.length-ge),ke=ge+pe==Ee.length;for(le.write_shift(1,+ke),le.write_shift(2,pe),le.write_shift(2,~pe&65535);pe-- >0;)le[le.l++]=Ee[ge++]}return le.l}function xe(Ee,le){for(var ge=0,pe=0,ke=Se?new Uint16Array(32768):[];pe<Ee.length;){var De=Math.min(65535,Ee.length-pe);if(De<10){for(ge=it(le,ge,+(pe+De==Ee.length)),ge&7&&(ge+=8-(ge&7)),le.l=ge/8|0,le.write_shift(2,De),le.write_shift(2,~De&65535);De-- >0;)le[le.l++]=Ee[pe++];ge=le.l*8;continue}ge=it(le,ge,+(pe+De==Ee.length)+2);for(var Re=0;De-- >0;){var Le=Ee[pe];Re=(Re<<5^Le)&32767;var ze=-1,st=0;if((ze=ke[Re])&&(ze|=pe&-32768,ze>pe&&(ze-=32768),ze<pe))for(;Ee[ze+st]==Ee[pe+st]&&st<250;)++st;if(st>2){Le=Z[st],Le<=22?ge=He(le,ge,Ne[Le+1]>>1)-1:(He(le,ge,3),ge+=5,He(le,ge,Ne[Le-23]>>5),ge+=3);var _e=Le<8?0:Le-4>>2;_e>0&&(Jn(le,ge,st-ce[Le]),ge+=_e),Le=P[pe-ze],ge=He(le,ge,Ne[Le]>>3),ge-=3;var Vt=Le<4?0:Le-2>>1;Vt>0&&(Jn(le,ge,pe-ze-ie[Le]),ge+=Vt);for(var gt=0;gt<st;++gt)ke[Re]=pe&32767,Re=(Re<<5^Ee[pe])&32767,++pe;De-=st-1}else Le<=143?Le=Le+48:ge=Jr(le,ge,1),ge=He(le,ge,Ne[Le]),ke[Re]=pe&32767,++pe}ge=He(le,ge,0)-1}return le.l=(ge+7)/8|0,le.l}return function(le,ge){return le.length<8?K(le,ge):xe(le,ge)}}();function dt(L){var P=be(50+Math.floor(L.length*1.1)),H=Ut(L,P);return P.slice(0,H)}var zt=Se?new Uint16Array(32768):Jt(32768),an=Se?new Uint16Array(32768):Jt(32768),xt=Se?new Uint16Array(128):Jt(128),Pe=1,sr=1;function Ft(L,P){var H=ot(L,P)+257;P+=5;var G=ot(L,P)+1;P+=5;var Z=_t(L,P)+4;P+=4;for(var K=0,xe=Se?new Uint8Array(19):Jt(19),Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,ge=Se?new Uint8Array(8):Jt(8),pe=Se?new Uint8Array(8):Jt(8),ke=xe.length,De=0;De<Z;++De)xe[se[De]]=K=ft(L,P),le<K&&(le=K),ge[K]++,P+=3;var Re=0;for(ge[0]=0,De=1;De<=le;++De)pe[De]=Re=Re+ge[De-1]<<1;for(De=0;De<ke;++De)(Re=xe[De])!=0&&(Ee[De]=pe[Re]++);var Le=0;for(De=0;De<ke;++De)if(Le=xe[De],Le!=0){Re=Ne[Ee[De]]>>8-Le;for(var ze=(1<<7-Le)-1;ze>=0;--ze)xt[Re|ze<<Le]=Le&7|De<<3}var st=[];for(le=1;st.length<H+G;)switch(Re=xt[Oe(L,P)],P+=Re&7,Re>>>=3){case 16:for(K=3+Ge(L,P),P+=2,Re=st[st.length-1];K-- >0;)st.push(Re);break;case 17:for(K=3+ft(L,P),P+=3;K-- >0;)st.push(0);break;case 18:for(K=11+Oe(L,P),P+=7;K-- >0;)st.push(0);break;default:st.push(Re),le<Re&&(le=Re);break}var _e=st.slice(0,H),Vt=st.slice(H);for(De=H;De<286;++De)_e[De]=0;for(De=G;De<30;++De)Vt[De]=0;return Pe=xn(_e,zt,286),sr=xn(Vt,an,30),P}function Kt(L,P){if(L[0]==3&&!(L[1]&3))return[Xa(P),2];for(var H=0,G=0,Z=wu(P||1<<18),K=0,xe=Z.length>>>0,Ee=0,le=0;!(G&1);){if(G=ft(L,H),H+=3,G>>>1)G>>1==1?(Ee=9,le=5):(H=Ft(L,H),Ee=Pe,le=sr);else{H&7&&(H+=8-(H&7));var ge=L[H>>>3]|L[(H>>>3)+1]<<8;if(H+=32,ge>0)for(!P&&xe<K+ge&&(Z=Wn(Z,K+ge),xe=Z.length);ge-- >0;)Z[K++]=L[H>>>3],H+=8;continue}for(;;){!P&&xe<K+32767&&(Z=Wn(Z,K+32767),xe=Z.length);var pe=rt(L,H,Ee),ke=G>>>1==1?vr[pe]:zt[pe];if(H+=ke&15,ke>>>=4,!(ke>>>8&255))Z[K++]=ke;else{if(ke==256)break;ke-=257;var De=ke<8?0:ke-4>>2;De>5&&(De=0);var Re=K+ce[ke];De>0&&(Re+=rt(L,H,De),H+=De),pe=rt(L,H,le),ke=G>>>1==1?Ta[pe]:an[pe],H+=ke&15,ke>>>=4;var Le=ke<4?0:ke-2>>1,ze=ie[ke];for(Le>0&&(ze+=rt(L,H,Le),H+=Le),!P&&xe<Re&&(Z=Wn(Z,Re+100),xe=Z.length);K<Re;)Z[K]=Z[K-ze],++K}}}return P?[Z,H+7>>>3]:[Z.slice(0,K),H+7>>>3]}function Na(L,P){var H=L.slice(L.l||0),G=Kt(H,P);return L.l+=G[1],G[0]}function Fs(L,P){if(L)typeof console<"u"&&console.error(P);else throw new Error(P)}function li(L,P){var H=L;Ur(H,0);var G=[],Z=[],K={FileIndex:G,FullPaths:Z};R(K,{root:P.root});for(var xe=H.length-4;(H[xe]!=80||H[xe+1]!=75||H[xe+2]!=5||H[xe+3]!=6)&&xe>=0;)--xe;H.l=xe+4,H.l+=4;var Ee=H.read_shift(2);H.l+=6;var le=H.read_shift(4);for(H.l=le,xe=0;xe<Ee;++xe){H.l+=20;var ge=H.read_shift(4),pe=H.read_shift(4),ke=H.read_shift(2),De=H.read_shift(2),Re=H.read_shift(2);H.l+=8;var Le=H.read_shift(4),ze=h(H.slice(H.l+ke,H.l+ke+De));H.l+=ke+De+Re;var st=H.l;H.l=Le+4,St(H,ge,pe,K,ze),H.l=st}return K}function St(L,P,H,G,Z){L.l+=2;var K=L.read_shift(2),xe=L.read_shift(2),Ee=l(L);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var le=L.read_shift(4),ge=L.read_shift(4),pe=L.read_shift(4),ke=L.read_shift(2),De=L.read_shift(2),Re="",Le=0;Le<ke;++Le)Re+=String.fromCharCode(L[L.l++]);if(De){var ze=h(L.slice(L.l,L.l+De));(ze[21589]||{}).mt&&(Ee=ze[21589].mt),((Z||{})[21589]||{}).mt&&(Ee=Z[21589].mt)}L.l+=De;var st=L.slice(L.l,L.l+ge);switch(xe){case 8:st=oe(L,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+xe)}var _e=!1;K&8&&(le=L.read_shift(4),le==134695760&&(le=L.read_shift(4),_e=!0),ge=L.read_shift(4),pe=L.read_shift(4)),ge!=P&&Fs(_e,"Bad compressed size: "+P+" != "+ge),pe!=H&&Fs(_e,"Bad uncompressed size: "+H+" != "+pe),Vn(G,Re,st,{unsafe:!0,mt:Ee})}function ha(L,P){var H=P||{},G=[],Z=[],K=be(1),xe=H.compression?8:0,Ee=0,le=0,ge=0,pe=0,ke=0,De=L.FullPaths[0],Re=De,Le=L.FileIndex[0],ze=[],st=0;for(le=1;le<L.FullPaths.length;++le)if(Re=L.FullPaths[le].slice(De.length),Le=L.FileIndex[le],!(!Le.size||!Le.content||Re=="Sh33tJ5")){var _e=pe,Vt=be(Re.length);for(ge=0;ge<Re.length;++ge)Vt.write_shift(1,Re.charCodeAt(ge)&127);Vt=Vt.slice(0,Vt.l),ze[ke]=p2.buf(Le.content,0);var gt=Le.content;xe==8&&(gt=te(gt)),K=be(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,Ee),K.write_shift(2,xe),Le.mt?o(K,Le.mt):K.write_shift(4,0),K.write_shift(-4,ze[ke]),K.write_shift(4,gt.length),K.write_shift(4,Le.content.length),K.write_shift(2,Vt.length),K.write_shift(2,0),pe+=K.length,G.push(K),pe+=Vt.length,G.push(Vt),pe+=gt.length,G.push(gt),K=be(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,Ee),K.write_shift(2,xe),K.write_shift(4,0),K.write_shift(-4,ze[ke]),K.write_shift(4,gt.length),K.write_shift(4,Le.content.length),K.write_shift(2,Vt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,_e),st+=K.l,Z.push(K),st+=Vt.length,Z.push(Vt),++ke}return K=be(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,ke),K.write_shift(2,ke),K.write_shift(4,st),K.write_shift(4,pe),K.write_shift(2,0),Or([Or(G),Or(Z),K])}var ns={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function xo(L,P){if(L.ctype)return L.ctype;var H=L.name||"",G=H.match(/\.([^\.]+)$/);return G&&ns[G[1]]||P&&(G=(H=P).match(/[\.\\]([^\.\\])+$/),G&&ns[G[1]])?ns[G[1]]:"application/octet-stream"}function mn(L){for(var P=Ui(L),H=[],G=0;G<P.length;G+=76)H.push(P.slice(G,G+76));return H.join(`\r
`)+`\r
`}function ui(L){var P=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var pe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});P=P.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),P.charAt(0)==`
`&&(P="=0D"+P.slice(1)),P=P.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var H=[],G=P.split(`\r
`),Z=0;Z<G.length;++Z){var K=G[Z];if(K.length==0){H.push("");continue}for(var xe=0;xe<K.length;){var Ee=76,le=K.slice(xe,xe+Ee);le.charAt(Ee-1)=="="?Ee--:le.charAt(Ee-2)=="="?Ee-=2:le.charAt(Ee-3)=="="&&(Ee-=3),le=K.slice(xe,xe+Ee),xe+=Ee,xe<K.length&&(le+="="),H.push(le)}}return H.join(`\r
`)}function Ir(L){for(var P=[],H=0;H<L.length;++H){for(var G=L[H];H<=L.length&&G.charAt(G.length-1)=="=";)G=G.slice(0,G.length-1)+L[++H];P.push(G)}for(var Z=0;Z<P.length;++Z)P[Z]=P[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return En(P.join(`\r
`))}function Ia(L,P,H){for(var G="",Z="",K="",xe,Ee=0;Ee<10;++Ee){var le=P[Ee];if(!le||le.match(/^\s*$/))break;var ge=le.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":G=ge[2].trim();break;case"content-type":K=ge[2].trim();break;case"content-transfer-encoding":Z=ge[2].trim();break}}switch(++Ee,Z.toLowerCase()){case"base64":xe=En(Sn(P.slice(Ee).join("")));break;case"quoted-printable":xe=Ir(P.slice(Ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var pe=Vn(L,G.slice(H.length),xe,{unsafe:!0});K&&(pe.ctype=K)}function Ds(L,P){if(he(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var H=P&&P.root||"",G=(yt&&Buffer.isBuffer(L)?L.toString("binary"):he(L)).split(`\r
`),Z=0,K="";for(Z=0;Z<G.length;++Z)if(K=G[Z],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),H||(H=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,H.length)!=H))for(;H.length>0&&(H=H.slice(0,H.length-1),H=H.slice(0,H.lastIndexOf("/")+1),K.slice(0,H.length)!=H););var xe=(G[1]||"").match(/boundary="(.*?)"/);if(!xe)throw new Error("MAD cannot find boundary");var Ee="--"+(xe[1]||""),le=[],ge=[],pe={FileIndex:le,FullPaths:ge};R(pe);var ke,De=0;for(Z=0;Z<G.length;++Z){var Re=G[Z];Re!==Ee&&Re!==Ee+"--"||(De++&&Ia(pe,G.slice(ke,Z),H),ke=Z)}return pe}function Tn(L,P){var H=P||{},G=H.boundary||"SheetJS";G="------="+G;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+G.slice(2)+'"',"","",""],K=L.FullPaths[0],xe=K,Ee=L.FileIndex[0],le=1;le<L.FullPaths.length;++le)if(xe=L.FullPaths[le].slice(K.length),Ee=L.FileIndex[le],!(!Ee.size||!Ee.content||xe=="Sh33tJ5")){xe=xe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var ge=Ee.content,pe=yt&&Buffer.isBuffer(ge)?ge.toString("binary"):he(ge),ke=0,De=Math.min(1024,pe.length),Re=0,Le=0;Le<=De;++Le)(Re=pe.charCodeAt(Le))>=32&&Re<128&&++ke;var ze=ke>=De*4/5;Z.push(G),Z.push("Content-Location: "+(H.root||"file:///C:/SheetJS/")+xe),Z.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),Z.push("Content-Type: "+xo(Ee,xe)),Z.push(""),Z.push(ze?ui(pe):mn(pe))}return Z.push(G+`--\r
`),Z.join(`\r
`)}function Ic(L){var P={};return R(P,L),P}function Vn(L,P,H,G){var Z=G&&G.unsafe;Z||R(L);var K=!Z&&$e.find(L,P);if(!K){var xe=L.FullPaths[0];P.slice(0,xe.length)==xe?xe=P:(xe.slice(-1)!="/"&&(xe+="/"),xe=(xe+P).replace("//","/")),K={name:a(P),type:2},L.FileIndex.push(K),L.FullPaths.push(xe),Z||$e.utils.cfb_gc(L)}return K.content=H,K.size=H?H.length:0,G&&(G.CLSID&&(K.clsid=G.CLSID),G.mt&&(K.mt=G.mt),G.ct&&(K.ct=G.ct)),K}function fi(L,P){R(L);var H=$e.find(L,P);if(H){for(var G=0;G<L.FileIndex.length;++G)if(L.FileIndex[G]==H)return L.FileIndex.splice(G,1),L.FullPaths.splice(G,1),!0}return!1}function Wr(L,P,H){R(L);var G=$e.find(L,P);if(G){for(var Z=0;Z<L.FileIndex.length;++Z)if(L.FileIndex[Z]==G)return L.FileIndex[Z].name=a(H),L.FullPaths[Z]=H,!0}return!1}function xa(L){U(L,!0)}return t.find=M,t.read=B,t.parse=p,t.write=Ve,t.writeFile=at,t.utils={cfb_new:Ic,cfb_add:Vn,cfb_del:fi,cfb_mov:Wr,cfb_gc:xa,ReadShift:Si,CheckField:Ch,prep_blob:Ur,bconcat:Or,use_zlib:Q,_deflateRaw:dt,_inflateRaw:Na,consts:Ae},t}();function v2(e){return typeof e=="string"?xc(e):Array.isArray(e)?Vp(e):e}function no(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=xc(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?la(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([v2(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(e);return h.open("w"),h.encoding="binary",Array.isArray(t)&&(t=Ja(t)),h.write(t),h.close(),t}catch(g){if(!g.message||!g.message.match(/onstruct/))throw g}throw new Error("cannot save file "+e)}function w2(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ur(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Tu(e,t){for(var r=[],n=ur(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function gc(e){for(var t=[],r=ur(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function pc(e){for(var t=[],r=ur(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function y2(e){for(var t=[],r=ur(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Go=new Date(1899,11,30,0,0,0);function Tr(e,t){var r=e.getTime(),n=Go.getTime()+(e.getTimezoneOffset()-Go.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ah=new Date,_2=Go.getTime()+(ah.getTimezoneOffset()-Go.getTimezoneOffset())*6e4,Nu=ah.getTimezoneOffset();function vc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+_2),t.getTimezoneOffset()!==Nu&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Nu)*6e4),t}function b2(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[o],10)}return t}var Iu=new Date("2017-02-19T19:06:09.000Z"),sh=isNaN(Iu.getFullYear())?new Date("2/19/17"):Iu,E2=sh.getFullYear()==2017;function Zt(e,t){var r=new Date(e);if(E2)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(sh.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function gs(e,t){if(yt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return la(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return la(Xd(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return la(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return la(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"â¬":"Â","â":"Â",Æ:"Â","â":"Â","â¦":"Â","â ":"Â","â¡":"Â","Ë":"Â","â°":"Â",Å :"Â","â¹":"Â",Å:"Â",Å½:"Â","â":"Â","â":"Â","â":"Â","â":"Â","â¢":"Â","â":"Â","â":"Â","Ë":"Â","â¢":"Â",Å¡:"Â","âº":"Â",Å:"Â",Å¾:"Â",Å¸:"Â"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[â¬âÆââ¦â â¡Ëâ°Å â¹ÅÅ½âââââ¢ââËâ¢Å¡âºÅÅ¾Å¸]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function $t(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=$t(e[r]));return t}function cr(e,t){for(var r="";r.length<t;)r+=e;return r}function Kn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(t=Number(n)))?t/r:t}var A2=["january","february","march","april","may","june","july","august","september","october","november","december"];function Js(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&A2.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var C2=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],h=1;h<o.length;++h)l.push(a),l.push(o[h]);return l}}();function ih(e){return e?e.content&&e.type?gs(e.content,!0):e.data?Ei(e.data):e.asNodeBuffer&&yt?Ei(e.asNodeBuffer().toString("binary")):e.asBinary?Ei(e.asBinary()):e._data&&e._data.getContent?Ei(gs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function oh(e){if(!e)return null;if(e.data)return pu(e.data);if(e.asNodeBuffer&&yt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?pu(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function S2(e){return e&&e.name.slice(-4)===".bin"?oh(e):ih(e)}function Ln(e,t){for(var r=e.FullPaths||ur(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function Ql(e,t){var r=Ln(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function yr(e,t,r){if(!r)return S2(Ql(e,t));if(!t)return null;try{return yr(e,t)}catch{return null}}function An(e,t,r){if(!r)return ih(Ql(e,t));if(!t)return null;try{return An(e,t)}catch{return null}}function T2(e,t,r){return oh(Ql(e,t))}function ku(e){for(var t=e.FullPaths||ur(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ht(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return yt?n=Aa(r):n=Gp(r),$e.utils.cfb_add(e,t,n)}$e.utils.cfb_add(e,t,r)}else e.file(t,r)}function Jl(){return $e.utils.cfb_new()}function ch(e,t){switch(t.type){case"base64":return $e.read(e,{type:"base64"});case"binary":return $e.read(e,{type:"binary"});case"buffer":case"array":return $e.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ci(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var pr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,N2=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Fu=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,I2=/<[^>]*>/g,Qr=pr.match(Fu)?Fu:I2,k2=/<\w*:/,F2=/<(\/?)\w+:/;function nt(e,t,r){for(var n={},a=0,o=0;a!==e.length&&!((o=e.charCodeAt(a))===32||o===10||o===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(N2),h=0,g="",m=0,p="",w="",E=1;if(l)for(m=0;m!=l.length;++m){for(w=l[m],o=0;o!=w.length&&w.charCodeAt(o)!==61;++o);for(p=w.slice(0,o).trim();w.charCodeAt(o+1)==32;)++o;for(E=(a=w.charCodeAt(o+1))==34||a==39?1:0,g=w.slice(o+1+E,w.length-E),h=0;h!=p.length&&p.charCodeAt(h)!==58;++h);if(h===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=g,n[p.toLowerCase()]=g;else{var A=(h===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(h+1);if(n[A]&&p.slice(h-3,h)=="ext")continue;n[A]=g,n[A.toLowerCase()]=g}}return n}function fa(e){return e.replace(F2,"<$1")}var lh={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},e0=gc(lh),Nt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(e,function(h,g){return lh[h]||String.fromCharCode(parseInt(g,h.indexOf("x")>-1?16:10))||h}).replace(t,function(h,g){return String.fromCharCode(parseInt(g,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}}(),t0=/[&<>'"]/g,D2=/[\u0000-\u0008\u000b-\u001f]/g;function Mt(e){var t=e+"";return t.replace(t0,function(r){return e0[r]}).replace(D2,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Du(e){return Mt(e).replace(/ /g,"_x0020_")}var uh=/[\u0000-\u001f]/g;function r0(e){var t=e+"";return t.replace(t0,function(r){return e0[r]}).replace(/\n/g,"<br/>").replace(uh,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function O2(e){var t=e+"";return t.replace(t0,function(r){return e0[r]}).replace(uh,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Ou=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function R2(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Yt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $c(e){for(var t="",r=0,n=0,a=0,o=0,l=0,h=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(o=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=e.charCodeAt(r++),h=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(h>>>10&1023)),t+=String.fromCharCode(56320+(h&1023))}return t}function Ru(e){var t=Xa(2*e.length),r,n,a=1,o=0,l=0,h;for(n=0;n<e.length;n+=a)a=1,(h=e.charCodeAt(n))<128?r=h:h<224?(r=(h&31)*64+(e.charCodeAt(n+1)&63),a=2):h<240?(r=(h&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(h&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[o++]=l&255,t[o++]=l>>>8,l=0),t[o++]=r%256,t[o++]=r>>>8;return t.slice(0,o).toString("ucs2")}function Mu(e){return Aa(e,"binary").toString("utf8")}var Eo="foo bar bazÃ¢ÂÂÃ°ÂÂÂ£",jt=yt&&(Mu(Eo)==$c(Eo)&&Mu||Ru(Eo)==$c(Eo)&&Ru)||$c,la=yt?function(e){return Aa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Hi=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),fh=function(){var e=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),M2=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),L2=/<\/?(?:vt:)?variant>/g,j2=/<(?:vt:)([^>]*)>([\s\S]*)</;function Lu(e,t){var r=nt(e),n=e.match(M2(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(L2,"").match(j2);l&&a.push({v:jt(l[2]),t:l[1]})}),a}var dh=/(^\s|\s$|\n)/;function Hr(e,t){return"<"+e+(t.match(dh)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Wi(e){return ur(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Be(e,t,r){return"<"+e+(r!=null?Wi(r):"")+(t!=null?(t.match(dh)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function El(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function P2(e,t){switch(typeof e){case"string":var r=Be("vt:lpwstr",Mt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Be((e|0)==e?"vt:i4":"vt:r8",Mt(String(e)));case"boolean":return Be("vt:bool",e?"true":"false")}if(e instanceof Date)return Be("vt:filetime",El(e));throw new Error("Unable to serialize "+e)}function n0(e){if(yt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return jt(Ja($l(e)));throw new Error("Bad input format: expected Buffer or string")}var Vi=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Sr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Es=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_n={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function B2(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,o=5;o>=0;--o)a=a*256+e[t+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function U2(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,o=0,l=n?-t:t;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(t)?26985:0);for(var h=0;h<=5;++h,o/=256)e[r+h]=o&255;e[r+6]=(a&15)<<4|o&15,e[r+7]=a>>4|n}var ju=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,o=e[0][n].length;a<o;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Pu=yt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Aa(t)})):ju(e)}:ju,Bu=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ga(e,a)));return n.join("").replace(nn,"")},a0=yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(nn,""):Bu(e,t,r)}:Bu,Uu=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},hh=yt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Uu(e,t,r)}:Uu,zu=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(zs(e,a)));return n.join("")},ao=yt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):zu(t,r,n)}:zu,xh=function(e,t){var r=bn(e,t);return r>0?ao(e,t+4,t+4+r-1):""},mh=xh,gh=function(e,t){var r=bn(e,t);return r>0?ao(e,t+4,t+4+r-1):""},ph=gh,vh=function(e,t){var r=2*bn(e,t);return r>0?ao(e,t+4,t+4+r-1):""},wh=vh,yh=function(t,r){var n=bn(t,r);return n>0?a0(t,r+4,r+4+n):""},_h=yh,bh=function(e,t){var r=bn(e,t);return r>0?ao(e,t+4,t+4+r):""},Eh=bh,Ah=function(e,t){return B2(e,t)},Xo=Ah,s0=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};yt&&(mh=function(t,r){if(!Buffer.isBuffer(t))return xh(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},ph=function(t,r){if(!Buffer.isBuffer(t))return gh(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},wh=function(t,r){if(!Buffer.isBuffer(t))return vh(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},_h=function(t,r){if(!Buffer.isBuffer(t))return yh(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Eh=function(t,r){if(!Buffer.isBuffer(t))return bh(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Xo=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ah(t,r)},s0=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var zs=function(e,t){return e[t]},ga=function(e,t){return e[t+1]*256+e[t]},z2=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},bn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},cs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},H2=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Si(e,t){var r="",n,a,o=[],l,h,g,m;switch(t){case"dbcs":if(m=this.l,yt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)r+=String.fromCharCode(ga(this,m)),m+=2;e*=2;break;case"utf8":r=ao(this,this.l,this.l+e);break;case"utf16le":e*=2,r=a0(this,this.l,this.l+e);break;case"wstr":return Si.call(this,e,"dbcs");case"lpstr-ansi":r=mh(this,this.l),e=4+bn(this,this.l);break;case"lpstr-cp":r=ph(this,this.l),e=4+bn(this,this.l);break;case"lpwstr":r=wh(this,this.l),e=4+2*bn(this,this.l);break;case"lpp4":e=4+bn(this,this.l),r=_h(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+bn(this,this.l),r=Eh(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=zs(this,this.l+e++))!==0;)o.push(bo(l));r=o.join("");break;case"_wstr":for(e=0,r="";(l=ga(this,this.l+e))!==0;)o.push(bo(l)),e+=2;e+=2,r=o.join("");break;case"dbcs-cont":for(r="",m=this.l,g=0;g<e;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return l=zs(this,m),this.l=m+1,h=Si.call(this,e-g,l?"dbcs-cont":"sbcs-cont"),o.join("")+h;o.push(bo(ga(this,m))),m+=2}r=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",m=this.l,g=0;g!=e;++g){if(this.lens&&this.lens.indexOf(m)!==-1)return l=zs(this,m),this.l=m+1,h=Si.call(this,e-g,l?"dbcs-cont":"sbcs-cont"),o.join("")+h;o.push(bo(zs(this,m))),m+=1}r=o.join("");break;default:switch(e){case 1:return n=zs(this,this.l),this.l++,n;case 2:return n=(t==="i"?z2:ga)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?cs:H2)(this,this.l),this.l+=4,n):(a=bn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Xo(this,this.l):a=Xo([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=hh(this,this.l,e);break}}return this.l+=e,r}var W2=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},V2=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},G2=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function X2(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)G2(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,W2(this,t,this.l);break;case 8:if(n=8,r==="f"){U2(this,t,this.l);break}case 16:break;case-4:n=4,V2(this,t,this.l);break}return this.l+=n,this}function Ch(e,t){var r=hh(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ur(e,t){e.l=t,e.read_shift=Si,e.chk=Ch,e.write_shift=X2}function Kr(e,t){e.l+=t}function be(e){var t=Xa(e);return Ur(t,0),t}function Ca(e,t,r){if(e){var n,a,o;Ur(e,e.l||0);for(var l=e.length,h=0,g=0;e.l<l;){h=e.read_shift(1),h&128&&(h=(h&127)+((e.read_shift(1)&127)<<7));var m=qi[h]||qi[65535];for(n=e.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=e.read_shift(1))&127)<<7*a;g=e.l+o;var p=m.f&&m.f(e,o,r);if(e.l=g,t(p,m,h))return}}}function fn(){var e=[],t=yt?256:2048,r=function(m){var p=be(m);return Ur(p,0),p},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},o=function(m){return n&&m<n.length-n.l?n:(a(),n=r(Math.max(m+1,t)))},l=function(){return a(),Or(e)},h=function(m){a(),n=m,n.l==null&&(n.l=n.length),o(t)};return{next:o,push:h,end:l,_bufs:e}}function Ie(e,t,r,n){var a=+t,o;if(!isNaN(a)){n||(n=qi[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=e.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var h=0;h!=4;++h)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&s0(r)&&e.push(r)}}function Ti(e,t,r){var n=$t(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Hu(e,t,r){var n=$t(e);return n.s=Ti(n.s,t.s,r),n.e=Ti(n.e,t.s,r),n}function Ni(e,t){if(e.cRel&&e.c<0)for(e=$t(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=$t(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=tt(e);return!e.cRel&&e.cRel!=null&&(r=$2(r)),!e.rRel&&e.rRel!=null&&(r=Y2(r)),r}function qc(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tr(e.s.c)+":"+(e.e.cRel?"":"$")+tr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+gr(e.s.r)+":"+(e.e.rRel?"":"$")+gr(e.e.r):Ni(e.s,t.biff)+":"+Ni(e.e,t.biff)}function i0(e){return parseInt(Z2(e),10)-1}function gr(e){return""+(e+1)}function Y2(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z2(e){return e.replace(/\$(\d+)$/,"$1")}function o0(e){for(var t=q2(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function tr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function $2(e){return e.replace(/^([A-Z])/,"$$$1")}function q2(e){return e.replace(/^\$([A-Z])/,"$1")}function K2(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function tt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function dn(e){var t=e.indexOf(":");return t==-1?{s:rr(e),e:rr(e)}:{s:rr(e.slice(0,t)),e:rr(e.slice(t+1))}}function ut(e,t){return typeof t>"u"||typeof t=="number"?ut(e.s,e.e):(typeof e!="string"&&(e=tt(e)),typeof t!="string"&&(t=tt(t)),e==t?e:e+":"+t)}function It(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=e.length;for(r=0;n<o&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<o&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===o||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=o&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=o&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Wu(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Un(e.z,r?Tr(t):t)}catch{}try{return e.w=Un((e.XF||{}).numFmtId||(r?14:0),r?Tr(t):t)}catch{return""+t}}function ba(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Sa[e.v]||e.v:t==null?Wu(e,e.v):Wu(e,t))}function es(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Sh(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,o=e||(a?[]:{}),l=0,h=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var g=typeof n.origin=="string"?rr(n.origin):n.origin;l=g.r,h=g.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=It(o["!ref"]);m.s.c=p.s.c,m.s.r=p.s.r,m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(m.e.r=l=p.e.r+1)}for(var w=0;w!=t.length;++w)if(t[w]){if(!Array.isArray(t[w]))throw new Error("aoa_to_sheet expects an array of arrays");for(var E=0;E!=t[w].length;++E)if(!(typeof t[w][E]>"u")){var A={v:t[w][E]},T=l+w,_=h+E;if(m.s.r>T&&(m.s.r=T),m.s.c>_&&(m.s.c=_),m.e.r<T&&(m.e.r=T),m.e.c<_&&(m.e.c=_),t[w][E]&&typeof t[w][E]=="object"&&!Array.isArray(t[w][E])&&!(t[w][E]instanceof Date))A=t[w][E];else if(Array.isArray(A.v)&&(A.f=t[w][E][1],A.v=A.v[0]),A.v===null)if(A.f)A.t="n";else if(n.nullError)A.t="e",A.v=0;else if(n.sheetStubs)A.t="z";else continue;else typeof A.v=="number"?A.t="n":typeof A.v=="boolean"?A.t="b":A.v instanceof Date?(A.z=n.dateNF||Je[14],n.cellDates?(A.t="d",A.w=Un(A.z,Tr(A.v))):(A.t="n",A.v=Tr(A.v),A.w=Un(A.z,A.v))):A.t="s";if(a)o[T]||(o[T]=[]),o[T][_]&&o[T][_].z&&(A.z=o[T][_].z),o[T][_]=A;else{var C=tt({c:_,r:T});o[C]&&o[C].z&&(A.z=o[C].z),o[C]=A}}}return m.s.c<1e7&&(o["!ref"]=ut(m)),o}function oi(e,t){return Sh(null,e,t)}function Q2(e){return e.read_shift(4,"i")}function Qn(e,t){return t||(t=be(4)),t.write_shift(4,e),t}function qr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Mr(e,t){var r=!1;return t==null&&(r=!0,t=be(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function J2(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ev(e,t){return t||(t=be(4)),t.write_shift(2,0),t.write_shift(2,0),t}function c0(e,t){var r=e.l,n=e.read_shift(1),a=qr(e),o=[],l={t:a,h:a};if(n&1){for(var h=e.read_shift(4),g=0;g!=h;++g)o.push(J2(e));l.r=o}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function tv(e,t){var r=!1;return t==null&&(r=!0,t=be(15+4*e.t.length)),t.write_shift(1,0),Mr(e.t,t),r?t.slice(0,t.l):t}var rv=c0;function nv(e,t){var r=!1;return t==null&&(r=!0,t=be(23+4*e.t.length)),t.write_shift(1,1),Mr(e.t,t),t.write_shift(4,1),ev({},t),r?t.slice(0,t.l):t}function zn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function As(e,t){return t==null&&(t=be(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Cs(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ss(e,t){return t==null&&(t=be(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var av=qr,Th=Mr;function l0(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Yo(e,t){var r=!1;return t==null&&(r=!0,t=be(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var sv=qr,Al=l0,u0=Yo;function f0(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Xo([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):cs(t,0)>>2;return r?a/100:a}function Nh(e,t){t==null&&(t=be(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ih(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function iv(e,t){return t||(t=be(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ts=Ih,ci=iv;function $r(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ps(e,t){return(t||be(8)).write_shift(8,e,"f")}function ov(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),o=e.read_shift(2,"i"),l=e.read_shift(1),h=e.read_shift(1),g=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var m=us[a];m&&(t.rgb=Xi(m));break;case 2:t.rgb=Xi([l,h,g]);break;case 3:t.theme=a;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function Zo(e,t){if(t||(t=be(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function cv(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function lv(e,t){t||(t=be(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function kh(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function uv(e){return kh(e,1)}function fv(e){return kh(e,2)}var d0=2,ln=3,Ao=11,Vu=12,$o=19,Co=64,dv=65,hv=71,xv=4108,mv=4126,Dr=80,Fh=81,gv=[Dr,Fh],Cl={1:{n:"CodePage",t:d0},2:{n:"Category",t:Dr},3:{n:"PresentationFormat",t:Dr},4:{n:"ByteCount",t:ln},5:{n:"LineCount",t:ln},6:{n:"ParagraphCount",t:ln},7:{n:"SlideCount",t:ln},8:{n:"NoteCount",t:ln},9:{n:"HiddenCount",t:ln},10:{n:"MultimediaClipCount",t:ln},11:{n:"ScaleCrop",t:Ao},12:{n:"HeadingPairs",t:xv},13:{n:"TitlesOfParts",t:mv},14:{n:"Manager",t:Dr},15:{n:"Company",t:Dr},16:{n:"LinksUpToDate",t:Ao},17:{n:"CharacterCount",t:ln},19:{n:"SharedDoc",t:Ao},22:{n:"HyperlinksChanged",t:Ao},23:{n:"AppVersion",t:ln,p:"version"},24:{n:"DigSig",t:dv},26:{n:"ContentType",t:Dr},27:{n:"ContentStatus",t:Dr},28:{n:"Language",t:Dr},29:{n:"Version",t:Dr},255:{},2147483648:{n:"Locale",t:$o},2147483651:{n:"Behavior",t:$o},1919054434:{}},Sl={1:{n:"CodePage",t:d0},2:{n:"Title",t:Dr},3:{n:"Subject",t:Dr},4:{n:"Author",t:Dr},5:{n:"Keywords",t:Dr},6:{n:"Comments",t:Dr},7:{n:"Template",t:Dr},8:{n:"LastAuthor",t:Dr},9:{n:"RevNumber",t:Dr},10:{n:"EditTime",t:Co},11:{n:"LastPrinted",t:Co},12:{n:"CreatedDate",t:Co},13:{n:"ModifiedDate",t:Co},14:{n:"PageCount",t:ln},15:{n:"WordCount",t:ln},16:{n:"CharCount",t:ln},17:{n:"Thumbnail",t:hv},18:{n:"Application",t:Dr},19:{n:"DocSecurity",t:ln},255:{},2147483648:{n:"Locale",t:$o},2147483651:{n:"Behavior",t:$o},1919054434:{}},Gu={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},pv=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function vv(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wv=vv([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),us=$t(wv),Sa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Dh={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tl={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},So={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function h0(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function yv(e){var t=h0();if(!e||!e.match)return t;var r={};if((e.match(Qr)||[]).forEach(function(n){var a=nt(n);switch(a[0].replace(k2,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Tl[a.ContentType]]!==void 0&&t[Tl[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Sr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Oh(e,t){var r=y2(Tl),n=[],a;n[n.length]=pr,n[n.length]=Be("Types",null,{xmlns:Sr.CT,"xmlns:xsd":Sr.xsd,"xmlns:xsi":Sr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(g){return Be("Default",null,{Extension:g[0],ContentType:g[1]})}));var o=function(g){e[g]&&e[g].length>0&&(a=e[g][0],n[n.length]=Be("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:So[g][t.bookType]||So[g].xlsx}))},l=function(g){(e[g]||[]).forEach(function(m){n[n.length]=Be("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:So[g][t.bookType]||So[g].xlsx})})},h=function(g){(e[g]||[]).forEach(function(m){n[n.length]=Be("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:r[g][0]})})};return o("workbooks"),l("sheets"),l("charts"),h("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),l("metadata"),h("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var bt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gi(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ii(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Qr)||[]).forEach(function(a){var o=nt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var h=o.TargetMode==="External"?o.Target:Ci(o.Target,t);r[h]=l,n[o.Id]=l}}),r["!id"]=n,r}function Zs(e){var t=[pr,Be("Relationships",null,{xmlns:Sr.RELS})];return ur(e["!id"]).forEach(function(r){t[t.length]=Be("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ot(e,t,r,n,a,o){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[bt.HLINK,bt.XPATH,bt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var _v="application/vnd.oasis.opendocument.spreadsheet";function bv(e,t){for(var r=n0(e),n,a;n=Vi.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=nt(n[0],!1),a.path=="/"&&a.type!==_v)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Ev(e){var t=[pr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Xu(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Av(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Cv(e){var t=[pr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Xu(e[r][0],e[r][1])),t.push(Av("",e[r][0]));return t.push(Xu("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Rh(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zo.version+"</meta:generator></office:meta></office:document-meta>"}var Bn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Sv=function(){for(var e=new Array(Bn.length),t=0;t<Bn.length;++t){var r=Bn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Mh(e){var t={};e=jt(e);for(var r=0;r<Bn.length;++r){var n=Bn[r],a=e.match(Sv[r]);a!=null&&a.length>0&&(t[n[1]]=Nt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Zt(t[n[1]]))}return t}function Kc(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Mt(t),n[n.length]=r?Be(e,t,r):Hr(e,t))}function Lh(e,t){var r=t||{},n=[pr,Be("cp:coreProperties",null,{"xmlns:cp":Sr.CORE_PROPS,"xmlns:dc":Sr.dc,"xmlns:dcterms":Sr.dcterms,"xmlns:dcmitype":Sr.dcmitype,"xmlns:xsi":Sr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Kc("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:El(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Kc("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:El(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var o=0;o!=Bn.length;++o){var l=Bn[o],h=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&Kc(l[0],h,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var fs=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],jh=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Ph(e,t,r,n){var a=[];if(typeof e=="string")a=Lu(e,n);else for(var o=0;o<e.length;++o)a=a.concat(e[o].map(function(p){return{v:p}}));var l=typeof t=="string"?Lu(t,n).map(function(p){return p.v}):t,h=0,g=0;if(l.length>0)for(var m=0;m!==a.length;m+=2){switch(g=+a[m+1].v,a[m].v){case"Worksheets":case"å·¥ä½è¡¨":case"ÐÐ¸ÑÑÑ":case"Ø£ÙØ±Ø§Ù Ø§ÙØ¹ÙÙ":case"ã¯ã¼ã¯ã·ã¼ã":case"××××× ××ª ×¢××××":case"ArbeitsblÃ¤tter":case"ÃalÄ±Åma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":r.Worksheets=g,r.SheetNames=l.slice(h,h+g);break;case"Named Ranges":case"Rangos con nombre":case"ååä»ãä¸è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":r.NamedRanges=g,r.DefinedNames=l.slice(h,h+g);break;case"Charts":case"Diagramme":r.Chartsheets=g,r.ChartNames=l.slice(h,h+g);break}h+=g}}function Tv(e,t,r){var n={};return t||(t={}),e=jt(e),fs.forEach(function(a){var o=(e.match(Hi(a[0]))||[])[1];switch(a[2]){case"string":o&&(t[a[1]]=Nt(o));break;case"bool":t[a[1]]=o==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Ph(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Bh(e){var t=[],r=Be;return e||(e={}),e.Application="SheetJS",t[t.length]=pr,t[t.length]=Be("Properties",null,{xmlns:Sr.EXT_PROPS,"xmlns:vt":Sr.vt}),fs.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Mt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Mt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Nv=/<[^>]+>[^<]*/g;function Iv(e,t){var r={},n="",a=e.match(Nv);if(a)for(var o=0;o!=a.length;++o){var l=a[o],h=nt(l);switch(h[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(h.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var g=l.split(">"),m=g[0].slice(4),p=g[1];switch(m){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(p);break;case"bool":r[n]=Yt(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=Zt(p);break;case"cy":case"error":r[n]=Nt(p);break;default:if(m.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,m,g)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function Uh(e){var t=[pr,Be("Properties",null,{xmlns:Sr.CUST_PROPS,"xmlns:vt":Sr.vt})];if(!e)return t.join("");var r=1;return ur(e).forEach(function(a){++r,t[t.length]=Be("property",P2(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Mt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Nl={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qc;function kv(e,t,r){Qc||(Qc=gc(Nl)),t=Qc[t]||t,e[t]=r}function Fv(e,t){var r=[];return ur(Nl).map(function(n){for(var a=0;a<Bn.length;++a)if(Bn[a][1]==n)return Bn[a];for(a=0;a<fs.length;++a)if(fs[a][1]==n)return fs[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(Hr(Nl[n[1]]||n[1],a))}}),Be("DocumentProperties",r.join(""),{xmlns:_n.o})}function Dv(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&ur(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var l=0;l<Bn.length;++l)if(o==Bn[l][1])return;for(l=0;l<fs.length;++l)if(o==fs[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var h=e[o],g="string";typeof h=="number"?(g="float",h=String(h)):h===!0||h===!1?(g="boolean",h=h?"1":"0"):h=String(h),a.push(Be(Du(o),h,{"dt:dt":g}))}}),t&&ur(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var l=t[o],h="string";typeof l=="number"?(h="float",l=String(l)):l===!0||l===!1?(h="boolean",l=l?"1":"0"):l instanceof Date?(h="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Be(Du(o),l,{"dt:dt":h}))}}),"<"+n+' xmlns="'+_n.o+'">'+a.join("")+"</"+n+">"}function x0(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ov(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),a+=o);var l=be(8);return l.write_shift(4,n),l.write_shift(4,a),l}function zh(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Hh(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Wh(e,t,r){return t===31?Hh(e):zh(e,t,r)}function Il(e,t,r){return Wh(e,t,r===!1?0:4)}function Rv(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Wh(e,t,0)}function Mv(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(nn,""),e.l-a&2&&(e.l+=2)}return r}function Lv(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(nn,"");return r}function jv(e){var t=e.l,r=qo(e,Fh);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=qo(e,ln);return[r,n]}function Pv(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(jv(e));return r}function Yu(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var o=e.read_shift(4),l=e.read_shift(4);n[o]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(nn,"").replace(Ai,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Vh(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Bv(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function qo(e,t,r){var n=e.read_shift(2),a,o=r||{};if(e.l+=2,t!==Vu&&n!==t&&gv.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Vu?n:t){case 2:return a=e.read_shift(2,"i"),o.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return zh(e,n,4).replace(nn,"");case 31:return Hh(e);case 64:return x0(e);case 65:return Vh(e);case 71:return Bv(e);case 80:return Il(e,n,!o.raw).replace(nn,"");case 81:return Rv(e,n).replace(nn,"");case 4108:return Pv(e);case 4126:case 4127:return n==4127?Mv(e):Lv(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Zu(e,t){var r=be(4),n=be(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=be(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Ov(t);break;case 31:case 80:for(n=be(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Or([r,n])}function $u(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),o=[],l=0,h=0,g=-1,m={};for(l=0;l!=a;++l){var p=e.read_shift(4),w=e.read_shift(4);o[l]=[p,w+r]}o.sort(function(k,N){return k[1]-N[1]});var E={};for(l=0;l!=a;++l){if(e.l!==o[l][1]){var A=!0;if(l>0&&t)switch(t[o[l-1][0]].t){case 2:e.l+2===o[l][1]&&(e.l+=2,A=!1);break;case 80:e.l<=o[l][1]&&(e.l=o[l][1],A=!1);break;case 4108:e.l<=o[l][1]&&(e.l=o[l][1],A=!1);break}if((!t||l==0)&&e.l<=o[l][1]&&(A=!1,e.l=o[l][1]),A)throw new Error("Read Error: Expected address "+o[l][1]+" at "+e.l+" :"+l)}if(t){var T=t[o[l][0]];if(E[T.n]=qo(e,T.t,{raw:!0}),T.p==="version"&&(E[T.n]=String(E[T.n]>>16)+"."+("0000"+String(E[T.n]&65535)).slice(-4)),T.n=="CodePage")switch(E[T.n]){case 0:E[T.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Zn(h=E[T.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+E[T.n])}}else if(o[l][0]===1){if(h=E.CodePage=qo(e,d0),Zn(h),g!==-1){var _=e.l;e.l=o[g][1],m=Yu(e,h),e.l=_}}else if(o[l][0]===0){if(h===0){g=l,e.l=o[l+1][1];continue}m=Yu(e,h)}else{var C=m[o[l][0]],S;switch(e[e.l]){case 65:e.l+=4,S=Vh(e);break;case 30:e.l+=4,S=Il(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,S=Il(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,S=e.read_shift(4,"i");break;case 19:e.l+=4,S=e.read_shift(4);break;case 5:e.l+=4,S=e.read_shift(8,"f");break;case 11:e.l+=4,S=hr(e,4);break;case 64:e.l+=4,S=Zt(x0(e));break;default:throw new Error("unparsed value: "+e[e.l])}E[C]=S}}return e.l=r+n,E}var Gh=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Uv(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function qu(e,t,r){var n=be(8),a=[],o=[],l=8,h=0,g=be(8),m=be(8);if(g.write_shift(4,2),g.write_shift(4,1200),m.write_shift(4,1),o.push(g),a.push(m),l+=8+g.length,!t){m=be(8),m.write_shift(4,0),a.unshift(m);var p=[be(4)];for(p[0].write_shift(4,e.length),h=0;h<e.length;++h){var w=e[h][0];for(g=be(8+2*(w.length+1)+(w.length%2?0:2)),g.write_shift(4,h+2),g.write_shift(4,w.length+1),g.write_shift(0,w,"dbcs");g.l!=g.length;)g.write_shift(1,0);p.push(g)}g=Or(p),o.unshift(g),l+=8+g.length}for(h=0;h<e.length;++h)if(!(t&&!t[e[h][0]])&&!(Gh.indexOf(e[h][0])>-1||jh.indexOf(e[h][0])>-1)&&e[h][1]!=null){var E=e[h][1],A=0;if(t){A=+t[e[h][0]];var T=r[A];if(T.p=="version"&&typeof E=="string"){var _=E.split(".");E=(+_[0]<<16)+(+_[1]||0)}g=Zu(T.t,E)}else{var C=Uv(E);C==-1&&(C=31,E=String(E)),g=Zu(C,E)}o.push(g),m=be(8),m.write_shift(4,t?A:2+h),a.push(m),l+=8+g.length}var S=8*(o.length+1);for(h=0;h<o.length;++h)a[h].write_shift(4,S),S+=o[h].length;return n.write_shift(4,l),n.write_shift(4,o.length),Or([n].concat(a).concat(o))}function Ku(e,t,r){var n=e.content;if(!n)return{};Ur(n,0);var a,o,l,h,g=0;n.chk("feff","Byte Order: "),n.read_shift(2);var m=n.read_shift(4),p=n.read_shift(16);if(p!==$e.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),h=n.read_shift(4),a===1&&h!==n.l)throw new Error("Length mismatch: "+h+" !== "+n.l);a===2&&(l=n.read_shift(16),g=n.read_shift(4));var w=$u(n,t),E={SystemIdentifier:m};for(var A in w)E[A]=w[A];if(E.FMTID=o,a===1)return E;if(g-n.l==2&&(n.l+=2),n.l!==g)throw new Error("Length mismatch 2: "+n.l+" !== "+g);var T;try{T=$u(n,null)}catch{}for(A in T)E[A]=T[A];return E.FMTID=[o,l],E}function Qu(e,t,r,n,a,o){var l=be(a?68:48),h=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,$e.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var g=qu(e,r,n);if(h.push(g),a){var m=qu(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+g.length),h.push(m)}return Or(h)}function Ma(e,t){return e.read_shift(t),null}function zv(e,t){t||(t=be(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Hv(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function hr(e,t){return e.read_shift(t)===1}function rn(e,t){return t||(t=be(2)),t.write_shift(2,+!!e),t}function _r(e){return e.read_shift(2,"u")}function jn(e,t){return t||(t=be(2)),t.write_shift(2,e),t}function Xh(e,t){return Hv(e,t,_r)}function Wv(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Yh(e,t,r){return r||(r=be(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function so(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=e.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function Vv(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,h,g={};a&&(l=e.read_shift(2)),n&&(h=e.read_shift(4));var m=o==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,m);return a&&(e.l+=4*l),n&&(e.l+=h),g.t=p,a||(g.raw="<t>"+g.t+"</t>",g.r=g.t),g}function Gv(e){var t=e.t||"",r=be(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=be(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Or(a)}function vs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function io(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):vs(e,n,r)}function Ns(e,t,r){if(r.biff>5)return io(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Zh(e,t,r){return r||(r=be(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Xv(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Yv(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(nn,"");return n&&(e.l+=24),a}function Zv(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(o>>1,"utf16le").replace(nn,"");return r+l}function $v(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Yv(e);case"0303000000000000c000000000000046":return Zv(e);default:throw new Error("Unsupported Moniker "+r)}}function To(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(nn,""):"";return r}function Ju(e,t){t||(t=be(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function qv(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var o,l,h,g,m="",p,w;a&16&&(o=To(e,r-e.l)),a&128&&(l=To(e,r-e.l)),(a&257)===257&&(h=To(e,r-e.l)),(a&257)===1&&(g=$v(e,r-e.l)),a&8&&(m=To(e,r-e.l)),a&32&&(p=e.read_shift(16)),a&64&&(w=x0(e)),e.l=r;var E=l||h||g||"";E&&m&&(E+="#"+m),E||(E="#"+m),a&2&&E.charAt(0)=="/"&&E.charAt(1)!="/"&&(E="file://"+E);var A={Target:E};return p&&(A.guid=p),w&&(A.time=w),o&&(A.Tooltip=o),A}function Kv(e){var t=be(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),o=a>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(o==28)n=n.slice(1),Ju(n,t);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var h=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(h.length+1)),r=0;r<h.length;++r)t.write_shift(2,h.charCodeAt(r));t.write_shift(2,0),o&8&&Ju(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var g=0;n.slice(g*3,g*3+3)=="../"||n.slice(g*3,g*3+3)=="..\\";)++g;for(t.write_shift(2,g),t.write_shift(4,n.length-3*g+1),r=0;r<n.length-3*g;++r)t.write_shift(1,n.charCodeAt(r+3*g)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function $h(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function qh(e,t){var r=$h(e);return r[3]=0,r}function da(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ws(e,t,r,n){return n||(n=be(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Qv(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Jv(e,t,r){return t===0?"":Ns(e,t,r)}function ew(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),o=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,o,l]}function Kh(e){var t=e.read_shift(2),r=f0(e);return[t,r]}function tw(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=so(e,t,r),o=e.read_shift(2);if(n-=e.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return e.l+=o,a}function wc(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Qh(e,t){return t||(t=be(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Jh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var rw=Jh;function e1(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function nw(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function aw(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Gr(e){e.l+=2,e.l+=e.read_shift(2)}var sw={0:Gr,4:Gr,5:Gr,6:Gr,7:aw,8:Gr,9:Gr,10:Gr,11:Gr,12:Gr,13:nw,14:Gr,15:Gr,16:Gr,17:Gr,18:Gr,19:Gr,20:Gr,21:e1};function iw(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(sw[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function No(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function m0(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=be(a);return o.write_shift(2,n),o.write_shift(2,t),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function ow(e,t){return t===0||e.read_shift(2),1200}function cw(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Ns(e,0,r);return e.read_shift(t+n-e.l),a}function lw(e,t){var r=!t||t.biff==8,n=be(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function uw(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function fw(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=so(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function dw(e,t){var r=!t||t.biff>=8?2:1,n=be(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function hw(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),o=[],l=0;l!=a&&e.l<r;++l)o.push(Vv(e));return o.Count=n,o.Unique=a,o}function xw(e,t){var r=be(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Gv(e[a]);var o=Or([r].concat(n));return o.parts=[r.length].concat(n.map(function(l){return l.length})),o}function mw(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function gw(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function pw(e){var t=Qv(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function vw(e){return e.read_shift(2),e.read_shift(4)}function ef(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function ww(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),h=e.read_shift(2),g=e.read_shift(2),m=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:h,Selected:g,TabRatio:m}}function yw(){var e=be(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function _w(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function bw(e){var t=be(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Ew(){}function Aw(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=so(e,0,r),n}function Cw(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,o=be(a);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}function Sw(e){var t=da(e);return t.isst=e.read_shift(4),t}function Tw(e,t,r,n){var a=be(10);return ws(e,t,n,a),a.write_shift(4,r),a}function Nw(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=da(e);r.biff==2&&e.l++;var o=io(e,n-e.l,r);return a.val=o,a}function Iw(e,t,r,n,a){var o=!a||a.biff==8,l=be(8+ +o+(1+o)*r.length);return ws(e,t,n,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function kw(e,t,r){var n=e.read_shift(2),a=Ns(e,0,r);return[n,a]}function Fw(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var Dw=Ns;function tf(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,o=e.read_shift(a),l=e.read_shift(a),h=e.read_shift(2),g=e.read_shift(2);return e.l=n,{s:{r:o,c:h},e:{r:l,c:g}}}function Ow(e,t){var r=t.biff==8||!t.biff?4:2,n=be(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Rw(e){var t=e.read_shift(2),r=e.read_shift(2),n=Kh(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Mw(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(Kh(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function Lw(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function jw(e,t,r,n){var a={},o=e.read_shift(4),l=e.read_shift(4),h=e.read_shift(4),g=e.read_shift(2);return a.patternType=pv[h>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=h&127,a.icvBottom=h>>7&127,a.icvDiag=h>>14&127,a.dgDiag=h>>21&15,a.icvFore=g&127,a.icvBack=g>>7&127,a.fsxButton=g>>14&1),a}function Pw(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=jw(e,t,n.fStyle,r),n}function rf(e,t,r,n){var a=r&&r.biff==5;n||(n=be(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&a&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Bw(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Uw(e){var t=be(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function nf(e,t,r){var n=da(e);(r.biff==2||t==9)&&++e.l;var a=Wv(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function zw(e,t,r,n,a,o){var l=be(8);return ws(e,t,n,l),Yh(r,o,l),l}function Hw(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=da(e),a=$r(e);return n.val=a,n}function Ww(e,t,r,n){var a=be(14);return ws(e,t,n,a),ps(r,a),a}var af=Jv;function Vw(e,t,r){var n=e.l+t,a=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=vs(e,o),h=[];n>e.l;)h.push(io(e));return[o,a,l,h]}function sf(e,t,r){var n=e.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=tw(e,t-2,r)),o.body=a||e.read_shift(t-2),typeof a=="string"&&(o.Name=a),o}var Gw=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function of(e,t,r){var n=e.l+t,a=e.read_shift(2),o=e.read_shift(1),l=e.read_shift(1),h=e.read_shift(r&&r.biff==2?1:2),g=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),g=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var m=vs(e,l,r);a&32&&(m=Gw[m.charCodeAt(0)]);var p=n-e.l;r&&r.biff==2&&--p;var w=n==e.l||h===0||!(p>0)?[]:ib(e,p,r,h);return{chKey:o,Name:m,itab:g,rgce:w}}function t1(e,t,r){if(r.biff<8)return Xw(e,t,r);for(var n=[],a=e.l+t,o=e.read_shift(r.biff>8?4:2);o--!==0;)n.push(ew(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Xw(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=so(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Yw(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),o=vs(e,n,r),l=vs(e,a,r);return[o,l]}function Zw(e,t,r){var n=Jh(e);e.l++;var a=e.read_shift(1);return t-=8,[ob(e,t,r),a,n]}function cf(e,t,r){var n=rw(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,ab(e,t,r)]}function $w(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function qw(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),h=Ns(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},h,l,o]}}function Kw(e,t,r){return qw(e,t,r)}function Qw(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(wc(e));return r}function Jw(e){var t=be(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Qh(e[r],t);return t}function ey(e,t,r){if(r&&r.biff<8)return ry(e,t,r);var n=e1(e),a=iw(e,t-22,n[1]);return{cmo:n,ft:a}}var ty={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function ry(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((ty[n]||Kr)(e,t,r)),{cmo:[a,n,o],ft:l}}function ny(e,t,r){var n=e.l,a="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:l=Xv(e,6,r);var h=e.read_shift(2);e.read_shift(2),_r(e,2);var g=e.read_shift(2);e.l+=g;for(var m=1;m<e.lens.length-1;++m){if(e.l-n!=e.lens[m])throw new Error("TxO: bad continue record");var p=e[e.l],w=vs(e,e.lens[m+1]-e.lens[m]-1);if(a+=w,a.length>=(p?h:2*h))break}if(a.length!==h&&a.length!==h*2)throw new Error("cchText: "+h+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function ay(e,t){var r=wc(e);e.l+=16;var n=qv(e,t-24);return[r,n]}function sy(e){var t=be(24),r=rr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Or([t,Kv(e[1])])}function iy(e,t){e.read_shift(2);var r=wc(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(nn,""),[r,n]}function oy(e){var t=e[1].Tooltip,r=be(10+2*(t.length+1));r.write_shift(2,2048);var n=rr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function cy(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Gu[r]||r,r=e.read_shift(2),t[1]=Gu[r]||r,t}function ly(e){return e||(e=be(4)),e.write_shift(2,1),e.write_shift(2,1),e}function uy(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qh(e));return r}function fy(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(qh(e));return r}function dy(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function r1(e,t,r){if(!r.cellStyles)return Kr(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),h=e.read_shift(n),g=e.read_shift(2);n==2&&(e.l+=2);var m={s:a,e:o,w:l,ixfe:h,flags:g};return(r.biff>=5||!r.biff)&&(m.level=g>>8&7),m}function hy(e,t){var r=be(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function xy(e,t){var r={};return t<32||(e.l+=16,r.header=$r(e),r.footer=$r(e),e.l+=2),r}function my(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function gy(e){for(var t=be(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var py=da,vy=Xh,wy=io;function yy(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function _y(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=da(e);++e.l;var a=Ns(e,t-7,r);return n.t="str",n.val=a,n}function by(e){var t=da(e);++e.l;var r=$r(e);return t.t="n",t.val=r,t}function Ey(e,t,r){var n=be(15);return uo(n,e,t),n.write_shift(8,r,"f"),n}function Ay(e){var t=da(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Cy(e,t,r){var n=be(9);return uo(n,e,t),n.write_shift(2,r),n}function Sy(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Ty(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Ny(e,t,r){var n=e.l+t,a=da(e),o=e.read_shift(2),l=vs(e,o,r);return e.l=n,a.t="str",a.val=l,a}var Iy=[2,3,48,49,131,139,140,245],kl=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=gc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(h,g){var m=[],p=Xa(1);switch(g.type){case"base64":p=En(Sn(h));break;case"binary":p=En(h);break;case"buffer":case"array":p=h;break}Ur(p,0);var w=p.read_shift(1),E=!!(w&136),A=!1,T=!1;switch(w){case 2:break;case 3:break;case 48:A=!0,E=!0;break;case 49:A=!0,E=!0;break;case 131:break;case 139:break;case 140:T=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+w.toString(16))}var _=0,C=521;w==2&&(_=p.read_shift(2)),p.l+=3,w!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),w!=2&&(C=p.read_shift(2));var S=p.read_shift(2),k=g.codepage||1252;w!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(k=e[p[p.l]]),p.l+=1,p.l+=2),T&&(p.l+=36);for(var N=[],F={},W=Math.min(p.length,w==2?521:C-10-(A?264:0)),B=T?32:11;p.l<W&&p[p.l]!=13;)switch(F={},F.name=Bi.utils.decode(k,p.slice(p.l,p.l+B)).replace(/[\u0000\r\n].*$/g,""),p.l+=B,F.type=String.fromCharCode(p.read_shift(1)),w!=2&&!T&&(F.offset=p.read_shift(4)),F.len=p.read_shift(1),w==2&&(F.offset=p.read_shift(2)),F.dec=p.read_shift(1),F.name.length&&N.push(F),w!=2&&(p.l+=T?13:14),F.type){case"B":(!A||F.len!=8)&&g.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(p[p.l]!==13&&(p.l=C-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=C;var R=0,z=0;for(m[0]=[],z=0;z!=N.length;++z)m[0][z]=N[z].name;for(;_-- >0;){if(p[p.l]===42){p.l+=S;continue}for(++p.l,m[++R]=[],z=0,z=0;z!=N.length;++z){var U=p.slice(p.l,p.l+N[z].len);p.l+=N[z].len,Ur(U,0);var fe=Bi.utils.decode(k,U);switch(N[z].type){case"C":fe.trim().length&&(m[R][z]=fe.replace(/\s+$/,""));break;case"D":fe.length===8?m[R][z]=new Date(+fe.slice(0,4),+fe.slice(4,6)-1,+fe.slice(6,8)):m[R][z]=fe;break;case"F":m[R][z]=parseFloat(fe.trim());break;case"+":case"I":m[R][z]=T?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(fe.trim().toUpperCase()){case"Y":case"T":m[R][z]=!0;break;case"N":case"F":m[R][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+fe+"|")}break;case"M":if(!E)throw new Error("DBF Unexpected MEMO for type "+w.toString(16));m[R][z]="##MEMO##"+(T?parseInt(fe.trim(),10):U.read_shift(4));break;case"N":fe=fe.replace(/\u0000/g,"").trim(),fe&&fe!="."&&(m[R][z]=+fe||0);break;case"@":m[R][z]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":m[R][z]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":m[R][z]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[R][z]=-U.read_shift(-8,"f");break;case"B":if(A&&N[z].len==8){m[R][z]=U.read_shift(8,"f");break}case"G":case"P":U.l+=N[z].len;break;case"0":if(N[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[z].type)}}}if(w!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return g&&g.sheetRows&&(m=m.slice(0,g.sheetRows)),g.DBF=N,m}function n(h,g){var m=g||{};m.dateNF||(m.dateNF="yyyymmdd");var p=oi(r(h,m),m);return p["!cols"]=m.DBF.map(function(w){return{wch:w.len,DBF:w}}),delete m.DBF,p}function a(h,g){try{return es(n(h,g),g)}catch(m){if(g&&g.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(h,g){var m=g||{};if(+m.codepage>=0&&Zn(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var p=fn(),w=ec(h,{header:1,raw:!0,cellDates:!0}),E=w[0],A=w.slice(1),T=h["!cols"]||[],_=0,C=0,S=0,k=1;for(_=0;_<E.length;++_){if(((T[_]||{}).DBF||{}).name){E[_]=T[_].DBF.name,++S;continue}if(E[_]!=null){if(++S,typeof E[_]=="number"&&(E[_]=E[_].toString(10)),typeof E[_]!="string")throw new Error("DBF Invalid column name "+E[_]+" |"+typeof E[_]+"|");if(E.indexOf(E[_])!==_){for(C=0;C<1024;++C)if(E.indexOf(E[_]+"_"+C)==-1){E[_]+="_"+C;break}}}}var N=It(h["!ref"]),F=[],W=[],B=[];for(_=0;_<=N.e.c-N.s.c;++_){var R="",z="",U=0,fe=[];for(C=0;C<A.length;++C)A[C][_]!=null&&fe.push(A[C][_]);if(fe.length==0||E[_]==null){F[_]="?";continue}for(C=0;C<fe.length;++C){switch(typeof fe[C]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=fe[C]instanceof Date?"D":"C";break;default:z="C"}U=Math.max(U,String(fe[C]).length),R=R&&R!=z?"C":z}U>250&&(U=250),z=((T[_]||{}).DBF||{}).type,z=="C"&&T[_].DBF.len>U&&(U=T[_].DBF.len),R=="B"&&z=="N"&&(R="N",B[_]=T[_].DBF.dec,U=T[_].DBF.len),W[_]=R=="C"||z=="N"?U:o[R]||0,k+=W[_],F[_]=R}var M=p.next(32);for(M.write_shift(4,318902576),M.write_shift(4,A.length),M.write_shift(2,296+32*S),M.write_shift(2,k),_=0;_<4;++_)M.write_shift(4,0);for(M.write_shift(4,0|(+t[Gd]||3)<<8),_=0,C=0;_<E.length;++_)if(E[_]!=null){var V=p.next(32),ne=(E[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ne,"sbcs"),V.write_shift(1,F[_]=="?"?"C":F[_],"sbcs"),V.write_shift(4,C),V.write_shift(1,W[_]||o[F[_]]||0),V.write_shift(1,B[_]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),C+=W[_]||o[F[_]]||0}var me=p.next(264);for(me.write_shift(4,13),_=0;_<65;++_)me.write_shift(4,0);for(_=0;_<A.length;++_){var J=p.next(k);for(J.write_shift(1,0),C=0;C<E.length;++C)if(E[C]!=null)switch(F[C]){case"L":J.write_shift(1,A[_][C]==null?63:A[_][C]?84:70);break;case"B":J.write_shift(8,A[_][C]||0,"f");break;case"N":var Ce="0";for(typeof A[_][C]=="number"&&(Ce=A[_][C].toFixed(B[C]||0)),S=0;S<W[C]-Ce.length;++S)J.write_shift(1,32);J.write_shift(1,Ce,"sbcs");break;case"D":A[_][C]?(J.write_shift(4,("0000"+A[_][C].getFullYear()).slice(-4),"sbcs"),J.write_shift(2,("00"+(A[_][C].getMonth()+1)).slice(-2),"sbcs"),J.write_shift(2,("00"+A[_][C].getDate()).slice(-2),"sbcs")):J.write_shift(8,"00000000","sbcs");break;case"C":var Ae=String(A[_][C]!=null?A[_][C]:"").slice(0,W[C]);for(J.write_shift(1,Ae,"sbcs"),S=0;S<W[C]-Ae.length;++S)J.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}}(),n1=function(){var e={AA:"Ã",BA:"Ã",CA:"Ã",DA:195,HA:"Ã",JA:197,AE:"Ã",BE:"Ã",CE:"Ã",HE:"Ã",AI:"Ã",BI:"Ã",CI:"Ã",HI:"Ã",AO:"Ã",BO:"Ã",CO:"Ã",DO:213,HO:"Ã",AU:"Ã",BU:"Ã",CU:"Ã",HU:"Ã",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã",Kc:"Ã§",q:"Ã¦",z:"Å",a:"Ã",j:"Å",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ur(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(E,A){var T=e[A];return typeof T=="number"?vu(T):T},n=function(E,A,T){var _=A.charCodeAt(0)-32<<4|T.charCodeAt(0)-48;return _==59?E:vu(_)};e["|"]=254;function a(E,A){switch(A.type){case"base64":return o(Sn(E),A);case"binary":return o(E,A);case"buffer":return o(yt&&Buffer.isBuffer(E)?E.toString("binary"):Ja(E),A);case"array":return o(gs(E),A)}throw new Error("Unrecognized type "+A.type)}function o(E,A){var T=E.split(/[\n\r]+/),_=-1,C=-1,S=0,k=0,N=[],F=[],W=null,B={},R=[],z=[],U=[],fe=0,M;for(+A.codepage>=0&&Zn(+A.codepage);S!==T.length;++S){fe=0;var V=T[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ne=V.replace(/;;/g,"\0").split(";").map(function(se){return se.replace(/\u0000/g,";")}),me=ne[0],J;if(V.length>0)switch(me){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&F.push(V.slice(3).replace(/;;/g,";"));break;case"C":var Ce=!1,Ae=!1,at=!1,he=!1,Ve=-1,Xe=-1;for(k=1;k<ne.length;++k)switch(ne[k].charAt(0)){case"A":break;case"X":C=parseInt(ne[k].slice(1))-1,Ae=!0;break;case"Y":for(_=parseInt(ne[k].slice(1))-1,Ae||(C=0),M=N.length;M<=_;++M)N[M]=[];break;case"K":J=ne[k].slice(1),J.charAt(0)==='"'?J=J.slice(1,J.length-1):J==="TRUE"?J=!0:J==="FALSE"?J=!1:isNaN(Kn(J))?isNaN(Js(J).getDate())||(J=Zt(J)):(J=Kn(J),W!==null&&si(W)&&(J=vc(J))),Ce=!0;break;case"E":he=!0;var Q=$s(ne[k].slice(1),{r:_,c:C});N[_][C]=[N[_][C],Q];break;case"S":at=!0,N[_][C]=[N[_][C],"S5S"];break;case"G":break;case"R":Ve=parseInt(ne[k].slice(1))-1;break;case"C":Xe=parseInt(ne[k].slice(1))-1;break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+V)}if(Ce&&(N[_][C]&&N[_][C].length==2?N[_][C][0]=J:N[_][C]=J,W=null),at){if(he)throw new Error("SYLK shared formula cannot have own formula");var oe=Ve>-1&&N[Ve][Xe];if(!oe||!oe[1])throw new Error("SYLK shared formula cannot find base");N[_][C][1]=_1(oe[1],{r:_-Ve,c:C-Xe})}break;case"F":var te=0;for(k=1;k<ne.length;++k)switch(ne[k].charAt(0)){case"X":C=parseInt(ne[k].slice(1))-1,++te;break;case"Y":for(_=parseInt(ne[k].slice(1))-1,M=N.length;M<=_;++M)N[M]=[];break;case"M":fe=parseInt(ne[k].slice(1))/20;break;case"F":break;case"G":break;case"P":W=F[parseInt(ne[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=ne[k].slice(1).split(" "),M=parseInt(U[0],10);M<=parseInt(U[1],10);++M)fe=parseInt(U[2],10),z[M-1]=fe===0?{hidden:!0}:{wch:fe},Ya(z[M-1]);break;case"C":C=parseInt(ne[k].slice(1))-1,z[C]||(z[C]={});break;case"R":_=parseInt(ne[k].slice(1))-1,R[_]||(R[_]={}),fe>0?(R[_].hpt=fe,R[_].hpx=ti(fe)):fe===0&&(R[_].hidden=!0);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+V)}te<1&&(W=null);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+V)}}return R.length>0&&(B["!rows"]=R),z.length>0&&(B["!cols"]=z),A&&A.sheetRows&&(N=N.slice(0,A.sheetRows)),[N,B]}function l(E,A){var T=a(E,A),_=T[0],C=T[1],S=oi(_,A);return ur(C).forEach(function(k){S[k]=C[k]}),S}function h(E,A){return es(l(E,A),A)}function g(E,A,T,_){var C="C;Y"+(T+1)+";X"+(_+1)+";K";switch(E.t){case"n":C+=E.v||0,E.f&&!E.F&&(C+=";E"+_0(E.f,{r:T,c:_}));break;case"b":C+=E.v?"TRUE":"FALSE";break;case"e":C+=E.w||E.v;break;case"d":C+='"'+(E.w||E.v)+'"';break;case"s":C+='"'+E.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function m(E,A){A.forEach(function(T,_){var C="F;W"+(_+1)+" "+(_+1)+" ";T.hidden?C+="0":(typeof T.width=="number"&&!T.wpx&&(T.wpx=Yi(T.width)),typeof T.wpx=="number"&&!T.wch&&(T.wch=Zi(T.wpx)),typeof T.wch=="number"&&(C+=Math.round(T.wch))),C.charAt(C.length-1)!=" "&&E.push(C)})}function p(E,A){A.forEach(function(T,_){var C="F;";T.hidden?C+="M0;":T.hpt?C+="M"+20*T.hpt+";":T.hpx&&(C+="M"+20*$i(T.hpx)+";"),C.length>2&&E.push(C+"R"+(_+1))})}function w(E,A){var T=["ID;PWXL;N;E"],_=[],C=It(E["!ref"]),S,k=Array.isArray(E),N=`\r
`;T.push("P;PGeneral"),T.push("F;P0;DG0G8;M255"),E["!cols"]&&m(T,E["!cols"]),E["!rows"]&&p(T,E["!rows"]),T.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var F=C.s.r;F<=C.e.r;++F)for(var W=C.s.c;W<=C.e.c;++W){var B=tt({r:F,c:W});S=k?(E[F]||[])[W]:E[B],!(!S||S.v==null&&(!S.f||S.F))&&_.push(g(S,E,F,W))}return T.join(N)+N+_.join(N)+N+"E"+N}return{to_workbook:h,to_sheet:l,from_sheet:w}}(),a1=function(){function e(o,l){switch(l.type){case"base64":return t(Sn(o),l);case"binary":return t(o,l);case"buffer":return t(yt&&Buffer.isBuffer(o)?o.toString("binary"):Ja(o),l);case"array":return t(gs(o),l)}throw new Error("Unrecognized type "+l.type)}function t(o,l){for(var h=o.split(`
`),g=-1,m=-1,p=0,w=[];p!==h.length;++p){if(h[p].trim()==="BOT"){w[++g]=[],m=0;continue}if(!(g<0)){var E=h[p].trim().split(","),A=E[0],T=E[1];++p;for(var _=h[p]||"";(_.match(/["]/g)||[]).length&1&&p<h.length-1;)_+=`
`+h[++p];switch(_=_.trim(),+A){case-1:if(_==="BOT"){w[++g]=[],m=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?w[g][m]=!0:_==="FALSE"?w[g][m]=!1:isNaN(Kn(T))?isNaN(Js(T).getDate())?w[g][m]=T:w[g][m]=Zt(T):w[g][m]=Kn(T),++m;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),w[g][m++]=_!==""?_:null;break}if(_==="EOD")break}}return l&&l.sheetRows&&(w=w.slice(0,l.sheetRows)),w}function r(o,l){return oi(e(o,l),l)}function n(o,l){return es(r(o,l),l)}var a=function(){var o=function(g,m,p,w,E){g.push(m),g.push(p+","+w),g.push('"'+E.replace(/"/g,'""')+'"')},l=function(g,m,p,w){g.push(m+","+p),g.push(m==1?'"'+w.replace(/"/g,'""')+'"':w)};return function(g){var m=[],p=It(g["!ref"]),w,E=Array.isArray(g);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,p.e.r-p.s.r+1,""),o(m,"TUPLES",0,p.e.c-p.s.c+1,""),o(m,"DATA",0,0,"");for(var A=p.s.r;A<=p.e.r;++A){l(m,-1,0,"BOT");for(var T=p.s.c;T<=p.e.c;++T){var _=tt({r:A,c:T});if(w=E?(g[A]||[])[T]:g[_],!w){l(m,1,0,"");continue}switch(w.t){case"n":var C=w.w;!C&&w.v!=null&&(C=w.v),C==null?w.f&&!w.F?l(m,1,0,"="+w.f):l(m,1,0,""):l(m,0,C,"V");break;case"b":l(m,0,w.v?1:0,w.v?"TRUE":"FALSE");break;case"s":l(m,1,0,isNaN(w.v)?w.v:'="'+w.v+'"');break;case"d":w.w||(w.w=Un(w.z||Je[14],Tr(Zt(w.v)))),l(m,0,w.w,"V");break;default:l(m,1,0,"")}}}l(m,-1,0,"EOD");var S=`\r
`,k=m.join(S);return k}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),s1=function(){function e(w){return w.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(w){return w.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(w,E){for(var A=w.split(`
`),T=-1,_=-1,C=0,S=[];C!==A.length;++C){var k=A[C].trim().split(":");if(k[0]==="cell"){var N=rr(k[1]);if(S.length<=N.r)for(T=S.length;T<=N.r;++T)S[T]||(S[T]=[]);switch(T=N.r,_=N.c,k[2]){case"t":S[T][_]=e(k[3]);break;case"v":S[T][_]=+k[3];break;case"vtf":var F=k[k.length-1];case"vtc":switch(k[3]){case"nl":S[T][_]=!!+k[4];break;default:S[T][_]=+k[4];break}k[2]=="vtf"&&(S[T][_]=[S[T][_],F])}}}return E&&E.sheetRows&&(S=S.slice(0,E.sheetRows)),S}function n(w,E){return oi(r(w,E),E)}function a(w,E){return es(n(w,E),E)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),g="--SocialCalcSpreadsheetControlSave--";function m(w){if(!w||!w["!ref"])return"";for(var E=[],A=[],T,_="",C=dn(w["!ref"]),S=Array.isArray(w),k=C.s.r;k<=C.e.r;++k)for(var N=C.s.c;N<=C.e.c;++N)if(_=tt({r:k,c:N}),T=S?(w[k]||[])[N]:w[_],!(!T||T.v==null||T.t==="z")){switch(A=["cell",_,"t"],T.t){case"s":case"str":A.push(t(T.v));break;case"n":T.f?(A[2]="vtf",A[3]="n",A[4]=T.v,A[5]=t(T.f)):(A[2]="v",A[3]=T.v);break;case"b":A[2]="vt"+(T.f?"f":"c"),A[3]="nl",A[4]=T.v?"1":"0",A[5]=t(T.f||(T.v?"TRUE":"FALSE"));break;case"d":var F=Tr(Zt(T.v));A[2]="vtc",A[3]="nd",A[4]=""+F,A[5]=T.w||Un(T.z||Je[14],F);break;case"e":continue}E.push(A.join(":"))}return E.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),E.push("valueformat:1:text-wiki"),E.join(`
`)}function p(w){return[o,l,h,l,m(w),g].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}}(),ei=function(){function e(p,w,E,A,T){T.raw?w[E][A]=p:p===""||(p==="TRUE"?w[E][A]=!0:p==="FALSE"?w[E][A]=!1:isNaN(Kn(p))?isNaN(Js(p).getDate())?w[E][A]=p:w[E][A]=Zt(p):w[E][A]=Kn(p))}function t(p,w){var E=w||{},A=[];if(!p||p.length===0)return A;for(var T=p.split(/[\r\n]/),_=T.length-1;_>=0&&T[_].length===0;)--_;for(var C=10,S=0,k=0;k<=_;++k)S=T[k].indexOf(" "),S==-1?S=T[k].length:S++,C=Math.max(C,S);for(k=0;k<=_;++k){A[k]=[];var N=0;for(e(T[k].slice(0,C).trim(),A,k,N,E),N=1;N<=(T[k].length-C)/10+1;++N)e(T[k].slice(C+(N-1)*10,C+N*10).trim(),A,k,N,E)}return E.sheetRows&&(A=A.slice(0,E.sheetRows)),A}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var w={},E=!1,A=0,T=0;A<p.length;++A)(T=p.charCodeAt(A))==34?E=!E:!E&&T in r&&(w[T]=(w[T]||0)+1);T=[];for(A in w)Object.prototype.hasOwnProperty.call(w,A)&&T.push([w[A],A]);if(!T.length){w=n;for(A in w)Object.prototype.hasOwnProperty.call(w,A)&&T.push([w[A],A])}return T.sort(function(_,C){return _[0]-C[0]||n[_[1]]-n[C[1]]}),r[T.pop()[1]]||44}function o(p,w){var E=w||{},A="",T=E.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(A=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(A=p.charAt(4),p=p.slice(6)):A=a(p.slice(0,1024)):E&&E.FS?A=E.FS:A=a(p.slice(0,1024));var C=0,S=0,k=0,N=0,F=0,W=A.charCodeAt(0),B=!1,R=0,z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var U=E.dateNF!=null?m2(E.dateNF):null;function fe(){var M=p.slice(N,F),V={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)V.t="z";else if(E.raw)V.t="s",V.v=M;else if(M.trim().length===0)V.t="s",V.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(V.t="s",V.v=M.slice(2,-1).replace(/""/g,'"')):V3(M)?(V.t="n",V.f=M.slice(1)):(V.t="s",V.v=M);else if(M=="TRUE")V.t="b",V.v=!0;else if(M=="FALSE")V.t="b",V.v=!1;else if(!isNaN(k=Kn(M)))V.t="n",E.cellText!==!1&&(V.w=M),V.v=k;else if(!isNaN(Js(M).getDate())||U&&M.match(U)){V.z=E.dateNF||Je[14];var ne=0;U&&M.match(U)&&(M=g2(M,E.dateNF,M.match(U)||[]),ne=1),E.cellDates?(V.t="d",V.v=Zt(M,ne)):(V.t="n",V.v=Tr(Zt(M,ne))),E.cellText!==!1&&(V.w=Un(V.z,V.v instanceof Date?Tr(V.v):V.v)),E.cellNF||delete V.z}else V.t="s",V.v=M;if(V.t=="z"||(E.dense?(T[C]||(T[C]=[]),T[C][S]=V):T[tt({c:S,r:C})]=V),N=F+1,z=p.charCodeAt(N),_.e.c<S&&(_.e.c=S),_.e.r<C&&(_.e.r=C),R==W)++S;else if(S=0,++C,E.sheetRows&&E.sheetRows<=C)return!0}e:for(;F<p.length;++F)switch(R=p.charCodeAt(F)){case 34:z===34&&(B=!B);break;case W:case 10:case 13:if(!B&&fe())break e;break}return F-N>0&&fe(),T["!ref"]=ut(_),T}function l(p,w){return!(w&&w.PRN)||w.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,w):oi(t(p,w),w)}function h(p,w){var E="",A=w.type=="string"?[0,0,0,0]:I0(p,w);switch(w.type){case"base64":E=Sn(p);break;case"binary":E=p;break;case"buffer":w.codepage==65001?E=p.toString("utf8"):w.codepage&&typeof Bi<"u"||(E=yt&&Buffer.isBuffer(p)?p.toString("binary"):Ja(p));break;case"array":E=gs(p);break;case"string":E=p;break;default:throw new Error("Unrecognized type "+w.type)}return A[0]==239&&A[1]==187&&A[2]==191?E=jt(E.slice(3)):w.type!="string"&&w.type!="buffer"&&w.codepage==65001?E=jt(E):w.type=="binary"&&typeof Bi<"u",E.slice(0,19)=="socialcalc:version:"?s1.to_sheet(w.type=="string"?E:jt(E),w):l(E,w)}function g(p,w){return es(h(p,w),w)}function m(p){for(var w=[],E=It(p["!ref"]),A,T=Array.isArray(p),_=E.s.r;_<=E.e.r;++_){for(var C=[],S=E.s.c;S<=E.e.c;++S){var k=tt({r:_,c:S});if(A=T?(p[_]||[])[S]:p[k],!A||A.v==null){C.push("          ");continue}for(var N=(A.w||(ba(A),A.w)||"").slice(0,10);N.length<10;)N+=" ";C.push(N+(S===0?" ":""))}w.push(C.join(""))}return w.join(`
`)}return{to_workbook:g,to_sheet:h,from_sheet:m}}();function ky(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=n1.to_workbook(e,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return ei.to_workbook(e,t)}}var ds=function(){function e(Q,oe,te){if(Q){Ur(Q,Q.l||0);for(var se=te.Enum||Ve;Q.l<Q.length;){var ce=Q.read_shift(2),ie=se[ce]||se[65535],ye=Q.read_shift(2),Se=Q.l+ye,Ne=ie.f&&ie.f(Q,ye,te);if(Q.l=Se,oe(Ne,ie,ce))return}}}function t(Q,oe){switch(oe.type){case"base64":return r(En(Sn(Q)),oe);case"binary":return r(En(Q),oe);case"buffer":case"array":return r(Q,oe)}throw"Unsupported type "+oe.type}function r(Q,oe){if(!Q)return Q;var te=oe||{},se=te.dense?[]:{},ce="Sheet1",ie="",ye=0,Se={},Ne=[],Ye=[],ee={s:{r:0,c:0},e:{r:0,c:0}},Ge=te.sheetRows||0;if(Q[2]==0&&(Q[3]==8||Q[3]==9)&&Q.length>=16&&Q[14]==5&&Q[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Q[2]==2)te.Enum=Ve,e(Q,function(Oe,rt,it){switch(it){case 0:te.vers=Oe,Oe>=4096&&(te.qpro=!0);break;case 6:ee=Oe;break;case 204:Oe&&(ie=Oe);break;case 222:ie=Oe;break;case 15:case 51:te.qpro||(Oe[1].v=Oe[1].v.slice(1));case 13:case 14:case 16:it==14&&(Oe[2]&112)==112&&(Oe[2]&15)>1&&(Oe[2]&15)<15&&(Oe[1].z=te.dateNF||Je[14],te.cellDates&&(Oe[1].t="d",Oe[1].v=vc(Oe[1].v))),te.qpro&&Oe[3]>ye&&(se["!ref"]=ut(ee),Se[ce]=se,Ne.push(ce),se=te.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ye=Oe[3],ce=ie||"Sheet"+(ye+1),ie="");var Jr=te.dense?(se[Oe[0].r]||[])[Oe[0].c]:se[tt(Oe[0])];if(Jr){Jr.t=Oe[1].t,Jr.v=Oe[1].v,Oe[1].z!=null&&(Jr.z=Oe[1].z),Oe[1].f!=null&&(Jr.f=Oe[1].f);break}te.dense?(se[Oe[0].r]||(se[Oe[0].r]=[]),se[Oe[0].r][Oe[0].c]=Oe[1]):se[tt(Oe[0])]=Oe[1];break}},te);else if(Q[2]==26||Q[2]==14)te.Enum=Xe,Q[2]==14&&(te.qpro=!0,Q.l=0),e(Q,function(Oe,rt,it){switch(it){case 204:ce=Oe;break;case 22:Oe[1].v=Oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Oe[3]>ye&&(se["!ref"]=ut(ee),Se[ce]=se,Ne.push(ce),se=te.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ye=Oe[3],ce="Sheet"+(ye+1)),Ge>0&&Oe[0].r>=Ge)break;te.dense?(se[Oe[0].r]||(se[Oe[0].r]=[]),se[Oe[0].r][Oe[0].c]=Oe[1]):se[tt(Oe[0])]=Oe[1],ee.e.c<Oe[0].c&&(ee.e.c=Oe[0].c),ee.e.r<Oe[0].r&&(ee.e.r=Oe[0].r);break;case 27:Oe[14e3]&&(Ye[Oe[14e3][0]]=Oe[14e3][1]);break;case 1537:Ye[Oe[0]]=Oe[1],Oe[0]==ye&&(ce=Oe[1]);break}},te);else throw new Error("Unrecognized LOTUS BOF "+Q[2]);if(se["!ref"]=ut(ee),Se[ie||ce]=se,Ne.push(ie||ce),!Ye.length)return{SheetNames:Ne,Sheets:Se};for(var ft={},_t=[],ot=0;ot<Ye.length;++ot)Se[Ne[ot]]?(_t.push(Ye[ot]||Ne[ot]),ft[Ye[ot]]=Se[Ye[ot]]||Se[Ne[ot]]):(_t.push(Ye[ot]),ft[Ye[ot]]={"!ref":"A1"});return{SheetNames:_t,Sheets:ft}}function n(Q,oe){var te=oe||{};if(+te.codepage>=0&&Zn(+te.codepage),te.type=="string")throw new Error("Cannot write WK1 to JS string");var se=fn(),ce=It(Q["!ref"]),ie=Array.isArray(Q),ye=[];Ue(se,0,o(1030)),Ue(se,6,g(ce));for(var Se=Math.min(ce.e.r,8191),Ne=ce.s.r;Ne<=Se;++Ne)for(var Ye=gr(Ne),ee=ce.s.c;ee<=ce.e.c;++ee){Ne===ce.s.r&&(ye[ee]=tr(ee));var Ge=ye[ee]+Ye,ft=ie?(Q[Ne]||[])[ee]:Q[Ge];if(!(!ft||ft.t=="z"))if(ft.t=="n")(ft.v|0)==ft.v&&ft.v>=-32768&&ft.v<=32767?Ue(se,13,A(Ne,ee,ft.v)):Ue(se,14,_(Ne,ee,ft.v));else{var _t=ba(ft);Ue(se,15,w(Ne,ee,_t.slice(0,239)))}}return Ue(se,1),se.end()}function a(Q,oe){var te=oe||{};if(+te.codepage>=0&&Zn(+te.codepage),te.type=="string")throw new Error("Cannot write WK3 to JS string");var se=fn();Ue(se,0,l(Q));for(var ce=0,ie=0;ce<Q.SheetNames.length;++ce)(Q.Sheets[Q.SheetNames[ce]]||{})["!ref"]&&Ue(se,27,he(Q.SheetNames[ce],ie++));var ye=0;for(ce=0;ce<Q.SheetNames.length;++ce){var Se=Q.Sheets[Q.SheetNames[ce]];if(!(!Se||!Se["!ref"])){for(var Ne=It(Se["!ref"]),Ye=Array.isArray(Se),ee=[],Ge=Math.min(Ne.e.r,8191),ft=Ne.s.r;ft<=Ge;++ft)for(var _t=gr(ft),ot=Ne.s.c;ot<=Ne.e.c;++ot){ft===Ne.s.r&&(ee[ot]=tr(ot));var Oe=ee[ot]+_t,rt=Ye?(Se[ft]||[])[ot]:Se[Oe];if(!(!rt||rt.t=="z"))if(rt.t=="n")Ue(se,23,fe(ft,ot,ye,rt.v));else{var it=ba(rt);Ue(se,22,R(ft,ot,ye,it.slice(0,239)))}}++ye}}return Ue(se,1),se.end()}function o(Q){var oe=be(2);return oe.write_shift(2,Q),oe}function l(Q){var oe=be(26);oe.write_shift(2,4096),oe.write_shift(2,4),oe.write_shift(4,0);for(var te=0,se=0,ce=0,ie=0;ie<Q.SheetNames.length;++ie){var ye=Q.SheetNames[ie],Se=Q.Sheets[ye];if(!(!Se||!Se["!ref"])){++ce;var Ne=dn(Se["!ref"]);te<Ne.e.r&&(te=Ne.e.r),se<Ne.e.c&&(se=Ne.e.c)}}return te>8191&&(te=8191),oe.write_shift(2,te),oe.write_shift(1,ce),oe.write_shift(1,se),oe.write_shift(2,0),oe.write_shift(2,0),oe.write_shift(1,1),oe.write_shift(1,2),oe.write_shift(4,0),oe.write_shift(4,0),oe}function h(Q,oe,te){var se={s:{c:0,r:0},e:{c:0,r:0}};return oe==8&&te.qpro?(se.s.c=Q.read_shift(1),Q.l++,se.s.r=Q.read_shift(2),se.e.c=Q.read_shift(1),Q.l++,se.e.r=Q.read_shift(2),se):(se.s.c=Q.read_shift(2),se.s.r=Q.read_shift(2),oe==12&&te.qpro&&(Q.l+=2),se.e.c=Q.read_shift(2),se.e.r=Q.read_shift(2),oe==12&&te.qpro&&(Q.l+=2),se.s.c==65535&&(se.s.c=se.e.c=se.s.r=se.e.r=0),se)}function g(Q){var oe=be(8);return oe.write_shift(2,Q.s.c),oe.write_shift(2,Q.s.r),oe.write_shift(2,Q.e.c),oe.write_shift(2,Q.e.r),oe}function m(Q,oe,te){var se=[{c:0,r:0},{t:"n",v:0},0,0];return te.qpro&&te.vers!=20768?(se[0].c=Q.read_shift(1),se[3]=Q.read_shift(1),se[0].r=Q.read_shift(2),Q.l+=2):(se[2]=Q.read_shift(1),se[0].c=Q.read_shift(2),se[0].r=Q.read_shift(2)),se}function p(Q,oe,te){var se=Q.l+oe,ce=m(Q,oe,te);if(ce[1].t="s",te.vers==20768){Q.l++;var ie=Q.read_shift(1);return ce[1].v=Q.read_shift(ie,"utf8"),ce}return te.qpro&&Q.l++,ce[1].v=Q.read_shift(se-Q.l,"cstr"),ce}function w(Q,oe,te){var se=be(7+te.length);se.write_shift(1,255),se.write_shift(2,oe),se.write_shift(2,Q),se.write_shift(1,39);for(var ce=0;ce<se.length;++ce){var ie=te.charCodeAt(ce);se.write_shift(1,ie>=128?95:ie)}return se.write_shift(1,0),se}function E(Q,oe,te){var se=m(Q,oe,te);return se[1].v=Q.read_shift(2,"i"),se}function A(Q,oe,te){var se=be(7);return se.write_shift(1,255),se.write_shift(2,oe),se.write_shift(2,Q),se.write_shift(2,te,"i"),se}function T(Q,oe,te){var se=m(Q,oe,te);return se[1].v=Q.read_shift(8,"f"),se}function _(Q,oe,te){var se=be(13);return se.write_shift(1,255),se.write_shift(2,oe),se.write_shift(2,Q),se.write_shift(8,te,"f"),se}function C(Q,oe,te){var se=Q.l+oe,ce=m(Q,oe,te);if(ce[1].v=Q.read_shift(8,"f"),te.qpro)Q.l=se;else{var ie=Q.read_shift(2);F(Q.slice(Q.l,Q.l+ie),ce),Q.l+=ie}return ce}function S(Q,oe,te){var se=oe&32768;return oe&=-32769,oe=(se?Q:0)+(oe>=8192?oe-16384:oe),(se?"":"$")+(te?tr(oe):gr(oe))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(Q,oe){Ur(Q,0);for(var te=[],se=0,ce="",ie="",ye="",Se="";Q.l<Q.length;){var Ne=Q[Q.l++];switch(Ne){case 0:te.push(Q.read_shift(8,"f"));break;case 1:ie=S(oe[0].c,Q.read_shift(2),!0),ce=S(oe[0].r,Q.read_shift(2),!1),te.push(ie+ce);break;case 2:{var Ye=S(oe[0].c,Q.read_shift(2),!0),ee=S(oe[0].r,Q.read_shift(2),!1);ie=S(oe[0].c,Q.read_shift(2),!0),ce=S(oe[0].r,Q.read_shift(2),!1),te.push(Ye+ee+":"+ie+ce)}break;case 3:if(Q.l<Q.length){console.error("WK1 premature formula end");return}break;case 4:te.push("("+te.pop()+")");break;case 5:te.push(Q.read_shift(2));break;case 6:{for(var Ge="";Ne=Q[Q.l++];)Ge+=String.fromCharCode(Ne);te.push('"'+Ge.replace(/"/g,'""')+'"')}break;case 8:te.push("-"+te.pop());break;case 23:te.push("+"+te.pop());break;case 22:te.push("NOT("+te.pop()+")");break;case 20:case 21:Se=te.pop(),ye=te.pop(),te.push(["AND","OR"][Ne-20]+"("+ye+","+Se+")");break;default:if(Ne<32&&N[Ne])Se=te.pop(),ye=te.pop(),te.push(ye+N[Ne]+Se);else if(k[Ne]){if(se=k[Ne][1],se==69&&(se=Q[Q.l++]),se>te.length){console.error("WK1 bad formula parse 0x"+Ne.toString(16)+":|"+te.join("|")+"|");return}var ft=te.slice(-se);te.length-=se,te.push(k[Ne][0]+"("+ft.join(",")+")")}else return Ne<=7?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=24?console.error("WK1 unsupported op "+Ne.toString(16)):Ne<=30?console.error("WK1 invalid opcode "+Ne.toString(16)):Ne<=115?console.error("WK1 unsupported function opcode "+Ne.toString(16)):console.error("WK1 unrecognized opcode "+Ne.toString(16))}}te.length==1?oe[1].f=""+te[0]:console.error("WK1 bad formula parse |"+te.join("|")+"|")}function W(Q){var oe=[{c:0,r:0},{t:"n",v:0},0];return oe[0].r=Q.read_shift(2),oe[3]=Q[Q.l++],oe[0].c=Q[Q.l++],oe}function B(Q,oe){var te=W(Q);return te[1].t="s",te[1].v=Q.read_shift(oe-4,"cstr"),te}function R(Q,oe,te,se){var ce=be(6+se.length);ce.write_shift(2,Q),ce.write_shift(1,te),ce.write_shift(1,oe),ce.write_shift(1,39);for(var ie=0;ie<se.length;++ie){var ye=se.charCodeAt(ie);ce.write_shift(1,ye>=128?95:ye)}return ce.write_shift(1,0),ce}function z(Q,oe){var te=W(Q);te[1].v=Q.read_shift(2);var se=te[1].v>>1;if(te[1].v&1)switch(se&7){case 0:se=(se>>3)*5e3;break;case 1:se=(se>>3)*500;break;case 2:se=(se>>3)/20;break;case 3:se=(se>>3)/200;break;case 4:se=(se>>3)/2e3;break;case 5:se=(se>>3)/2e4;break;case 6:se=(se>>3)/16;break;case 7:se=(se>>3)/64;break}return te[1].v=se,te}function U(Q,oe){var te=W(Q),se=Q.read_shift(4),ce=Q.read_shift(4),ie=Q.read_shift(2);if(ie==65535)return se===0&&ce===3221225472?(te[1].t="e",te[1].v=15):se===0&&ce===3489660928?(te[1].t="e",te[1].v=42):te[1].v=0,te;var ye=ie&32768;return ie=(ie&32767)-16446,te[1].v=(1-ye*2)*(ce*Math.pow(2,ie+32)+se*Math.pow(2,ie)),te}function fe(Q,oe,te,se){var ce=be(14);if(ce.write_shift(2,Q),ce.write_shift(1,te),ce.write_shift(1,oe),se==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var ie=0,ye=0,Se=0,Ne=0;return se<0&&(ie=1,se=-se),ye=Math.log2(se)|0,se/=Math.pow(2,ye-31),Ne=se>>>0,Ne&2147483648||(se/=2,++ye,Ne=se>>>0),se-=Ne,Ne|=2147483648,Ne>>>=0,se*=Math.pow(2,32),Se=se>>>0,ce.write_shift(4,Se),ce.write_shift(4,Ne),ye+=16383+(ie?32768:0),ce.write_shift(2,ye),ce}function M(Q,oe){var te=U(Q);return Q.l+=oe-14,te}function V(Q,oe){var te=W(Q),se=Q.read_shift(4);return te[1].v=se>>6,te}function ne(Q,oe){var te=W(Q),se=Q.read_shift(8,"f");return te[1].v=se,te}function me(Q,oe){var te=ne(Q);return Q.l+=oe-10,te}function J(Q,oe){return Q[Q.l+oe-1]==0?Q.read_shift(oe,"cstr"):""}function Ce(Q,oe){var te=Q[Q.l++];te>oe-1&&(te=oe-1);for(var se="";se.length<te;)se+=String.fromCharCode(Q[Q.l++]);return se}function Ae(Q,oe,te){if(!(!te.qpro||oe<21)){var se=Q.read_shift(1);Q.l+=17,Q.l+=1,Q.l+=2;var ce=Q.read_shift(oe-21,"cstr");return[se,ce]}}function at(Q,oe){for(var te={},se=Q.l+oe;Q.l<se;){var ce=Q.read_shift(2);if(ce==14e3){for(te[ce]=[0,""],te[ce][0]=Q.read_shift(2);Q[Q.l];)te[ce][1]+=String.fromCharCode(Q[Q.l]),Q.l++;Q.l++}}return te}function he(Q,oe){var te=be(5+Q.length);te.write_shift(2,14e3),te.write_shift(2,oe);for(var se=0;se<Q.length;++se){var ce=Q.charCodeAt(se);te[te.l++]=ce>127?95:ce}return te[te.l++]=0,te}var Ve={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:E},14:{n:"NUMBER",f:T},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:J},222:{n:"SHEETNAMELP",f:Ce},65535:{n:""}},Xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:at},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:me},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:J},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function Fy(e){var t={},r=e.match(Qr),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=nt(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;t.cp=Xl[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return t}var Dy=function(){var e=Hi("t"),t=Hi("rPr");function r(o){var l=o.match(e);if(!l)return{t:"s",v:""};var h={t:"s",v:Nt(l[1])},g=o.match(t);return g&&(h.s=Fy(g[1])),h}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(h){return h.v})}}(),Oy=function(){var t=/(\r\n|\n)/g;function r(a,o,l){var h=[];a.u&&h.push("text-decoration: underline;"),a.uval&&h.push("text-underline-style:"+a.uval+";"),a.sz&&h.push("font-size:"+a.sz+"pt;"),a.outline&&h.push("text-effect: outline;"),a.shadow&&h.push("text-shadow: auto;"),o.push('<span style="'+h.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var g=a.valign||"";return g=="superscript"||g=="super"?g="sup":g=="subscript"&&(g="sub"),g!=""&&(o.push("<"+g+">"),l.push("</"+g+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(t,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),Ry=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,My=/<(?:\w+:)?r>/,Ly=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function g0(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(jt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=jt(e),r&&(n.h=r0(n.t))):e.match(My)&&(n.r=jt(e),n.t=Nt(jt((e.replace(Ly,"").match(Ry)||[]).join("").replace(Qr,""))),r&&(n.h=Oy(Dy(n.r)))),n):{t:""}}var jy=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Py=/<(?:\w+:)?(?:si|sstItem)>/g,By=/<\/(?:\w+:)?(?:si|sstItem)>/;function Uy(e,t){var r=[],n="";if(!e)return r;var a=e.match(jy);if(a){n=a[2].replace(Py,"").split(By);for(var o=0;o!=n.length;++o){var l=g0(n[o].trim(),t);l!=null&&(r[r.length]=l)}a=nt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var zy=/^\s|\s$|[\t\n\r]/;function i1(e,t){if(!t.bookSST)return"";var r=[pr];r[r.length]=Be("sst",null,{xmlns:Es[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(zy)&&(o+=' xml:space="preserve"'),o+=">"+Mt(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Hy(e){return[e.read_shift(4),e.read_shift(4)]}function Wy(e,t){var r=[],n=!1;return Ca(e,function(o,l,h){switch(h){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}),r}function Vy(e,t){return t||(t=be(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Gy=tv;function Xy(e){var t=fn();Ie(t,159,Vy(e));for(var r=0;r<e.length;++r)Ie(t,19,Gy(e[r]));return Ie(t,160),t.end()}function o1(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ya(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Yy(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ya(e,4),t.U=ya(e,4),t.W=ya(e,4),t}function Zy(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),o=[];a-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $y(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Zy(e));return t}function qy(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Ky(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ya(e,4),t.U=ya(e,4),t.W=ya(e,4),t}function Qy(e){var t=Ky(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function c1(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function l1(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Jy(e){var t=ya(e);switch(t.Minor){case 2:return[t.Minor,e_(e)];case 3:return[t.Minor,t_()];case 4:return[t.Minor,r_(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function e_(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=c1(e,r),a=l1(e,e.length-e.l);return{t:"Std",h:n,v:a}}function t_(){throw new Error("File is password-protected: ECMA-376 Extensible")}function r_(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Qr,function(o){var l=nt(o);switch(fa(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(h){n[h]=l[h]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function n_(e,t){var r={},n=r.EncryptionVersionInfo=ya(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=c1(e,a),t-=a,r.EncryptionVerifier=l1(e,t),r}function a_(e){var t={},r=t.EncryptionVersionInfo=ya(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function p0(e){var t=0,r,n=o1(e),a=n.length+1,o,l,h,g,m;for(r=Xa(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],h=t&16384?1:0,g=t<<1&32767,m=h|g,t=m^l;return t^52811}var u1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,h){return n(l^h)},o=function(l){for(var h=t[l.length-1],g=104,m=l.length-1;m>=0;--m)for(var p=l[m],w=0;w!=7;++w)p&64&&(h^=r[g]),p*=2,--g;return h};return function(l){for(var h=o1(l),g=o(h),m=h.length,p=Xa(16),w=0;w!=16;++w)p[w]=0;var E,A,T;for((m&1)===1&&(E=g>>8,p[m]=a(e[0],E),--m,E=g&255,A=h[h.length-1],p[m]=a(A,E));m>0;)--m,E=g>>8,p[m]=a(h[m],E),--m,E=g&255,p[m]=a(h[m],E);for(m=15,T=15-h.length;T>0;)E=g>>8,p[m]=a(e[T],E),--m,--T,E=g&255,p[m]=a(h[m],E),--m,--T;return p}}(),s_=function(e,t,r,n,a){a||(a=t),n||(n=u1(e));var o,l;for(o=0;o!=t.length;++o)l=t[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},i_=function(e){var t=0,r=u1(e);return function(n){var a=s_("",n,t,r);return t=a[1],a[0]}};function o_(e,t,r,n){var a={key:_r(e),verificationBytes:_r(e)};return r.password&&(a.verifier=p0(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=i_(r.password)),a}function c_(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=a_(e):n.Data=n_(e,t),n}function l_(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?c_(e,t-2,n):o_(e,r.biff>=8?t:t-2,r,n),n}var f1=function(){function e(a,o){switch(o.type){case"base64":return t(Sn(a),o);case"binary":return t(a,o);case"buffer":return t(yt&&Buffer.isBuffer(a)?a.toString("binary"):Ja(a),o);case"array":return t(gs(a),o)}throw new Error("Unrecognized type "+o.type)}function t(a,o){var l=o||{},h=l.dense?[]:{},g=a.match(/\\trowd.*?\\row\b/g);if(!g.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:g.length-1}};return g.forEach(function(p,w){Array.isArray(h)&&(h[w]=[]);for(var E=/\\\w+\b/g,A=0,T,_=-1;T=E.exec(p);){switch(T[0]){case"\\cell":var C=p.slice(A,E.lastIndex-T[0].length);if(C[0]==" "&&(C=C.slice(1)),++_,C.length){var S={v:C,t:"s"};Array.isArray(h)?h[w][_]=S:h[tt({r:w,c:_})]=S}break}A=E.lastIndex}_>m.e.c&&(m.e.c=_)}),h["!ref"]=ut(m),h}function r(a,o){return es(e(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=It(a["!ref"]),h,g=Array.isArray(a),m=l.s.r;m<=l.e.r;++m){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var w=tt({r:m,c:p});h=g?(a[m]||[])[p]:a[w],!(!h||h.v==null&&(!h.f||h.F))&&(o.push(" "+(h.w||(ba(h),h.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function u_(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Xi(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function f_(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),o=Math.min(t,r,n),l=a-o;if(l===0)return[0,0,t];var h=0,g=0,m=a+o;switch(g=l/(m>1?2-m:m),a){case t:h=((r-n)/l+6)%6;break;case r:h=(n-t)/l+2;break;case n:h=(t-r)/l+4;break}return[h/6,g,m/2]}function d_(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],h=6*t,g;if(r!==0)switch(h|0){case 0:case 6:g=a*h,l[0]+=a,l[1]+=g;break;case 1:g=a*(2-h),l[0]+=g,l[1]+=a;break;case 2:g=a*(h-2),l[1]+=a,l[2]+=g;break;case 3:g=a*(4-h),l[1]+=g,l[2]+=a;break;case 4:g=a*(h-4),l[2]+=a,l[0]+=g;break;case 5:g=a*(6-h),l[2]+=g,l[0]+=a;break}for(var m=0;m!=3;++m)l[m]=Math.round(l[m]*255);return l}function Ko(e,t){if(t===0)return e;var r=f_(u_(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Xi(d_(r))}var d1=6,h_=15,x_=1,Zr=d1;function Yi(e){return Math.floor((e+Math.round(128/Zr)/256)*Zr)}function Zi(e){return Math.floor((e-5)/Zr*100+.5)/100}function Qo(e){return Math.round((e*Zr+5)/Zr*256)/256}function Jc(e){return Qo(Zi(Yi(e)))}function v0(e){var t=Math.abs(e-Jc(e)),r=Zr;if(t>.005)for(Zr=x_;Zr<h_;++Zr)Math.abs(e-Jc(e))<=t&&(t=Math.abs(e-Jc(e)),r=Zr);Zr=r}function Ya(e){e.width?(e.wpx=Yi(e.width),e.wch=Zi(e.wpx),e.MDW=Zr):e.wpx?(e.wch=Zi(e.wpx),e.width=Qo(e.wch),e.MDW=Zr):typeof e.wch=="number"&&(e.width=Qo(e.wch),e.wpx=Yi(e.width),e.MDW=Zr),e.customWidth&&delete e.customWidth}var m_=96,h1=m_;function $i(e){return e*96/h1}function ti(e){return e*h1/96}var g_={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function p_(e,t,r,n){t.Borders=[];var a={},o=!1;(e[0].match(Qr)||[]).forEach(function(l){var h=nt(l);switch(fa(h[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},h.diagonalUp&&(a.diagonalUp=Yt(h.diagonalUp)),h.diagonalDown&&(a.diagonalDown=Yt(h.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+h[0]+" in borders")}})}function v_(e,t,r,n){t.Fills=[];var a={},o=!1;(e[0].match(Qr)||[]).forEach(function(l){var h=nt(l);switch(fa(h[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":h.patternType&&(a.patternType=h.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),h.indexed&&(a.bgColor.indexed=parseInt(h.indexed,10)),h.theme&&(a.bgColor.theme=parseInt(h.theme,10)),h.tint&&(a.bgColor.tint=parseFloat(h.tint)),h.rgb&&(a.bgColor.rgb=h.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),h.theme&&(a.fgColor.theme=parseInt(h.theme,10)),h.tint&&(a.fgColor.tint=parseFloat(h.tint)),h.rgb!=null&&(a.fgColor.rgb=h.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+h[0]+" in fills")}})}function w_(e,t,r,n){t.Fonts=[];var a={},o=!1;(e[0].match(Qr)||[]).forEach(function(l){var h=nt(l);switch(fa(h[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":h.val&&(a.name=jt(h.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=h.val?Yt(h.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=h.val?Yt(h.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(h.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=h.val?Yt(h.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=h.val?Yt(h.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=h.val?Yt(h.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=h.val?Yt(h.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=h.val?Yt(h.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":h.val&&(a.sz=+h.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":h.val&&(a.vertAlign=h.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":h.val&&(a.family=parseInt(h.val,10));break;case"<family/>":case"</family>":break;case"<scheme":h.val&&(a.scheme=h.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(h.val=="1")break;h.codepage=Xl[parseInt(h.val,10)];break;case"<color":if(a.color||(a.color={}),h.auto&&(a.color.auto=Yt(h.auto)),h.rgb)a.color.rgb=h.rgb.slice(-6);else if(h.indexed){a.color.index=parseInt(h.indexed,10);var g=us[a.color.index];a.color.index==81&&(g=us[1]),g||(g=us[1]),a.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else h.theme&&(a.color.theme=parseInt(h.theme,10),h.tint&&(a.color.tint=parseFloat(h.tint)),h.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Ko(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+h[0]+" in fonts")}})}function y_(e,t,r){t.NumberFmt=[];for(var n=ur(Je),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Je[n[a]];var o=e[0].match(Qr);if(o)for(a=0;a<o.length;++a){var l=nt(o[a]);switch(fa(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var h=Nt(jt(l.formatCode)),g=parseInt(l.numFmtId,10);if(t.NumberFmt[g]=h,g>0){if(g>392){for(g=392;g>60&&t.NumberFmt[g]!=null;--g);t.NumberFmt[g]=h}wa(h,g)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function __(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Be("numFmt",null,{numFmtId:n,formatCode:Mt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Be("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Io=["numFmtId","fillId","fontId","borderId","xfId"],ko=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function b_(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Qr)||[]).forEach(function(o){var l=nt(o),h=0;switch(fa(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],h=0;h<Io.length;++h)n[Io[h]]&&(n[Io[h]]=parseInt(n[Io[h]],10));for(h=0;h<ko.length;++h)n[ko[h]]&&(n[ko[h]]=Yt(n[ko[h]]));if(t.NumberFmt&&n.numFmtId>392){for(h=392;h>60;--h)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[h]){n.numFmtId=h;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var g={};l.vertical&&(g.vertical=l.vertical),l.horizontal&&(g.horizontal=l.horizontal),l.textRotation!=null&&(g.textRotation=l.textRotation),l.indent&&(g.indent=l.indent),l.wrapText&&(g.wrapText=Yt(l.wrapText)),n.alignment=g;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function E_(e){var t=[];return t[t.length]=Be("cellXfs",null),e.forEach(function(r){t[t.length]=Be("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Be("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var A_=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(h,g,m){var p={};if(!h)return p;h=h.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var w;return(w=h.match(t))&&y_(w,p,m),(w=h.match(a))&&w_(w,p,g,m),(w=h.match(n))&&v_(w,p,g,m),(w=h.match(o))&&p_(w,p,g,m),(w=h.match(r))&&b_(w,p,m),p}}();function x1(e,t){var r=[pr,Be("styleSheet",null,{xmlns:Es[0],"xmlns:vt":Sr.vt})],n;return e.SSF&&(n=__(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=E_(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function C_(e,t){var r=e.read_shift(2),n=qr(e);return[r,n]}function S_(e,t,r){r||(r=be(6+4*t.length)),r.write_shift(2,e),Mr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function T_(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=cv(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=e.read_shift(2);switch(o===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var h=e.read_shift(1);h>0&&(n.family=h);var g=e.read_shift(1);switch(g>0&&(n.charset=g),e.l++,n.color=ov(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=qr(e),n}function N_(e,t){t||(t=be(25+4*32)),t.write_shift(2,e.sz*20),lv(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Zo(e.color,t);var n=0;return n=2,t.write_shift(1,n),Mr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var I_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],el,k_=Kr;function lf(e,t){t||(t=be(4*3+8*7+16*1)),el||(el=gc(I_));var r=el[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Zo({auto:1},t),Zo({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function F_(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function m1(e,t,r){r||(r=be(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function _i(e,t){return t||(t=be(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var D_=Kr;function O_(e,t){return t||(t=be(51)),t.write_shift(1,0),_i(null,t),_i(null,t),_i(null,t),_i(null,t),_i(null,t),t.length>t.l?t.slice(0,t.l):t}function R_(e,t){return t||(t=be(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Yo(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function M_(e,t,r){var n=be(2052);return n.write_shift(4,e),Yo(t,n),Yo(r,n),n.length>n.l?n.slice(0,n.l):n}function L_(e,t,r){var n={};n.NumberFmt=[];for(var a in Je)n.NumberFmt[a]=Je[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return Ca(e,function(g,m,p){switch(p){case 44:n.NumberFmt[g[0]]=g[1],wa(g[1],g[0]);break;case 43:n.Fonts.push(g),g.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(g.color.rgb=Ko(t.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(g);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(m.T>0)o.push(p);else if(m.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function j_(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Ie(e,615,Qn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ie(e,44,S_(a,t[a]))}),Ie(e,616))}}function P_(e){var t=1;Ie(e,611,Qn(t)),Ie(e,43,N_({sz:12,color:{theme:1},name:"Calibri",family:2})),Ie(e,612)}function B_(e){var t=2;Ie(e,603,Qn(t)),Ie(e,45,lf({patternType:"none"})),Ie(e,45,lf({patternType:"gray125"})),Ie(e,604)}function U_(e){var t=1;Ie(e,613,Qn(t)),Ie(e,46,O_()),Ie(e,614)}function z_(e){var t=1;Ie(e,626,Qn(t)),Ie(e,47,m1({numFmtId:0},65535)),Ie(e,627)}function H_(e,t){Ie(e,617,Qn(t.length)),t.forEach(function(r){Ie(e,47,m1(r,0))}),Ie(e,618)}function W_(e){var t=1;Ie(e,619,Qn(t)),Ie(e,48,R_({xfId:0,name:"Normal"})),Ie(e,620)}function V_(e){var t=0;Ie(e,505,Qn(t)),Ie(e,506)}function G_(e){var t=0;Ie(e,508,M_(t,"TableStyleMedium9","PivotStyleMedium4")),Ie(e,509)}function X_(e,t){var r=fn();return Ie(r,278),j_(r,e.SSF),P_(r),B_(r),U_(r),z_(r),H_(r,t.cellXfs),W_(r),V_(r),G_(r),Ie(r,279),r.end()}var Y_=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Z_(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Qr)||[]).forEach(function(a){var o=nt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(t.themeElements.clrScheme[Y_.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function $_(){}function q_(){}var K_=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Q_=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,J_=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function e3(e,t,r){t.themeElements={};var n;[["clrScheme",K_,Z_],["fontScheme",Q_,$_],["fmtScheme",J_,q_]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var t3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function g1(e,t){(!e||e.length===0)&&(e=w0());var r,n={};if(!(r=e.match(t3)))throw new Error("themeElements not found in theme");return e3(r[0],n,t),n.raw=e,n}function w0(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[pr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function r3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var o=e.slice(e.l);e.l=n;var l;try{l=ch(o,{type:"array"})}catch{return}var h=An(l,"theme/theme/theme1.xml",!0);if(h)return g1(h,r)}}function n3(e){return e.read_shift(4)}function a3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=s3(e,4);break;case 2:t.xclrValue=$h(e);break;case 3:t.xclrValue=n3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function s3(e,t){return Kr(e,t)}function i3(e,t){return Kr(e,t)}function o3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=a3(e);break;case 6:n[1]=i3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function c3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),o=[];a-- >0;)o.push(o3(e,r-e.l));return{ixfe:n,ext:o}}function l3(e,t){t.forEach(function(r){switch(r[0]){}})}function u3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:qr(e)}}function f3(e){var t=be(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Mr(e.name,t),t.slice(0,t.l)}function d3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function h3(e){var t=be(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function x3(e,t){var r=be(8+2*t.length);return r.write_shift(4,e),Mr(t,r),r.slice(0,r.l)}function m3(e){return e.l+=4,e.read_shift(4)!=0}function g3(e,t){var r=be(8);return r.write_shift(4,e),r.write_shift(4,1),r}function p3(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,h=2;return Ca(e,function(g,m,p){switch(p){case 335:n.Types.push({name:g.name});break;case 51:g.forEach(function(w){h==1?n.Cell.push({type:n.Types[w[0]-1].name,index:w[1]}):h==0&&n.Value.push({type:n.Types[w[0]-1].name,index:w[1]})});break;case 337:h=g?1:0;break;case 338:h=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!m.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function v3(){var e=fn();return Ie(e,332),Ie(e,334,Qn(1)),Ie(e,335,f3({name:"XLDAPR",version:12e4,flags:3496657072})),Ie(e,336),Ie(e,339,x3(1,"XLDAPR")),Ie(e,52),Ie(e,35,Qn(514)),Ie(e,4096,Qn(0)),Ie(e,4097,jn(1)),Ie(e,36),Ie(e,53),Ie(e,340),Ie(e,337,g3(1)),Ie(e,51,h3([[1,0]])),Ie(e,338),Ie(e,333),e.end()}function w3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,o=2,l;return e.replace(Qr,function(h){var g=nt(h);switch(fa(g[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:g.name});break;case"</metadataType>":break;case"<futureMetadata":for(var m=0;m<n.Types.length;++m)n.Types[m].name==g.name&&(l=n.Types[m]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[g.t-1].name,index:+g.v}):o==0&&n.Value.push({type:n.Types[g.t-1].name,index:+g.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+g.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return h}),n}function p1(){var e=[pr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function y3(e){var t=[];if(!e)return t;var r=1;return(e.match(Qr)||[]).forEach(function(n){var a=nt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function _3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=tt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function b3(e,t,r){var n=[];return Ca(e,function(o,l,h){switch(h){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function E3(e,t,r,n){if(!e)return e;var a=n||{},o=!1;Ca(e,function(h,g,m){switch(m){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!g.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}},a)}function A3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Hs=1024;function v1(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Be("xml",null,{"xmlns:v":_n.v,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:mv":_n.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Hs<e*1e3;)Hs+=1e3;return t.forEach(function(o){var l=rr(o[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var g=h.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Be("v:fill",g,h),p={on:"t",obscured:"t"};++Hs,a=a.concat(["<v:shape"+Wi({id:"_x0000_s"+Hs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Be("v:shadow",null,p),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Hr("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Hr("x:AutoFill","False"),Hr("x:Row",String(l.r)),Hr("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function uf(e,t,r,n){var a=Array.isArray(e),o;t.forEach(function(l){var h=rr(l.ref);if(a?(e[h.r]||(e[h.r]=[]),o=e[h.r][h.c]):o=e[l.ref],!o){o={t:"z"},a?e[h.r][h.c]=o:e[l.ref]=o;var g=It(e["!ref"]||"BDWGO1000001:A1");g.s.r>h.r&&(g.s.r=h.r),g.e.r<h.r&&(g.e.r=h.r),g.s.c>h.c&&(g.s.c=h.c),g.e.c<h.c&&(g.e.c=h.c);var m=ut(g);m!==e["!ref"]&&(e["!ref"]=m)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:r};l.h&&(p.h=l.h);for(var w=o.c.length-1;w>=0;--w){if(!r&&o.c[w].T)return;r&&!o.c[w].T&&o.c.splice(w,1)}if(r&&n){for(w=0;w<n.length;++w)if(p.a==n[w].id){p.a=n[w].name||p.a;break}}o.c.push(p)})}function C3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var h=l.match(/<(?:\w+:)?author[^>]*>(.*)/);h&&r.push(h[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var h=l.match(/<(?:\w+:)?comment[^>]*>/);if(h){var g=nt(h[0]),m={author:g.authorId&&r[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},p=rr(g.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var w=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),E=!!w&&!!w[1]&&g0(w[1])||{r:"",t:"",h:""};m.r=E.r,E.r=="<t></t>"&&(E.t=E.h=""),m.t=(E.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(m.h=E.h),n.push(m)}}}}),n}function w1(e){var t=[pr,Be("comments",null,{xmlns:Es[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var o=Mt(a.a);r.indexOf(o)==-1&&(r.push(o),t.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(g){g.a&&(a=r.indexOf(Mt(g.a))),o.push(g.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),o.length<=1)t.push(Hr("t",Mt(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,h=1;h<o.length;++h)l+=`Reply:
    `+o[h]+`
`;t.push(Hr("t",Mt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function S3(e,t){var r=[],n=!1,a={},o=0;return e.replace(Qr,function(h,g){var m=nt(h);switch(fa(m[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:m.personId,guid:m.id,ref:m.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=g+h.length;break;case"</text>":a.t=e.slice(o,g).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+m[0]+" in threaded comments")}return h}),r}function T3(e,t,r){var n=[pr,Be("ThreadedComments",null,{xmlns:Sr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,h){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var g={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};h==0?o=g.id:g.parentId=o,l.ID=g.id,l.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Be("threadedComment",Hr("text",l.t||""),g))})}),n.push("</ThreadedComments>"),n.join("")}function N3(e,t){var r=[],n=!1;return e.replace(Qr,function(o){var l=nt(o);switch(fa(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function I3(e){var t=[pr,Be("personList",null,{xmlns:Sr.TCMNT,"xmlns:x":Es[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Be("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function k3(e){var t={};t.iauthor=e.read_shift(4);var r=Ts(e);return t.rfx=r.s,t.ref=tt(r.s),e.l+=16,t}function F3(e,t){return t==null&&(t=be(36)),t.write_shift(4,e[1].iauthor),ci(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var D3=qr;function O3(e){return Mr(e.slice(0,54))}function R3(e,t){var r=[],n=[],a={},o=!1;return Ca(e,function(h,g,m){switch(m){case 632:n.push(h);break;case 635:a=h;break;case 637:a.t=h.t,a.h=h.h,a.r=h.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!g.T){if(!o||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function M3(e){var t=fn(),r=[];return Ie(t,628),Ie(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ie(t,632,O3(a.a)))})}),Ie(t,631),Ie(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:rr(n[0]),e:rr(n[0])};Ie(t,635,F3([o,a])),a.t&&a.t.length>0&&Ie(t,637,nv(a)),Ie(t,636),delete a.iauthor})}),Ie(t,634),Ie(t,629),t.end()}var L3="application/vnd.ms-office.vbaProject";function j3(e){var t=$e.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");$e.utils.cfb_add(t,a,e.FileIndex[n].content)}}),$e.write(t)}function P3(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&$e.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var y1=["xlsb","xlsm","xlam","biff8","xla"];function B3(){return{"!type":"dialog"}}function U3(){return{"!type":"dialog"}}function z3(){return{"!type":"macro"}}function H3(){return{"!type":"macro"}}var $s=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,o,l){var h=!1,g=!1;o.length==0?g=!0:o.charAt(0)=="["&&(g=!0,o=o.slice(1,-1)),l.length==0?h=!0:l.charAt(0)=="["&&(h=!0,l=l.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return h?p+=t.c:--p,g?m+=t.r:--m,a+(h?"":"$")+tr(p)+(g?"":"$")+gr(m)}return function(a,o){return t=o,a.replace(e,r)}}(),y0=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_0=function(){return function(t,r){return t.replace(y0,function(n,a,o,l,h,g){var m=o0(l)-(o?0:r.c),p=i0(g)-(h?0:r.r),w=p==0?"":h?p+1:"["+p+"]",E=m==0?"":o?m+1:"["+m+"]";return a+"R"+w+"C"+E})}}();function _1(e,t){return e.replace(y0,function(r,n,a,o,l,h){return n+(a=="$"?a+o:tr(o0(o)+t.c))+(l=="$"?l+h:gr(i0(h)+t.r))})}function W3(e,t,r){var n=dn(t),a=n.s,o=rr(r),l={r:o.r-a.r,c:o.c-a.c};return _1(e,l)}function V3(e){return e.length!=1}function ff(e){return e.replace(/_xlfn\./g,"")}function wr(e){e.l+=1}function Za(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function b1(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return E1(e);r.biff==12&&(n=4)}var a=e.read_shift(n),o=e.read_shift(n),l=Za(e),h=Za(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:h[0],cRel:h[1],rRel:h[2]}}}function E1(e){var t=Za(e),r=Za(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function G3(e,t,r){if(r.biff<8)return E1(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),o=Za(e),l=Za(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function A1(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return X3(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Za(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function X3(e){var t=Za(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Y3(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Z3(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $3(e);var a=e.read_shift(n>=12?4:2),o=e.read_shift(2),l=(o&16384)>>14,h=(o&32768)>>15;if(o&=16383,h==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:h}}function $3(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function q3(e,t,r){var n=(e[e.l++]&96)>>5,a=b1(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function K3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var l=b1(e,o,r);return[n,a,l]}function Q3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function J3(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[n,a]}function e4(e,t,r){var n=(e[e.l++]&96)>>5,a=G3(e,t-1,r);return[n,a]}function t4(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function df(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function r4(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function n4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function a4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function s4(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function i4(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function C1(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function o4(e){return e.read_shift(2),C1(e)}function c4(e){return e.read_shift(2),C1(e)}function l4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=A1(e,0,r);return[n,a]}function u4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Z3(e,0,r);return[n,a]}function f4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var o=A1(e,0,r);return[n,a,o]}function d4(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[mb[a],N1[a],n]}function h4(e,t,r){var n=e[e.l++],a=e.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:x4(e);return[a,(o[0]===0?N1:xb)[o[1]]]}function x4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function m4(e,t,r){e.l+=r&&r.biff==2?3:4}function g4(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function p4(e){return e.l++,Sa[e.read_shift(1)]}function v4(e){return e.l++,e.read_shift(2)}function w4(e){return e.l++,e.read_shift(1)!==0}function y4(e){return e.l++,$r(e)}function _4(e,t,r){return e.l++,so(e,t-1,r)}function b4(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Sa[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$r(e);break;case 2:r[1]=Ns(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function E4(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?Ts:wc)(e));return a}function A4(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var h=0;h!=a;++h)l[o][h]=b4(e,r.biff);return l}function C4(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,o]}function S4(e,t,r){if(r.biff==5)return T4(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),o=e.read_shift(4);return[n,a,o]}function T4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function N4(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function I4(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function k4(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function F4(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[n,a]}var D4=Kr,O4=Kr,R4=Kr;function oo(e,t,r){return e.l+=2,[Y3(e)]}function b0(e){return e.l+=6,[]}var M4=oo,L4=b0,j4=b0,P4=oo;function S1(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var B4=oo,U4=S1,z4=b0,H4=oo,W4=oo,V4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function G4(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),o=e.read_shift(2),l=V4[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:o}}function X4(e){return e.l+=2,[e.read_shift(4)]}function Y4(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Z4(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function q4(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function K4(e){return e.l+=4,[0,0]}var hf={1:{n:"PtgExp",f:g4},2:{n:"PtgTbl",f:R4},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:_4},26:{n:"PtgSheet",f:Y4},27:{n:"PtgEndSheet",f:Z4},28:{n:"PtgErr",f:p4},29:{n:"PtgBool",f:w4},30:{n:"PtgInt",f:v4},31:{n:"PtgNum",f:y4},32:{n:"PtgArray",f:t4},33:{n:"PtgFunc",f:d4},34:{n:"PtgFuncVar",f:h4},35:{n:"PtgName",f:C4},36:{n:"PtgRef",f:l4},37:{n:"PtgArea",f:q3},38:{n:"PtgMemArea",f:N4},39:{n:"PtgMemErr",f:D4},40:{n:"PtgMemNoMem",f:O4},41:{n:"PtgMemFunc",f:I4},42:{n:"PtgRefErr",f:k4},43:{n:"PtgAreaErr",f:Q3},44:{n:"PtgRefN",f:u4},45:{n:"PtgAreaN",f:e4},46:{n:"PtgMemAreaN",f:$4},47:{n:"PtgMemNoMemN",f:q4},57:{n:"PtgNameX",f:S4},58:{n:"PtgRef3d",f:f4},59:{n:"PtgArea3d",f:K3},60:{n:"PtgRefErr3d",f:F4},61:{n:"PtgAreaErr3d",f:J3},255:{}},Q4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},J4={1:{n:"PtgElfLel",f:S1},2:{n:"PtgElfRw",f:H4},3:{n:"PtgElfCol",f:M4},6:{n:"PtgElfRwV",f:W4},7:{n:"PtgElfColV",f:P4},10:{n:"PtgElfRadical",f:B4},11:{n:"PtgElfRadicalS",f:z4},13:{n:"PtgElfColS",f:L4},15:{n:"PtgElfColSV",f:j4},16:{n:"PtgElfRadicalLel",f:U4},25:{n:"PtgList",f:G4},29:{n:"PtgSxName",f:X4},255:{}},eb={0:{n:"PtgAttrNoop",f:K4},1:{n:"PtgAttrSemi",f:i4},2:{n:"PtgAttrIf",f:a4},4:{n:"PtgAttrChoose",f:r4},8:{n:"PtgAttrGoto",f:n4},16:{n:"PtgAttrSum",f:m4},32:{n:"PtgAttrBaxcel",f:df},33:{n:"PtgAttrBaxcel",f:df},64:{n:"PtgAttrSpace",f:o4},65:{n:"PtgAttrSpaceSemi",f:c4},128:{n:"PtgAttrIfError",f:s4},255:{}};function co(e,t,r,n){if(n.biff<8)return Kr(e,t);for(var a=e.l+t,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=A4(e,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=E4(e,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&o.push(Kr(e,t)),o}function lo(e,t,r){for(var n=e.l+t,a,o,l=[];n!=e.l;)t=n-e.l,o=e[e.l],a=hf[o]||hf[Q4[o]],(o===24||o===25)&&(a=(o===24?J4:eb)[e[e.l+1]]),!a||!a.f?Kr(e,t):l.push([a.n,a.f(e,t,r)]);return l}function tb(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var rb={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nb(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function T1(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xf(e,t,r){var n=T1(e,t,r);return n=="#REF"?n:nb(n,r)}function Yr(e,t,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},h=[],g,m,p,w=0,E=0,A,T="";if(!e[0]||!e[0][0])return"";for(var _=-1,C="",S=0,k=e[0].length;S<k;++S){var N=e[0][S];switch(N[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=h.pop(),m=h.pop(),_>=0){switch(e[0][_][1][0]){case 0:C=cr(" ",e[0][_][1][1]);break;case 1:C=cr("\r",e[0][_][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}m=m+C,_=-1}h.push(m+rb[N[0]]+g);break;case"PtgIsect":g=h.pop(),m=h.pop(),h.push(m+" "+g);break;case"PtgUnion":g=h.pop(),m=h.pop(),h.push(m+","+g);break;case"PtgRange":g=h.pop(),m=h.pop(),h.push(m+":"+g);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Ti(N[1][1],l,a),h.push(Ni(p,o));break;case"PtgRefN":p=r?Ti(N[1][1],r,a):N[1][1],h.push(Ni(p,o));break;case"PtgRef3d":w=N[1][1],p=Ti(N[1][2],l,a),T=xf(n,w,a),h.push(T+"!"+Ni(p,o));break;case"PtgFunc":case"PtgFuncVar":var F=N[1][0],W=N[1][1];F||(F=0),F&=127;var B=F==0?[]:h.slice(-F);h.length-=F,W==="User"&&(W=B.shift()),h.push(W+"("+B.join(",")+")");break;case"PtgBool":h.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(N[1]);break;case"PtgNum":h.push(String(N[1]));break;case"PtgStr":h.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(N[1]);break;case"PtgAreaN":A=Hu(N[1][1],r?{s:r}:l,a),h.push(qc(A,a));break;case"PtgArea":A=Hu(N[1][1],l,a),h.push(qc(A,a));break;case"PtgArea3d":w=N[1][1],A=N[1][2],T=xf(n,w,a),h.push(T+"!"+qc(A,a));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":E=N[1][2];var R=(n.names||[])[E-1]||(n[0]||[])[E],z=R?R.Name:"SH33TJSNAME"+String(E);z&&z.slice(0,6)=="_xlfn."&&!a.xlfn&&(z=z.slice(6)),h.push(z);break;case"PtgNameX":var U=N[1][1];E=N[1][2];var fe;if(a.biff<=5)U<0&&(U=-U),n[U]&&(fe=n[U][E]);else{var M="";if(((n[U]||[])[0]||[])[0]==14849||(((n[U]||[])[0]||[])[0]==1025?n[U][E]&&n[U][E].itab>0&&(M=n.SheetNames[n[U][E].itab-1]+"!"):M=n.SheetNames[E-1]+"!"),n[U]&&n[U][E])M+=n[U][E].Name;else if(n[0]&&n[0][E])M+=n[0][E].Name;else{var V=(T1(n,U,a)||"").split(";;");V[E-1]?M=V[E-1]:M+="SH33TJSERRX"}h.push(M);break}fe||(fe={Name:"SH33TJSERRY"}),h.push(fe.Name);break;case"PtgParen":var ne="(",me=")";if(_>=0){switch(C="",e[0][_][1][0]){case 2:ne=cr(" ",e[0][_][1][1])+ne;break;case 3:ne=cr("\r",e[0][_][1][1])+ne;break;case 4:me=cr(" ",e[0][_][1][1])+me;break;case 5:me=cr("\r",e[0][_][1][1])+me;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}h.push(ne+h.pop()+me);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":p={c:N[1][1],r:N[1][0]};var J={c:r.c,r:r.r};if(n.sharedf[tt(p)]){var Ce=n.sharedf[tt(p)];h.push(Yr(Ce,l,J,n,a))}else{var Ae=!1;for(g=0;g!=n.arrayf.length;++g)if(m=n.arrayf[g],!(p.c<m[0].s.c||p.c>m[0].e.c)&&!(p.r<m[0].s.r||p.r>m[0].e.r)){h.push(Yr(m[1],l,J,n,a)),Ae=!0;break}Ae||h.push(N[1])}break;case"PtgArray":h.push("{"+tb(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var at=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&_>=0&&at.indexOf(e[0][S][0])==-1){N=e[0][_];var he=!0;switch(N[1][0]){case 4:he=!1;case 0:C=cr(" ",N[1][1]);break;case 5:he=!1;case 1:C=cr("\r",N[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}h.push((he?C:"")+h.pop()+(he?"":C)),_=-1}}if(h.length>1&&a.WTF)throw new Error("bad formula stack");return h[0]}function ab(e,t,r){var n=e.l+t,a=r.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Kr(e,t-2)];var h=lo(e,l,r);return t!==l+a&&(o=co(e,t-l-a,h,r)),e.l=n,[h,o]}function sb(e,t,r){var n=e.l+t,a=r.biff==2?1:2,o,l=e.read_shift(a);if(l==65535)return[[],Kr(e,t-2)];var h=lo(e,l,r);return t!==l+a&&(o=co(e,t-l-a,h,r)),e.l=n,[h,o]}function ib(e,t,r,n){var a=e.l+t,o=lo(e,n,r),l;return a!==e.l&&(l=co(e,a-e.l,o,r)),[o,l]}function ob(e,t,r){var n=e.l+t,a,o=e.read_shift(2),l=lo(e,o,r);return o==65535?[[],Kr(e,t-2)]:(t!==o+2&&(a=co(e,n-o-2,l,r)),[l,a])}function cb(e){var t;if(ga(e,e.l+6)!==65535)return[$r(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function lb(e){if(e==null){var t=be(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ps(e);return ps(0)}function tl(e,t,r){var n=e.l+t,a=da(e);r.biff==2&&++e.l;var o=cb(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var h=sb(e,n-e.l,r);return{cell:a,val:o[0],formula:h,shared:l>>3&1,tt:o[1]}}function ub(e,t,r,n,a){var o=ws(t,r,a),l=lb(e.v),h=be(6),g=33;h.write_shift(2,g),h.write_shift(4,0);for(var m=be(e.bf.length),p=0;p<e.bf.length;++p)m[p]=e.bf[p];var w=Or([o,l,h,m]);return w}function yc(e,t,r){var n=e.read_shift(4),a=lo(e,n,r),o=e.read_shift(4),l=o>0?co(e,o,a,r):null;return[a,l]}var fb=yc,_c=yc,db=yc,hb=yc,xb={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},N1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mb={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function mf(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function gb(e){var t="of:="+e.replace(y0,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function rl(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function pb(e){return e.replace(/\./,"!")}var ki={},qs={},Fi=typeof Map<"u";function E0(e,t,r){var n=0,a=e.length;if(r){if(Fi?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var o=Fi?r.get(t):r[t];n<o.length;++n)if(e[o[n]].t===t)return e.Count++,o[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Fi?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function bc(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Zr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Zi(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Qo(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function hs(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ts(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,o=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){wa(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=o;++a)if(e[a].numFmtId===n)return a;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function I1(e,t,r,n,a,o){try{n.cellNF&&(e.z=Je[t])}catch(h){if(n.WTF)throw h}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Zt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Je[t]==null&&wa(x2[t]||"General",t),e.t==="e")e.w=e.w||Sa[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zi(e.v);else if(e.t==="d"){var l=Tr(e.v);(l|0)===l?e.w=l.toString(10):e.w=zi(l)}else{if(e.v===void 0)return"";e.w=ms(e.v,qs)}else e.t==="d"?e.w=Un(t,Tr(e.v),qs):e.w=Un(t,e.v,qs)}catch(h){if(n.WTF)throw h}if(n.cellStyles&&r!=null)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ko(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ko(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(h){if(n.WTF&&o.Fills)throw h}}}function vb(e,t,r){if(e&&e["!ref"]){var n=It(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function wb(e,t){var r=It(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ut(r))}var yb=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,_b=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,bb=/<(?:\w:)?hyperlink [^>]*>/mg,Eb=/"(\w*:\w*)"/,Ab=/<(?:\w:)?col\b[^>]*[\/]?>/g,Cb=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Sb=/<(?:\w:)?pageMargins[^>]*\/>/g,k1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Tb=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Nb=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Ib(e,t,r,n,a,o,l){if(!e)return e;n||(n={"!id":{}});var h=t.dense?[]:{},g={s:{r:2e6,c:2e6},e:{r:0,c:0}},m="",p="",w=e.match(_b);w?(m=e.slice(0,w.index),p=e.slice(w.index+w[0].length)):m=p=e;var E=m.match(k1);E?A0(E[0],h,a,r):(E=m.match(Tb))&&Fb(E[0],E[1]||"",h,a,r);var A=(m.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(A>0){var T=m.slice(A,A+50).match(Eb);T&&wb(h,T[1])}var _=m.match(Nb);_&&_[1]&&Vb(_[1],a);var C=[];if(t.cellStyles){var S=m.match(Ab);S&&Bb(C,S)}w&&Yb(w[1],h,t,g,o,l);var k=p.match(Cb);k&&(h["!autofilter"]=zb(k[0]));var N=[],F=p.match(yb);if(F)for(A=0;A!=F.length;++A)N[A]=It(F[A].slice(F[A].indexOf('"')+1));var W=p.match(bb);W&&Lb(h,W,n);var B=p.match(Sb);if(B&&(h["!margins"]=jb(nt(B[0]))),!h["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(h["!ref"]=ut(g)),t.sheetRows>0&&h["!ref"]){var R=It(h["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>g.e.r&&(R.e.r=g.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>g.e.c&&(R.e.c=g.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),h["!fullref"]=h["!ref"],h["!ref"]=ut(R))}return C.length>0&&(h["!cols"]=C),N.length>0&&(h["!merges"]=N),h}function kb(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ut(e[r])+'"/>';return t+"</mergeCells>"}function A0(e,t,r,n){var a=nt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Nt(jt(a.codeName)))}function Fb(e,t,r,n,a){A0(e.slice(0,e.indexOf(">")),r,n,a)}function Db(e,t,r,n,a){var o=!1,l={},h=null;if(n.bookType!=="xlsx"&&t.vbaraw){var g=t.SheetNames[r];try{t.Workbook&&(g=t.Workbook.Sheets[r].CodeName||g)}catch{}o=!0,l.codeName=la(Mt(g))}if(e&&e["!outline"]){var m={summaryBelow:1,summaryRight:1};e["!outline"].above&&(m.summaryBelow=0),e["!outline"].left&&(m.summaryRight=0),h=(h||"")+Be("outlinePr",null,m)}!o&&!h||(a[a.length]=Be("sheetPr",h,l))}var Ob=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Rb=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Mb(e){var t={sheet:1};return Ob.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Rb.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=p0(e.password).toString(16).toUpperCase()),Be("sheetProtection",null,t)}function Lb(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var o=nt(jt(t[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Nt(o.location))):(o.Target="#"+Nt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var h=It(o.ref),g=h.s.r;g<=h.e.r;++g)for(var m=h.s.c;m<=h.e.c;++m){var p=tt({c:m,r:g});n?(e[g]||(e[g]=[]),e[g][m]||(e[g][m]={t:"z",v:void 0}),e[g][m].l=o):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=o)}}}function jb(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Pb(e){return hs(e),Be("pageMargins",null,e)}function Bb(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=nt(t[n],!0);a.hidden&&(a.hidden=Yt(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,v0(a.width)),Ya(a);o<=l;)e[o++]=$t(a)}}function Ub(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Be("col",null,bc(a,n)));return r[r.length]="</cols>",r.join("")}function zb(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Hb(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ut(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=dn(a);l.s.r==l.e.r&&(l.e.r=dn(t["!ref"]).e.r,a=ut(l));for(var h=0;h<o.length;++h){var g=o[h];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==n){g.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return h==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Be("autoFilter",null,{ref:a})}var Wb=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Vb(e,t){t.Views||(t.Views=[{}]),(e.match(Wb)||[]).forEach(function(r,n){var a=nt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Yt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Gb(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,a),{})}function Xb(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",o=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Sa[e.v];break;case"d":n&&n.cellDates?a=Zt(e.v,-1).toISOString():(e=$t(e),e.t="n",a=""+(e.v=Tr(Zt(e.v)))),typeof e.z>"u"&&(e.z=Je[14]);break;default:a=e.v;break}var h=Hr("v",Mt(a)),g={r:t},m=ts(n.cellXfs,e,n);switch(m!==0&&(g.s=m),e.t){case"n":break;case"d":g.t="d";break;case"b":g.t="b";break;case"e":g.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){h=Hr("v",""+E0(n.Strings,e.v,n.revStrings)),g.t="s";break}g.t="str";break}if(e.t!=o&&(e.t=o,e.v=l),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;h=Be("f",Mt(e.f),p)+(e.v!=null?h:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(g.cm=1),Be("c",h,g)}var Yb=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Hi("v"),l=Hi("f");return function(g,m,p,w,E,A){for(var T=0,_="",C=[],S=[],k=0,N=0,F=0,W="",B,R,z=0,U=0,fe,M,V=0,ne=0,me=Array.isArray(A.CellXf),J,Ce=[],Ae=[],at=Array.isArray(m),he=[],Ve={},Xe=!1,Q=!!p.sheetStubs,oe=g.split(t),te=0,se=oe.length;te!=se;++te){_=oe[te].trim();var ce=_.length;if(ce!==0){var ie=0;e:for(T=0;T<ce;++T)switch(_[T]){case">":if(_[T-1]!="/"){++T;break e}if(p&&p.cellStyles){if(R=nt(_.slice(ie,T),!0),z=R.r!=null?parseInt(R.r,10):z+1,U=-1,p.sheetRows&&p.sheetRows<z)continue;Ve={},Xe=!1,R.ht&&(Xe=!0,Ve.hpt=parseFloat(R.ht),Ve.hpx=ti(Ve.hpt)),R.hidden=="1"&&(Xe=!0,Ve.hidden=!0),R.outlineLevel!=null&&(Xe=!0,Ve.level=+R.outlineLevel),Xe&&(he[z-1]=Ve)}break;case"<":ie=T;break}if(ie>=T)break;if(R=nt(_.slice(ie,T),!0),z=R.r!=null?parseInt(R.r,10):z+1,U=-1,!(p.sheetRows&&p.sheetRows<z)){w.s.r>z-1&&(w.s.r=z-1),w.e.r<z-1&&(w.e.r=z-1),p&&p.cellStyles&&(Ve={},Xe=!1,R.ht&&(Xe=!0,Ve.hpt=parseFloat(R.ht),Ve.hpx=ti(Ve.hpt)),R.hidden=="1"&&(Xe=!0,Ve.hidden=!0),R.outlineLevel!=null&&(Xe=!0,Ve.level=+R.outlineLevel),Xe&&(he[z-1]=Ve)),C=_.slice(T).split(e);for(var ye=0;ye!=C.length&&C[ye].trim().charAt(0)=="<";++ye);for(C=C.slice(ye),T=0;T!=C.length;++T)if(_=C[T].trim(),_.length!==0){if(S=_.match(r),k=T,N=0,F=0,_="<c "+(_.slice(0,1)=="<"?">":"")+_,S!=null&&S.length===2){for(k=0,W=S[1],N=0;N!=W.length&&!((F=W.charCodeAt(N)-64)<1||F>26);++N)k=26*k+F;--k,U=k}else++U;for(N=0;N!=_.length&&_.charCodeAt(N)!==62;++N);if(++N,R=nt(_.slice(0,N),!0),R.r||(R.r=tt({r:z-1,c:U})),W=_.slice(N),B={t:""},(S=W.match(o))!=null&&S[1]!==""&&(B.v=Nt(S[1])),p.cellFormula){if((S=W.match(l))!=null&&S[1]!==""){if(B.f=Nt(jt(S[1])).replace(/\r\n/g,`
`),p.xlfn||(B.f=ff(B.f)),S[0].indexOf('t="array"')>-1)B.F=(W.match(a)||[])[1],B.F.indexOf(":")>-1&&Ce.push([It(B.F),B.F]);else if(S[0].indexOf('t="shared"')>-1){M=nt(S[0]);var Se=Nt(jt(S[1]));p.xlfn||(Se=ff(Se)),Ae[parseInt(M.si,10)]=[M,Se,R.r]}}else(S=W.match(/<f[^>]*\/>/))&&(M=nt(S[0]),Ae[M.si]&&(B.f=W3(Ae[M.si][1],Ae[M.si][2],R.r)));var Ne=rr(R.r);for(N=0;N<Ce.length;++N)Ne.r>=Ce[N][0].s.r&&Ne.r<=Ce[N][0].e.r&&Ne.c>=Ce[N][0].s.c&&Ne.c<=Ce[N][0].e.c&&(B.F=Ce[N][1])}if(R.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(Q)B.t="z";else continue;else B.t=R.t||"n";switch(w.s.c>U&&(w.s.c=U),w.e.c<U&&(w.e.c=U),B.t){case"n":if(B.v==""||B.v==null){if(!Q)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!Q)continue;B.t="z"}else fe=ki[parseInt(B.v,10)],B.v=fe.t,B.r=fe.r,p.cellHTML&&(B.h=fe.h);break;case"str":B.t="s",B.v=B.v!=null?jt(B.v):"",p.cellHTML&&(B.h=r0(B.v));break;case"inlineStr":S=W.match(n),B.t="s",S!=null&&(fe=g0(S[1]))?(B.v=fe.t,p.cellHTML&&(B.h=fe.h)):B.v="";break;case"b":B.v=Yt(B.v);break;case"d":p.cellDates?B.v=Zt(B.v,1):(B.v=Tr(Zt(B.v,1)),B.t="n");break;case"e":(!p||p.cellText!==!1)&&(B.w=B.v),B.v=Dh[B.v];break}if(V=ne=0,J=null,me&&R.s!==void 0&&(J=A.CellXf[R.s],J!=null&&(J.numFmtId!=null&&(V=J.numFmtId),p.cellStyles&&J.fillId!=null&&(ne=J.fillId))),I1(B,V,ne,p,E,A),p.cellDates&&me&&B.t=="n"&&si(Je[V])&&(B.t="d",B.v=vc(B.v)),R.cm&&p.xlmeta){var Ye=(p.xlmeta.Cell||[])[+R.cm-1];Ye&&Ye.type=="XLDAPR"&&(B.D=!0)}if(at){var ee=rr(R.r);m[ee.r]||(m[ee.r]=[]),m[ee.r][ee.c]=B}else m[R.r]=B}}}}he.length>0&&(m["!rows"]=he)}}();function Zb(e,t,r,n){var a=[],o=[],l=It(e["!ref"]),h="",g,m="",p=[],w=0,E=0,A=e["!rows"],T=Array.isArray(e),_={r:m},C,S=-1;for(E=l.s.c;E<=l.e.c;++E)p[E]=tr(E);for(w=l.s.r;w<=l.e.r;++w){for(o=[],m=gr(w),E=l.s.c;E<=l.e.c;++E){g=p[E]+m;var k=T?(e[w]||[])[E]:e[g];k!==void 0&&(h=Xb(k,g,e,t))!=null&&o.push(h)}(o.length>0||A&&A[w])&&(_={r:m},A&&A[w]&&(C=A[w],C.hidden&&(_.hidden=1),S=-1,C.hpx?S=$i(C.hpx):C.hpt&&(S=C.hpt),S>-1&&(_.ht=S,_.customHeight=1),C.level&&(_.outlineLevel=C.level)),a[a.length]=Be("row",o.join(""),_))}if(A)for(;w<A.length;++w)A&&A[w]&&(_={r:w+1},C=A[w],C.hidden&&(_.hidden=1),S=-1,C.hpx?S=$i(C.hpx):C.hpt&&(S=C.hpt),S>-1&&(_.ht=S,_.customHeight=1),C.level&&(_.outlineLevel=C.level),a[a.length]=Be("row","",_));return a.join("")}function F1(e,t,r,n){var a=[pr,Be("worksheet",null,{xmlns:Es[0],"xmlns:r":Sr.r})],o=r.SheetNames[e],l=0,h="",g=r.Sheets[o];g==null&&(g={});var m=g["!ref"]||"A1",p=It(m);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),m=ut(p)}n||(n={}),g["!comments"]=[];var w=[];Db(g,r,e,t,a),a[a.length]=Be("dimension",null,{ref:m}),a[a.length]=Gb(g,t,e,r),t.sheetFormat&&(a[a.length]=Be("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),g["!cols"]!=null&&g["!cols"].length>0&&(a[a.length]=Ub(g,g["!cols"])),a[l=a.length]="<sheetData/>",g["!links"]=[],g["!ref"]!=null&&(h=Zb(g,t),h.length>0&&(a[a.length]=h)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),g["!protect"]&&(a[a.length]=Mb(g["!protect"])),g["!autofilter"]!=null&&(a[a.length]=Hb(g["!autofilter"],g,r,e)),g["!merges"]!=null&&g["!merges"].length>0&&(a[a.length]=kb(g["!merges"]));var E=-1,A,T=-1;return g["!links"].length>0&&(a[a.length]="<hyperlinks>",g["!links"].forEach(function(_){_[1].Target&&(A={ref:_[0]},_[1].Target.charAt(0)!="#"&&(T=Ot(n,-1,Mt(_[1].Target).replace(/#.*$/,""),bt.HLINK),A["r:id"]="rId"+T),(E=_[1].Target.indexOf("#"))>-1&&(A.location=Mt(_[1].Target.slice(E+1))),_[1].Tooltip&&(A.tooltip=Mt(_[1].Tooltip)),a[a.length]=Be("hyperlink",null,A))}),a[a.length]="</hyperlinks>"),delete g["!links"],g["!margins"]!=null&&(a[a.length]=Pb(g["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=Hr("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:m}))),w.length>0&&(T=Ot(n,-1,"../drawings/drawing"+(e+1)+".xml",bt.DRAW),a[a.length]=Be("drawing",null,{"r:id":"rId"+T}),g["!drawing"]=w),g["!comments"].length>0&&(T=Ot(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",bt.VML),a[a.length]=Be("legacyDrawing",null,{"r:id":"rId"+T}),g["!legacy"]=T),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function $b(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function qb(e,t,r){var n=be(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var o=320;a.hpx?o=$i(a.hpx)*20:a.hpt&&(o=a.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var h=0,g=n.l;n.l+=4;for(var m={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var w=-1,E=-1,A=p<<10;A<p+1<<10;++A){m.c=A;var T=Array.isArray(r)?(r[m.r]||[])[m.c]:r[tt(m)];T&&(w<0&&(w=A),E=A)}w<0||(++h,n.write_shift(4,w),n.write_shift(4,E))}var _=n.l;return n.l=g,n.write_shift(4,h),n.l=_,n.length>n.l?n.slice(0,n.l):n}function Kb(e,t,r,n){var a=qb(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Ie(e,0,a)}var Qb=Ts,Jb=ci;function eE(){}function tE(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=av(e),r}function rE(e,t,r){r==null&&(r=be(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Zo({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Th(e,r),r.slice(0,r.l)}function nE(e){var t=zn(e);return[t]}function aE(e,t,r){return r==null&&(r=be(8)),As(t,r)}function sE(e){var t=Cs(e);return[t]}function iE(e,t,r){return r==null&&(r=be(4)),Ss(t,r)}function oE(e){var t=zn(e),r=e.read_shift(1);return[t,r,"b"]}function cE(e,t,r){return r==null&&(r=be(9)),As(t,r),r.write_shift(1,e.v?1:0),r}function lE(e){var t=Cs(e),r=e.read_shift(1);return[t,r,"b"]}function uE(e,t,r){return r==null&&(r=be(5)),Ss(t,r),r.write_shift(1,e.v?1:0),r}function fE(e){var t=zn(e),r=e.read_shift(1);return[t,r,"e"]}function dE(e,t,r){return r==null&&(r=be(9)),As(t,r),r.write_shift(1,e.v),r}function hE(e){var t=Cs(e),r=e.read_shift(1);return[t,r,"e"]}function xE(e,t,r){return r==null&&(r=be(8)),Ss(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function mE(e){var t=zn(e),r=e.read_shift(4);return[t,r,"s"]}function gE(e,t,r){return r==null&&(r=be(12)),As(t,r),r.write_shift(4,t.v),r}function pE(e){var t=Cs(e),r=e.read_shift(4);return[t,r,"s"]}function vE(e,t,r){return r==null&&(r=be(8)),Ss(t,r),r.write_shift(4,t.v),r}function wE(e){var t=zn(e),r=$r(e);return[t,r,"n"]}function yE(e,t,r){return r==null&&(r=be(16)),As(t,r),ps(e.v,r),r}function D1(e){var t=Cs(e),r=$r(e);return[t,r,"n"]}function _E(e,t,r){return r==null&&(r=be(12)),Ss(t,r),ps(e.v,r),r}function bE(e){var t=zn(e),r=f0(e);return[t,r,"n"]}function EE(e,t,r){return r==null&&(r=be(12)),As(t,r),Nh(e.v,r),r}function AE(e){var t=Cs(e),r=f0(e);return[t,r,"n"]}function CE(e,t,r){return r==null&&(r=be(8)),Ss(t,r),Nh(e.v,r),r}function SE(e){var t=zn(e),r=c0(e);return[t,r,"is"]}function TE(e){var t=zn(e),r=qr(e);return[t,r,"str"]}function NE(e,t,r){return r==null&&(r=be(12+4*e.v.length)),As(t,r),Mr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IE(e){var t=Cs(e),r=qr(e);return[t,r,"str"]}function kE(e,t,r){return r==null&&(r=be(8+4*e.v.length)),Ss(t,r),Mr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function FE(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var o=e.read_shift(1),l=[a,o,"b"];if(r.cellFormula){e.l+=2;var h=_c(e,n-e.l,r);l[3]=Yr(h,null,a,r.supbooks,r)}else e.l=n;return l}function DE(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var o=e.read_shift(1),l=[a,o,"e"];if(r.cellFormula){e.l+=2;var h=_c(e,n-e.l,r);l[3]=Yr(h,null,a,r.supbooks,r)}else e.l=n;return l}function OE(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var o=$r(e),l=[a,o,"n"];if(r.cellFormula){e.l+=2;var h=_c(e,n-e.l,r);l[3]=Yr(h,null,a,r.supbooks,r)}else e.l=n;return l}function RE(e,t,r){var n=e.l+t,a=zn(e);a.r=r["!row"];var o=qr(e),l=[a,o,"str"];if(r.cellFormula){e.l+=2;var h=_c(e,n-e.l,r);l[3]=Yr(h,null,a,r.supbooks,r)}else e.l=n;return l}var ME=Ts,LE=ci;function jE(e,t){return t==null&&(t=be(4)),t.write_shift(4,e),t}function PE(e,t){var r=e.l+t,n=Ts(e),a=l0(e),o=qr(e),l=qr(e),h=qr(e);e.l=r;var g={rfx:n,relId:a,loc:o,display:h};return l&&(g.Tooltip=l),g}function BE(e,t){var r=be(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ci({s:rr(e[0]),e:rr(e[0])},r),u0("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Mr(a||"",r),Mr(e[1].Tooltip||"",r),Mr("",r),r.slice(0,r.l)}function UE(){}function zE(e,t,r){var n=e.l+t,a=Ih(e),o=e.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var h=fb(e,n-e.l,r);l[1]=h}else e.l=n;return l}function HE(e,t,r){var n=e.l+t,a=Ts(e),o=[a];if(r.cellFormula){var l=hb(e,n-e.l,r);o[1]=l,e.l=n}else e.l=n;return o}function WE(e,t,r){r==null&&(r=be(18));var n=bc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var O1=["left","right","top","bottom","header","footer"];function VE(e){var t={};return O1.forEach(function(r){t[r]=$r(e)}),t}function GE(e,t){return t==null&&(t=be(6*8)),hs(e),O1.forEach(function(r){ps(e[r],t)}),t}function XE(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function YE(e,t,r){r==null&&(r=be(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function ZE(e){var t=be(24);return t.write_shift(4,4),t.write_shift(4,1),ci(e,t),t}function $E(e,t){return t==null&&(t=be(16*4+2)),t.write_shift(2,e.password?p0(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function qE(){}function KE(){}function QE(e,t,r,n,a,o,l){if(!e)return e;var h=t||{};n||(n={"!id":{}});var g=h.dense?[]:{},m,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=!1,E=!1,A,T,_,C,S,k,N,F,W,B=[];h.biff=12,h["!row"]=0;var R=0,z=!1,U=[],fe={},M=h.supbooks||a.supbooks||[[]];if(M.sharedf=fe,M.arrayf=U,M.SheetNames=a.SheetNames||a.Sheets.map(function(at){return at.name}),!h.supbooks&&(h.supbooks=M,a.Names))for(var V=0;V<a.Names.length;++V)M[0][V+1]=a.Names[V];var ne=[],me=[],J=!1;qi[16]={n:"BrtShortReal",f:D1};var Ce;if(Ca(e,function(he,Ve,Xe){if(!E)switch(Xe){case 148:m=he;break;case 0:A=he,h.sheetRows&&h.sheetRows<=A.r&&(E=!0),F=gr(C=A.r),h["!row"]=A.r,(he.hidden||he.hpt||he.level!=null)&&(he.hpt&&(he.hpx=ti(he.hpt)),me[he.r]=he);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(T={t:he[2]},he[2]){case"n":T.v=he[1];break;case"s":N=ki[he[1]],T.v=N.t,T.r=N.r;break;case"b":T.v=!!he[1];break;case"e":T.v=he[1],h.cellText!==!1&&(T.w=Sa[T.v]);break;case"str":T.t="s",T.v=he[1];break;case"is":T.t="s",T.v=he[1].t;break}if((_=l.CellXf[he[0].iStyleRef])&&I1(T,_.numFmtId,null,h,o,l),S=he[0].c==-1?S+1:he[0].c,h.dense?(g[C]||(g[C]=[]),g[C][S]=T):g[tr(S)+F]=T,h.cellFormula){for(z=!1,R=0;R<U.length;++R){var Q=U[R];A.r>=Q[0].s.r&&A.r<=Q[0].e.r&&S>=Q[0].s.c&&S<=Q[0].e.c&&(T.F=ut(Q[0]),z=!0)}!z&&he.length>3&&(T.f=he[3])}if(p.s.r>A.r&&(p.s.r=A.r),p.s.c>S&&(p.s.c=S),p.e.r<A.r&&(p.e.r=A.r),p.e.c<S&&(p.e.c=S),h.cellDates&&_&&T.t=="n"&&si(Je[_.numFmtId])){var oe=ls(T.v);oe&&(T.t="d",T.v=new Date(oe.y,oe.m-1,oe.d,oe.H,oe.M,oe.S,oe.u))}Ce&&(Ce.type=="XLDAPR"&&(T.D=!0),Ce=void 0);break;case 1:case 12:if(!h.sheetStubs||w)break;T={t:"z",v:void 0},S=he[0].c==-1?S+1:he[0].c,h.dense?(g[C]||(g[C]=[]),g[C][S]=T):g[tr(S)+F]=T,p.s.r>A.r&&(p.s.r=A.r),p.s.c>S&&(p.s.c=S),p.e.r<A.r&&(p.e.r=A.r),p.e.c<S&&(p.e.c=S),Ce&&(Ce.type=="XLDAPR"&&(T.D=!0),Ce=void 0);break;case 176:B.push(he);break;case 49:Ce=((h.xlmeta||{}).Cell||[])[he-1];break;case 494:var te=n["!id"][he.relId];for(te?(he.Target=te.Target,he.loc&&(he.Target+="#"+he.loc),he.Rel=te):he.relId==""&&(he.Target="#"+he.loc),C=he.rfx.s.r;C<=he.rfx.e.r;++C)for(S=he.rfx.s.c;S<=he.rfx.e.c;++S)h.dense?(g[C]||(g[C]=[]),g[C][S]||(g[C][S]={t:"z",v:void 0}),g[C][S].l=he):(k=tt({c:S,r:C}),g[k]||(g[k]={t:"z",v:void 0}),g[k].l=he);break;case 426:if(!h.cellFormula)break;U.push(he),W=h.dense?g[C][S]:g[tr(S)+F],W.f=Yr(he[1],p,{r:A.r,c:S},M,h),W.F=ut(he[0]);break;case 427:if(!h.cellFormula)break;fe[tt(he[0].s)]=he[1],W=h.dense?g[C][S]:g[tr(S)+F],W.f=Yr(he[1],p,{r:A.r,c:S},M,h);break;case 60:if(!h.cellStyles)break;for(;he.e>=he.s;)ne[he.e--]={width:he.w/256,hidden:!!(he.flags&1),level:he.level},J||(J=!0,v0(he.w/256)),Ya(ne[he.e+1]);break;case 161:g["!autofilter"]={ref:ut(he)};break;case 476:g["!margins"]=he;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),he.name&&(a.Sheets[r].CodeName=he.name),(he.above||he.left)&&(g["!outline"]={above:he.above,left:he.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),he.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:w=!0;break;case 36:w=!1;break;case 37:w=!0;break;case 38:w=!1;break;default:if(!Ve.T){if(!w||h.WTF)throw new Error("Unexpected record 0x"+Xe.toString(16))}}},h),delete h.supbooks,delete h["!row"],!g["!ref"]&&(p.s.r<2e6||m&&(m.e.r>0||m.e.c>0||m.s.r>0||m.s.c>0))&&(g["!ref"]=ut(m||p)),h.sheetRows&&g["!ref"]){var Ae=It(g["!ref"]);h.sheetRows<=+Ae.e.r&&(Ae.e.r=h.sheetRows-1,Ae.e.r>p.e.r&&(Ae.e.r=p.e.r),Ae.e.r<Ae.s.r&&(Ae.s.r=Ae.e.r),Ae.e.c>p.e.c&&(Ae.e.c=p.e.c),Ae.e.c<Ae.s.c&&(Ae.s.c=Ae.e.c),g["!fullref"]=g["!ref"],g["!ref"]=ut(Ae))}return B.length>0&&(g["!merges"]=B),ne.length>0&&(g["!cols"]=ne),me.length>0&&(g["!rows"]=me),g}function JE(e,t,r,n,a,o,l){if(t.v===void 0)return!1;var h="";switch(t.t){case"b":h=t.v?"1":"0";break;case"d":t=$t(t),t.z=t.z||Je[14],t.v=Tr(Zt(t.v)),t.t="n";break;case"n":case"e":h=""+t.v;break;default:h=t.v;break}var g={r,c:n};switch(g.s=ts(a.cellXfs,t,a),t.l&&o["!links"].push([tt(g),t.l]),t.c&&o["!comments"].push([tt(g),t.c]),t.t){case"s":case"str":return a.bookSST?(h=E0(a.Strings,t.v,a.revStrings),g.t="s",g.v=h,l?Ie(e,18,vE(t,g)):Ie(e,7,gE(t,g))):(g.t="str",l?Ie(e,17,kE(t,g)):Ie(e,6,NE(t,g))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Ie(e,13,CE(t,g)):Ie(e,2,EE(t,g)):l?Ie(e,16,_E(t,g)):Ie(e,5,yE(t,g)),!0;case"b":return g.t="b",l?Ie(e,15,uE(t,g)):Ie(e,4,cE(t,g)),!0;case"e":return g.t="e",l?Ie(e,14,xE(t,g)):Ie(e,3,dE(t,g)),!0}return l?Ie(e,12,iE(t,g)):Ie(e,1,aE(t,g)),!0}function eA(e,t,r,n){var a=It(t["!ref"]||"A1"),o,l="",h=[];Ie(e,145);var g=Array.isArray(t),m=a.e.r;t["!rows"]&&(m=Math.max(a.e.r,t["!rows"].length-1));for(var p=a.s.r;p<=m;++p){l=gr(p),Kb(e,t,a,p);var w=!1;if(p<=a.e.r)for(var E=a.s.c;E<=a.e.c;++E){p===a.s.r&&(h[E]=tr(E)),o=h[E]+l;var A=g?(t[p]||[])[E]:t[o];if(!A){w=!1;continue}w=JE(e,A,p,E,n,t,w)}}Ie(e,146)}function tA(e,t){!t||!t["!merges"]||(Ie(e,177,jE(t["!merges"].length)),t["!merges"].forEach(function(r){Ie(e,176,LE(r))}),Ie(e,178))}function rA(e,t){!t||!t["!cols"]||(Ie(e,390),t["!cols"].forEach(function(r,n){r&&Ie(e,60,WE(n,r))}),Ie(e,391))}function nA(e,t){!t||!t["!ref"]||(Ie(e,648),Ie(e,649,ZE(It(t["!ref"]))),Ie(e,650))}function aA(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ot(r,-1,n[1].Target.replace(/#.*$/,""),bt.HLINK);Ie(e,494,BE(n,a))}}),delete t["!links"]}function sA(e,t,r,n){if(t["!comments"].length>0){var a=Ot(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",bt.VML);Ie(e,551,u0("rId"+a)),t["!legacy"]=a}}function iA(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],o=typeof a.ref=="string"?a.ref:ut(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,h=dn(o);h.s.r==h.e.r&&(h.e.r=dn(t["!ref"]).e.r,o=ut(h));for(var g=0;g<l.length;++g){var m=l[g];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+r.SheetNames[n]+"'!"+o;break}}g==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Ie(e,161,ci(It(o))),Ie(e,162)}}function oA(e,t,r){Ie(e,133),Ie(e,137,YE(t,r)),Ie(e,138),Ie(e,134)}function cA(e,t){t["!protect"]&&Ie(e,535,$E(t["!protect"]))}function lA(e,t,r,n){var a=fn(),o=r.SheetNames[e],l=r.Sheets[o]||{},h=o;try{r&&r.Workbook&&(h=r.Workbook.Sheets[e].CodeName||h)}catch{}var g=It(l["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ie(a,129),(r.vbaraw||l["!outline"])&&Ie(a,147,rE(h,l["!outline"])),Ie(a,148,Jb(g)),oA(a,l,r.Workbook),rA(a,l),eA(a,l,e,t),cA(a,l),iA(a,l,r,e),tA(a,l),aA(a,l,n),l["!margins"]&&Ie(a,476,GE(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&nA(a,l),sA(a,l,e,n),Ie(a,130),a.end()}function uA(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=Nt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[t,a,n]}function fA(e,t,r,n,a,o){var l=o||{"!type":"chart"};if(!e)return o;var h=0,g=0,m="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(w){var E=uA(w);p.s.r=p.s.c=0,p.e.c=h,m=tr(h),E[0].forEach(function(A,T){l[m+gr(T)]={t:"n",v:A,z:E[1]},g=T}),p.e.r<g&&(p.e.r=g),++h}),h>0&&(l["!ref"]=ut(p)),l}function dA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,h=e.match(k1);return h&&A0(h[0],o,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function hA(e,t){e.l+=10;var r=qr(e);return{name:r}}function xA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Ca(e,function(g,m,p){switch(p){case 550:o["!rel"]=g;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),g.name&&(a.Sheets[r].CodeName=g.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(m.T>0)){if(!(m.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var C0=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mA=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gA=[],pA=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gf(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var o=t[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=Yt(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function pf(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Yt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function R1(e){pf(e.WBProps,C0),pf(e.CalcPr,pA),gf(e.WBView,mA),gf(e.Sheets,gA),qs.date1904=Yt(e.WBProps.date1904)}function vA(e){return!e.Workbook||!e.Workbook.WBProps?"false":Yt(e.Workbook.WBProps.date1904)?"true":"false"}var wA="][*?/\\".split("");function M1(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wA.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function yA(e,t,r){e.forEach(function(n,a){M1(n);for(var o=0;o<a;++o)if(n==e[o])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function _A(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];yA(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)vb(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var bA=/<\w+:workbook/;function EA(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(e.replace(Qr,function(g,m){var p=nt(g);switch(fa(p[0])){case"<?xml":break;case"<workbook":g.match(bA)&&(a="xmlns"+g.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":C0.forEach(function(w){if(p[w[0]]!=null)switch(w[2]){case"bool":r.WBProps[w[0]]=Yt(p[w[0]]);break;case"int":r.WBProps[w[0]]=parseInt(p[w[0]],10);break;default:r.WBProps[w[0]]=p[w[0]]}}),p.codeName&&(r.WBProps.CodeName=jt(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Nt(jt(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=jt(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),Yt(p.hidden||"0")&&(o.Hidden=!0),l=m+g.length;break;case"</definedName>":o.Ref=Nt(jt(e.slice(l,m))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return g}),Es.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return R1(r),r}function L1(e){var t=[pr];t[t.length]=Be("workbook",null,{xmlns:Es[0],"xmlns:r":Sr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(C0.forEach(function(h){e.Workbook.WBProps[h[0]]!=null&&e.Workbook.WBProps[h[0]]!=h[1]&&(n[h[0]]=e.Workbook.WBProps[h[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Be("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var l={name:Mt(e.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Be("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(h){var g={name:h.Name};h.Comment&&(g.comment=h.Comment),h.Sheet!=null&&(g.localSheetId=""+h.Sheet),h.Hidden&&(g.hidden="1"),h.Ref&&(t[t.length]=Be("definedName",Mt(h.Ref),g))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function AA(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Al(e),r.name=qr(e),r}function CA(e,t){return t||(t=be(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),u0(e.strRelID,t),Mr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function SA(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?qr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function TA(e,t){t||(t=be(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Th(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function NA(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function IA(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),o=sv(e),l=db(e,0,r),h=l0(e);e.l=n;var g={Name:o,Ptg:l};return a<268435455&&(g.Sheet=a),h&&(g.Comment=h),g}function kA(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],qi[16]={n:"BrtFRTArchID$",f:NA},Ca(e,function(g,m,p){switch(p){case 156:l.SheetNames.push(g.name),r.Sheets.push(g);break;case 153:r.WBProps=g;break;case 39:g.Sheet!=null&&(t.SID=g.Sheet),g.Ref=Yr(g.Ptg,null,null,l,t),delete t.SID,delete g.Ptg,o.push(g);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,g]):l[0]=[p,g],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(g),l.XTI=l.XTI.concat(g);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!m.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),R1(r),r.Names=o,r.supbooks=l,r}function FA(e,t){Ie(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ie(e,156,CA(a))}Ie(e,144)}function DA(e,t){t||(t=be(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Mr("SheetJS",t),Mr(zo.version,t),Mr(zo.version,t),Mr("7262",t),t.length>t.l?t.slice(0,t.l):t}function OA(e,t){t||(t=be(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function RA(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&o==-1&&(o=n);o>a||(Ie(e,135),Ie(e,158,OA(a)),Ie(e,136))}}function MA(e,t){var r=fn();return Ie(r,131),Ie(r,128,DA()),Ie(r,153,TA(e.Workbook&&e.Workbook.WBProps||null)),RA(r,e),FA(r,e),Ie(r,132),r.end()}function LA(e,t,r){return t.slice(-4)===".bin"?kA(e,r):EA(e,r)}function jA(e,t,r,n,a,o,l,h){return t.slice(-4)===".bin"?QE(e,n,r,a,o,l,h):Ib(e,n,r,a,o,l,h)}function PA(e,t,r,n,a,o,l,h){return t.slice(-4)===".bin"?xA(e,n,r,a,o):dA(e,n,r,a,o)}function BA(e,t,r,n,a,o,l,h){return t.slice(-4)===".bin"?z3():H3()}function UA(e,t,r,n,a,o,l,h){return t.slice(-4)===".bin"?B3():U3()}function zA(e,t,r,n){return t.slice(-4)===".bin"?L_(e,r,n):A_(e,r,n)}function HA(e,t,r){return g1(e,r)}function WA(e,t,r){return t.slice(-4)===".bin"?Wy(e,r):Uy(e,r)}function VA(e,t,r){return t.slice(-4)===".bin"?R3(e,r):C3(e,r)}function GA(e,t,r){return t.slice(-4)===".bin"?b3(e):y3(e)}function XA(e,t,r,n){return r.slice(-4)===".bin"?E3(e,t,r,n):void 0}function YA(e,t,r){return t.slice(-4)===".bin"?p3(e,t,r):w3(e,t,r)}function ZA(e,t,r){return(t.slice(-4)===".bin"?MA:L1)(e)}function $A(e,t,r,n,a){return(t.slice(-4)===".bin"?lA:F1)(e,r,n,a)}function qA(e,t,r){return(t.slice(-4)===".bin"?X_:x1)(e,r)}function KA(e,t,r){return(t.slice(-4)===".bin"?Xy:i1)(e,r)}function QA(e,t,r){return(t.slice(-4)===".bin"?M3:w1)(e)}function JA(e){return(e.slice(-4)===".bin"?v3:p1)()}var j1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,P1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Xn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(j1),o,l,h,g;if(a)for(g=0;g!=a.length;++g)o=a[g].match(P1),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?h="xmlns"+o[1].slice(6):h=o[1].slice(l+1),n[h]=o[2].slice(1,o[2].length-1));return n}function eC(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(j1),a,o,l,h;if(n)for(h=0;h!=n.length;++h)a=n[h].match(P1),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Di;function tC(e,t){var r=Di[e]||Nt(e);return r==="General"?ms(t):Un(r,t)}function rC(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Yt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Zt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Nt(t)]=a}function nC(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Sa[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zi(e.v):e.w=ms(e.v):e.w=tC(t||"General",e.v)}catch(o){if(r.WTF)throw o}try{var n=Di[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&si(n)){var a=ls(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function aC(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=g_[n.Pattern]||n.Pattern)}e[t.ID]=t}function sC(e,t,r,n,a,o,l,h,g,m){var p="General",w=n.StyleID,E={};m=m||{};var A=[],T=0;for(w===void 0&&h&&(w=h.StyleID),w===void 0&&l&&(w=l.StyleID);o[w]!==void 0&&(o[w].nf&&(p=o[w].nf),o[w].Interior&&A.push(o[w].Interior),!!o[w].Parent);)w=o[w].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Yt(e);break;case"String":n.t="s",n.r=Ou(Nt(e)),n.v=e.indexOf("<")>-1?Nt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Zt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Dh[e],m.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Ou(t||e));break}if(nC(n,p,m),m.cellFormula!==!1)if(n.Formula){var _=Nt(n.Formula);_.charCodeAt(0)==61&&(_=_.slice(1)),n.f=$s(_,a),delete n.Formula,n.ArrayRange=="RC"?n.F=$s("RC:RC",a):n.ArrayRange&&(n.F=$s(n.ArrayRange,a),g.push([It(n.F),n.F]))}else for(T=0;T<g.length;++T)a.r>=g[T][0].s.r&&a.r<=g[T][0].e.r&&a.c>=g[T][0].s.c&&a.c<=g[T][0].e.c&&(n.F=g[T][1]);m.cellStyles&&(A.forEach(function(C){!E.patternType&&C.patternType&&(E.patternType=C.patternType)}),n.s=E),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function iC(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function nl(e,t){var r=t||{};ii();var n=Ei(n0(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=jt(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=$t(r);return l.type="string",ei.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){a.indexOf("<"+rt)>=0&&(o=!0)}),o)return GC(n,r);Di={"General Number":"General","General Date":Je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Je[15],"Short Date":Je[14],"Long Time":Je[19],"Medium Time":Je[18],"Short Time":Je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Je[2],Standard:Je[4],Percent:Je[10],Scientific:Je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var h,g=[],m,p={},w=[],E=r.dense?[]:{},A="",T={},_={},C=Xn('<Data ss:Type="String">'),S=0,k=0,N=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},W={},B={},R="",z=0,U=[],fe={},M={},V=0,ne=[],me=[],J={},Ce=[],Ae,at=!1,he=[],Ve=[],Xe={},Q=0,oe=0,te={Sheets:[],WBProps:{date1904:!1}},se={};Vi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ce="";h=Vi.exec(n);)switch(h[3]=(ce=h[3]).toLowerCase()){case"data":if(ce=="data"){if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&g.push([h[3],!0]);break}if(g[g.length-1][1])break;h[1]==="/"?sC(n.slice(S,h.index),R,C,g[g.length-1][0]=="comment"?J:T,{c:k,r:N},W,Ce[k],_,he,r):(R="",C=Xn(h[0]),S=h.index+h[0].length);break;case"cell":if(h[1]==="/")if(me.length>0&&(T.c=me),(!r.sheetRows||r.sheetRows>N)&&T.v!==void 0&&(r.dense?(E[N]||(E[N]=[]),E[N][k]=T):E[tr(k)+gr(N)]=T),T.HRef&&(T.l={Target:Nt(T.HRef)},T.HRefScreenTip&&(T.l.Tooltip=T.HRefScreenTip),delete T.HRef,delete T.HRefScreenTip),(T.MergeAcross||T.MergeDown)&&(Q=k+(parseInt(T.MergeAcross,10)|0),oe=N+(parseInt(T.MergeDown,10)|0),U.push({s:{c:k,r:N},e:{c:Q,r:oe}})),!r.sheetStubs)T.MergeAcross?k=Q+1:++k;else if(T.MergeAcross||T.MergeDown){for(var ie=k;ie<=Q;++ie)for(var ye=N;ye<=oe;++ye)(ie>k||ye>N)&&(r.dense?(E[ye]||(E[ye]=[]),E[ye][ie]={t:"z"}):E[tr(ie)+gr(ye)]={t:"z"});k=Q+1}else++k;else T=eC(h[0]),T.Index&&(k=+T.Index-1),k<F.s.c&&(F.s.c=k),k>F.e.c&&(F.e.c=k),h[0].slice(-2)==="/>"&&++k,me=[];break;case"row":h[1]==="/"||h[0].slice(-2)==="/>"?(N<F.s.r&&(F.s.r=N),N>F.e.r&&(F.e.r=N),h[0].slice(-2)==="/>"&&(_=Xn(h[0]),_.Index&&(N=+_.Index-1)),k=0,++N):(_=Xn(h[0]),_.Index&&(N=+_.Index-1),Xe={},(_.AutoFitHeight=="0"||_.Height)&&(Xe.hpx=parseInt(_.Height,10),Xe.hpt=$i(Xe.hpx),Ve[N]=Xe),_.Hidden=="1"&&(Xe.hidden=!0,Ve[N]=Xe));break;case"worksheet":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"));w.push(A),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(E["!ref"]=ut(F),r.sheetRows&&r.sheetRows<=F.e.r&&(E["!fullref"]=E["!ref"],F.e.r=r.sheetRows-1,E["!ref"]=ut(F))),U.length&&(E["!merges"]=U),Ce.length>0&&(E["!cols"]=Ce),Ve.length>0&&(E["!rows"]=Ve),p[A]=E}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=k=0,g.push([h[3],!1]),m=Xn(h[0]),A=Nt(m.Name),E=r.dense?[]:{},U=[],he=[],Ve=[],se={name:A,Hidden:0},te.Sheets.push(se);break;case"table":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"))}else{if(h[0].slice(-2)=="/>")break;g.push([h[3],!1]),Ce=[],at=!1}break;case"style":h[1]==="/"?aC(W,B,r):B=Xn(h[0]);break;case"numberformat":B.nf=Nt(Xn(h[0]).Format||"General"),Di[B.nf]&&(B.nf=Di[B.nf]);for(var Se=0;Se!=392&&Je[Se]!=B.nf;++Se);if(Se==392){for(Se=57;Se!=392;++Se)if(Je[Se]==null){wa(B.nf,Se);break}}break;case"column":if(g[g.length-1][0]!=="table")break;if(Ae=Xn(h[0]),Ae.Hidden&&(Ae.hidden=!0,delete Ae.Hidden),Ae.Width&&(Ae.wpx=parseInt(Ae.Width,10)),!at&&Ae.wpx>10){at=!0,Zr=d1;for(var Ne=0;Ne<Ce.length;++Ne)Ce[Ne]&&Ya(Ce[Ne])}at&&Ya(Ae),Ce[Ae.Index-1||Ce.length]=Ae;for(var Ye=0;Ye<+Ae.Span;++Ye)Ce[Ce.length]=$t(Ae);break;case"namedrange":if(h[1]==="/")break;te.Names||(te.Names=[]);var ee=nt(h[0]),Ge={Name:ee.Name,Ref:$s(ee.RefersTo.slice(1),{r:0,c:0})};te.Sheets.length>0&&(Ge.Sheet=te.Sheets.length-1),te.Names.push(Ge);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(h[0].slice(-2)==="/>")break;h[1]==="/"?R+=n.slice(z,h.index):z=h.index+h[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=Xn(h[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(h[0].slice(-2)==="/>")break;h[1]==="/"?kv(fe,ce,n.slice(V,h.index)):V=h.index+h[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"))}else g.push([h[3],!1]);break;case"comment":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"));iC(J),me.push(J)}else g.push([h[3],!1]),m=Xn(h[0]),J={a:m.Author};break;case"autofilter":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"))}else if(h[0].charAt(h[0].length-2)!=="/"){var ft=Xn(h[0]);E["!autofilter"]={ref:$s(ft.Range).replace(/\$/g,"")},g.push([h[3],!0])}break;case"name":break;case"datavalidation":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&g.push([h[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(h[1]==="/"){if((m=g.pop())[0]!==h[3])throw new Error("Bad state: "+m.join("|"))}else h[0].charAt(h[0].length-2)!=="/"&&g.push([h[3],!0]);break;case"null":break;default:if(g.length==0&&h[3]=="document"||g.length==0&&h[3]=="uof")return bf(n,r);var _t=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(h[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:_t=!1}break;case"componentoptions":switch(h[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:_t=!1}break;case"excelworkbook":switch(h[3]){case"date1904":te.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:_t=!1}break;case"workbookoptions":switch(h[3]){case"owcversion":break;case"height":break;case"width":break;default:_t=!1}break;case"worksheetoptions":switch(h[3]){case"visible":if(h[0].slice(-2)!=="/>")if(h[1]==="/")switch(n.slice(V,h.index)){case"SheetHidden":se.Hidden=1;break;case"SheetVeryHidden":se.Hidden=2;break}else V=h.index+h[0].length;break;case"header":E["!margins"]||hs(E["!margins"]={},"xlml"),isNaN(+nt(h[0]).Margin)||(E["!margins"].header=+nt(h[0]).Margin);break;case"footer":E["!margins"]||hs(E["!margins"]={},"xlml"),isNaN(+nt(h[0]).Margin)||(E["!margins"].footer=+nt(h[0]).Margin);break;case"pagemargins":var ot=nt(h[0]);E["!margins"]||hs(E["!margins"]={},"xlml"),isNaN(+ot.Top)||(E["!margins"].top=+ot.Top),isNaN(+ot.Left)||(E["!margins"].left=+ot.Left),isNaN(+ot.Right)||(E["!margins"].right=+ot.Right),isNaN(+ot.Bottom)||(E["!margins"].bottom=+ot.Bottom);break;case"displayrighttoleft":te.Views||(te.Views=[]),te.Views[0]||(te.Views[0]={}),te.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":E["!outline"]||(E["!outline"]={}),E["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":E["!outline"]||(E["!outline"]={}),E["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:_t=!1}break;case"pivottable":case"pivotcache":switch(h[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:_t=!1}break;case"pagebreaks":switch(h[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:_t=!1}break;case"autofilter":switch(h[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:_t=!1}break;case"querytable":switch(h[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:_t=!1}break;case"datavalidation":switch(h[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:_t=!1}break;case"sorting":case"conditionalformatting":switch(h[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:_t=!1}break;case"mapinfo":case"schema":case"data":switch(h[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:_t=!1}break;case"smarttags":break;default:_t=!1;break}if(_t||h[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+h[3]+"|"+g.join("|");if(g[g.length-1][0]==="customdocumentproperties"){if(h[0].slice(-2)==="/>")break;h[1]==="/"?rC(M,ce,ne,n.slice(V,h.index)):(ne=h,V=h.index+h[0].length);break}if(r.WTF)throw"Unrecognized tag: "+h[3]+"|"+g.join("|")}var Oe={};return!r.bookSheets&&!r.bookProps&&(Oe.Sheets=p),Oe.SheetNames=w,Oe.Workbook=te,Oe.SSF=$t(Je),Oe.Props=fe,Oe.Custprops=M,Oe}function Fl(e,t){switch(T0(t=t||{}),t.type||"base64"){case"base64":return nl(Sn(e),t);case"binary":case"buffer":case"file":return nl(e,t);case"array":return nl(Ja(e),t)}}function oC(e,t){var r=[];return e.Props&&r.push(Fv(e.Props,t)),e.Custprops&&r.push(Dv(e.Props,e.Custprops)),r.join("")}function cC(){return""}function lC(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var o=[];o.push(Be("NumberFormat",null,{"ss:Format":Mt(Je[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Be("Style",o.join(""),l))}),Be("Styles",r.join(""))}function B1(e){return Be("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_0(e.Ref,{r:0,c:0})})}function uC(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(B1(a)))}return Be("Names",r.join(""))}function fC(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,o=[],l=0;l<a.length;++l){var h=a[l];h.Sheet==r&&(h.Name.match(/^_xlfn\./)||o.push(B1(h)))}return o.join("")}function dC(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Be("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Be("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Be("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Be("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(Hr("ProtectContents","True")),e["!protect"].objects&&a.push(Hr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(Hr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(Hr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(Hr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Be("WorksheetOptions",a.join(""),{xmlns:_n.x})}function hC(e){return e.map(function(t){var r=R2(t.t||""),n=Be("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Be("Comment",n,{"ss:Author":t.a})}).join("")}function xC(e,t,r,n,a,o,l){if(!e||e.v==null&&e.f==null)return"";var h={};if(e.f&&(h["ss:Formula"]="="+Mt(_0(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var g=rr(e.F.slice(t.length+1));h["ss:ArrayRange"]="RC:R"+(g.r==l.r?"":"["+(g.r-l.r)+"]")+"C"+(g.c==l.c?"":"["+(g.c-l.c)+"]")}if(e.l&&e.l.Target&&(h["ss:HRef"]=Mt(e.l.Target),e.l.Tooltip&&(h["x:HRefScreenTip"]=Mt(e.l.Tooltip))),r["!merges"])for(var m=r["!merges"],p=0;p!=m.length;++p)m[p].s.c!=l.c||m[p].s.r!=l.r||(m[p].e.c>m[p].s.c&&(h["ss:MergeAcross"]=m[p].e.c-m[p].s.c),m[p].e.r>m[p].s.r&&(h["ss:MergeDown"]=m[p].e.r-m[p].s.r));var w="",E="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":w="Number",E=String(e.v);break;case"b":w="Boolean",E=e.v?"1":"0";break;case"e":w="Error",E=Sa[e.v];break;case"d":w="DateTime",E=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Je[14]);break;case"s":w="String",E=O2(e.v||"");break}var A=ts(n.cellXfs,e,n);h["ss:StyleID"]="s"+(21+A),h["ss:Index"]=l.c+1;var T=e.v!=null?E:"",_=e.t=="z"?"":'<Data ss:Type="'+w+'">'+T+"</Data>";return(e.c||[]).length>0&&(_+=hC(e.c)),Be("Cell",_,h)}function mC(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ti(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function gC(e,t,r,n){if(!e["!ref"])return"";var a=It(e["!ref"]),o=e["!merges"]||[],l=0,h=[];e["!cols"]&&e["!cols"].forEach(function(C,S){Ya(C);var k=!!C.width,N=bc(S,C),F={"ss:Index":S+1};k&&(F["ss:Width"]=Yi(N.width)),C.hidden&&(F["ss:Hidden"]="1"),h.push(Be("Column",null,F))});for(var g=Array.isArray(e),m=a.s.r;m<=a.e.r;++m){for(var p=[mC(m,(e["!rows"]||[])[m])],w=a.s.c;w<=a.e.c;++w){var E=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>w)&&!(o[l].s.r>m)&&!(o[l].e.c<w)&&!(o[l].e.r<m)){(o[l].s.c!=w||o[l].s.r!=m)&&(E=!0);break}if(!E){var A={r:m,c:w},T=tt(A),_=g?(e[m]||[])[w]:e[T];p.push(xC(_,T,e,t,r,n,A))}}p.push("</Row>"),p.length>2&&h.push(p.join(""))}return h.join("")}function pC(e,t,r){var n=[],a=r.SheetNames[e],o=r.Sheets[a],l=o?fC(o,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?gC(o,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(dC(o,t,e,r)),n.join("")}function vC(e,t){t||(t={}),e.SSF||(e.SSF=$t(Je)),e.SSF&&(ii(),mc(e.SSF),t.revssf=pc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ts(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(oC(e,t)),r.push(cC()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Be("Worksheet",pC(n,t,e),{"ss:Name":Mt(e.SheetNames[n])}));return r[2]=lC(e,t),r[3]=uC(e),pr+Be("Workbook",r.join(""),{xmlns:_n.ss,"xmlns:o":_n.o,"xmlns:x":_n.x,"xmlns:ss":_n.ss,"xmlns:dt":_n.dt,"xmlns:html":_n.html})}function wC(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=uv(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=fv(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var yC=[60,1084,2066,2165,2175];function _C(e,t,r,n,a){var o=n,l=[],h=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&h.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(h)}l.push(h),r.l+=o;for(var g=ga(r,r.l),m=Dl[g],p=0;m!=null&&yC.indexOf(g)>-1;)o=ga(r,r.l+2),p=r.l+4,g==2066?p+=4:(g==2165||g==2175)&&(p+=12),h=r.slice(p,r.l+4+o),l.push(h),r.l+=4+o,m=Dl[g=ga(r,r.l)];var w=Or(l);Ur(w,0);var E=0;w.lens=[];for(var A=0;A<l.length;++A)w.lens.push(E),E+=l[A].length;if(w.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+w.length+" < "+n;return t.f(w,w.length,a)}function na(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Je[n])}catch(o){if(t.WTF)throw o}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Sa[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zi(e.v):e.w=ms(e.v):e.w=Un(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(o){if(t.WTF)throw o}if(t.cellDates&&n&&e.t=="n"&&si(Je[n]||String(n))){var a=ls(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Fo(e,t,r){return{v:e,ixfe:t,t:r}}function bC(e,t){var r={opts:{}},n={},a=t.dense?[]:{},o={},l={},h=null,g=[],m="",p={},w,E="",A,T,_,C,S={},k=[],N,F,W=[],B=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},U=function(dt){return dt<8?us[dt]:dt<64&&B[dt-8]||us[dt]},fe=function(dt,zt,an){var xt=zt.XF.data;if(!(!xt||!xt.patternType||!an||!an.cellStyles)){zt.s={},zt.s.patternType=xt.patternType;var Pe;(Pe=Xi(U(xt.icvFore)))&&(zt.s.fgColor={rgb:Pe}),(Pe=Xi(U(xt.icvBack)))&&(zt.s.bgColor={rgb:Pe})}},M=function(dt,zt,an){if(!(Xe>1)&&!(an.sheetRows&&dt.r>=an.sheetRows)){if(an.cellStyles&&zt.XF&&zt.XF.data&&fe(dt,zt,an),delete zt.ixfe,delete zt.XF,w=dt,E=tt(dt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),dt.r<l.s.r&&(l.s.r=dt.r),dt.c<l.s.c&&(l.s.c=dt.c),dt.r+1>l.e.r&&(l.e.r=dt.r+1),dt.c+1>l.e.c&&(l.e.c=dt.c+1),an.cellFormula&&zt.f){for(var xt=0;xt<k.length;++xt)if(!(k[xt][0].s.c>dt.c||k[xt][0].s.r>dt.r)&&!(k[xt][0].e.c<dt.c||k[xt][0].e.r<dt.r)){zt.F=ut(k[xt][0]),(k[xt][0].s.c!=dt.c||k[xt][0].s.r!=dt.r)&&delete zt.f,zt.f&&(zt.f=""+Yr(k[xt][1],l,dt,he,V));break}}an.dense?(a[dt.r]||(a[dt.r]=[]),a[dt.r][dt.c]=zt):a[E]=zt}},V={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var ne,me=[],J=[],Ce=[],Ae=[],at=!1,he=[];he.SheetNames=V.snames,he.sharedf=V.sharedf,he.arrayf=V.arrayf,he.names=[],he.XTI=[];var Ve=0,Xe=0,Q=0,oe=[],te=[],se;V.codepage=1200,Zn(1200);for(var ce=!1;e.l<e.length-1;){var ie=e.l,ye=e.read_shift(2);if(ye===0&&Ve===10)break;var Se=e.l===e.length?0:e.read_shift(2),Ne=Dl[ye];if(Ne&&Ne.f){if(t.bookSheets&&Ve===133&&ye!==133)break;if(Ve=ye,Ne.r===2||Ne.r==12){var Ye=e.read_shift(2);if(Se-=2,!V.enc&&Ye!==ye&&((Ye&255)<<8|Ye>>8)!==ye)throw new Error("rt mismatch: "+Ye+"!="+ye);Ne.r==12&&(e.l+=10,Se-=10)}var ee={};if(ye===10?ee=Ne.f(e,Se,V):ee=_C(ye,Ne,e,Se,V),Xe==0&&[9,521,1033,2057].indexOf(Ve)===-1)continue;switch(ye){case 34:r.opts.Date1904=R.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=ee,!t.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=ee;break;case 66:var Ge=Number(ee);switch(Ge){case 21010:Ge=1200;break;case 32768:Ge=1e4;break;case 32769:Ge=1252;break}Zn(V.codepage=Ge),ce=!0;break;case 317:V.rrtabid=ee;break;case 25:V.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:V.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(a["!type"]="dialog"),ee.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ee.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:W.push(ee);break;case 430:he.push([ee]),he[he.length-1].XTI=[];break;case 35:case 547:he[he.length-1].push(ee);break;case 24:case 536:se={Name:ee.Name,Ref:Yr(ee.rgce,l,null,he,V)},ee.itab>0&&(se.Sheet=ee.itab-1),he.names.push(se),he[0]||(he[0]=[],he[0].XTI=[]),he[he.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(te[ee.itab-1]={ref:ut(ee.rgce[0][0][1][2])});break;case 22:V.ExternCount=ee;break;case 23:he.length==0&&(he[0]=[],he[0].XTI=[]),he[he.length-1].XTI=he[he.length-1].XTI.concat(ee),he.XTI=he.XTI.concat(ee);break;case 2196:if(V.biff<8)break;se!=null&&(se.Comment=ee[1]);break;case 18:a["!protect"]=ee;break;case 19:ee!==0&&V.WTF&&console.error("Password verifier: "+ee);break;case 133:o[ee.pos]=ee,V.snames.push(ee.name);break;case 10:{if(--Xe)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=ut(l),t.sheetRows&&t.sheetRows<=l.e.r){var ft=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=ut(l),l.e.r=ft}l.e.r++,l.e.c++}me.length>0&&(a["!merges"]=me),J.length>0&&(a["!objects"]=J),Ce.length>0&&(a["!cols"]=Ce),Ae.length>0&&(a["!rows"]=Ae),R.Sheets.push(z)}m===""?p=a:n[m]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[ye]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),V.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(V.biff=5,ce=!0,Zn(V.codepage=28591)),V.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(V.biff=2),Xe++)break;if(a=t.dense?[]:{},V.biff<8&&!ce&&(ce=!0,Zn(V.codepage=t.codepage||1252)),V.biff<5||ee.BIFFVer==0&&ee.dt==4096){m===""&&(m="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var _t={pos:e.l-Se,name:m};o[_t.pos]=_t,V.snames.push(m)}else m=(o[ie]||{name:""}).name;ee.dt==32&&(a["!type"]="chart"),ee.dt==64&&(a["!type"]="macro"),me=[],J=[],V.arrayf=k=[],Ce=[],Ae=[],at=!1,z={Hidden:(o[ie]||{hs:0}).hs,name:m}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[ee.r]||[])[ee.c]:a[tt({c:ee.c,r:ee.r})])&&++ee.c,N={ixfe:ee.ixfe,XF:W[ee.ixfe]||{},v:ee.val,t:"n"},Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ee.c,r:ee.r},N,t);break;case 5:case 517:N={ixfe:ee.ixfe,XF:W[ee.ixfe],v:ee.val,t:ee.t},Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ee.c,r:ee.r},N,t);break;case 638:N={ixfe:ee.ixfe,XF:W[ee.ixfe],v:ee.rknum,t:"n"},Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ee.c,r:ee.r},N,t);break;case 189:for(var ot=ee.c;ot<=ee.C;++ot){var Oe=ee.rkrec[ot-ee.c][0];N={ixfe:Oe,XF:W[Oe],v:ee.rkrec[ot-ee.c][1],t:"n"},Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ot,r:ee.r},N,t)}break;case 6:case 518:case 1030:{if(ee.val=="String"){h=ee;break}if(N=Fo(ee.val,ee.cell.ixfe,ee.tt),N.XF=W[N.ixfe],t.cellFormula){var rt=ee.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var it=rt[0][0][1][0],Jr=rt[0][0][1][1],He=tt({r:it,c:Jr});S[He]?N.f=""+Yr(ee.formula,l,ee.cell,he,V):N.F=((t.dense?(a[it]||[])[Jr]:a[He])||{}).F}else N.f=""+Yr(ee.formula,l,ee.cell,he,V)}Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M(ee.cell,N,t),h=ee}break;case 7:case 519:if(h)h.val=ee,N=Fo(ee,h.cell.ixfe,"s"),N.XF=W[N.ixfe],t.cellFormula&&(N.f=""+Yr(h.formula,l,h.cell,he,V)),Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M(h.cell,N,t),h=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(ee);var Jn=tt(ee[0].s);if(A=t.dense?(a[ee[0].s.r]||[])[ee[0].s.c]:a[Jn],t.cellFormula&&A){if(!h||!Jn||!A)break;A.f=""+Yr(ee[1],l,ee[0],he,V),A.F=ut(ee[0])}}break;case 1212:{if(!t.cellFormula)break;if(E){if(!h)break;S[tt(h.cell)]=ee[0],A=t.dense?(a[h.cell.r]||[])[h.cell.c]:a[tt(h.cell)],(A||{}).f=""+Yr(ee[0],l,w,he,V)}}break;case 253:N=Fo(g[ee.isst].t,ee.ixfe,"s"),g[ee.isst].h&&(N.h=g[ee.isst].h),N.XF=W[N.ixfe],Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ee.c,r:ee.r},N,t);break;case 513:t.sheetStubs&&(N={ixfe:ee.ixfe,XF:W[ee.ixfe],t:"z"},Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ee.c,r:ee.r},N,t));break;case 190:if(t.sheetStubs)for(var Wn=ee.c;Wn<=ee.C;++Wn){var Jt=ee.ixfe[Wn-ee.c];N={ixfe:Jt,XF:W[Jt],t:"z"},Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:Wn,r:ee.r},N,t)}break;case 214:case 516:case 4:N=Fo(ee.val,ee.ixfe,"s"),N.XF=W[N.ixfe],Q>0&&(N.z=oe[N.ixfe>>8&63]),na(N,t,r.opts.Date1904),M({c:ee.c,r:ee.r},N,t);break;case 0:case 512:Xe===1&&(l=ee);break;case 252:g=ee;break;case 1054:if(V.biff==4){oe[Q++]=ee[1];for(var xn=0;xn<Q+163&&Je[xn]!=ee[1];++xn);xn>=163&&wa(ee[1],Q+163)}else wa(ee[1],ee[0]);break;case 30:{oe[Q++]=ee;for(var vr=0;vr<Q+163&&Je[vr]!=ee;++vr);vr>=163&&wa(ee,Q+163)}break;case 229:me=me.concat(ee);break;case 93:J[ee.cmo[0]]=V.lastobj=ee;break;case 438:V.lastobj.TxO=ee;break;case 127:V.lastobj.ImData=ee;break;case 440:for(C=ee[0].s.r;C<=ee[0].e.r;++C)for(_=ee[0].s.c;_<=ee[0].e.c;++_)A=t.dense?(a[C]||[])[_]:a[tt({c:_,r:C})],A&&(A.l=ee[1]);break;case 2048:for(C=ee[0].s.r;C<=ee[0].e.r;++C)for(_=ee[0].s.c;_<=ee[0].e.c;++_)A=t.dense?(a[C]||[])[_]:a[tt({c:_,r:C})],A&&A.l&&(A.l.Tooltip=ee[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;A=t.dense?(a[ee[0].r]||[])[ee[0].c]:a[tt(ee[0])];var Ta=J[ee[2]];A||(t.dense?(a[ee[0].r]||(a[ee[0].r]=[]),A=a[ee[0].r][ee[0].c]={t:"z"}):A=a[tt(ee[0])]={t:"z"},l.e.r=Math.max(l.e.r,ee[0].r),l.s.r=Math.min(l.s.r,ee[0].r),l.e.c=Math.max(l.e.c,ee[0].c),l.s.c=Math.min(l.s.c,ee[0].c)),A.c||(A.c=[]),T={a:ee[1],t:Ta.TxO.t},A.c.push(T)}break;case 2173:l3(W[ee.ixfe],ee.ext);break;case 125:{if(!V.cellStyles)break;for(;ee.e>=ee.s;)Ce[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},at||(at=!0,v0(ee.w/256)),Ya(Ce[ee.e+1])}break;case 520:{var qt={};ee.level!=null&&(Ae[ee.r]=qt,qt.level=ee.level),ee.hidden&&(Ae[ee.r]=qt,qt.hidden=!0),ee.hpt&&(Ae[ee.r]=qt,qt.hpt=ee.hpt,qt.hpx=ti(ee.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||hs(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ye]]=ee;break;case 161:a["!margins"]||hs(a["!margins"]={}),a["!margins"].header=ee.header,a["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(R.Views[0].RTL=!0);break;case 146:B=ee;break;case 2198:ne=ee;break;case 140:F=ee;break;case 442:m?z.CodeName=ee||z.name:R.WBProps.CodeName=ee||"ThisWorkbook";break}}else Ne||console.error("Missing Info for XLS Record 0x"+ye.toString(16)),e.l+=Se}return r.SheetNames=ur(o).sort(function(Ut,dt){return Number(Ut)-Number(dt)}).map(function(Ut){return o[Ut].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&te.forEach(function(Ut,dt){r.Sheets[r.SheetNames[dt]]["!autofilter"]=Ut}),r.Strings=g,r.SSF=$t(Je),V.enc&&(r.Encryption=V.enc),ne&&(r.Themes=ne),r.Metadata={},F!==void 0&&(r.Metadata.Country=F),he.names.length>0&&(R.Names=he.names),r.Workbook=R,r}var Oi={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function EC(e,t,r){var n=$e.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Ku(n,Cl,Oi.DSI);for(var o in a)t[o]=a[o]}catch(m){if(r.WTF)throw m}var l=$e.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var h=Ku(l,Sl,Oi.SI);for(var g in h)t[g]==null&&(t[g]=h[g])}catch(m){if(r.WTF)throw m}t.HeadingPairs&&t.TitlesOfParts&&(Ph(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function AC(e,t){var r=[],n=[],a=[],o=0,l,h=Tu(Cl,"n"),g=Tu(Sl,"n");if(e.Props)for(l=ur(e.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(h,l[o])?r:Object.prototype.hasOwnProperty.call(g,l[o])?n:a).push([l[o],e.Props[l[o]]]);if(e.Custprops)for(l=ur(e.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(h,l[o])?r:Object.prototype.hasOwnProperty.call(g,l[o])?n:a).push([l[o],e.Custprops[l[o]]]);var m=[];for(o=0;o<a.length;++o)Gh.indexOf(a[o][0])>-1||jh.indexOf(a[o][0])>-1||a[o][1]!=null&&m.push(a[o]);n.length&&$e.utils.cfb_add(t,"/SummaryInformation",Qu(n,Oi.SI,g,Sl)),(r.length||m.length)&&$e.utils.cfb_add(t,"/DocumentSummaryInformation",Qu(r,Oi.DSI,h,Cl,m.length?m:null,Oi.UDI))}function U1(e,t){t||(t={}),T0(t),Zl(),t.codepage&&Yl(t.codepage);var r,n;if(e.FullPaths){if($e.find(e,"/encryption"))throw new Error("File is password-protected");r=$e.find(e,"!CompObj"),n=$e.find(e,"/Workbook")||$e.find(e,"/Book")}else{switch(t.type){case"base64":e=En(Sn(e));break;case"binary":e=En(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ur(e,0),n={content:e}}var a,o;if(r&&wC(r),t.bookProps&&!t.bookSheets)a={};else{var l=yt?"buffer":"array";if(n&&n.content)a=bC(n.content,t);else if((o=$e.find(e,"PerfectOffice_MAIN"))&&o.content)a=ds.to_workbook(o.content,(t.type=l,t));else if((o=$e.find(e,"NativeContent_MAIN"))&&o.content)a=ds.to_workbook(o.content,(t.type=l,t));else throw(o=$e.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&$e.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=j3(e))}var h={};return e.FullPaths&&EC(e,h,t),a.Props=a.Custprops=h,t.bookFiles&&(a.cfb=e),a}function CC(e,t){var r=t||{},n=$e.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return $e.utils.cfb_add(n,a,z1(e,r)),r.biff==8&&(e.Props||e.Custprops)&&AC(e,n),r.biff==8&&e.vbaraw&&P3(n,$e.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var qi={0:{f:$b},1:{f:nE},2:{f:bE},3:{f:fE},4:{f:oE},5:{f:wE},6:{f:TE},7:{f:mE},8:{f:RE},9:{f:OE},10:{f:FE},11:{f:DE},12:{f:sE},13:{f:AE},14:{f:hE},15:{f:lE},16:{f:D1},17:{f:IE},18:{f:pE},19:{f:c0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IA},40:{},42:{},43:{f:T_},44:{f:C_},45:{f:k_},46:{f:D_},47:{f:F_},48:{},49:{f:Q2},50:{},51:{f:d3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:r1},62:{f:SE},63:{f:_3},64:{f:qE},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:XE},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tE},148:{f:Qb,p:16},151:{f:UE},152:{},153:{f:SA},154:{},155:{},156:{f:AA},157:{},158:{},159:{T:1,f:Hy},160:{T:-1},161:{T:1,f:Ts},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ME},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:u3},336:{T:-1},337:{f:m3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Al},357:{},358:{},359:{},360:{T:1},361:{},362:{f:t1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:zE},427:{f:HE},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:VE},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:eE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:PE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Al},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:D3},633:{T:1},634:{T:-1},635:{T:1,f:k3},636:{T:-1},637:{f:rv},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:KE},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Dl={6:{f:tl},10:{f:Ma},12:{f:_r},13:{f:_r},14:{f:hr},15:{f:hr},16:{f:$r},17:{f:hr},18:{f:hr},19:{f:_r},20:{f:af},21:{f:af},23:{f:t1},24:{f:of},25:{f:hr},26:{},27:{},28:{f:Kw},29:{},34:{f:hr},35:{f:sf},38:{f:$r},39:{f:$r},40:{f:$r},41:{f:$r},42:{f:hr},43:{f:hr},47:{f:l_},49:{f:Aw},51:{f:_r},60:{},61:{f:ww},64:{f:hr},65:{f:Ew},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:cw},93:{f:ey},94:{},95:{f:hr},96:{},97:{},99:{f:hr},125:{f:r1},128:{f:Bw},129:{f:uw},130:{f:_r},131:{f:hr},132:{f:hr},133:{f:fw},134:{},140:{f:cy},141:{f:_r},144:{},146:{f:fy},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:vy},161:{f:xy},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Mw},190:{f:Lw},193:{f:Ma},197:{},198:{},199:{},200:{},201:{},202:{f:hr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:hr},222:{},224:{f:Pw},225:{f:ow},226:{f:Ma},227:{},229:{f:Qw},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:hw},253:{f:Sw},255:{f:mw},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Xh},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hr},353:{f:Ma},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Vw},431:{f:hr},432:{},433:{},434:{},437:{},438:{f:ny},439:{f:hr},440:{f:ay},441:{},442:{f:io},443:{},444:{f:_r},445:{},446:{},448:{f:Ma},449:{f:vw,r:2},450:{f:Ma},512:{f:tf},513:{f:py},515:{f:Hw},516:{f:Nw},517:{f:nf},519:{f:wy},520:{f:gw},523:{},545:{f:cf},549:{f:ef},566:{},574:{f:_w},638:{f:Rw},659:{},1048:{},1054:{f:kw},1084:{},1212:{f:Zw},2048:{f:iy},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:No},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ma},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:dy,r:12},2173:{f:c3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Yw,r:12},2197:{},2198:{f:r3,r:12},2199:{},2200:{},2201:{},2202:{f:$w,r:12},2203:{f:Ma},2204:{},2205:{},2206:{},2207:{},2211:{f:pw},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:my},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:uy},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:tf},1:{},2:{f:Ay},3:{f:by},4:{f:_y},5:{f:nf},7:{f:Sy},8:{},9:{f:No},11:{},22:{f:_r},30:{f:Dw},31:{},32:{},33:{f:cf},36:{},37:{f:ef},50:{f:Ty},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:yy},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ny},223:{},234:{},354:{},421:{},518:{f:tl},521:{f:No},536:{f:of},547:{f:sf},561:{},579:{},1030:{f:tl},1033:{f:No},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ue(e,t,r,n){var a=t;if(!isNaN(a)){var o=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&s0(r)&&e.push(r)}}function SC(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Ue(e,t,r,a);var o=t;if(!isNaN(o)){for(var l=r.parts||[],h=0,g=0,m=0;m+(l[h]||8224)<=8224;)m+=l[h]||8224,h++;var p=e.next(4);for(p.write_shift(2,o),p.write_shift(2,m),e.push(r.slice(g,g+m)),g+=m;g<a;){for(p=e.next(4),p.write_shift(2,60),m=0;m+(l[h]||8224)<=8224;)m+=l[h]||8224,h++;p.write_shift(2,m),e.push(r.slice(g,g+m)),g+=m}}}function uo(e,t,r){return e||(e=be(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function TC(e,t,r,n){var a=be(9);return uo(a,e,t),Yh(r,n||"b",a),a}function NC(e,t,r){var n=be(8+2*r.length);return uo(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function IC(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Tr(Zt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Ue(e,2,Cy(r,n,a)):Ue(e,3,Ey(r,n,a));return;case"b":case"e":Ue(e,5,TC(r,n,t.v,t.t));return;case"s":case"str":Ue(e,4,NC(r,n,(t.v||"").slice(0,255)));return}Ue(e,1,uo(null,r,n))}function kC(e,t,r,n){var a=Array.isArray(t),o=It(t["!ref"]||"A1"),l,h="",g=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=ut(o)}for(var m=o.s.r;m<=o.e.r;++m){h=gr(m);for(var p=o.s.c;p<=o.e.c;++p){m===o.s.r&&(g[p]=tr(p)),l=g[p]+h;var w=a?(t[m]||[])[p]:t[l];w&&IC(e,w,m,p)}}}function FC(e,t){for(var r=t||{},n=fn(),a=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ue(n,r.biff==4?1033:r.biff==3?521:9,m0(e,16,r)),kC(n,e.Sheets[e.SheetNames[a]],a,r),Ue(n,10),n.end()}function DC(e,t,r){Ue(e,49,Cw({sz:12,name:"Arial"},r))}function OC(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Ue(e,1054,Fw(a,t[a],r))})}function RC(e,t){var r=be(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ue(e,2151,r),r=be(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Qh(It(t["!ref"]||"A1"),r),r.write_shift(4,4),Ue(e,2152,r)}function MC(e,t){for(var r=0;r<16;++r)Ue(e,224,rf({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ue(e,224,rf(n,0,t))})}function LC(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ue(e,440,sy(n)),n[1].Tooltip&&Ue(e,2048,oy(n))}delete t["!links"]}function jC(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Ue(e,125,hy(bc(a,n),a))})}}function PC(e,t,r,n,a){var o=16+ts(a.cellXfs,t,a);if(t.v==null&&!t.bf){Ue(e,513,ws(r,n,o));return}if(t.bf)Ue(e,6,ub(t,r,n,a,o));else switch(t.t){case"d":case"n":var l=t.t=="d"?Tr(Zt(t.v)):t.v;Ue(e,515,Ww(r,n,l,o));break;case"b":case"e":Ue(e,517,zw(r,n,t.v,o,a,t.t));break;case"s":case"str":if(a.bookSST){var h=E0(a.Strings,t.v,a.revStrings);Ue(e,253,Tw(r,n,h,o))}else Ue(e,516,Iw(r,n,(t.v||"").slice(0,255),o,a));break;default:Ue(e,513,ws(r,n,o))}}function BC(e,t,r){var n=fn(),a=r.SheetNames[e],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},h=(l.Sheets||[])[e]||{},g=Array.isArray(o),m=t.biff==8,p,w="",E=[],A=It(o["!ref"]||"A1"),T=m?65536:16384;if(A.e.c>255||A.e.r>=T){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");A.e.c=Math.min(A.e.c,255),A.e.r=Math.min(A.e.c,T-1)}Ue(n,2057,m0(r,16,t)),Ue(n,13,jn(1)),Ue(n,12,jn(100)),Ue(n,15,rn(!0)),Ue(n,17,rn(!1)),Ue(n,16,ps(.001)),Ue(n,95,rn(!0)),Ue(n,42,rn(!1)),Ue(n,43,rn(!1)),Ue(n,130,jn(1)),Ue(n,128,Uw()),Ue(n,131,rn(!1)),Ue(n,132,rn(!1)),m&&jC(n,o["!cols"]),Ue(n,512,Ow(A,t)),m&&(o["!links"]=[]);for(var _=A.s.r;_<=A.e.r;++_){w=gr(_);for(var C=A.s.c;C<=A.e.c;++C){_===A.s.r&&(E[C]=tr(C)),p=E[C]+w;var S=g?(o[_]||[])[C]:o[p];S&&(PC(n,S,_,C,t),m&&S.l&&o["!links"].push([p,S.l]))}}var k=h.CodeName||h.name||a;return m&&Ue(n,574,bw((l.Views||[])[0])),m&&(o["!merges"]||[]).length&&Ue(n,229,Jw(o["!merges"])),m&&LC(n,o),Ue(n,442,Zh(k)),m&&RC(n,o),Ue(n,10),n.end()}function UC(e,t,r){var n=fn(),a=(e||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},h=r.biff==8,g=r.biff==5;if(Ue(n,2057,m0(e,5,r)),r.bookType=="xla"&&Ue(n,135),Ue(n,225,h?jn(1200):null),Ue(n,193,zv(2)),g&&Ue(n,191),g&&Ue(n,192),Ue(n,226),Ue(n,92,lw("SheetJS",r)),Ue(n,66,jn(h?1200:1252)),h&&Ue(n,353,jn(0)),h&&Ue(n,448),Ue(n,317,gy(e.SheetNames.length)),h&&e.vbaraw&&Ue(n,211),h&&e.vbaraw){var m=l.CodeName||"ThisWorkbook";Ue(n,442,Zh(m))}Ue(n,156,jn(17)),Ue(n,25,rn(!1)),Ue(n,18,rn(!1)),Ue(n,19,jn(0)),h&&Ue(n,431,rn(!1)),h&&Ue(n,444,jn(0)),Ue(n,61,yw()),Ue(n,64,rn(!1)),Ue(n,141,jn(0)),Ue(n,34,rn(vA(e)=="true")),Ue(n,14,rn(!0)),h&&Ue(n,439,rn(!1)),Ue(n,218,jn(0)),DC(n,e,r),OC(n,e.SSF,r),MC(n,r),h&&Ue(n,352,rn(!1));var p=n.end(),w=fn();h&&Ue(w,140,ly()),h&&r.Strings&&SC(w,252,xw(r.Strings)),Ue(w,10);var E=w.end(),A=fn(),T=0,_=0;for(_=0;_<e.SheetNames.length;++_)T+=(h?12:11)+(h?2:1)*e.SheetNames[_].length;var C=p.length+T+E.length;for(_=0;_<e.SheetNames.length;++_){var S=o[_]||{};Ue(A,133,dw({pos:C,hs:S.Hidden||0,dt:0,name:e.SheetNames[_]},r)),C+=t[_].length}var k=A.end();if(T!=k.length)throw new Error("BS8 "+T+" != "+k.length);var N=[];return p.length&&N.push(p),k.length&&N.push(k),E.length&&N.push(E),Or(N)}function zC(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=$t(Je)),e&&e.SSF&&(ii(),mc(e.SSF),r.revssf=pc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,N0(r),r.cellXfs=[],ts(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=BC(a,r,e);return n.unshift(UC(e,n,r)),Or(n)}function z1(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=dn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return zC(e,t);case 4:case 3:case 2:return FC(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function vf(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=a.index,h=o&&o.index||e.length,g=C2(e.slice(l,h),/(:?<tr[^>]*>)/i,"<tr>"),m=-1,p=0,w=0,E=0,A={s:{r:1e7,c:1e7},e:{r:0,c:0}},T=[];for(l=0;l<g.length;++l){var _=g[l].trim(),C=_.slice(0,3).toLowerCase();if(C=="<tr"){if(++m,r.sheetRows&&r.sheetRows<=m){--m;break}p=0;continue}if(!(C!="<td"&&C!="<th")){var S=_.split(/<\/t[dh]>/i);for(h=0;h<S.length;++h){var k=S[h].trim();if(k.match(/<t[dh]/i)){for(var N=k,F=0;N.charAt(0)=="<"&&(F=N.indexOf(">"))>-1;)N=N.slice(F+1);for(var W=0;W<T.length;++W){var B=T[W];B.s.c==p&&B.s.r<m&&m<=B.e.r&&(p=B.e.c+1,W=-1)}var R=nt(k.slice(0,k.indexOf(">")));E=R.colspan?+R.colspan:1,((w=+R.rowspan)>1||E>1)&&T.push({s:{r:m,c:p},e:{r:m+(w||1)-1,c:p+E-1}});var z=R.t||R["data-t"]||"";if(!N.length){p+=E;continue}if(N=fh(N),A.s.r>m&&(A.s.r=m),A.e.r<m&&(A.e.r=m),A.s.c>p&&(A.s.c=p),A.e.c<p&&(A.e.c=p),!N.length){p+=E;continue}var U={t:"s",v:N};r.raw||!N.trim().length||z=="s"||(N==="TRUE"?U={t:"b",v:!0}:N==="FALSE"?U={t:"b",v:!1}:isNaN(Kn(N))?isNaN(Js(N).getDate())||(U={t:"d",v:Zt(N)},r.cellDates||(U={t:"n",v:Tr(U.v)}),U.z=r.dateNF||Je[14]):U={t:"n",v:Kn(N)}),r.dense?(n[m]||(n[m]=[]),n[m][p]=U):n[tt({r:m,c:p})]=U,p+=E}}}}return n["!ref"]=ut(A),T.length&&(n["!merges"]=T),n}function HC(e,t,r,n){for(var a=e["!merges"]||[],o=[],l=t.s.c;l<=t.e.c;++l){for(var h=0,g=0,m=0;m<a.length;++m)if(!(a[m].s.r>r||a[m].s.c>l)&&!(a[m].e.r<r||a[m].e.c<l)){if(a[m].s.r<r||a[m].s.c<l){h=-1;break}h=a[m].e.r-a[m].s.r+1,g=a[m].e.c-a[m].s.c+1;break}if(!(h<0)){var p=tt({r,c:l}),w=n.dense?(e[r]||[])[l]:e[p],E=w&&w.v!=null&&(w.h||r0(w.w||(ba(w),w.w)||""))||"",A={};h>1&&(A.rowspan=h),g>1&&(A.colspan=g),n.editable?E='<span contenteditable="true">'+E+"</span>":w&&(A["data-t"]=w&&w.t||"z",w.v!=null&&(A["data-v"]=w.v),w.z!=null&&(A["data-z"]=w.z),w.l&&(w.l.Target||"#").charAt(0)!="#"&&(E='<a href="'+w.l.Target+'">'+E+"</a>")),A.id=(n.id||"sjs")+"-"+p,o.push(Be("td",E,A))}}var T="<tr>";return T+o.join("")+"</tr>"}var WC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VC="</body></html>";function GC(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return es(vf(r[0],t),t);var n=F0();return r.forEach(function(a,o){D0(n,vf(a,t),"Sheet"+(o+1))}),n}function XC(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function H1(e,t){var r=t||{},n=r.header!=null?r.header:WC,a=r.footer!=null?r.footer:VC,o=[n],l=dn(e["!ref"]);r.dense=Array.isArray(e),o.push(XC(e,l,r));for(var h=l.s.r;h<=l.e.r;++h)o.push(HC(e,l,h,r));return o.push("</table>"+a),o.join("")}function W1(e,t,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?rr(n.origin):n.origin;a=l.r,o=l.c}var h=t.getElementsByTagName("tr"),g=Math.min(n.sheetRows||1e7,h.length),m={s:{r:0,c:0},e:{r:a,c:o}};if(e["!ref"]){var p=dn(e["!ref"]);m.s.r=Math.min(m.s.r,p.s.r),m.s.c=Math.min(m.s.c,p.s.c),m.e.r=Math.max(m.e.r,p.e.r),m.e.c=Math.max(m.e.c,p.e.c),a==-1&&(m.e.r=a=p.e.r+1)}var w=[],E=0,A=e["!rows"]||(e["!rows"]=[]),T=0,_=0,C=0,S=0,k=0,N=0;for(e["!cols"]||(e["!cols"]=[]);T<h.length&&_<g;++T){var F=h[T];if(wf(F)){if(n.display)continue;A[_]={hidden:!0}}var W=F.children;for(C=S=0;C<W.length;++C){var B=W[C];if(!(n.display&&wf(B))){var R=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):fh(B.innerHTML),z=B.getAttribute("data-z")||B.getAttribute("z");for(E=0;E<w.length;++E){var U=w[E];U.s.c==S+o&&U.s.r<_+a&&_+a<=U.e.r&&(S=U.e.c+1-o,E=-1)}N=+B.getAttribute("colspan")||1,((k=+B.getAttribute("rowspan")||1)>1||N>1)&&w.push({s:{r:_+a,c:S+o},e:{r:_+a+(k||1)-1,c:S+o+(N||1)-1}});var fe={t:"s",v:R},M=B.getAttribute("data-t")||B.getAttribute("t")||"";R!=null&&(R.length==0?fe.t=M||"z":n.raw||R.trim().length==0||M=="s"||(R==="TRUE"?fe={t:"b",v:!0}:R==="FALSE"?fe={t:"b",v:!1}:isNaN(Kn(R))?isNaN(Js(R).getDate())||(fe={t:"d",v:Zt(R)},n.cellDates||(fe={t:"n",v:Tr(fe.v)}),fe.z=n.dateNF||Je[14]):fe={t:"n",v:Kn(R)})),fe.z===void 0&&z!=null&&(fe.z=z);var V="",ne=B.getElementsByTagName("A");if(ne&&ne.length)for(var me=0;me<ne.length&&!(ne[me].hasAttribute("href")&&(V=ne[me].getAttribute("href"),V.charAt(0)!="#"));++me);V&&V.charAt(0)!="#"&&(fe.l={Target:V}),n.dense?(e[_+a]||(e[_+a]=[]),e[_+a][S+o]=fe):e[tt({c:S+o,r:_+a})]=fe,m.e.c<S+o&&(m.e.c=S+o),S+=N}}++_}return w.length&&(e["!merges"]=(e["!merges"]||[]).concat(w)),m.e.r=Math.max(m.e.r,_-1+a),e["!ref"]=ut(m),_>=g&&(e["!fullref"]=ut((m.e.r=h.length-T+_-1+a,m))),e}function V1(e,t){var r=t||{},n=r.dense?[]:{};return W1(n,e,t)}function YC(e,t){return es(V1(e,t),t)}function wf(e){var t="",r=ZC(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function ZC(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function $C(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(t.replace(/<[^>]*>/g,""));return[r]}var yf={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function G1(e,t){var r=t||{},n=n0(e),a=[],o,l,h={name:""},g="",m=0,p,w,E={},A=[],T=r.dense?[]:{},_,C,S={value:""},k="",N=0,F=[],W=-1,B=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,U={},fe=[],M={},V=0,ne=0,me=[],J=1,Ce=1,Ae=[],at={Names:[]},he={},Ve=["",""],Xe=[],Q={},oe="",te=0,se=!1,ce=!1,ie=0;for(Vi.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");_=Vi.exec(n);)switch(_[3]=_[3].replace(/_.*$/,"")){case"table":case"å·¥ä½è¡¨":_[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?T["!ref"]=ut(R):T["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(T["!fullref"]=T["!ref"],R.e.r=r.sheetRows-1,T["!ref"]=ut(R)),fe.length&&(T["!merges"]=fe),me.length&&(T["!rows"]=me),p.name=p.åç§°||p.name,typeof JSON<"u"&&JSON.stringify(p),A.push(p.name),E[p.name]=T,ce=!1):_[0].charAt(_[0].length-2)!=="/"&&(p=nt(_[0],!1),W=B=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,T=r.dense?[]:{},fe=[],me=[],ce=!0);break;case"table-row-group":_[1]==="/"?--z:++z;break;case"table-row":case"è¡":if(_[1]==="/"){W+=J,J=1;break}if(w=nt(_[0],!1),w.è¡å·?W=w.è¡å·-1:W==-1&&(W=0),J=+w["number-rows-repeated"]||1,J<10)for(ie=0;ie<J;++ie)z>0&&(me[W+ie]={level:z});B=-1;break;case"covered-table-cell":_[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(T[W]||(T[W]=[]),T[W][B]={t:"z"}):T[tt({r:W,c:B})]={t:"z"}),k="",F=[];break;case"table-cell":case"æ°æ®":if(_[0].charAt(_[0].length-2)==="/")++B,S=nt(_[0],!1),Ce=parseInt(S["number-columns-repeated"]||"1",10),C={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(C.f=mf(Nt(S.formula))),(S.æ°æ®ç±»å||S["value-type"])=="string"&&(C.t="s",C.v=Nt(S["string-value"]||""),r.dense?(T[W]||(T[W]=[]),T[W][B]=C):T[tt({r:W,c:B})]=C),B+=Ce-1;else if(_[1]!=="/"){++B,k="",N=0,F=[],Ce=1;var ye=J?W+J-1:W;if(B>R.e.c&&(R.e.c=B),B<R.s.c&&(R.s.c=B),W<R.s.r&&(R.s.r=W),ye>R.e.r&&(R.e.r=ye),S=nt(_[0],!1),Xe=[],Q={},C={t:S.æ°æ®ç±»å||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=Nt(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(V=parseInt(S["number-matrix-rows-spanned"],10)||0,ne=parseInt(S["number-matrix-columns-spanned"],10)||0,M={s:{r:W,c:B},e:{r:W+V-1,c:B+ne-1}},C.F=ut(M),Ae.push([M,C.F])),S.formula)C.f=mf(S.formula);else for(ie=0;ie<Ae.length;++ie)W>=Ae[ie][0].s.r&&W<=Ae[ie][0].e.r&&B>=Ae[ie][0].s.c&&B<=Ae[ie][0].e.c&&(C.F=Ae[ie][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(V=parseInt(S["number-rows-spanned"],10)||0,ne=parseInt(S["number-columns-spanned"],10)||0,M={s:{r:W,c:B},e:{r:W+V-1,c:B+ne-1}},fe.push(M)),S["number-columns-repeated"]&&(Ce=parseInt(S["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=Yt(S["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(S.value);break;case"percentage":C.t="n",C.v=parseFloat(S.value);break;case"currency":C.t="n",C.v=parseFloat(S.value);break;case"date":C.t="d",C.v=Zt(S["date-value"]),r.cellDates||(C.t="n",C.v=Tr(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=b2(S["time-value"])/86400,r.cellDates&&(C.t="d",C.v=vc(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(S.æ°æ®æ°å¼);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",S["string-value"]!=null&&(k=Nt(S["string-value"]),F=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(se=!1,C.t==="s"&&(C.v=k||"",F.length&&(C.R=F),se=N==0),he.Target&&(C.l=he),Xe.length>0&&(C.c=Xe,Xe=[]),k&&r.cellText!==!1&&(C.w=k),se&&(C.t="z",delete C.v),(!se||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=W))for(var Se=0;Se<J;++Se){if(Ce=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(T[W+Se]||(T[W+Se]=[]),T[W+Se][B]=Se==0?C:$t(C);--Ce>0;)T[W+Se][B+Ce]=$t(C);else for(T[tt({r:W+Se,c:B})]=C;--Ce>0;)T[tt({r:W+Se,c:B+Ce})]=$t(C);R.e.c<=B&&(R.e.c=B)}Ce=parseInt(S["number-columns-repeated"]||"1",10),B+=Ce-1,Ce=0,C={},k="",F=[]}he={};break;case"document":case"document-content":case"çµå­è¡¨æ ¼ææ¡£":case"spreadsheet":case"ä¸»ä½":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(_[1]==="/"){if((o=a.pop())[0]!==_[3])throw"Bad state: "+o}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!0]);break;case"annotation":if(_[1]==="/"){if((o=a.pop())[0]!==_[3])throw"Bad state: "+o;Q.t=k,F.length&&(Q.R=F),Q.a=oe,Xe.push(Q)}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!1]);oe="",te=0,k="",N=0,F=[];break;case"creator":_[1]==="/"?oe=n.slice(te,_.index):te=_.index+_[0].length;break;case"meta":case"åæ°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(_[1]==="/"){if((o=a.pop())[0]!==_[3])throw"Bad state: "+o}else _[0].charAt(_[0].length-2)!=="/"&&a.push([_[3],!1]);k="",N=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(_[1]==="/"){if(U[h.name]=g,(o=a.pop())[0]!==_[3])throw"Bad state: "+o}else _[0].charAt(_[0].length-2)!=="/"&&(g="",h=nt(_[0],!1),a.push([_[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=nt(_[0],!1),g+=yf[_[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=nt(_[0],!1),g+=yf[_[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(_[0].slice(-2)==="/>")break;if(_[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":g+=n.slice(m,_.index);break}else m=_.index+_[0].length;break;case"named-range":l=nt(_[0],!1),Ve=rl(l["cell-range-address"]);var Ne={Name:l.name,Ref:Ve[0]+"!"+Ve[1]};ce&&(Ne.Sheet=A.length),at.Names.push(Ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"çµå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"ææ¬ä¸²":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(_[1]==="/"&&(!S||!S["string-value"])){var Ye=$C(n.slice(N,_.index));k=(k.length>0?k+`
`:"")+Ye[0]}else nt(_[0],!1),N=_.index+_[0].length;break;case"s":break;case"database-range":if(_[1]==="/")break;try{Ve=rl(nt(_[0])["target-range-address"]),E[Ve[0]]["!autofilter"]={ref:Ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ é¢":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(_[1]!=="/"){if(he=nt(_[0],!1),!he.href)break;he.Target=Nt(he.href),delete he.href,he.Target.charAt(0)=="#"&&he.Target.indexOf(".")>-1?(Ve=rl(he.Target.slice(1)),he.Target="#"+Ve[0]+"!"+Ve[1]):he.Target.match(/^\.\.[\\\/]/)&&(he.Target=he.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(_[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­:":break;default:if(r.WTF)throw new Error(_)}}var ee={Sheets:E,SheetNames:A,Workbook:at};return r.bookSheets&&delete ee.Sheets,ee}function _f(e,t){t=t||{},Ln(e,"META-INF/manifest.xml")&&bv(yr(e,"META-INF/manifest.xml"),t);var r=An(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=G1(jt(r),t);return Ln(e,"meta.xml")&&(n.Props=Mh(yr(e,"meta.xml"))),n}function bf(e,t){return G1(e,t)}var qC=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pr+t}}(),Ef=function(){var e=function(o){return Mt(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(o,l,h){var g=[];g.push('      <table:table table:name="'+Mt(l.SheetNames[h])+`" table:style-name="ta1">
`);var m=0,p=0,w=dn(o["!ref"]||"A1"),E=o["!merges"]||[],A=0,T=Array.isArray(o);if(o["!cols"])for(p=0;p<=w.e.c;++p)g.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",C=o["!rows"]||[];for(m=0;m<w.s.r;++m)_=C[m]?' table:style-name="ro'+C[m].ods+'"':"",g.push("        <table:table-row"+_+`></table:table-row>
`);for(;m<=w.e.r;++m){for(_=C[m]?' table:style-name="ro'+C[m].ods+'"':"",g.push("        <table:table-row"+_+`>
`),p=0;p<w.s.c;++p)g.push(t);for(;p<=w.e.c;++p){var S=!1,k={},N="";for(A=0;A!=E.length;++A)if(!(E[A].s.c>p)&&!(E[A].s.r>m)&&!(E[A].e.c<p)&&!(E[A].e.r<m)){(E[A].s.c!=p||E[A].s.r!=m)&&(S=!0),k["table:number-columns-spanned"]=E[A].e.c-E[A].s.c+1,k["table:number-rows-spanned"]=E[A].e.r-E[A].s.r+1;break}if(S){g.push(r);continue}var F=tt({r:m,c:p}),W=T?(o[m]||[])[p]:o[F];if(W&&W.f&&(k["table:formula"]=Mt(gb(W.f)),W.F&&W.F.slice(0,F.length)==F)){var B=dn(W.F);k["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,k["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!W){g.push(t);continue}switch(W.t){case"b":N=W.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=W.v?"true":"false";break;case"n":N=W.w||String(W.v||0),k["office:value-type"]="float",k["office:value"]=W.v||0;break;case"s":case"str":N=W.v==null?"":W.v,k["office:value-type"]="string";break;case"d":N=W.w||Zt(W.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Zt(W.v).toISOString(),k["table:style-name"]="ce1";break;default:g.push(t);continue}var R=e(N);if(W.l&&W.l.Target){var z=W.l.Target;z=z.charAt(0)=="#"?"#"+pb(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),R=Be("text:a",R,{"xlink:href":z.replace(/&/g,"&amp;")})}g.push("          "+Be("table:table-cell",Be("text:p",R,{}),k)+`
`)}g.push(`        </table:table-row>
`)}return g.push(`      </table:table>
`),g.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var h=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var p=0;p<m["!cols"].length;++p)if(m["!cols"][p]){var w=m["!cols"][p];if(w.width==null&&w.wpx==null&&w.wch==null)continue;Ya(w),w.ods=h;var E=m["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+E+`"/>
`),o.push(`  </style:style>
`),++h}}});var g=0;l.SheetNames.map(function(m){return l.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var p=0;p<m["!rows"].length;++p)if(m["!rows"][p]){m["!rows"][p].ods=g;var w=m["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+g+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+w+`"/>
`),o.push(`  </style:style>
`),++g}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,h){var g=[pr],m=Wi({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Wi({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(g.push("<office:document"+m+p+`>
`),g.push(Rh().replace(/office:document-meta/g,"office:meta"))):g.push("<office:document-content"+m+`>
`),a(g,l),g.push(`  <office:body>
`),g.push(`    <office:spreadsheet>
`);for(var w=0;w!=l.SheetNames.length;++w)g.push(n(l.Sheets[l.SheetNames[w]],l,w));return g.push(`    </office:spreadsheet>
`),g.push(`  </office:body>
`),h.bookType=="fods"?g.push("</office:document>"):g.push("</office:document-content>"),g.join("")}}();function X1(e,t){if(t.bookType=="fods")return Ef(e,t);var r=Jl(),n="",a=[],o=[];return n="mimetype",ht(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ht(r,n,Ef(e,t)),a.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",ht(r,n,qC(e,t)),a.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",ht(r,n,pr+Rh()),a.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",ht(r,n,Cv(o)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ht(r,n,Ev(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ys(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ol(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):jt(Ja(e))}function KC(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):En(la(e))}function QC(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function $a(e){var t=e.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Af(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function JC(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function eS(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var o=0;a>=1;++o,a/=256)e[t+o]=a&255;e[t+15]|=r>=0?0:128}function Ki(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Dt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function lr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function kt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Ki(e,r),o=a&7;a=Math.floor(a/8);var l=0,h;if(a==0)break;switch(o){case 0:{for(var g=r[0];e[r[0]++]>=128;);h=e.slice(g,r[0])}break;case 5:l=4,h=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,h=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=Ki(e,r),h=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var m={data:h,type:o};t[a]==null?t[a]=[m]:t[a].push(m)}return t}function Br(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Dt(n*8+a.type)),a.type==2&&t.push(Dt(a.data.length)),t.push(a.data))})}),$a(t)}function S0(e,t){return e?.map(function(r){return t(r.data)})||[]}function Rn(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Ki(e,n),o=kt(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:lr(o[1][0].data),messages:[]};o[2].forEach(function(h){var g=kt(h.data),m=lr(g[3][0].data);l.messages.push({meta:g,data:e.slice(n[0],n[0]+m)}),n[0]+=m}),(t=o[3])!=null&&t[0]&&(l.merge=lr(o[3][0].data)>>>0>0),r.push(l)}return r}function Bs(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Dt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Dt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Dt(l.data.length)}],n[2].push({data:Br(l.meta),type:2})});var o=Br(n);t.push(Dt(o.length)),t.push(o),a.forEach(function(l){return t.push(l)})}),$a(t)}function tS(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ki(t,r),a=[];r[0]<t.length;){var o=t[r[0]]&3;if(o==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var h=l-59;l=t[r[0]],h>1&&(l|=t[r[0]+1]<<8),h>2&&(l|=t[r[0]+2]<<16),h>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=h}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var g=0,m=0;if(o==1?(m=(t[r[0]]>>2&7)+4,g=(t[r[0]++]&224)<<3,g|=t[r[0]++]):(m=(t[r[0]++]>>2)+1,o==2?(g=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(g=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[$a(a)],g==0)throw new Error("Invalid offset 0");if(g>a[0].length)throw new Error("Invalid offset beyond length");if(m>=g)for(a.push(a[0].slice(-g)),m-=g;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-g,-g+m))}}var p=$a(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Mn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(tS(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $a(t)}function Us(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var o=Dt(n),l=o.length;t.push(o),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return $a(t)}function rS(e,t,r,n){var a=ys(e),o=a.getUint32(4,!0),l=(n>1?12:8)+Af(o&(n>1?3470:398))*4,h=-1,g=-1,m=NaN,p=new Date(2001,0,1);o&512&&(h=a.getUint32(l,!0),l+=4),l+=Af(o&(n>1?12288:4096))*4,o&16&&(g=a.getUint32(l,!0),l+=4),o&32&&(m=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var w;switch(e[2]){case 0:break;case 2:w={t:"n",v:m};break;case 3:w={t:"s",v:t[g]};break;case 5:w={t:"d",v:p};break;case 6:w={t:"b",v:m>0};break;case 7:w={t:"n",v:m/86400};break;case 8:w={t:"e",v:0};break;case 9:if(h>-1)w={t:"s",v:r[h]};else if(g>-1)w={t:"s",v:t[g]};else if(!isNaN(m))w={t:"n",v:m};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return w}function nS(e,t,r){var n=ys(e),a=n.getUint32(8,!0),o=12,l=-1,h=-1,g=NaN,m=NaN,p=new Date(2001,0,1);a&1&&(g=JC(e,o),o+=16),a&2&&(m=n.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(h=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var w;switch(e[1]){case 0:break;case 2:w={t:"n",v:g};break;case 3:w={t:"s",v:t[h]};break;case 5:w={t:"d",v:p};break;case 6:w={t:"b",v:m>0};break;case 7:w={t:"n",v:m/86400};break;case 8:w={t:"e",v:0};break;case 9:if(l>-1)w={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:w={t:"n",v:g};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return w}function al(e,t){var r=new Uint8Array(32),n=ys(r),a=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2,eS(r,a,e.v),o|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),o|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),r.slice(0,a)}function sl(e,t){var r=new Uint8Array(32),n=ys(r),a=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),o|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),o|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),r.slice(0,a)}function aS(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return rS(e,t,r,e[0]);case 5:return nS(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Xr(e){var t=kt(e);return Ki(t[1][0].data)}function Cf(e,t){var r=kt(t.data),n=lr(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var h=kt(l.data),g=lr(h[1][0].data)>>>0;switch(n){case 1:o[g]=Ol(h[3][0].data);break;case 8:{var m=e[Xr(h[9][0].data)][0],p=kt(m.data),w=e[Xr(p[1][0].data)][0],E=lr(w.meta[1][0].data);if(E!=2001)throw new Error("2000 unexpected reference to ".concat(E));var A=kt(w.data);o[g]=A[3].map(function(T){return Ol(T.data)}).join("")}break}}),o}function sS(e,t){var r,n,a,o,l,h,g,m,p,w,E,A,T,_,C=kt(e),S=lr(C[1][0].data)>>>0,k=lr(C[2][0].data)>>>0,N=((n=(r=C[8])==null?void 0:r[0])==null?void 0:n.data)&&lr(C[8][0].data)>0||!1,F,W;if((o=(a=C[7])==null?void 0:a[0])!=null&&o.data&&t!=0)F=(h=(l=C[7])==null?void 0:l[0])==null?void 0:h.data,W=(m=(g=C[6])==null?void 0:g[0])==null?void 0:m.data;else if((w=(p=C[4])==null?void 0:p[0])!=null&&w.data&&t!=1)F=(A=(E=C[4])==null?void 0:E[0])==null?void 0:A.data,W=(_=(T=C[3])==null?void 0:T[0])==null?void 0:_.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var B=N?4:1,R=ys(F),z=[],U=0;U<F.length/2;++U){var fe=R.getUint16(U*2,!0);fe<65535&&z.push([U,fe])}if(z.length!=k)throw"Expected ".concat(k," cells, found ").concat(z.length);var M=[];for(U=0;U<z.length-1;++U)M[z[U][0]]=W.subarray(z[U][1]*B,z[U+1][1]*B);return z.length>=1&&(M[z[z.length-1][0]]=W.subarray(z[z.length-1][1]*B)),{R:S,cells:M}}function iS(e,t){var r,n=kt(t.data),a=(r=n?.[7])!=null&&r[0]?lr(n[7][0].data)>>>0>0?1:0:-1,o=S0(n[5],function(l){return sS(l,a)});return{nrows:lr(n[4][0].data)>>>0,data:o.reduce(function(l,h){return l[h.R]||(l[h.R]=[]),h.cells.forEach(function(g,m){if(l[h.R][m])throw new Error("Duplicate cell r=".concat(h.R," c=").concat(m));l[h.R][m]=g}),l},[])}}function oS(e,t,r){var n,a=kt(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(lr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(lr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=ut(o);var l=kt(a[4][0].data),h=Cf(e,e[Xr(l[4][0].data)][0]),g=(n=l[17])!=null&&n[0]?Cf(e,e[Xr(l[17][0].data)][0]):[],m=kt(l[3][0].data),p=0;m[1].forEach(function(w){var E=kt(w.data),A=e[Xr(E[2][0].data)][0],T=lr(A.meta[1][0].data);if(T!=6002)throw new Error("6001 unexpected reference to ".concat(T));var _=iS(e,A);_.data.forEach(function(C,S){C.forEach(function(k,N){var F=tt({r:p+S,c:N}),W=aS(k,h,g);W&&(r[F]=W)})}),p+=_.nrows})}function cS(e,t){var r=kt(t.data),n={"!ref":"A1"},a=e[Xr(r[2][0].data)],o=lr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return oS(e,a[0],n),n}function lS(e,t){var r,n=kt(t.data),a={name:(r=n[1])!=null&&r[0]?Ol(n[1][0].data):"",sheets:[]},o=S0(n[2],Xr);return o.forEach(function(l){e[l].forEach(function(h){var g=lr(h.meta[1][0].data);g==6e3&&a.sheets.push(cS(e,h))})}),a}function uS(e,t){var r=F0(),n=kt(t.data),a=S0(n[1],Xr);if(a.forEach(function(o){e[o].forEach(function(l){var h=lr(l.meta[1][0].data);if(h==2){var g=lS(e,l);g.sheets.forEach(function(m,p){D0(r,m,p==0?g.name:g.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function il(e){var t,r,n,a,o={},l=[];if(e.FullPaths.forEach(function(g){if(g.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(g){if(g.name.match(/\.iwa$/)){var m;try{m=Mn(g.content)}catch(w){return console.log("?? "+g.content.length+" "+(w.message||w))}var p;try{p=Rn(m)}catch(w){return console.log("## "+(w.message||w))}p.forEach(function(w){o[w.id]=w.messages,l.push(w.id)})}}),!l.length)throw new Error("File has no messages");var h=((a=(n=(r=(t=o?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&lr(o[1][0].meta[1][0].data)==1&&o[1][0];if(h||l.forEach(function(g){o[g].forEach(function(m){var p=lr(m.meta[1][0].data)>>>0;if(p==1)if(!h)h=m;else throw new Error("Document has multiple roots")})}),!h)throw new Error("Cannot find Document root");return uS(o,h)}function fS(e,t,r){var n,a,o,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var h=((l=(o=e[8])==null?void 0:o[0])==null?void 0:l.data)&&lr(e[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var g=0,m=ys(e[7][0].data),p=0,w=[],E=ys(e[4][0].data),A=0,T=[],_=0;_<t.length;++_){if(t[_]==null){m.setUint16(_*2,65535,!0),E.setUint16(_*2,65535);continue}m.setUint16(_*2,p,!0),E.setUint16(_*2,A,!0);var C,S;switch(typeof t[_]){case"string":C=al({t:"s",v:t[_]},r),S=sl({t:"s",v:t[_]},r);break;case"number":C=al({t:"n",v:t[_]},r),S=sl({t:"n",v:t[_]},r);break;case"boolean":C=al({t:"b",v:t[_]},r),S=sl({t:"b",v:t[_]},r);break;default:throw new Error("Unsupported value "+t[_])}w.push(C),p+=C.length,T.push(S),A+=S.length,++g}for(e[2][0].data=Dt(g);_<e[7][0].data.length/2;++_)m.setUint16(_*2,65535,!0),E.setUint16(_*2,65535,!0);return e[6][0].data=$a(w),e[3][0].data=$a(T),g}function dS(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=dn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ut(n)));var o=ec(r,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(oe){return oe.forEach(function(te){typeof te=="string"&&l.push(te)})});var h={},g=[],m=$e.read(t.numbers,{type:"base64"});m.FileIndex.map(function(oe,te){return[oe,m.FullPaths[te]]}).forEach(function(oe){var te=oe[0],se=oe[1];if(te.type==2&&te.name.match(/\.iwa/)){var ce=te.content,ie=Mn(ce),ye=Rn(ie);ye.forEach(function(Se){g.push(Se.id),h[Se.id]={deps:[],location:se,type:lr(Se.messages[0].meta[1][0].data)}})}}),g.sort(function(oe,te){return oe-te});var p=g.filter(function(oe){return oe>1}).map(function(oe){return[oe,Dt(oe)]});m.FileIndex.map(function(oe,te){return[oe,m.FullPaths[te]]}).forEach(function(oe){var te=oe[0];if(oe[1],!!te.name.match(/\.iwa/)){var se=Rn(Mn(te.content));se.forEach(function(ce){ce.messages.forEach(function(ie){p.forEach(function(ye){ce.messages.some(function(Se){return lr(Se.meta[1][0].data)!=11006&&QC(Se.data,ye[1])})&&h[ye[0]].deps.push(ce.id)})})})}});for(var w=$e.find(m,h[1].location),E=Rn(Mn(w.content)),A,T=0;T<E.length;++T){var _=E[T];_.id==1&&(A=_)}var C=Xr(kt(A.messages[0].data)[1][0].data);for(w=$e.find(m,h[C].location),E=Rn(Mn(w.content)),T=0;T<E.length;++T)_=E[T],_.id==C&&(A=_);for(C=Xr(kt(A.messages[0].data)[2][0].data),w=$e.find(m,h[C].location),E=Rn(Mn(w.content)),T=0;T<E.length;++T)_=E[T],_.id==C&&(A=_);for(C=Xr(kt(A.messages[0].data)[2][0].data),w=$e.find(m,h[C].location),E=Rn(Mn(w.content)),T=0;T<E.length;++T)_=E[T],_.id==C&&(A=_);var S=kt(A.messages[0].data);{S[6][0].data=Dt(n.e.r+1),S[7][0].data=Dt(n.e.c+1);var k=Xr(S[46][0].data),N=$e.find(m,h[k].location),F=Rn(Mn(N.content));{for(var W=0;W<F.length&&F[W].id!=k;++W);if(F[W].id!=k)throw"Bad ColumnRowUIDMapArchive";var B=kt(F[W].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var R=0;R<=n.e.c;++R){var z=[];z[1]=z[2]=[{type:0,data:Dt(R+420690)}],B[1].push({type:2,data:Br(z)}),B[2].push({type:0,data:Dt(R)}),B[3].push({type:0,data:Dt(R)})}B[4]=[],B[5]=[],B[6]=[];for(var U=0;U<=n.e.r;++U)z=[],z[1]=z[2]=[{type:0,data:Dt(U+726270)}],B[4].push({type:2,data:Br(z)}),B[5].push({type:0,data:Dt(U)}),B[6].push({type:0,data:Dt(U)});F[W].messages[0].data=Br(B)}N.content=Us(Bs(F)),N.size=N.content.length,delete S[46];var fe=kt(S[4][0].data);{fe[7][0].data=Dt(n.e.r+1);var M=kt(fe[1][0].data),V=Xr(M[2][0].data);N=$e.find(m,h[V].location),F=Rn(Mn(N.content));{if(F[0].id!=V)throw"Bad HeaderStorageBucket";var ne=kt(F[0].messages[0].data);for(U=0;U<o.length;++U){var me=kt(ne[2][0].data);me[1][0].data=Dt(U),me[4][0].data=Dt(o[U].length),ne[2][U]={type:ne[2][0].type,data:Br(me)}}F[0].messages[0].data=Br(ne)}N.content=Us(Bs(F)),N.size=N.content.length;var J=Xr(fe[2][0].data);N=$e.find(m,h[J].location),F=Rn(Mn(N.content));{if(F[0].id!=J)throw"Bad HeaderStorageBucket";for(ne=kt(F[0].messages[0].data),R=0;R<=n.e.c;++R)me=kt(ne[2][0].data),me[1][0].data=Dt(R),me[4][0].data=Dt(n.e.r+1),ne[2][R]={type:ne[2][0].type,data:Br(me)};F[0].messages[0].data=Br(ne)}N.content=Us(Bs(F)),N.size=N.content.length;var Ce=Xr(fe[4][0].data);(function(){for(var oe=$e.find(m,h[Ce].location),te=Rn(Mn(oe.content)),se,ce=0;ce<te.length;++ce){var ie=te[ce];ie.id==Ce&&(se=ie)}var ye=kt(se.messages[0].data);{ye[3]=[];var Se=[];l.forEach(function(ee,Ge){Se[1]=[{type:0,data:Dt(Ge)}],Se[2]=[{type:0,data:Dt(1)}],Se[3]=[{type:2,data:KC(ee)}],ye[3].push({type:2,data:Br(Se)})})}se.messages[0].data=Br(ye);var Ne=Bs(te),Ye=Us(Ne);oe.content=Ye,oe.size=oe.content.length})();var Ae=kt(fe[3][0].data);{var at=Ae[1][0];delete Ae[2];var he=kt(at.data);{var Ve=Xr(he[2][0].data);(function(){for(var oe=$e.find(m,h[Ve].location),te=Rn(Mn(oe.content)),se,ce=0;ce<te.length;++ce){var ie=te[ce];ie.id==Ve&&(se=ie)}var ye=kt(se.messages[0].data);{delete ye[6],delete Ae[7];var Se=new Uint8Array(ye[5][0].data);ye[5]=[];for(var Ne=0,Ye=0;Ye<=n.e.r;++Ye){var ee=kt(Se);Ne+=fS(ee,o[Ye],l),ee[1][0].data=Dt(Ye),ye[5].push({data:Br(ee),type:2})}ye[1]=[{type:0,data:Dt(n.e.c+1)}],ye[2]=[{type:0,data:Dt(n.e.r+1)}],ye[3]=[{type:0,data:Dt(Ne)}],ye[4]=[{type:0,data:Dt(n.e.r+1)}]}se.messages[0].data=Br(ye);var Ge=Bs(te),ft=Us(Ge);oe.content=ft,oe.size=oe.content.length})()}at.data=Br(he)}fe[3][0].data=Br(Ae)}S[4][0].data=Br(fe)}A.messages[0].data=Br(S);var Xe=Bs(E),Q=Us(Xe);return w.content=Q,w.size=w.content.length,m}function Y1(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function T0(e){Y1([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function N0(e){Y1([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function hS(e){return bt.WS.indexOf(e)>-1?"sheet":e==bt.CS?"chart":e==bt.DS?"dialog":e==bt.MS?"macro":e&&e.length?e:"sheet"}function xS(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,hS(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function mS(e,t,r,n,a,o,l,h,g,m,p,w){try{o[n]=Ii(An(e,r,!0),t);var E=yr(e,t),A;switch(h){case"sheet":A=jA(E,t,a,g,o[n],m,p,w);break;case"chart":if(A=PA(E,t,a,g,o[n],m,p,w),!A||!A["!drawel"])break;var T=Ci(A["!drawel"].Target,t),_=Gi(T),C=A3(An(e,T,!0),Ii(An(e,_,!0),T)),S=Ci(C,T),k=Gi(S);A=fA(An(e,S,!0),S,g,Ii(An(e,k,!0),S),m,A);break;case"macro":A=BA(E,t,a,g,o[n],m,p,w);break;case"dialog":A=UA(E,t,a,g,o[n],m,p,w);break;default:throw new Error("Unrecognized sheet type "+h)}l[n]=A;var N=[];o&&o[n]&&ur(o[n]).forEach(function(F){var W="";if(o[n][F].Type==bt.CMNT){W=Ci(o[n][F].Target,t);var B=VA(yr(e,W,!0),W,g);if(!B||!B.length)return;uf(A,B,!1)}o[n][F].Type==bt.TCMNT&&(W=Ci(o[n][F].Target,t),N=N.concat(S3(yr(e,W,!0),g)))}),N&&N.length&&uf(A,N,!0,g.people||[])}catch(F){if(g.WTF)throw F}}function Dn(e){return e.charAt(0)=="/"?e.slice(1):e}function gS(e,t){if(ii(),t=t||{},T0(t),Ln(e,"META-INF/manifest.xml")||Ln(e,"objectdata.xml"))return _f(e,t);if(Ln(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof il<"u"){if(e.FileIndex)return il(e);var r=$e.utils.cfb_new();return ku(e).forEach(function(me){ht(r,me,T2(e,me))}),il(r)}throw new Error("Unsupported NUMBERS file")}if(!Ln(e,"[Content_Types].xml"))throw Ln(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=ku(e),a=yv(An(e,"[Content_Types].xml")),o=!1,l,h;if(a.workbooks.length===0&&(h="xl/workbook.xml",yr(e,h,!0)&&a.workbooks.push(h)),a.workbooks.length===0){if(h="xl/workbook.bin",!yr(e,h,!0))throw new Error("Could not find workbook");a.workbooks.push(h),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var g={},m={};if(!t.bookSheets&&!t.bookProps){if(ki=[],a.sst)try{ki=WA(yr(e,Dn(a.sst)),a.sst,t)}catch(me){if(t.WTF)throw me}t.cellStyles&&a.themes.length&&(g=HA(An(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(m=zA(yr(e,Dn(a.style)),a.style,g,t))}a.links.map(function(me){try{var J=Ii(An(e,Gi(Dn(me))),me);return XA(yr(e,Dn(me)),J,me,t)}catch{}});var p=LA(yr(e,Dn(a.workbooks[0])),a.workbooks[0],t),w={},E="";a.coreprops.length&&(E=yr(e,Dn(a.coreprops[0]),!0),E&&(w=Mh(E)),a.extprops.length!==0&&(E=yr(e,Dn(a.extprops[0]),!0),E&&Tv(E,w,t)));var A={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(E=An(e,Dn(a.custprops[0]),!0),E&&(A=Iv(E,t)));var T={};if((t.bookSheets||t.bookProps)&&(p.Sheets?l=p.Sheets.map(function(J){return J.name}):w.Worksheets&&w.SheetNames.length>0&&(l=w.SheetNames),t.bookProps&&(T.Props=w,T.Custprops=A),t.bookSheets&&typeof l<"u"&&(T.SheetNames=l),t.bookSheets?T.SheetNames:t.bookProps))return T;l={};var _={};t.bookDeps&&a.calcchain&&(_=GA(yr(e,Dn(a.calcchain)),a.calcchain));var C=0,S={},k,N;{var F=p.Sheets;w.Worksheets=F.length,w.SheetNames=[];for(var W=0;W!=F.length;++W)w.SheetNames[W]=F[W].name}var B=o?"bin":"xml",R=a.workbooks[0].lastIndexOf("/"),z=(a.workbooks[0].slice(0,R+1)+"_rels/"+a.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");Ln(e,z)||(z="xl/_rels/workbook."+B+".rels");var U=Ii(An(e,z,!0),z.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=YA(yr(e,Dn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=N3(yr(e,Dn(a.people[0])),t)),U&&(U=xS(U,p.Sheets));var fe=yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=w.Worksheets;++C){var M="sheet";if(U&&U[C]?(k="xl/"+U[C][1].replace(/[\/]?xl\//,""),Ln(e,k)||(k=U[C][1]),Ln(e,k)||(k=z.replace(/_rels\/.*$/,"")+U[C][1]),M=U[C][2]):(k="xl/worksheets/sheet"+(C+1-fe)+"."+B,k=k.replace(/sheet0\./,"sheet.")),N=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(C!=t.sheets)continue e;break;case"string":if(w.SheetNames[C].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,ne=0;ne!=t.sheets.length;++ne)typeof t.sheets[ne]=="number"&&t.sheets[ne]==C&&(V=1),typeof t.sheets[ne]=="string"&&t.sheets[ne].toLowerCase()==w.SheetNames[C].toLowerCase()&&(V=1);if(!V)continue e}}mS(e,k,N,w.SheetNames[C],C,S,l,M,t,p,g,m)}return T={Directory:a,Workbook:p,Props:w,Custprops:A,Deps:_,Sheets:l,SheetNames:w.SheetNames,Strings:ki,Styles:m,Themes:g,SSF:$t(Je)},t&&t.bookFiles&&(e.files?(T.keys=n,T.files=e.files):(T.keys=[],T.files={},e.FullPaths.forEach(function(me,J){me=me.replace(/^Root Entry[\/]/,""),T.keys.push(me),T.files[me]=e.FileIndex[J]}))),t&&t.bookVBA&&(a.vba.length>0?T.vbaraw=yr(e,Dn(a.vba[0]),!0):a.defaults&&a.defaults.bin===L3&&(T.vbaraw=yr(e,"xl/vbaProject.bin",!0))),T}function pS(e,t){var r=t||{},n="Workbook",a=$e.find(e,n);try{if(n="/!DataSpaces/Version",a=$e.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Yy(a.content),n="/!DataSpaces/DataSpaceMap",a=$e.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=$y(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=$e.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=qy(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=$e.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Qy(a.content)}catch{}if(n="/EncryptionInfo",a=$e.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var h=Jy(a.content);if(n="/EncryptedPackage",a=$e.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(h[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(h[1],a.content,r.password||"",r);if(h[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(h[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function vS(e,t){return t.bookType=="ods"?X1(e,t):t.bookType=="numbers"?dS(e,t):t.bookType=="xlsb"?wS(e,t):yS(e,t)}function wS(e,t){Hs=1024,e&&!e.SSF&&(e.SSF=$t(Je)),e&&e.SSF&&(ii(),mc(e.SSF),t.revssf=pc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fi?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=y1.indexOf(t.bookType)>-1,a=h0();N0(t=t||{});var o=Jl(),l="",h=0;if(t.cellXfs=[],ts(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ht(o,l,Lh(e.Props,t)),a.coreprops.push(l),Ot(t.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(e.SheetNames[m]);e.Props.SheetNames=g}for(e.Props.Worksheets=e.Props.SheetNames.length,ht(o,l,Bh(e.Props)),a.extprops.push(l),Ot(t.rels,3,l,bt.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ht(o,l,Uh(e.Custprops)),a.custprops.push(l),Ot(t.rels,4,l,bt.CUST_PROPS)),h=1;h<=e.SheetNames.length;++h){var p={"!id":{}},w=e.Sheets[e.SheetNames[h-1]],E=(w||{})["!type"]||"sheet";switch(E){case"chart":default:l="xl/worksheets/sheet"+h+"."+r,ht(o,l,$A(h-1,l,t,e,p)),a.sheets.push(l),Ot(t.wbrels,-1,"worksheets/sheet"+h+"."+r,bt.WS[0])}if(w){var A=w["!comments"],T=!1,_="";A&&A.length>0&&(_="xl/comments"+h+"."+r,ht(o,_,QA(A,_)),a.comments.push(_),Ot(p,-1,"../comments"+h+"."+r,bt.CMNT),T=!0),w["!legacy"]&&T&&ht(o,"xl/drawings/vmlDrawing"+h+".vml",v1(h,w["!comments"])),delete w["!comments"],delete w["!legacy"]}p["!id"].rId1&&ht(o,Gi(l),Zs(p))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ht(o,l,KA(t.Strings,l,t)),a.strs.push(l),Ot(t.wbrels,-1,"sharedStrings."+r,bt.SST)),l="xl/workbook."+r,ht(o,l,ZA(e,l)),a.workbooks.push(l),Ot(t.rels,1,l,bt.WB),l="xl/theme/theme1.xml",ht(o,l,w0(e.Themes,t)),a.themes.push(l),Ot(t.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+r,ht(o,l,qA(e,l,t)),a.styles.push(l),Ot(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ht(o,l,e.vbaraw),a.vba.push(l),Ot(t.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+r,ht(o,l,JA(l)),a.metadata.push(l),Ot(t.wbrels,-1,"metadata."+r,bt.XLMETA),ht(o,"[Content_Types].xml",Oh(a,t)),ht(o,"_rels/.rels",Zs(t.rels)),ht(o,"xl/_rels/workbook."+r+".rels",Zs(t.wbrels)),delete t.revssf,delete t.ssf,o}function yS(e,t){Hs=1024,e&&!e.SSF&&(e.SSF=$t(Je)),e&&e.SSF&&(ii(),mc(e.SSF),t.revssf=pc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Fi?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=y1.indexOf(t.bookType)>-1,a=h0();N0(t=t||{});var o=Jl(),l="",h=0;if(t.cellXfs=[],ts(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",ht(o,l,Lh(e.Props,t)),a.coreprops.push(l),Ot(t.rels,2,l,bt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var g=[],m=0;m<e.SheetNames.length;++m)(e.Workbook.Sheets[m]||{}).Hidden!=2&&g.push(e.SheetNames[m]);e.Props.SheetNames=g}e.Props.Worksheets=e.Props.SheetNames.length,ht(o,l,Bh(e.Props)),a.extprops.push(l),Ot(t.rels,3,l,bt.EXT_PROPS),e.Custprops!==e.Props&&ur(e.Custprops||{}).length>0&&(l="docProps/custom.xml",ht(o,l,Uh(e.Custprops)),a.custprops.push(l),Ot(t.rels,4,l,bt.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,h=1;h<=e.SheetNames.length;++h){var w={"!id":{}},E=e.Sheets[e.SheetNames[h-1]],A=(E||{})["!type"]||"sheet";switch(A){case"chart":default:l="xl/worksheets/sheet"+h+"."+r,ht(o,l,F1(h-1,t,e,w)),a.sheets.push(l),Ot(t.wbrels,-1,"worksheets/sheet"+h+"."+r,bt.WS[0])}if(E){var T=E["!comments"],_=!1,C="";if(T&&T.length>0){var S=!1;T.forEach(function(k){k[1].forEach(function(N){N.T==!0&&(S=!0)})}),S&&(C="xl/threadedComments/threadedComment"+h+"."+r,ht(o,C,T3(T,p,t)),a.threadedcomments.push(C),Ot(w,-1,"../threadedComments/threadedComment"+h+"."+r,bt.TCMNT)),C="xl/comments"+h+"."+r,ht(o,C,w1(T)),a.comments.push(C),Ot(w,-1,"../comments"+h+"."+r,bt.CMNT),_=!0}E["!legacy"]&&_&&ht(o,"xl/drawings/vmlDrawing"+h+".vml",v1(h,E["!comments"])),delete E["!comments"],delete E["!legacy"]}w["!id"].rId1&&ht(o,Gi(l),Zs(w))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,ht(o,l,i1(t.Strings,t)),a.strs.push(l),Ot(t.wbrels,-1,"sharedStrings."+r,bt.SST)),l="xl/workbook."+r,ht(o,l,L1(e)),a.workbooks.push(l),Ot(t.rels,1,l,bt.WB),l="xl/theme/theme1.xml",ht(o,l,w0(e.Themes,t)),a.themes.push(l),Ot(t.wbrels,-1,"theme/theme1.xml",bt.THEME),l="xl/styles."+r,ht(o,l,x1(e,t)),a.styles.push(l),Ot(t.wbrels,-1,"styles."+r,bt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",ht(o,l,e.vbaraw),a.vba.push(l),Ot(t.wbrels,-1,"vbaProject.bin",bt.VBA)),l="xl/metadata."+r,ht(o,l,p1()),a.metadata.push(l),Ot(t.wbrels,-1,"metadata."+r,bt.XLMETA),p.length>1&&(l="xl/persons/person.xml",ht(o,l,I3(p)),a.people.push(l),Ot(t.wbrels,-1,"persons/person.xml",bt.PEOPLE)),ht(o,"[Content_Types].xml",Oh(a,t)),ht(o,"_rels/.rels",Zs(t.rels)),ht(o,"xl/_rels/workbook."+r+".rels",Zs(t.wbrels)),delete t.revssf,delete t.ssf,o}function I0(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Sn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function _S(e,t){return $e.find(e,"EncryptedPackage")?pS(e,t):U1(e,t)}function bS(e,t){var r,n=e,a=t||{};return a.type||(a.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),r=ch(n,a),gS(r,a)}function Z1(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Fl(e.slice(r),t);default:break e}return ei.to_workbook(e,t)}function ES(e,t){var r="",n=I0(e,t);switch(t.type){case"base64":r=Sn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=gs(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=jt(r)),t.type="binary",Z1(r,t)}function AS(e,t){var r=e;return t.type=="base64"&&(r=Sn(r)),r=Bi.utils.decode(1200,r.slice(2),"str"),t.type="binary",Z1(r,t)}function CS(e){return e.match(/[^\x00-\x7F]/)?la(e):e}function ol(e,t,r,n){return n?(r.type="string",ei.to_workbook(e,r)):ei.to_workbook(t,r)}function Jo(e,t){Zl();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Jo(new Uint8Array(e),(r=$t(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),qs={},r.dateNF&&(qs.dateNF=r.dateNF),r.type||(r.type=yt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=yt?"buffer":"binary",n=w2(e),typeof Uint8Array<"u"&&!yt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=CS(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),h=new Uint8Array(l);if(h.foo="bar",!h.foo)return r=$t(r),r.type="array",Jo($l(n),r)}switch((a=I0(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return _S($e.read(n,r),r);break;case 9:if(a[1]<=8)return U1(n,r);break;case 60:return Fl(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return ky(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return a1.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?bS(n,r):ol(e,n,r,o);case 239:return a[3]===60?Fl(n,r):ol(e,n,r,o);case 255:if(a[1]===254)return AS(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return ds.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return ds.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return kl.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return f1.to_workbook(n,r);break;case 10:case 13:case 32:return ES(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Iy.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?kl.to_workbook(n,r):ol(e,n,r,o)}function $1(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return no(t.file,$e.write(e,{type:yt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return $e.write(e,t)}function SS(e,t){var r=$t(t||{}),n=vS(e,r);return TS(n,r)}function TS(e,t){var r={},n=yt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?$e.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(xc(a))}return t.password&&typeof encrypt_agile<"u"?$1(encrypt_agile(a,t.password),t):t.type==="file"?no(t.file,a):t.type=="string"?jt(a):a}function NS(e,t){var r=t||{},n=CC(e,r);return $1(n,r)}function sa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ui(la(n));case"binary":return la(n);case"string":return e;case"file":return no(t.file,n,"utf8");case"buffer":return yt?Aa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):sa(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function IS(e,t){switch(t.type){case"base64":return Ui(e);case"binary":return e;case"string":return e;case"file":return no(t.file,e,"binary");case"buffer":return yt?Aa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Do(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ui(r):t.type=="string"?jt(r):r;case"file":return no(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function q1(e,t){Zl(),_A(e);var r=$t(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=q1(e,r);return r.type="array",xc(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return sa(vC(e,r),r);case"slk":case"sylk":return sa(n1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return sa(H1(e.Sheets[e.SheetNames[a]],r),r);case"txt":return IS(K1(e.Sheets[e.SheetNames[a]],r),r);case"csv":return sa(k0(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return sa(a1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Do(kl.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return sa(ei.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return sa(f1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return sa(s1.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return sa(X1(e,r),r);case"wk1":return Do(ds.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Do(ds.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Do(z1(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),NS(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return SS(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function kS(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ec(e,t,r){var n={};return n.type="file",n.file=t,kS(n),q1(e,n)}function FS(e,t,r,n,a,o,l,h){var g=gr(r),m=h.defval,p=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),w=!0,E=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(E,"__rowNum__",{value:r,enumerable:!1})}catch{E.__rowNum__=r}else E.__rowNum__=r;if(!l||e[r])for(var A=t.s.c;A<=t.e.c;++A){var T=l?e[r][A]:e[n[A]+g];if(T===void 0||T.t===void 0){if(m===void 0)continue;o[A]!=null&&(E[o[A]]=m);continue}var _=T.v;switch(T.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+T.t)}if(o[A]!=null){if(_==null)if(T.t=="e"&&_===null)E[o[A]]=null;else if(m!==void 0)E[o[A]]=m;else if(p&&_===null)E[o[A]]=null;else continue;else E[o[A]]=p&&(T.t!=="n"||T.t==="n"&&h.rawNumbers!==!1)?_:ba(T,_,h);_!=null&&(w=!1)}}return{row:E,isempty:w}}function ec(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,h="",g={s:{r:0,c:0},e:{r:0,c:0}},m=t||{},p=m.range!=null?m.range:e["!ref"];switch(m.header===1?n=1:m.header==="A"?n=2:Array.isArray(m.header)?n=3:m.header==null&&(n=0),typeof p){case"string":g=It(p);break;case"number":g=It(e["!ref"]),g.s.r=p;break;default:g=p}n>0&&(a=0);var w=gr(g.s.r),E=[],A=[],T=0,_=0,C=Array.isArray(e),S=g.s.r,k=0,N={};C&&!e[S]&&(e[S]=[]);var F=m.skipHidden&&e["!cols"]||[],W=m.skipHidden&&e["!rows"]||[];for(k=g.s.c;k<=g.e.c;++k)if(!(F[k]||{}).hidden)switch(E[k]=tr(k),r=C?e[S][k]:e[E[k]+w],n){case 1:o[k]=k-g.s.c;break;case 2:o[k]=E[k];break;case 3:o[k]=m.header[k-g.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),h=l=ba(r,null,m),_=N[l]||0,!_)N[l]=1;else{do h=l+"_"+_++;while(N[h]);N[l]=_,N[h]=1}o[k]=h}for(S=g.s.r+a;S<=g.e.r;++S)if(!(W[S]||{}).hidden){var B=FS(e,g,S,E,n,o,C,m);(B.isempty===!1||(n===1?m.blankrows!==!1:m.blankrows))&&(A[T++]=B.row)}return A.length=T,A}var Sf=/"/g;function DS(e,t,r,n,a,o,l,h){for(var g=!0,m=[],p="",w=gr(r),E=t.s.c;E<=t.e.c;++E)if(n[E]){var A=h.dense?(e[r]||[])[E]:e[n[E]+w];if(A==null)p="";else if(A.v!=null){g=!1,p=""+(h.rawNumbers&&A.t=="n"?A.v:ba(A,null,h));for(var T=0,_=0;T!==p.length;++T)if((_=p.charCodeAt(T))===a||_===o||_===34||h.forceQuotes){p='"'+p.replace(Sf,'""')+'"';break}p=="ID"&&(p='"ID"')}else A.f!=null&&!A.F?(g=!1,p="="+A.f,p.indexOf(",")>=0&&(p='"'+p.replace(Sf,'""')+'"')):p="";m.push(p)}return h.blankrows===!1&&g?null:m.join(l)}function k0(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=It(e["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),h=n.RS!==void 0?n.RS:`
`,g=h.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),p="",w=[];n.dense=Array.isArray(e);for(var E=n.skipHidden&&e["!cols"]||[],A=n.skipHidden&&e["!rows"]||[],T=a.s.c;T<=a.e.c;++T)(E[T]||{}).hidden||(w[T]=tr(T));for(var _=0,C=a.s.r;C<=a.e.r;++C)(A[C]||{}).hidden||(p=DS(e,a,C,w,l,g,o,n),p!=null&&(n.strip&&(p=p.replace(m,"")),(p||n.blankrows!==!1)&&r.push((_++?h:"")+p)));return delete n.dense,r.join("")}function K1(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=k0(e,t);return r}function OS(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=It(e["!ref"]),o="",l=[],h,g=[],m=Array.isArray(e);for(h=a.s.c;h<=a.e.c;++h)l[h]=tr(h);for(var p=a.s.r;p<=a.e.r;++p)for(o=gr(p),h=a.s.c;h<=a.e.c;++h)if(t=l[h]+o,r=m?(e[p]||[])[h]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}g[g.length]=t+"="+n}return g}function Q1(e,t,r){var n=r||{},a=+!n.skipHeader,o=e||{},l=0,h=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var g=typeof n.origin=="string"?rr(n.origin):n.origin;l=g.r,h=g.c}var m,p={s:{c:0,r:0},e:{c:h,r:l+t.length-1+a}};if(o["!ref"]){var w=It(o["!ref"]);p.e.c=Math.max(p.e.c,w.e.c),p.e.r=Math.max(p.e.r,w.e.r),l==-1&&(l=w.e.r+1,p.e.r=l+t.length-1+a)}else l==-1&&(l=0,p.e.r=t.length-1+a);var E=n.header||[],A=0;t.forEach(function(_,C){ur(_).forEach(function(S){(A=E.indexOf(S))==-1&&(E[A=E.length]=S);var k=_[S],N="z",F="",W=tt({c:h+A,r:l+C+a});m=Qi(o,W),k&&typeof k=="object"&&!(k instanceof Date)?o[W]=k:(typeof k=="number"?N="n":typeof k=="boolean"?N="b":typeof k=="string"?N="s":k instanceof Date?(N="d",n.cellDates||(N="n",k=Tr(k)),F=n.dateNF||Je[14]):k===null&&n.nullError&&(N="e",k=0),m?(m.t=N,m.v=k,delete m.w,delete m.R,F&&(m.z=F)):o[W]=m={t:N,v:k},F&&(m.z=F))})}),p.e.c=Math.max(p.e.c,h+E.length-1);var T=gr(l);if(a)for(A=0;A<E.length;++A)o[tr(A+h)+T]={t:"s",v:E[A]};return o["!ref"]=ut(p),o}function RS(e,t){return Q1(null,e,t)}function Qi(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=rr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Qi(e,tt(t)):Qi(e,tt({r:t,c:r||0}))}function MS(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function F0(){return{SheetNames:[],Sheets:{}}}function D0(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(M1(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function LS(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=MS(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function jS(e,t){return e.z=t,e}function J1(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function PS(e,t,r){return J1(e,"#"+t,r)}function BS(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function US(e,t,r,n){for(var a=typeof t!="string"?t:It(t),o=typeof t=="string"?t:ut(t),l=a.s.r;l<=a.e.r;++l)for(var h=a.s.c;h<=a.e.c;++h){var g=Qi(e,l,h);g.t="n",g.F=o,delete g.v,l==a.s.r&&h==a.s.c&&(g.f=r,n&&(g.D=!0))}return e}var Rr={encode_col:tr,encode_row:gr,encode_cell:tt,encode_range:ut,decode_col:o0,decode_row:i0,split_cell:K2,decode_cell:rr,decode_range:dn,format_cell:ba,sheet_add_aoa:Sh,sheet_add_json:Q1,sheet_add_dom:W1,aoa_to_sheet:oi,json_to_sheet:RS,table_to_sheet:V1,table_to_book:YC,sheet_to_csv:k0,sheet_to_txt:K1,sheet_to_json:ec,sheet_to_html:H1,sheet_to_formulae:OS,sheet_to_row_object_array:ec,sheet_get_cell:Qi,book_new:F0,book_append_sheet:D0,book_set_sheet_visibility:LS,cell_set_number_format:jS,cell_set_hyperlink:J1,cell_set_internal_link:PS,cell_add_comment:BS,sheet_set_array_formula:US,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const zS=()=>{const e=[{"Asset Name":"BVTR5 - TRACTOR","Filling Date":"2025-11-14","Fuel Type":"Diesel","Quantity (L)":50,"Price per Liter":1.48,"Total Cost":74,"Current Hours":525,Location:"Main Depot","Driver Name":"John Smith","Attendant Name":"Jane Doe","Receipt Number":"SH-20251114-001","Odometer Reading":"",Notes:"Regular refill"},{"Asset Name":"FL3 - FORKLIFT","Filling Date":"2025-11-14","Fuel Type":"Diesel","Quantity (L)":30,"Price per Liter":1.48,"Total Cost":44.4,"Current Hours":1250,Location:"Shell Station","Driver Name":"Mike Johnson","Attendant Name":"Sarah Williams","Receipt Number":"SH-20251114-002","Odometer Reading":"",Notes:""}],t=Rr.json_to_sheet(e);t["!cols"]=[{wch:20},{wch:15},{wch:12},{wch:12},{wch:15},{wch:12},{wch:15},{wch:20},{wch:20},{wch:20},{wch:20},{wch:18},{wch:30}];const r=Rr.book_new();Rr.book_append_sheet(r,t,"Fuel Records Template");const n=[["Bulk Fuel Upload Template Instructions"],[""],["Column Descriptions:"],["Asset Name","REQUIRED - Must match an existing asset name (e.g., BVTR5 - TRACTOR)"],["Filling Date","REQUIRED - Format: YYYY-MM-DD (e.g., 2025-11-14)"],["Fuel Type","REQUIRED - Diesel, Petrol, or other fuel type"],["Quantity (L)","REQUIRED - Fuel quantity in liters (numbers only)"],["Price per Liter","REQUIRED - Price per liter (e.g., 1.48)"],["Total Cost","REQUIRED - Total cost (auto-calculated if blank)"],["Current Hours","REQUIRED - Current hour meter reading for consumption calculation"],["Location","REQUIRED - Refueling location (e.g., Main Depot, Shell Station)"],["Driver Name","OPTIONAL - Name of the driver"],["Attendant Name","OPTIONAL - Name of the filling attendant"],["Receipt Number","OPTIONAL - Receipt/transaction number"],["Odometer Reading","OPTIONAL - Vehicle odometer reading"],["Notes","OPTIONAL - Additional notes or comments"],[""],["Important Notes:"],["1. Asset names must match exactly (including spaces and hyphens)"],["2. Dates must be in YYYY-MM-DD format"],["3. Current Hours must be greater than the asset's last recorded hours"],["4. Required fields cannot be empty"],["5. Remove example rows before uploading your data"],["6. Maximum 100 records per upload"]],a=Rr.aoa_to_sheet(n);a["!cols"]=[{wch:25},{wch:70}],Rr.book_append_sheet(r,a,"Instructions"),Ec(r,`Fuel_Upload_Template_${new Date().toISOString().split("T")[0]}.xlsx`)},ex=(e,t)=>{const r=e.map(p=>{const w=t.find(A=>A.id===p.asset_id),E=p.filling_date?new Date(p.filling_date).toISOString().split("T")[0]:new Date(p.date).toISOString().split("T")[0];return{"Asset Name":w?.name||"Unknown","Filling Date":E,"Fuel Type":p.fuel_type,"Quantity (L)":p.quantity,"Price per Liter":p.price_per_liter,"Total Cost":p.cost,"Current Hours":p.current_hours??"",Location:p.location,"Driver Name":p.driver_name||"","Attendant Name":p.attendant_name||"","Receipt Number":p.receipt_number||"","Odometer Reading":p.odometer_reading??"",Notes:p.notes||""}}),n=Rr.json_to_sheet(r);n["!cols"]=[{wch:20},{wch:15},{wch:12},{wch:12},{wch:15},{wch:12},{wch:15},{wch:20},{wch:20},{wch:20},{wch:20},{wch:18},{wch:30}];const a=Rr.book_new();Rr.book_append_sheet(a,n,"Fuel Records");const o=e.reduce((p,w)=>p+w.quantity,0),l=e.reduce((p,w)=>p+w.cost,0),h=e.filter(p=>p.consumption_rate&&p.consumption_rate>0).reduce((p,w)=>p+(w.consumption_rate||0),0)/e.filter(p=>p.consumption_rate&&p.consumption_rate>0).length,g=[["Fuel Records Export Summary"],["Export Date",new Date().toISOString()],[""],["Total Records",e.length],["Total Fuel Quantity (L)",o.toFixed(2)],["Total Cost",`$${l.toFixed(2)}`],["Average Consumption Rate (L/h)",h?h.toFixed(2):"N/A"],[""],["Fuel Type Breakdown"],...Object.entries(e.reduce((p,w)=>(p[w.fuel_type]=(p[w.fuel_type]||0)+w.quantity,p),{})).map(([p,w])=>[p,`${w.toFixed(2)} L`])],m=Rr.aoa_to_sheet(g);m["!cols"]=[{wch:30},{wch:25}],Rr.book_append_sheet(a,m,"Summary"),Ec(a,`Fuel_Records_Export_${new Date().toISOString().split("T")[0]}.xlsx`)},HS=async(e,t)=>new Promise((r,n)=>{const a=new FileReader;a.onload=o=>{try{const l=o.target?.result;if(!l){n(new Error("Failed to read file data"));return}const h=Jo(l,{type:"binary"}),g=h.SheetNames[0];if(!g){n(new Error("No sheets found in workbook"));return}const m=h.Sheets[g];if(!m){n(new Error("Failed to read worksheet"));return}const p=Rr.sheet_to_json(m),w=[],E=[];p.forEach((A,T)=>{const _=T+2,C=[],S=t.find(B=>B.name===A["Asset Name"]?.trim());A["Asset Name"]?S||C.push({row:_,field:"Asset Name",message:`Asset "${A["Asset Name"]}" not found`}):C.push({row:_,field:"Asset Name",message:"Asset Name is required"});const k=A["Filling Date"];k?/^\d{4}-\d{2}-\d{2}$/.test(k)||C.push({row:_,field:"Filling Date",message:"Date must be in YYYY-MM-DD format"}):C.push({row:_,field:"Filling Date",message:"Filling Date is required"}),A["Fuel Type"]||C.push({row:_,field:"Fuel Type",message:"Fuel Type is required"});const N=Number(A["Quantity (L)"]);(!A["Quantity (L)"]||isNaN(N)||N<=0)&&C.push({row:_,field:"Quantity (L)",message:"Quantity must be a positive number"});const F=Number(A["Price per Liter"]);(!A["Price per Liter"]||isNaN(F)||F<=0)&&C.push({row:_,field:"Price per Liter",message:"Price per Liter must be a positive number"});const W=A["Current Hours"]?Number(A["Current Hours"]):null;if(W!==null&&(isNaN(W)||W<0?C.push({row:_,field:"Current Hours",message:"Current Hours must be a non-negative number"}):S&&S.current_hours&&W<=S.current_hours&&C.push({row:_,field:"Current Hours",message:`Current Hours (${W}) must be greater than asset's last recorded hours (${S.current_hours})`})),A.Location||C.push({row:_,field:"Location",message:"Location is required"}),C.length===0&&S){const B=A["Total Cost"]?Number(A["Total Cost"]):N*F,R=S.current_hours,z=W&&R?W-R:null,U=z&&z>0?N/z:null;w.push({asset_id:S.id,filling_date:k,date:new Date().toISOString(),fuel_type:A["Fuel Type"].trim(),quantity:N,price_per_liter:F,cost:B,current_hours:W,previous_hours:R,hour_difference:z,consumption_rate:U,location:A.Location.trim(),driver_name:A["Driver Name"]?.trim()||null,attendant_name:A["Attendant Name"]?.trim()||null,receipt_number:A["Receipt Number"]?.trim()||null,odometer_reading:A["Odometer Reading"]?Number(A["Odometer Reading"]):null,notes:A.Notes?.trim()||null,operator_id:null,fuel_grade:null,weather_conditions:null})}else E.push(...C)}),r({records:w,errors:E})}catch(l){n(l instanceof Error?l:new Error(String(l)))}},a.onerror=()=>n(new Error("Failed to read file")),a.readAsBinaryString(e)}),WS=({fuelRecords:e,assets:t})=>{const[r,n]=Y.useState({assetId:"",driverId:"",farmLocation:"",dateFrom:"",dateTo:"",fuelType:""}),[a,o]=Y.useState("overview"),l=Y.useMemo(()=>{const S=new Set;return e.forEach(k=>{k.driver_name&&S.add(k.driver_name)}),Array.from(S).sort()},[e]),h=Y.useMemo(()=>{const S=new Set;return t.forEach(k=>{k.location&&S.add(k.location)}),e.forEach(k=>{k.location&&S.add(k.location)}),Array.from(S).sort()},[t,e]),g=Y.useMemo(()=>{const S=new Set;return e.forEach(k=>S.add(k.fuel_type)),Array.from(S).sort()},[e]),m=Y.useMemo(()=>e.filter(S=>{if(r.assetId&&S.asset_id!==r.assetId||r.driverId&&S.driver_name!==r.driverId||r.fuelType&&S.fuel_type!==r.fuelType)return!1;if(r.farmLocation){const k=t.find(N=>N.id===S.asset_id);if(!k||k.location!==r.farmLocation)return!1}return!(r.dateFrom&&new Date(S.filling_date||S.date)<new Date(r.dateFrom)||r.dateTo&&new Date(S.filling_date||S.date)>new Date(r.dateTo))}),[e,t,r]),p=Y.useMemo(()=>{const S=new Map;return m.forEach(N=>{const F=t.find(B=>B.id===N.asset_id);if(!F)return;const W=S.get(F.id)||{assetId:F.id,assetName:F.name,totalFuelQuantity:0,totalCost:0,averageConsumption:0,costPerHour:0,totalHours:0,recordCount:0,averageFuelEfficiency:0};W.totalFuelQuantity+=N.quantity,W.totalCost+=N.cost,W.recordCount+=1,N.hour_difference&&(W.totalHours+=N.hour_difference),S.set(F.id,W)}),Array.from(S.values()).map(N=>{const F=m.filter(W=>W.asset_id===N.assetId&&W.consumption_rate).map(W=>W.consumption_rate);return N.averageConsumption=F.length>0?F.reduce((W,B)=>W+B,0)/F.length:0,N.costPerHour=N.totalHours>0?N.totalCost/N.totalHours:0,N.averageFuelEfficiency=N.averageConsumption>0?1/N.averageConsumption:0,N}).sort((N,F)=>F.totalCost-N.totalCost)},[m,t]),w=Y.useMemo(()=>{const S=new Map;return m.forEach(N=>{if(!N.driver_name)return;const F=S.get(N.driver_name)||{driverName:N.driver_name,totalFuelQuantity:0,totalCost:0,averageConsumption:0,costPerHour:0,totalHours:0,recordCount:0,assetsOperated:0};F.totalFuelQuantity+=N.quantity,F.totalCost+=N.cost,F.recordCount+=1,N.hour_difference&&(F.totalHours+=N.hour_difference),S.set(N.driver_name,F)}),Array.from(S.values()).map(N=>{const F=m.filter(R=>R.driver_name===N.driverName),W=new Set(F.map(R=>R.asset_id));N.assetsOperated=W.size;const B=F.filter(R=>R.consumption_rate).map(R=>R.consumption_rate);return N.averageConsumption=B.length>0?B.reduce((R,z)=>R+z,0)/B.length:0,N.costPerHour=N.totalHours>0?N.totalCost/N.totalHours:0,N}).sort((N,F)=>F.totalCost-N.totalCost)},[m]),E=Y.useMemo(()=>{const S=new Map;return m.forEach(N=>{const W=t.find(R=>R.id===N.asset_id)?.location||"Unknown",B=S.get(W)||{location:W,totalFuelQuantity:0,totalCost:0,averageConsumption:0,costPerHour:0,totalHours:0,recordCount:0,assetsCount:0};B.totalFuelQuantity+=N.quantity,B.totalCost+=N.cost,B.recordCount+=1,N.hour_difference&&(B.totalHours+=N.hour_difference),S.set(W,B)}),Array.from(S.values()).map(N=>{const F=m.filter(R=>t.find(U=>U.id===R.asset_id)?.location===N.location),W=new Set(F.map(R=>R.asset_id));N.assetsCount=W.size;const B=F.filter(R=>R.consumption_rate).map(R=>R.consumption_rate);return N.averageConsumption=B.length>0?B.reduce((R,z)=>R+z,0)/B.length:0,N.costPerHour=N.totalHours>0?N.totalCost/N.totalHours:0,N}).sort((N,F)=>F.totalCost-N.totalCost)},[m,t]),A=Y.useMemo(()=>{const S=m.reduce((z,U)=>z+U.quantity,0),k=m.reduce((z,U)=>z+U.cost,0),N=m.reduce((z,U)=>z+(U.hour_difference||0),0),F=m.filter(z=>z.consumption_rate&&z.consumption_rate>0).map(z=>z.consumption_rate),W=F.length>0?F.reduce((z,U)=>z+U,0)/F.length:0,B=Math.max(...p.map(z=>z.costPerHour),0),R=Math.min(...p.filter(z=>z.costPerHour>0).map(z=>z.costPerHour),1/0);return{totalQuantity:S,totalCost:k,totalHours:N,avgConsumption:W,costPerHour:N>0?k/N:0,highestCostPerHour:B>0?B:0,lowestCostPerHour:R!==1/0?R:0,recordCount:m.length}},[m,p]),T=()=>{n({assetId:"",driverId:"",farmLocation:"",dateFrom:"",dateTo:"",fuelType:""})},_=()=>{ex(m,t)},C=Object.values(r).filter(S=>S!=="").length;return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(pd,{className:"h-5 w-5 text-gray-600"}),f.jsx("h3",{className:"text-lg font-semibold",children:"Filters"}),C>0&&f.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:[C," active"]})]}),f.jsxs("div",{className:"flex gap-2",children:[C>0&&f.jsx("button",{onClick:T,className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Clear All"}),f.jsxs("button",{onClick:_,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[f.jsx(vd,{className:"h-4 w-4"}),"Export Report"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset"}),f.jsxs("select",{value:r.assetId,onChange:S=>n({...r,assetId:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"All Assets"}),t.map(S=>f.jsx("option",{value:S.id,children:S.name},S.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver"}),f.jsxs("select",{value:r.driverId,onChange:S=>n({...r,driverId:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"All Drivers"}),l.map(S=>f.jsx("option",{value:S,children:S},S))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Farm Location"}),f.jsxs("select",{value:r.farmLocation,onChange:S=>n({...r,farmLocation:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"All Locations"}),h.map(S=>f.jsx("option",{value:S,children:S},S))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Type"}),f.jsxs("select",{value:r.fuelType,onChange:S=>n({...r,fuelType:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"All Types"}),g.map(S=>f.jsx("option",{value:S,children:S},S))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date From"}),f.jsx("input",{type:"date",value:r.dateFrom,onChange:S=>n({...r,dateFrom:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date To"}),f.jsx("input",{type:"date",value:r.dateTo,onChange:S=>n({...r,dateTo:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Total Fuel"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[A.totalQuantity.toFixed(1),"L"]}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[A.recordCount," records"]})]}),f.jsx(vm,{className:"h-12 w-12 text-blue-500 opacity-20"})]})}),f.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Total Cost"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",A.totalCost.toFixed(2)]}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["$",A.costPerHour.toFixed(2),"/hr avg"]})]}),f.jsx(wd,{className:"h-12 w-12 text-green-500 opacity-20"})]})}),f.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Avg Consumption"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[A.avgConsumption.toFixed(2)," L/h"]}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[A.totalHours.toFixed(0)," hrs total"]})]}),f.jsx(gd,{className:"h-12 w-12 text-orange-500 opacity-20"})]})}),f.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Cost/Hour Range"}),f.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",A.highestCostPerHour.toFixed(2)]}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Low: $",A.lowestCostPerHour.toFixed(2)]})]}),f.jsx(oc,{className:"h-12 w-12 text-red-500 opacity-20"})]})})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow-md",children:[f.jsx("div",{className:"border-b border-gray-200",children:f.jsxs("div",{className:"flex overflow-x-auto",children:[f.jsxs("button",{onClick:()=>o("overview"),className:`flex items-center gap-2 px-6 py-3 font-medium text-sm whitespace-nowrap ${a==="overview"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[f.jsx(Qs,{className:"h-4 w-4"}),"Overview"]}),f.jsxs("button",{onClick:()=>o("assets"),className:`flex items-center gap-2 px-6 py-3 font-medium text-sm whitespace-nowrap ${a==="assets"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[f.jsx(qn,{className:"h-4 w-4"}),"By Asset (",p.length,")"]}),f.jsxs("button",{onClick:()=>o("drivers"),className:`flex items-center gap-2 px-6 py-3 font-medium text-sm whitespace-nowrap ${a==="drivers"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[f.jsx(Ul,{className:"h-4 w-4"}),"By Driver (",w.length,")"]}),f.jsxs("button",{onClick:()=>o("farms"),className:`flex items-center gap-2 px-6 py-3 font-medium text-sm whitespace-nowrap ${a==="farms"?"border-b-2 border-blue-600 text-blue-600":"text-gray-600 hover:text-gray-900"}`,children:[f.jsx(qn,{className:"h-4 w-4"}),"By Farm (",E.length,")"]})]})}),f.jsxs("div",{className:"p-6",children:[a==="overview"&&f.jsxs("div",{className:"space-y-6",children:[f.jsx("h3",{className:"text-lg font-semibold",children:"Summary Overview"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"border rounded-lg p-4",children:[f.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Top 5 Assets by Cost"}),f.jsx("div",{className:"space-y-2",children:p.slice(0,5).map((S,k)=>f.jsxs("div",{className:"flex justify-between items-center text-sm",children:[f.jsxs("span",{className:"text-gray-600",children:[k+1,". ",S.assetName]}),f.jsxs("span",{className:"font-medium",children:["$",S.totalCost.toFixed(2)]})]},S.assetId))})]}),f.jsxs("div",{className:"border rounded-lg p-4",children:[f.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Top 5 Drivers by Cost"}),f.jsx("div",{className:"space-y-2",children:w.slice(0,5).map((S,k)=>f.jsxs("div",{className:"flex justify-between items-center text-sm",children:[f.jsxs("span",{className:"text-gray-600",children:[k+1,". ",S.driverName]}),f.jsxs("span",{className:"font-medium",children:["$",S.totalCost.toFixed(2)]})]},S.driverName))})]}),f.jsxs("div",{className:"border rounded-lg p-4",children:[f.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Farms by Cost"}),f.jsx("div",{className:"space-y-2",children:E.map((S,k)=>f.jsxs("div",{className:"flex justify-between items-center text-sm",children:[f.jsxs("span",{className:"text-gray-600",children:[k+1,". ",S.location]}),f.jsxs("span",{className:"font-medium",children:["$",S.totalCost.toFixed(2)]})]},S.location))})]})]})]}),a==="assets"&&f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Asset"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Fuel"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Cost"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Cost/Hour"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Avg L/h"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Hours"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Records"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(S=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:S.assetName}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:[S.totalFuelQuantity.toFixed(1),"L"]}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:["$",S.totalCost.toFixed(2)]}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-red-600",children:["$",S.costPerHour.toFixed(2)]}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:S.averageConsumption.toFixed(2)}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:[S.totalHours.toFixed(0),"h"]}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-600",children:S.recordCount})]},S.assetId))})]})}),a==="drivers"&&f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Driver"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Fuel"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Cost"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Cost/Hour"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Avg L/h"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Hours"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Assets"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Records"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:w.map(S=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:S.driverName}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:[S.totalFuelQuantity.toFixed(1),"L"]}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:["$",S.totalCost.toFixed(2)]}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-red-600",children:["$",S.costPerHour.toFixed(2)]}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:S.averageConsumption.toFixed(2)}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:[S.totalHours.toFixed(0),"h"]}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-600",children:S.assetsOperated}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-600",children:S.recordCount})]},S.driverName))})]})}),a==="farms"&&f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Farm Location"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Fuel"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Cost"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Cost/Hour"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Avg L/h"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total Hours"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Assets"}),f.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Records"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:E.map(S=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:S.location}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:[S.totalFuelQuantity.toFixed(1),"L"]}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:["$",S.totalCost.toFixed(2)]}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right font-medium text-red-600",children:["$",S.costPerHour.toFixed(2)]}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:S.averageConsumption.toFixed(2)}),f.jsxs("td",{className:"px-4 py-3 text-sm text-right text-gray-900",children:[S.totalHours.toFixed(0),"h"]}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-600",children:S.assetsCount}),f.jsx("td",{className:"px-4 py-3 text-sm text-right text-gray-600",children:S.recordCount})]},S.location))})]})})]})]})]})};class VS{assets;fuelRecords;operatingSessions;constructor(t,r,n){this.assets=t,this.fuelRecords=r,this.operatingSessions=n}calculateFuelConsumptionRate(t){const r=t?this.operatingSessions.filter(o=>o.asset_id===t):this.operatingSessions,n=r.reduce((o,l)=>o+(l.fuel_consumed??0),0),a=r.reduce((o,l)=>o+(l.operating_hours??0),0);return a>0?n/a:0}calculateAverageFleetConsumption(){return this.calculateFuelConsumptionRate()}calculateEquipmentTypeAverages(){const t={};return[...new Set(this.assets.map(n=>n.type))].forEach(n=>{const o=this.assets.filter(m=>m.type===n).map(m=>m.id),l=this.operatingSessions.filter(m=>m.asset_id&&o.includes(m.asset_id)),h=l.reduce((m,p)=>m+(p.fuel_consumed??0),0),g=l.reduce((m,p)=>m+(p.operating_hours??0),0);t[n]=g>0?h/g:0}),t}calculateFuelCostPerHour(t){const r=this.calculateFuelConsumptionRate(t),n=this.getAverageFuelPrice();return r*n}calculateTotalEquipmentFuelCost(t){return(t?this.fuelRecords.filter(n=>n.asset_id===t):this.fuelRecords).reduce((n,a)=>n+a.cost,0)}calculateFuelCostPercentage(t){const r=this.calculateTotalEquipmentFuelCost();return t>0?r/t*100:0}calculateTaskSpecificConsumption(){const t=new Map;this.operatingSessions.forEach(n=>{const a=n.operator_notes?.split("-")[0]?.trim().toLowerCase()||"general operations",o=t.get(a)??{fuel:0,hours:0};t.set(a,{fuel:o.fuel+(n.fuel_consumed??0),hours:o.hours+(n.operating_hours??0)})});const r={};return t.forEach((n,a)=>{r[a]=n.hours>0?n.fuel/n.hours:0}),r}calculateOperatorEfficiency(){const t=new Map;this.operatingSessions.forEach(n=>{const a=this.assets.find(h=>h.id===n.asset_id),o=a?a.name:"Unknown Asset",l=t.get(o)??{fuel:0,hours:0};t.set(o,{fuel:l.fuel+(n.fuel_consumed??0),hours:l.hours+(n.operating_hours??0)})});const r={};return t.forEach((n,a)=>{r[a]=n.hours>0?n.fuel/n.hours:0}),r}calculateMonthlyTrends(){const t={};return this.operatingSessions.forEach(r=>{const n=new Date(r.session_start??r.created_at).toISOString().substring(0,7);t[n]||(t[n]={fuel:0,hours:0,cost:0}),t[n].fuel+=r.fuel_consumed??0,t[n].hours+=r.operating_hours??0}),this.fuelRecords.forEach(r=>{const n=new Date(r.created_at).toISOString().substring(0,7);t[n]&&(t[n].cost+=r.cost)}),Object.entries(t).map(([r,n])=>({month:r,consumption:n.hours>0?n.fuel/n.hours:0,cost:n.cost})).sort((r,n)=>r.month.localeCompare(n.month))}getAverageFuelPrice(){if(this.fuelRecords.length===0)return 0;const t=this.fuelRecords.reduce((n,a)=>n+a.cost,0),r=this.fuelRecords.reduce((n,a)=>n+a.quantity,0);return r>0?t/r:0}calculateAllKPIs(t=1e6){const r=this.operatingSessions.reduce((o,l)=>o+(l.operating_hours??0),0),n=this.operatingSessions.reduce((o,l)=>o+(l.fuel_consumed??0),0),a=this.calculateTotalEquipmentFuelCost();return{consumption:{fuelConsumptionRate:this.calculateFuelConsumptionRate(),averageFleetConsumption:this.calculateAverageFleetConsumption(),equipmentTypeAverages:this.calculateEquipmentTypeAverages()},cost:{fuelCostPerHour:this.calculateFuelCostPerHour(),totalEquipmentFuelCost:a,fuelCostPercentage:this.calculateFuelCostPercentage(t)},performance:{taskSpecificConsumption:this.calculateTaskSpecificConsumption(),operatorEfficiency:this.calculateOperatorEfficiency(),monthlyTrends:this.calculateMonthlyTrends()},totalOperatingHours:r,totalFuelConsumed:n,totalFuelCost:a}}}const bi=e=>`${e.toFixed(2)} L/H`,cl=e=>`$${e.toFixed(2)}`,GS=e=>`${e.toFixed(1)}%`,XS=e=>`${e.toFixed(1)} hrs`,Ws=e=>{if(e==null)return 0;if(typeof e=="number")return e;const t=Number(e);return Number.isNaN(t)?0:t},ja=e=>e==null?null:Ws(e),ct=e=>e??null,ll=e=>({id:e.id,name:e.name,type:e.type,model:ct(e.model),serial_number:ct(e.serial_number),purchase_date:ct(e.purchase_date),status:e.status,location:ct(e.location),current_hours:ct(e.current_hours),fuel_capacity:ja(e.fuel_capacity),fuel_type:ct(e.fuel_type),barcode:ct(e.barcode),qr_code:ct(e.qr_code),notes:ct(e.notes),purchase_cost:ja(e.purchase_cost??null),created_at:e.created_at,updated_at:e.updated_at}),ul=e=>({id:e.id,asset_id:e.asset_id,date:e.date,filling_date:e.filling_date||e.date,quantity:Ws(e.quantity),price_per_liter:Ws(e.price_per_liter),cost:Ws(e.cost),fuel_type:e.fuel_type,location:e.location,odometer_reading:ct(e.odometer_reading),receipt_number:ct(e.receipt_number),fuel_grade:ct(e.fuel_grade),notes:ct(e.notes),weather_conditions:ct(e.weather_conditions),operator_id:ct(e.operator_id),driver_name:ct(e.driver_name),attendant_name:ct(e.attendant_name),current_hours:ct(e.current_hours),previous_hours:ct(e.previous_hours),consumption_rate:e.consumption_rate?Ws(e.consumption_rate):null,hour_difference:ct(e.hour_difference),created_at:e.created_at,updated_at:e.updated_at}),fl=e=>({id:e.id,asset_id:e.asset_id,session_start:e.session_start,session_end:ct(e.session_end),initial_fuel_level:ja(e.initial_fuel_level),final_fuel_level:ja(e.final_fuel_level),fuel_consumed:ja(e.fuel_consumed),distance_traveled:ja(e.distance_traveled),operating_hours:ja(e.operating_hours),efficiency_rating:ja(e.efficiency_rating),operator_notes:ct(e.operator_notes),created_at:e.created_at,updated_at:e.updated_at}),Tf=e=>({id:e.id,fuel_type:e.fuel_type,price_per_liter:Ws(e.price_per_liter),effective_date:e.effective_date,location:ct(e.location),supplier:ct(e.supplier),created_at:e.created_at,updated_at:e.updated_at}),Nf=e=>({name:e.name,type:e.type,model:ct(e.model),serial_number:ct(e.serial_number),purchase_date:ct(e.purchase_date),status:e.status,location:ct(e.location),current_hours:e.current_hours??null,fuel_capacity:e.fuel_capacity??null,fuel_type:ct(e.fuel_type),barcode:ct(e.barcode),qr_code:ct(e.qr_code),notes:ct(e.notes)}),If=e=>({asset_id:e.asset_id,date:e.date,filling_date:e.filling_date||e.date,quantity:e.quantity,cost:e.cost??0,price_per_liter:e.price_per_liter,fuel_type:e.fuel_type,location:e.location,odometer_reading:e.odometer_reading??null,receipt_number:ct(e.receipt_number),fuel_grade:ct(e.fuel_grade),notes:ct(e.notes),weather_conditions:ct(e.weather_conditions),operator_id:ct(e.operator_id),driver_name:ct(e.driver_name),attendant_name:ct(e.attendant_name),current_hours:e.current_hours??null,previous_hours:e.previous_hours??null,consumption_rate:e.consumption_rate??null,hour_difference:e.hour_difference??null}),kf=e=>({asset_id:e.asset_id,session_start:e.session_start,session_end:ct(e.session_end),initial_fuel_level:e.initial_fuel_level??null,final_fuel_level:e.final_fuel_level??null,fuel_consumed:e.fuel_consumed??null,distance_traveled:e.distance_traveled??null,operating_hours:e.operating_hours??null,efficiency_rating:e.efficiency_rating??null,operator_notes:ct(e.operator_notes)}),YS=e=>({fuel_type:e.fuel_type,price_per_liter:e.price_per_liter,effective_date:e.effective_date,location:ct(e.location),supplier:ct(e.supplier)}),tx=()=>{console.log("useFuelData: Hook initialized");const[e,t]=Y.useState([]),[r,n]=Y.useState([]),[a,o]=Y.useState([]),[l,h]=Y.useState([]),[g,m]=Y.useState(!0),[p,w]=Y.useState(null),E=Y.useCallback(async()=>{m(!0);try{console.log("useFuelData: Starting to fetch all data...");const[ne,me,J,Ce]=await Promise.all([Ct.from(en.ASSETS).select("*").order("created_at",{ascending:!1}),Ct.from(en.FUEL_RECORDS).select("*").order("date",{ascending:!1}),Ct.from(en.OPERATING_SESSIONS).select("*").order("session_start",{ascending:!1}),Ct.from(en.FUEL_PRICES).select("*").order("effective_date",{ascending:!1})]);if(console.log("useFuelData: Assets response:",ne.error||`${ne.data?.length} assets`),console.log("useFuelData: Records response:",me.error||`${me.data?.length} records`),console.log("useFuelData: Sessions response:",J.error||`${J.data?.length} sessions`),console.log("useFuelData: Prices response:",Ce.error||`${Ce.data?.length} prices`),ne.error)throw ne.error;if(me.error)throw me.error;if(J.error)throw J.error;if(Ce.error)throw Ce.error;const Ae=ne.data??[],at=me.data??[],he=J.data??[],Ve=Ce.data??[],Xe=Ae.map(ll),Q=at.map(ul),oe=he.map(fl),te=Ve.map(Tf);if(console.log("useFuelData: Setting assets:",Xe.length),t(Xe),n(Q),o(oe),h(te),Xe.length||Q.length||oe.length){const se=new VS(Xe,Q,oe);w(se.calculateAllKPIs())}else w(null)}catch(ne){console.error("Failed to fetch fuel data:",ne),dr.error("Failed to load fuel data")}finally{m(!1)}},[]);Y.useEffect(()=>{E()},[E]);const A=Y.useCallback(async ne=>{const me=await Ct.from(en.ASSETS).insert([Nf(ne)]).select("*").single();if(me.error)throw console.error("Failed to create asset:",me.error),dr.error("Failed to create asset"),me.error;const J=ll(me.data);return t(Ce=>[J,...Ce]),dr.success("Asset created successfully"),J},[]),T=Y.useCallback(async(ne,me)=>{const J=await Ct.from(en.ASSETS).update({...Nf(me),updated_at:new Date().toISOString()}).eq("id",ne).select("*").single();if(J.error)throw console.error("Failed to update asset:",J.error),dr.error("Failed to update asset"),J.error;const Ce=ll(J.data);return t(Ae=>Ae.map(at=>at.id===ne?Ce:at)),dr.success("Asset updated successfully"),Ce},[]),_=Y.useCallback(async ne=>{const{error:me}=await Ct.from(en.ASSETS).delete().eq("id",ne);if(me)throw console.error("Failed to delete asset:",me),dr.error("Failed to delete asset"),me;t(J=>J.filter(Ce=>Ce.id!==ne)),dr.success("Asset deleted successfully")},[]),C=Y.useCallback(async ne=>{const me=await Ct.from(en.FUEL_RECORDS).insert([If(ne)]).select("*").single();if(me.error)throw console.error("Failed to create fuel record:",me.error),dr.error("Failed to create fuel record"),me.error;const J=ul(me.data);return n(Ce=>[J,...Ce]),dr.success("Fuel record created successfully"),await E(),J},[E]),S=Y.useCallback(async(ne,me)=>{const J=await Ct.from(en.FUEL_RECORDS).update({...If(me),updated_at:new Date().toISOString()}).eq("id",ne).select("*").single();if(J.error)throw console.error("Failed to update fuel record:",J.error),dr.error("Failed to update fuel record"),J.error;const Ce=ul(J.data);return n(Ae=>Ae.map(at=>at.id===ne?Ce:at)),dr.success("Fuel record updated successfully"),await E(),Ce},[E]),k=Y.useCallback(async ne=>{const{error:me}=await Ct.from(en.FUEL_RECORDS).delete().eq("id",ne);if(me)throw console.error("Failed to delete fuel record:",me),dr.error("Failed to delete fuel record"),me;n(J=>J.filter(Ce=>Ce.id!==ne)),dr.success("Fuel record deleted successfully"),await E()},[E]),N=Y.useCallback(async ne=>{const me=await Ct.from(en.OPERATING_SESSIONS).insert([kf(ne)]).select("*").single();if(me.error)throw console.error("Failed to create operating session:",me.error),dr.error("Failed to create operating session"),me.error;const J=fl(me.data);return o(Ce=>[J,...Ce]),dr.success("Operating session created successfully"),await E(),J},[E]),F=Y.useCallback(async(ne,me)=>{const J=await Ct.from(en.OPERATING_SESSIONS).update({...kf(me),updated_at:new Date().toISOString()}).eq("id",ne).select("*").single();if(J.error)throw console.error("Failed to update operating session:",J.error),dr.error("Failed to update operating session"),J.error;const Ce=fl(J.data);return o(Ae=>Ae.map(at=>at.id===ne?Ce:at)),dr.success("Operating session updated successfully"),await E(),Ce},[E]),W=Y.useCallback(async ne=>{const{error:me}=await Ct.from(en.OPERATING_SESSIONS).delete().eq("id",ne);if(me)throw console.error("Failed to delete operating session:",me),dr.error("Failed to delete operating session"),me;o(J=>J.filter(Ce=>Ce.id!==ne)),dr.success("Operating session deleted successfully"),await E()},[E]),B=Y.useCallback(async ne=>{const me=await Ct.from(en.FUEL_PRICES).insert([YS(ne)]).select("*").single();if(me.error)throw console.error("Failed to create fuel price:",me.error),dr.error("Failed to create fuel price"),me.error;const J=Tf(me.data);return h(Ce=>[J,...Ce]),dr.success("Fuel price record created successfully"),J},[]),R=Y.useCallback(ne=>e.filter(me=>me.type===ne),[e]),z=Y.useCallback(()=>e.filter(ne=>ne.status==="active"),[e]),U=Y.useCallback(ne=>r.filter(me=>me.asset_id===ne),[r]),fe=Y.useCallback(ne=>a.filter(me=>me.asset_id===ne),[a]),M=Y.useCallback((ne,me)=>r.filter(Ce=>Ce.asset_id===ne).filter(Ce=>new Date(Ce.filling_date||Ce.date)<new Date(me)).sort((Ce,Ae)=>new Date(Ae.filling_date||Ae.date).getTime()-new Date(Ce.filling_date||Ce.date).getTime())[0]||null,[r]),V=Y.useMemo(()=>({assetCount:e.length,fuelRecordCount:r.length,sessionCount:a.length,fuelPriceCount:l.length}),[e.length,l.length,r.length,a.length]);return{assets:e,fuelRecords:r,operatingSessions:a,fuelPrices:l,kpis:p,loading:g,stats:V,fetchAllData:E,createAsset:A,updateAsset:T,deleteAsset:_,createFuelRecord:C,updateFuelRecord:S,deleteFuelRecord:k,createOperatingSession:N,updateOperatingSession:F,deleteOperatingSession:W,createFuelPrice:B,getAssetsByType:R,getActiveAssets:z,getFuelRecordsByAsset:U,getSessionsByAsset:fe,getPreviousFuelFill:M}},ZS=()=>{const{kpis:e,assets:t,loading:r}=tx();if(r)return f.jsxs("div",{className:"flex items-center justify-center h-64",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),f.jsx("span",{className:"ml-3 text-gray-600",children:"Loading fuel analytics..."})]});if(!e)return f.jsxs("div",{className:"text-center py-12",children:[f.jsx(Po,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No fuel data available"}),f.jsx("p",{className:"text-gray-500",children:"Add assets and fuel records to see analytics."})]});const n=t.reduce((a,o)=>(a[o.type]=(a[o.type]||0)+1,a),{});return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fuel Management Dashboard"}),f.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive fuel consumption and cost analytics"})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[f.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Po,{className:"h-8 w-8 text-blue-600"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Fleet Fuel Consumption"}),f.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:bi(e.consumption.averageFleetConsumption)})]})]})}),f.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(wd,{className:"h-8 w-8 text-green-600"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Fuel Cost per Hour"}),f.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:cl(e.cost.fuelCostPerHour)})]})]})}),f.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(oc,{className:"h-8 w-8 text-purple-600"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Fuel Cost"}),f.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:cl(e.totalFuelCost)})]})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[f.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(xs,{className:"h-6 w-6 text-orange-600"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Operating Hours"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:XS(e.totalOperatingHours)})]})]})}),f.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(ml,{className:"h-6 w-6 text-red-600"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Fuel Consumed"}),f.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[e.totalFuelConsumed.toFixed(1)," L"]})]})]})}),f.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Qs,{className:"h-6 w-6 text-indigo-600"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Fuel Cost %"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:GS(e.cost.fuelCostPercentage)})]})]})}),f.jsx("div",{className:"bg-white p-4 rounded-lg shadow-md",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Ul,{className:"h-6 w-6 text-cyan-600"}),f.jsxs("div",{className:"ml-3",children:[f.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Active Assets"}),f.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.filter(a=>a.status==="active").length})]})]})})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Equipment Type Fuel Efficiency"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(e.consumption.equipmentTypeAverages).map(([a,o])=>f.jsx("div",{className:"border rounded-lg p-4",children:f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsxs("p",{className:"text-sm font-medium text-gray-600 capitalize",children:[a,"s"]}),f.jsx("p",{className:"text-xl font-bold text-gray-900",children:bi(o)})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("p",{className:"text-xs text-gray-500",children:"Count"}),f.jsx("p",{className:"text-lg font-semibold text-blue-600",children:n[a]||0})]})]})},a))})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Task-Specific Fuel Consumption"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:Object.entries(e.performance.taskSpecificConsumption).map(([a,o])=>f.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize mb-2",children:a}),f.jsx("p",{className:"text-lg font-bold text-gray-900",children:bi(o)}),f.jsx("div",{className:"mt-2 bg-blue-100 rounded-full h-2",children:f.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(o/Math.max(...Object.values(e.performance.taskSpecificConsumption))*100,100)}%`}})})]},a))})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Operator Fuel Efficiency"}),f.jsx("div",{className:"space-y-3",children:Object.entries(e.performance.operatorEfficiency).sort(([,a],[,o])=>a-o).map(([a,o])=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-bold",children:a.charAt(0).toUpperCase()}),f.jsx("span",{className:"ml-3 font-medium text-gray-900",children:a})]}),f.jsxs("div",{className:"text-right",children:[f.jsx("span",{className:"text-lg font-semibold text-gray-900",children:bi(o)}),f.jsx("div",{className:"text-xs text-gray-500",children:o<=Math.min(...Object.values(e.performance.operatorEfficiency))*1.1?"Most Efficient":"Needs Improvement"})]})]},a))})]}),f.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Fuel Trends"}),e.performance.monthlyTrends.length>0?f.jsx("div",{className:"space-y-4",children:e.performance.monthlyTrends.map(a=>f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(qn,{className:"h-5 w-5 text-gray-400 mr-3"}),f.jsx("span",{className:"font-medium text-gray-900",children:new Date(a.month+"-01").toLocaleDateString("en-US",{year:"numeric",month:"long"})})]}),f.jsxs("div",{className:"flex space-x-6",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Consumption"}),f.jsx("p",{className:"text-lg font-semibold text-blue-600",children:bi(a.consumption)})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-sm text-gray-500",children:"Cost"}),f.jsx("p",{className:"text-lg font-semibold text-green-600",children:cl(a.cost)})]})]})]},a.month))}):f.jsx("p",{className:"text-gray-500 text-center py-8",children:"No monthly trend data available yet."})]})]})},$S=({isOpen:e,onClose:t,onSave:r,asset:n})=>{const[a,o]=Y.useState({name:n?.name||"",type:n?.type||"tractor",fuel_type:n?.fuel_type||"diesel",fuel_capacity:n?.fuel_capacity||0,model:n?.model||"",serial_number:n?.serial_number||"",purchase_date:n?.purchase_date||"",purchase_cost:n?.purchase_cost||0,status:n?.status||"active",location:n?.location||"",current_hours:n?.current_hours||0,barcode:n?.barcode||"",qr_code:n?.qr_code||"",notes:n?.notes||""}),[l,h]=Y.useState(!1),[g,m]=Y.useState([]),[p,w]=Y.useState([]);Y.useEffect(()=>{e&&(async()=>{const{data:C,error:S}=await Ct.from("assets").select("*").order("name");!S&&C&&m(C)})()},[e]);const E=_=>{_.preventDefault(),h(!0),(async()=>{try{await r({...a,id:n?.id||"",created_at:n?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}),t()}catch(C){console.error("Failed to save asset:",C)}finally{h(!1)}})()},A=_=>{const{name:C,value:S}=_.target;o(k=>({...k,[C]:C==="fuel_capacity"||C==="current_hours"||C==="purchase_cost"?Number(S):S}))},T=_=>{w(C=>C.includes(_)?C.filter(S=>S!==_):[...C,_])};return e?f.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:f.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[f.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),f.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[n?f.jsx(Ri,{className:"h-6 w-6 text-blue-600 mr-2"}):f.jsx(Pn,{className:"h-6 w-6 text-green-600 mr-2"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n?"Edit Asset":"Add New Asset"})]}),f.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsxs("form",{onSubmit:E,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Assets *"}),f.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-300 rounded-lg p-2",children:g.map(_=>f.jsxs("label",{className:"block",children:[f.jsx("input",{type:"checkbox",value:_.id,checked:p.includes(_.id),onChange:()=>T(_.id),className:"mr-2"}),_.name," (Type: ",_.type,", Fuel: ",_.fuel_type,")"]},_.id))})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset Name *"}),f.jsx("input",{type:"text",name:"name",value:a.name,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., John Deere 6120M"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Equipment Type *"}),f.jsxs("select",{name:"type",value:a.type,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"tractor",children:"Tractor"}),f.jsx("option",{value:"forklift",children:"Forklift"}),f.jsx("option",{value:"motorbike",children:"Motorbike"}),f.jsx("option",{value:"generator",children:"Generator"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Type *"}),f.jsxs("select",{name:"fuel_type",value:a.fuel_type,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"diesel",children:"Diesel"}),f.jsx("option",{value:"petrol",children:"Petrol"}),f.jsx("option",{value:"electric",children:"Electric"}),f.jsx("option",{value:"hybrid",children:"Hybrid"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),f.jsx("input",{type:"text",name:"model",value:a.model,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 6120M"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Serial Number"}),f.jsx("input",{type:"text",name:"serial_number",value:a.serial_number,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., SN123456"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Date"}),f.jsx("input",{type:"date",name:"purchase_date",value:a.purchase_date,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Cost"}),f.jsx("input",{type:"number",name:"purchase_cost",value:a.purchase_cost,onChange:A,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 50000.00"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Capacity (L) *"}),f.jsx("input",{type:"number",name:"fuel_capacity",value:a.fuel_capacity,onChange:A,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 150"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Hours"}),f.jsx("input",{type:"number",name:"current_hours",value:a.current_hours,onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 1250"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),f.jsxs("select",{name:"status",value:a.status,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"active",children:"Active"}),f.jsx("option",{value:"maintenance",children:"Maintenance"}),f.jsx("option",{value:"retired",children:"Retired"}),f.jsx("option",{value:"out_of_service",children:"Out of Service"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),f.jsx("input",{type:"text",name:"location",value:a.location,onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Main Barn"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),f.jsx("textarea",{name:"notes",value:a.notes,onChange:A,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Additional notes..."})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:l?"Saving...":n?"Update Asset":"Create Asset"}),f.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]})}):null},qS=({isOpen:e,onClose:t,onUpload:r,assets:n})=>{const[a,o]=Y.useState(null),[l,h]=Y.useState(!1),[g,m]=Y.useState(!1),[p,w]=Y.useState([]),[E,A]=Y.useState([]),[T,_]=Y.useState(!1);if(!e)return null;const C=F=>{const W=F.target.files?.[0];W&&(o(W),w([]),A([]),_(!1))},S=async()=>{if(a){h(!0);try{const F=await HS(a,n);w(F.records),A(F.errors)}catch(F){console.error("Failed to parse file:",F),A([{row:0,field:"File",message:"Failed to parse Excel file. Please check the file format."}])}finally{h(!1)}}},k=async()=>{if(p.length!==0){m(!0);try{await r(p),_(!0)}catch(F){console.error("Failed to upload records:",F),A([{row:0,field:"Upload",message:"Failed to upload records. Please try again."}])}finally{m(!1)}}},N=()=>{o(null),w([]),A([]),_(!1),t()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[f.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-green-700 px-6 py-4 flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Mi,{className:"h-6 w-6 text-white"}),f.jsx("h2",{className:"text-xl font-bold text-white",children:"Bulk Fuel Upload"})]}),f.jsx("button",{onClick:N,className:"text-white hover:text-gray-200 transition-colors",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:T?f.jsxs("div",{className:"text-center py-12",children:[f.jsx(Ga,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),f.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Upload Complete!"}),f.jsxs("p",{className:"text-gray-600 mb-6",children:["Successfully uploaded ",p.length," fuel records."]}),f.jsx("button",{onClick:N,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Close"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"How to use bulk upload:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[f.jsx("li",{children:"Download the Excel template using the button below"}),f.jsx("li",{children:"Fill in your fuel records following the template format"}),f.jsx("li",{children:"Upload the completed file"}),f.jsx("li",{children:"Review the parsed data and fix any errors"}),f.jsx("li",{children:'Click "Upload Records" to save to database'})]})]}),f.jsxs("div",{className:"mb-6",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File"}),f.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:C,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-lg file:border-0
                    file:text-sm file:font-semibold
                    file:bg-green-50 file:text-green-700
                    hover:file:bg-green-100
                    cursor-pointer`}),a&&f.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",a.name]})]}),a&&!p.length&&!E.length&&f.jsx("button",{onClick:()=>void S(),disabled:l,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors mb-6",children:l?"Parsing...":"Parse File"}),E.length>0&&f.jsx("div",{className:"mb-6",children:f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[f.jsx(to,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsxs("h4",{className:"font-semibold text-red-900",children:[E.length," Error",E.length!==1?"s":""," Found"]}),f.jsx("p",{className:"text-sm text-red-700",children:"Please fix the following errors and try again:"})]})]}),f.jsx("div",{className:"max-h-60 overflow-y-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-red-100",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-left text-red-900",children:"Row"}),f.jsx("th",{className:"px-3 py-2 text-left text-red-900",children:"Field"}),f.jsx("th",{className:"px-3 py-2 text-left text-red-900",children:"Error"})]})}),f.jsx("tbody",{className:"divide-y divide-red-200",children:E.map((F,W)=>f.jsxs("tr",{className:"hover:bg-red-50",children:[f.jsx("td",{className:"px-3 py-2 text-red-800",children:F.row}),f.jsx("td",{className:"px-3 py-2 text-red-800",children:F.field}),f.jsx("td",{className:"px-3 py-2 text-red-700",children:F.message})]},W))})]})})]})}),p.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ga,{className:"h-5 w-5 text-green-600"}),f.jsxs("h4",{className:"font-semibold text-green-900",children:[p.length," Record",p.length!==1?"s":""," Ready to Upload"]})]})}),f.jsx("div",{className:"max-h-80 overflow-auto border rounded-lg",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-gray-50 sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"#"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"Date"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"Asset"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"Quantity"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"Cost"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"Hours"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-700",children:"L/h"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map((F,W)=>{const B=n.find(R=>R.id===F.asset_id);return f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-3 py-2 text-gray-600",children:W+1}),f.jsx("td",{className:"px-3 py-2 text-gray-900",children:F.filling_date?new Date(F.filling_date).toLocaleDateString():"N/A"}),f.jsx("td",{className:"px-3 py-2 text-gray-900",children:B?.name||"Unknown"}),f.jsxs("td",{className:"px-3 py-2 text-gray-900",children:[F.quantity,"L"]}),f.jsxs("td",{className:"px-3 py-2 text-gray-900",children:["$",F.cost?.toFixed(2)]}),f.jsxs("td",{className:"px-3 py-2 text-gray-900",children:[F.current_hours??"N/A",F.hour_difference&&f.jsxs("span",{className:"text-green-600 ml-1",children:["+",F.hour_difference,"h"]})]}),f.jsx("td",{className:"px-3 py-2 text-gray-900",children:F.consumption_rate?F.consumption_rate.toFixed(2):"-"})]},W)})})]})})]})]})}),!T&&f.jsxs("div",{className:"border-t bg-gray-50 px-6 py-4 flex justify-between items-center",children:[f.jsx("div",{children:f.jsxs("p",{className:"text-sm text-gray-600",children:[p.length>0&&`${p.length} records ready`,E.length>0&&` â¢ ${E.length} errors`]})}),f.jsxs("div",{className:"flex gap-3",children:[f.jsx("button",{onClick:N,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"}),p.length>0&&E.length===0&&f.jsx("button",{onClick:()=>void k(),disabled:g,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:g?"Uploading...":"Upload Records"})]})]})]})})};function un({label:e,name:t,value:r,onChange:n,options:a,placeholder:o="Select an option",required:l=!1,error:h,className:g="",disabled:m=!1}){const p=w=>{n?.(w.target.value)};return f.jsxs("div",{className:`space-y-1 ${g}`,children:[f.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700",children:[e,l&&f.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),f.jsxs("div",{className:"relative",children:[f.jsxs("select",{id:t,name:t,value:r||"",onChange:p,required:l,disabled:m,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors appearance-none pr-10 ${h?"border-red-300 focus:ring-red-500":"border-gray-300 hover:border-gray-400"} ${m?"bg-gray-100 cursor-not-allowed":""}`,children:[f.jsx("option",{value:"",children:o}),a.map(w=>f.jsx("option",{value:w.value,children:w.label},w.value))]}),f.jsx(wm,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"})]}),h&&f.jsx("p",{className:"text-sm text-red-600 mt-1",children:h})]})}const KS=({isOpen:e,onClose:t,onSave:r,record:n})=>{const[a,o]=Y.useState({asset_id:n?.asset_id||"",filling_date:n?.filling_date?new Date(n.filling_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],quantity:n?.quantity||0,cost:n?.cost||0,price_per_liter:n?.price_per_liter||0,fuel_type:n?.fuel_type||"diesel",location:n?.location||"",receipt_number:n?.receipt_number||"",odometer_reading:n?.odometer_reading||0,notes:n?.notes||"",fuel_grade:n?.fuel_grade||"",weather_conditions:n?.weather_conditions||"",operator_id:n?.operator_id||"",driver_name:n?.driver_name||"",attendant_name:n?.attendant_name||"",current_hours:0}),[l,h]=Y.useState([]),[g,m]=Y.useState([]),[p,w]=Y.useState(!0),[E,A]=Y.useState(null),[T,_]=Y.useState(!1);Y.useEffect(()=>{if(e){const N=async()=>{w(!0);const{data:W,error:B}=await Ct.from("assets").select("*").order("name");!B&&W&&h(W),w(!1)},F=async()=>{const{data:W,error:B}=await Ct.from("farms").select("id, name, location").eq("status","active").order("name");!B&&W&&m(W)};N(),F(),o({asset_id:n?.asset_id||"",filling_date:n?.filling_date?new Date(n.filling_date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],quantity:n?.quantity||0,cost:n?.cost||0,price_per_liter:n?.price_per_liter||0,fuel_type:n?.fuel_type||"diesel",location:n?.location||"",receipt_number:n?.receipt_number||"",odometer_reading:n?.odometer_reading||0,notes:n?.notes||"",fuel_grade:n?.fuel_grade||"",weather_conditions:n?.weather_conditions||"",operator_id:n?.operator_id||"",driver_name:n?.driver_name||"",attendant_name:n?.attendant_name||"",current_hours:0}),A(null)}},[e,n]);const C=N=>{N.preventDefault();const F=l.find(W=>W.id===a.asset_id);if(F&&F.current_hours&&a.current_hours<=F.current_hours){alert(`Current hour meter reading (${a.current_hours}) must be greater than the previous reading (${F.current_hours})`);return}_(!0),(async()=>{try{const W=F?.current_hours||null,B=W&&a.current_hours>0?a.current_hours-W:null,R=B&&B>0?a.quantity/B:null,z=a.filling_date??new Date().toISOString().split("T")[0],U={...a,asset_id:a.asset_id||null,operator_id:a.operator_id||null,driver_name:a.driver_name||null,attendant_name:a.attendant_name||null,filling_date:z,previous_hours:W,hour_difference:B,consumption_rate:R,id:n?.id||"",date:n?.date||new Date().toISOString(),created_at:n?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await r(U),t()}catch(W){console.error("Failed to save fuel record:",W)}finally{_(!1)}})()},S=N=>{const{name:F,value:W}=N.target;let B=W;["quantity","cost","price_per_liter","odometer_reading","current_hours"].includes(F)&&(B=Number(W)||0),o(R=>{const z={...R,[F]:B};if(F==="quantity"||F==="price_per_liter"?z.cost=z.quantity*z.price_per_liter:F==="cost"&&z.quantity>0&&(z.price_per_liter=z.cost/z.quantity),F==="current_hours"||F==="quantity"||F==="asset_id"){const U=l.find(fe=>fe.id===z.asset_id);if(U&&U.current_hours&&z.current_hours>U.current_hours){const fe=z.current_hours-U.current_hours;fe>0&&z.quantity>0&&A(z.quantity/fe)}else A(null)}return z})},k=l.find(N=>N.id===a.asset_id);return e?f.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:f.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[f.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),f.jsxs("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[n?f.jsx(Ri,{className:"h-6 w-6 text-blue-600 mr-2"}):f.jsx(Pn,{className:"h-6 w-6 text-green-600 mr-2"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n?"Edit Fuel Record":"Add Fuel Record"})]}),f.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsxs("form",{onSubmit:C,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(un,{label:"Asset",name:"asset_id",value:a.asset_id,onChange:N=>o(F=>({...F,asset_id:N})),options:[{value:"",label:"Select Asset"},...l.map(N=>({value:N.id,label:N.name}))],required:!0,disabled:p}),p&&f.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded border border-gray-200",children:f.jsx("p",{className:"text-sm text-gray-500",children:"Loading assets..."})}),l.length===0&&!p&&f.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded border border-red-200",children:f.jsx("p",{className:"text-sm text-red-800",children:"â ï¸ No assets loaded!"})}),k&&f.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:f.jsxs("div",{className:"text-sm text-gray-700",children:[f.jsx("span",{className:"font-medium",children:"Type:"})," ",k.type," â¢",f.jsx("span",{className:"font-medium ml-2",children:"Fuel:"})," ",k.fuel_type," â¢",f.jsx("span",{className:"font-medium ml-2",children:"Tank:"})," ",k.fuel_capacity??"N/A","L â¢",f.jsx("span",{className:"font-medium ml-2",children:"Current Hours:"})," ",k.current_hours??0,"h"]})})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filling Date *"}),f.jsx("input",{type:"date",name:"filling_date",value:a.filling_date,onChange:S,required:!0,max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity (L) *"}),f.jsx("input",{type:"number",name:"quantity",value:a.quantity,onChange:S,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"50.0"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price per Liter *"}),f.jsx("input",{type:"number",name:"price_per_liter",value:a.price_per_liter,onChange:S,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"1.50"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Cost *"}),f.jsx("input",{type:"number",name:"cost",value:a.cost,onChange:S,required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"75.00"}),f.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Auto-calculated: ",(a.quantity*a.price_per_liter).toFixed(2)]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Hour Meter Reading *"}),f.jsx("input",{type:"number",name:"current_hours",value:a.current_hours,onChange:S,required:!0,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"1250.5"}),k&&f.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Previous reading: ",k.current_hours??0,"h",a.current_hours>0&&k.current_hours&&a.current_hours>k.current_hours&&f.jsxs("span",{className:"text-blue-600 font-medium ml-2",children:["â¢ Hours used: ",(a.current_hours-k.current_hours).toFixed(1),"h"]})]}),E!==null&&f.jsx("div",{className:"mt-2 p-2 bg-blue-50 rounded-lg",children:f.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["â½ Consumption Rate: ",E.toFixed(2)," L/hour"]})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Driver Name"}),f.jsx("input",{type:"text",name:"driver_name",value:a.driver_name,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter driver's name"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Filling Attendant Name"}),f.jsx("input",{type:"text",name:"attendant_name",value:a.attendant_name,onChange:S,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Enter attendant's name"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location *"}),f.jsxs("select",{name:"location",value:a.location,onChange:S,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"Select Location"}),f.jsx("optgroup",{label:"Farms",children:g.map(N=>f.jsx("option",{value:N.name,children:N.name},N.id))}),f.jsxs("optgroup",{label:"Fuel Stations",children:[f.jsx("option",{value:"Shell Station",children:"Shell Station"}),f.jsx("option",{value:"BP Station",children:"BP Station"}),f.jsx("option",{value:"Total Station",children:"Total Station"}),f.jsx("option",{value:"Engen Station",children:"Engen Station"}),f.jsx("option",{value:"Other Station",children:"Other Station"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Odometer/Distance (optional)"}),f.jsx("input",{type:"number",name:"odometer_reading",value:a.odometer_reading,onChange:S,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"5000.0"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receipt Number"}),f.jsxs("div",{className:"relative",children:[f.jsx(ym,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",name:"receipt_number",value:a.receipt_number,onChange:S,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"SH-20240115-001"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),f.jsx("textarea",{name:"notes",value:a.notes,onChange:S,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Additional notes..."})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"submit",disabled:T,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:T?"Saving...":n?"Update Record":"Create Record"}),f.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]})}):null},QS=({isOpen:e,onClose:t,onSave:r,session:n})=>{const[a,o]=Y.useState({asset_id:n?.asset_id||"",session_start:n?.session_start?n.session_start.slice(0,16):"",session_end:n?.session_end?n.session_end.slice(0,16):"",operating_hours:n?.operating_hours||null,fuel_consumed:n?.fuel_consumed||null,initial_fuel_level:n?.initial_fuel_level||null,final_fuel_level:n?.final_fuel_level||null,distance_traveled:n?.distance_traveled||null,efficiency_rating:n?.efficiency_rating||null,operator_notes:n?.operator_notes||""}),[l,h]=Y.useState([]),[g,m]=Y.useState(!0),[p,w]=Y.useState(!1);Y.useEffect(()=>{e&&((async()=>{m(!0);const{data:C,error:S}=await Ct.from("assets").select("*").order("name");!S&&C&&h(C),m(!1)})(),o({asset_id:n?.asset_id||"",session_start:n?.session_start?n.session_start.slice(0,16):"",session_end:n?.session_end?n.session_end.slice(0,16):"",operating_hours:n?.operating_hours||null,fuel_consumed:n?.fuel_consumed||null,initial_fuel_level:n?.initial_fuel_level||null,final_fuel_level:n?.final_fuel_level||null,distance_traveled:n?.distance_traveled||null,efficiency_rating:n?.efficiency_rating||null,operator_notes:n?.operator_notes||""}))},[e,n]);const E=_=>{_.preventDefault(),w(!0),(async()=>{try{await r({...a,asset_id:a.asset_id||null,session_start:new Date(a.session_start).toISOString(),session_end:a.session_end?new Date(a.session_end).toISOString():null,created_at:n?.created_at||new Date().toISOString(),updated_at:new Date().toISOString()}),t()}catch(C){console.error("Failed to save operating session:",C)}finally{w(!1)}})()},A=_=>{const{name:C,value:S}=_.target;let k=S;["operating_hours","fuel_consumed","initial_fuel_level","final_fuel_level","distance_traveled","efficiency_rating"].includes(C)&&(k=S?Number(S):null),o(N=>{const F={...N,[C]:k};if((C==="session_start"||C==="session_end")&&F.session_start&&F.session_end){const W=new Date(F.session_start),B=new Date(F.session_end);B>W&&(F.operating_hours=(B.getTime()-W.getTime())/(1e3*60*60))}return F})},T=l.find(_=>_.id===a.asset_id);return e?f.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:f.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[f.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),f.jsxs("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[n?f.jsx(Ri,{className:"h-6 w-6 text-blue-600 mr-2"}):f.jsx(Pn,{className:"h-6 w-6 text-green-600 mr-2"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:n?"Edit Operating Session":"Add Operating Session"})]}),f.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsxs("form",{onSubmit:E,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(un,{label:"Asset",name:"asset_id",value:a.asset_id,onChange:_=>o(C=>({...C,asset_id:_})),options:[{value:"",label:"Select Asset"},...l.map(_=>({value:_.id,label:_.name}))],required:!0,disabled:g}),g&&f.jsx("div",{className:"mt-2 p-2 bg-gray-50 rounded border border-gray-200",children:f.jsx("p",{className:"text-sm text-gray-500",children:"Loading assets..."})}),l.length===0&&!g&&f.jsx("div",{className:"mt-2 p-2 bg-red-50 rounded border border-red-200",children:f.jsx("p",{className:"text-sm text-red-800",children:"â ï¸ No assets loaded!"})}),T&&f.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:f.jsxs("div",{className:"text-sm text-gray-700",children:[f.jsx("span",{className:"font-medium",children:"Type:"})," ",T.type," â¢",f.jsx("span",{className:"font-medium ml-2",children:"Fuel:"})," ",T.fuel_type]})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time *"}),f.jsx("input",{type:"datetime-local",name:"session_start",value:a.session_start,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time *"}),f.jsx("input",{type:"datetime-local",name:"session_end",value:a.session_end,onChange:A,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operating Hours"}),f.jsxs("div",{className:"relative",children:[f.jsx(xs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"number",name:"operating_hours",value:a.operating_hours||"",onChange:A,min:"0",step:"0.1",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"8.0"})]}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Auto-calculated from start/end times"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fuel Consumed (L)"}),f.jsx("input",{type:"number",name:"fuel_consumed",value:a.fuel_consumed||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"45.2"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Distance Traveled (km)"}),f.jsx("input",{type:"number",name:"distance_traveled",value:a.distance_traveled||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"25.5"})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Initial Fuel Level (L)"}),f.jsx("input",{type:"number",name:"initial_fuel_level",value:a.initial_fuel_level||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"100.0"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Final Fuel Level (L)"}),f.jsx("input",{type:"number",name:"final_fuel_level",value:a.final_fuel_level||"",onChange:A,min:"0",step:"0.1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"54.8"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Efficiency Rating (1-5)"}),f.jsxs("select",{name:"efficiency_rating",value:a.efficiency_rating||"",onChange:A,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"",children:"Not Rated"}),f.jsx("option",{value:1,children:"1 - Poor"}),f.jsx("option",{value:2,children:"2 - Below Average"}),f.jsx("option",{value:3,children:"3 - Average"}),f.jsx("option",{value:4,children:"4 - Good"}),f.jsx("option",{value:5,children:"5 - Excellent"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Operator Notes"}),f.jsx("textarea",{name:"operator_notes",value:a.operator_notes,onChange:A,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Session notes..."})]}),f.jsxs("div",{className:"flex gap-3 pt-4",children:[f.jsx("button",{type:"submit",disabled:p,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:p?"Saving...":n?"Update Session":"Create Session"}),f.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancel"})]})]})]})]})}):null},JS=()=>{const{assets:e,fuelRecords:t,operatingSessions:r,loading:n,createAsset:a,updateAsset:o,deleteAsset:l,createFuelRecord:h,updateFuelRecord:g,deleteFuelRecord:m,createOperatingSession:p,updateOperatingSession:w,deleteOperatingSession:E}=tx();console.log("FuelManagement - assets loaded:",e.length),console.log("FuelManagement - fuel records:",t.length),console.log("FuelManagement - sessions:",r.length),console.log("FuelManagement - loading:",n);const[A,T]=Y.useState("dashboard"),[_,C]=Y.useState(!1),[S,k]=Y.useState(!1),[N,F]=Y.useState(!1),[W,B]=Y.useState(!1),[R,z]=Y.useState(null),[U,fe]=Y.useState(null),[M,V]=Y.useState(null),[ne,me]=Y.useState(""),[J,Ce]=Y.useState("all"),Ae=[{id:"dashboard",label:"Dashboard",icon:Qs},{id:"assets",label:"Assets",icon:_m},{id:"fuel-records",label:"Fuel Records",icon:Po},{id:"sessions",label:"Operating Sessions",icon:xs},{id:"analytics",label:"Analytics & Reports",icon:Qs}],at=ie=>{z(ie),C(!0)},he=ie=>{fe(ie),k(!0)},Ve=ie=>{V(ie),F(!0)},Xe=async(ie,ye)=>{confirm(`Are you sure you want to delete ${ye}?`)&&await l(ie)},Q=async ie=>{confirm("Are you sure you want to delete this fuel record?")&&await m(ie)},oe=async ie=>{confirm("Are you sure you want to delete this operating session?")&&await E(ie)},te=e.filter(ie=>{const ye=ie.name.toLowerCase().includes(ne.toLowerCase())||ie.id.toLowerCase().includes(ne.toLowerCase()),Se=J==="all"||ie.type===J;return ye&&Se}),se=t.filter(ie=>e.find(Ne=>Ne.id===ie.asset_id)?.name.toLowerCase().includes(ne.toLowerCase())||ie.location?.toLowerCase().includes(ne.toLowerCase())),ce=r.filter(ie=>e.find(Ne=>Ne.id===ie.asset_id)?.name.toLowerCase().includes(ne.toLowerCase())||ie.operator_notes?.toLowerCase().includes(ne.toLowerCase()));return n?f.jsxs("div",{className:"flex items-center justify-center h-64",children:[f.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600"}),f.jsx("span",{className:"ml-3 text-gray-600",children:"Loading fuel management system..."})]}):f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"flex flex-col sm:flex-row gap-4 justify-between items-start sm:items-center",children:f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Fuel Management System"}),f.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive fuel tracking and analytics for farm equipment"})]})}),f.jsx("div",{className:"border-b border-gray-200",children:f.jsx("nav",{className:"-mb-px flex space-x-8",children:Ae.map(ie=>{const ye=ie.icon;return f.jsxs("button",{onClick:()=>T(ie.id),className:`flex items-center py-2 px-1 border-b-2 font-medium text-sm transition-colors ${A===ie.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[f.jsx(ye,{className:"h-5 w-5 mr-2"}),ie.label]},ie.id)})})}),A==="dashboard"&&f.jsx(ZS,{}),A==="assets"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search assets...",value:ne,onChange:ie=>me(ie.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("select",{value:J,onChange:ie=>Ce(ie.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Types"}),f.jsx("option",{value:"tractor",children:"Tractors"}),f.jsx("option",{value:"forklift",children:"Forklifts"}),f.jsx("option",{value:"motorbike",children:"Motorbikes"}),f.jsx("option",{value:"generator",children:"Generators"})]}),f.jsxs("button",{onClick:()=>{z(null),C(!0)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"Add Asset"]})]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:te.map(ie=>f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ie.name}),f.jsx("p",{className:"text-sm text-gray-500",children:ie.id})]}),f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ie.status==="active"?"bg-green-100 text-green-800":ie.status==="maintenance"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:ie.status})]}),f.jsxs("div",{className:"space-y-2 mb-4",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Type:"}),f.jsx("span",{className:"font-medium capitalize",children:ie.type})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Fuel Type:"}),f.jsx("span",{className:"font-medium capitalize",children:ie.fuel_type})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Tank Capacity:"}),f.jsxs("span",{className:"font-medium",children:[ie.fuel_capacity??"N/A","L"]})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Location:"}),f.jsx("span",{className:"font-medium",children:ie.location})]})]}),"                ",f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>at(ie),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition-colors",children:[f.jsx(Ri,{className:"h-4 w-4 inline mr-1"}),"Edit"]}),f.jsxs("button",{onClick:()=>void Xe(ie.id,ie.name),className:"flex-1 bg-red-600 text-white py-2 px-3 rounded text-sm hover:bg-red-700 transition-colors",children:[f.jsx(gl,{className:"h-4 w-4 inline mr-1"}),"Delete"]})]})]},ie.id))})]}),A==="fuel-records"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search fuel records...",value:ne,onChange:ie=>me(ie.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("button",{onClick:zS,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(Li,{className:"h-5 w-5 mr-2"}),"Template"]}),f.jsxs("button",{onClick:()=>ex(t,e),className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[f.jsx(Li,{className:"h-5 w-5 mr-2"}),"Export"]}),f.jsxs("button",{onClick:()=>B(!0),className:"flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:[f.jsx(Mi,{className:"h-5 w-5 mr-2"}),"Bulk Upload"]}),f.jsxs("button",{onClick:()=>{fe(null),k(!0)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"Add Record"]})]})]}),f.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fleet / Asset"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fuel Type"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hours"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Consumption"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Filling Date"}),f.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:se.map(ie=>{const ye=e.find(Se=>Se.id===ie.asset_id);return f.jsxs("tr",{children:[f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium text-gray-900",children:ye?.name||"Unknown"}),f.jsx("div",{className:"text-xs text-gray-500",children:ye?.type||"N/A"})]})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:f.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full capitalize",children:ie.fuel_type})}),f.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[ie.quantity.toFixed(1),"L"]}),f.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[f.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",ie.cost.toFixed(2)]}),f.jsxs("div",{className:"text-xs text-gray-500",children:["$",ie.price_per_liter.toFixed(2),"/L"]})]}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ie.current_hours!==null&&ie.current_hours!==void 0?f.jsxs("div",{children:[f.jsxs("div",{className:"text-sm text-gray-900",children:[ie.current_hours,"h"]}),ie.hour_difference?f.jsxs("div",{className:"text-xs text-green-600",children:["+",ie.hour_difference,"h"]}):null]}):f.jsx("span",{className:"text-sm text-gray-400",children:"N/A"})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ie.consumption_rate?f.jsxs("div",{children:[f.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[ie.consumption_rate.toFixed(2)," L/h"]}),ie.hour_difference?f.jsxs("div",{className:"text-xs text-gray-500",children:[ie.hour_difference,"h used"]}):null]}):f.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ie.location||"N/A"}),f.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ie.filling_date||ie.date).toLocaleDateString()}),f.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[f.jsx("button",{onClick:()=>he(ie),className:"text-blue-600 hover:text-blue-900",children:"Edit"}),f.jsx("button",{onClick:()=>void Q(ie.id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},ie.id)})})]})})})]}),A==="sessions"&&f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search sessions...",value:ne,onChange:ie=>me(ie.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("button",{onClick:()=>{V(null),F(!0)},className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"Add Session"]})]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:ce.map(ie=>{const ye=e.find(ee=>ee.id===ie.asset_id),Se=ie.operating_hours??0,Ne=ie.fuel_consumed??0,Ye=Se>0?Ne/Se:0;return f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ye?.name}),f.jsxs("p",{className:"text-sm text-gray-500",children:["Session ID: ",ie.id.slice(0,8)]})]}),f.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:"Operating"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Operating Hours"}),f.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Se.toFixed(1),"h"]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Fuel Consumed"}),f.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Ne.toFixed(1),"L"]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Efficiency Rating"}),f.jsxs("div",{className:"flex items-center",children:[f.jsxs("span",{className:"text-lg font-semibold text-gray-900 mr-2",children:[ie.efficiency_rating??0,"/5"]}),f.jsx("div",{className:"flex",children:Array.from({length:5}).map((ee,Ge)=>f.jsx("div",{className:`w-3 h-3 rounded-full mr-1 ${Ge<(ie.efficiency_rating??0)?"bg-yellow-400":"bg-gray-200"}`},Ge))})]})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Consumption Rate"}),f.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[Ye.toFixed(2)," L/H"]})]})]}),f.jsxs("div",{className:"text-sm text-gray-500 mb-4",children:[f.jsxs("p",{children:[new Date(ie.session_start).toLocaleString()," - ",ie.session_end?new Date(ie.session_end).toLocaleString():"Ongoing"]}),ie.operator_notes&&f.jsxs("p",{children:["Notes: ",ie.operator_notes]})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("button",{onClick:()=>Ve(ie),className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded text-sm hover:bg-blue-700 transition-colors",children:[f.jsx(Ri,{className:"h-4 w-4 inline mr-1"}),"Edit"]}),f.jsxs("button",{onClick:()=>void oe(ie.id),className:"flex-1 bg-red-600 text-white py-2 px-3 rounded text-sm hover:bg-red-700 transition-colors",children:[f.jsx(gl,{className:"h-4 w-4 inline mr-1"}),"Delete"]})]})]},ie.id)})})]}),A==="analytics"&&f.jsx(WS,{fuelRecords:t,assets:e,operatingSessions:r}),f.jsx($S,{isOpen:_,onClose:()=>{C(!1),z(null)},onSave:async ie=>{R?await o(R.id,ie):await a(ie)},asset:R}),f.jsx(KS,{isOpen:S,onClose:()=>{k(!1),fe(null)},onSave:async ie=>{if(U)await g(U.id,ie);else if(await h(ie),"current_hours"in ie&&typeof ie.current_hours=="number"&&ie.current_hours>0&&ie.asset_id){const ye=e.find(Se=>Se.id===ie.asset_id);ye&&(!ye.current_hours||ie.current_hours>ye.current_hours)&&await o(ie.asset_id,{current_hours:ie.current_hours})}},record:U}),f.jsx(QS,{isOpen:N,onClose:()=>{F(!1),V(null)},onSave:async ie=>{M?await w(M.id,ie):await p(ie)},session:M}),f.jsx(qS,{isOpen:W,onClose:()=>B(!1),onUpload:async ie=>{for(const ye of ie)if(await h(ye),ye.current_hours&&ye.asset_id){const Se=e.find(Ne=>Ne.id===ye.asset_id);Se&&(!Se.current_hours||ye.current_hours>Se.current_hours)&&await o(ye.asset_id,{current_hours:ye.current_hours})}},assets:e})]})};function fo({isOpen:e,onClose:t,title:r,size:n="md",children:a,showCloseButton:o=!0,closeOnOverlayClick:l=!0}){Y.useEffect(()=>{const g=m=>{m.key==="Escape"&&e&&t()};return e&&(document.addEventListener("keydown",g),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",g),document.body.style.overflow="unset"}},[e,t]);const h={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return f.jsx(md,{children:e&&f.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:f.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[f.jsx(nr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:l?t:void 0}),f.jsxs(nr.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:`inline-block w-full ${h[n]} p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl relative`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 pr-8",children:r}),o&&f.jsx("button",{onClick:t,className:"absolute top-6 right-6 text-gray-400 hover:text-gray-500 transition-colors","aria-label":"Close modal",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsx("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto",children:a})]})]})})})}function eT({isOpen:e,onClose:t,onSave:r,inspection:n}){const[a,o]=Y.useState({title:"",type:"safety",inspector:"",scheduled_date:"",description:"",asset_id:""}),[l,h]=Y.useState(!1),[g,m]=Y.useState(""),[p,w]=Y.useState([]),[E,A]=Y.useState(!0);Y.useEffect(()=>{o(n?{title:n.title,type:n.type,inspector:n.inspector,scheduled_date:n.scheduled_date.slice(0,16),description:n.checklist_items?.[0]?.description||"",asset_id:n.asset_id||""}:{title:"",type:"safety",inspector:"",scheduled_date:"",description:"",asset_id:""}),m("")},[n,e]),Y.useEffect(()=>{e&&(async()=>{A(!0);const{data:S,error:k}=await Ct.from("assets").select("*").order("name");!k&&S?(w(S),console.log("InspectionModal: Loaded assets:",S.length)):k&&console.error("InspectionModal: Failed to load assets:",k),A(!1)})()},[e]);const T=S=>{S.preventDefault(),_()},_=async()=>{m(""),h(!0);try{if(!a.title||!a.inspector||!a.scheduled_date||!a.asset_id){m("Please fill in all required fields including equipment/asset"),h(!1);return}const S={title:a.title,type:a.type,inspector:a.inspector,scheduled_date:new Date(a.scheduled_date).toISOString(),status:n?.status||"scheduled",progress:n?.progress||0,score:n?.score||0,asset_id:a.asset_id||null,checklist_items:a.description?[{id:"1",description:a.description,completed:!1}]:[]};await r(S),t()}catch(S){m(S instanceof Error?S.message:"Failed to save inspection")}finally{h(!1)}},C=S=>{const{name:k,value:N}=S.target;o(F=>({...F,[k]:N}))};return f.jsx(fo,{isOpen:e,onClose:t,title:n?"Edit Inspection":"Create New Inspection",size:"lg",children:f.jsxs("form",{onSubmit:T,className:"space-y-6",children:[g&&f.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:g}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspection Title ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Monthly Safety Check",required:!0})]}),f.jsxs("div",{children:[f.jsxs("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspection Type ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("select",{id:"type",name:"type",value:a.type,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,children:[f.jsx("option",{value:"safety",children:"Safety"}),f.jsx("option",{value:"pre_season",children:"Pre-Season"}),f.jsx("option",{value:"compliance",children:"Compliance"}),f.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),f.jsxs("div",{children:[f.jsxs("label",{htmlFor:"asset_id",className:"block text-sm font-medium text-gray-700 mb-1",children:["Equipment/Asset ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx(un,{label:"",name:"asset_id",value:a.asset_id,onChange:S=>o(k=>({...k,asset_id:S})),options:[{value:"",label:"Select Equipment..."},...p.map(S=>({value:S.id,label:S.name}))],required:!0}),a.asset_id&&f.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:f.jsxs("p",{className:"text-sm text-green-700",children:["Selected: ",p.find(S=>S.id===a.asset_id)?.name||"Unknown Asset"]})}),E&&f.jsx("div",{className:"mt-2 p-2 bg-blue-50 border border-blue-200 rounded",children:f.jsx("p",{className:"text-sm text-blue-700",children:"â³ Loading equipment list..."})}),p.length===0&&!E&&f.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded",children:f.jsx("p",{className:"text-sm text-red-700",children:"â ï¸ No equipment found in database!"})})]}),f.jsxs("div",{children:[f.jsxs("label",{htmlFor:"inspector",className:"block text-sm font-medium text-gray-700 mb-1",children:["Inspector ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",id:"inspector",name:"inspector",value:a.inspector,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., John Doe",required:!0})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsxs("label",{htmlFor:"scheduled_date",className:"block text-sm font-medium text-gray-700 mb-1",children:["Scheduled Date & Time ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"datetime-local",id:"scheduled_date",name:"scheduled_date",value:a.scheduled_date,onChange:C,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description / Notes"}),f.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:C,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add any additional notes or checklist items..."})]})]}),f.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[f.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:l,children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:l,children:l?"Saving...":n?"Update Inspection":"Create Inspection"})]})]})})}const tT=[{id:"safety-monthly",name:"Monthly Safety Inspection",frequency:"Monthly"},{id:"pre-season",name:"Pre-Season Equipment Check",frequency:"Seasonal"},{id:"compliance-annual",name:"Annual Compliance Audit",frequency:"Annual"},{id:"maintenance-weekly",name:"Weekly Maintenance Check",frequency:"Weekly"}];function rT(){const[e,t]=Y.useState(""),[r,n]=Y.useState("all"),[a,o]=Y.useState("all"),[l,h]=Y.useState(!1),[g,m]=Y.useState(null),{items:p,loading:w,create:E,update:A,delete:T,refresh:_}=ca("inspections");Y.useEffect(()=>{_()},[_]),Y.useEffect(()=>{console.log("Inspections updated:",p.length,"items"),console.log("Inspections list:",p)},[p]);const C=p.filter(z=>{const U=z.title.toLowerCase().includes(e.toLowerCase())||z.inspector.toLowerCase().includes(e.toLowerCase()),fe=r==="all"||z.status===r,M=a==="all"||z.type===a;return U&&fe&&M}),S=async z=>{if(console.log("Creating/Updating inspection with data:",z),g)await A(g.id,z);else{const U={title:z.title,type:z.type,inspector:z.inspector,status:z.status||"scheduled",progress:z.progress||0,score:z.score||0,scheduled_date:z.scheduled_date,completed_date:z.completed_date||null,checklist_items:z.checklist_items||[],findings:z.findings||null,recommendations:z.recommendations||null,asset_id:z.asset_id||null};console.log("Creating new inspection:",U);const fe=await E(U);console.log("Create result:",fe)}console.log("Refreshing inspections list..."),await _(),console.log("Current inspections count:",p.length)},k=async z=>{confirm("Are you sure you want to delete this inspection?")&&await T(z)},N=async(z,U)=>{await A(z,{status:U})},F=z=>{m(z),h(!0)},W=()=>{h(!1),m(null)},B=z=>{switch(z){case"scheduled":return"text-blue-600 bg-blue-100";case"in_progress":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"overdue":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},R=z=>z?z>=90?"text-green-600":z>=70?"text-yellow-600":"text-red-600":"text-gray-500";return w?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"Loading inspections..."})]})}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search inspections...",value:e,onChange:z=>t(z.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("button",{onClick:()=>h(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"Schedule Inspection"]})]}),f.jsxs("div",{className:"flex gap-4 flex-wrap",children:[f.jsxs("select",{value:r,onChange:z=>n(z.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Statuses"}),f.jsx("option",{value:"scheduled",children:"Scheduled"}),f.jsx("option",{value:"in_progress",children:"In Progress"}),f.jsx("option",{value:"completed",children:"Completed"}),f.jsx("option",{value:"overdue",children:"Overdue"})]}),f.jsxs("select",{value:a,onChange:z=>o(z.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Types"}),f.jsx("option",{value:"safety",children:"Safety"}),f.jsx("option",{value:"pre_season",children:"Pre-Season"}),f.jsx("option",{value:"compliance",children:"Compliance"}),f.jsx("option",{value:"maintenance",children:"Maintenance"})]})]}),f.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:C.length===0?f.jsxs("div",{className:"col-span-full text-center py-12",children:[f.jsx("p",{className:"text-gray-500 text-lg",children:"No inspections found"}),f.jsx("p",{className:"text-gray-400 text-sm mt-2",children:e||r!=="all"?"Try adjusting your filters":"Schedule your first inspection to get started"})]}):C.map((z,U)=>f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:U*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:z.title}),f.jsxs("p",{className:"text-sm text-gray-600",children:["Type: ",z.type]})]}),f.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${B(z.status)}`,children:z.status==="in_progress"?"In Progress":z.status.charAt(0).toUpperCase()+z.status.slice(1)})]}),f.jsxs("div",{className:"space-y-3 mb-4",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Inspector:"}),f.jsx("span",{className:"text-sm font-medium",children:z.inspector})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Scheduled:"}),f.jsxs("span",{className:"text-sm font-medium",children:[new Date(z.scheduled_date).toLocaleDateString()," at ",new Date(z.scheduled_date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),z.completed_date&&f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Completed:"}),f.jsx("span",{className:"text-sm font-medium",children:new Date(z.completed_date).toLocaleDateString()})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Progress:"}),f.jsxs("span",{className:"text-sm font-medium",children:[z.progress,"%"]})]}),z.score>0&&f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Score:"}),f.jsxs("span",{className:`text-sm font-bold ${R(z.score)}`,children:[z.score,"%"]})]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:f.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${z.status==="completed"?"bg-green-500":"bg-blue-500"}`,style:{width:`${z.progress}%`}})}),f.jsx("div",{className:"flex gap-2",children:z.status==="completed"?f.jsxs(f.Fragment,{children:[f.jsxs("button",{className:"flex items-center px-3 py-2 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(Li,{className:"h-4 w-4 mr-1"}),"Download PDF"]}),f.jsxs("button",{className:"flex items-center px-3 py-2 text-sm text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[f.jsx(vd,{className:"h-4 w-4 mr-1"}),"View Report"]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("button",{onClick:()=>{N(z.id,"in_progress")},className:"flex items-center px-3 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Ga,{className:"h-4 w-4 mr-1"}),"Start Inspection"]}),f.jsxs("button",{onClick:()=>F(z),className:"flex items-center px-3 py-2 text-sm text-blue-600 border border-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[f.jsx(qn,{className:"h-4 w-4 mr-1"}),"Edit"]}),f.jsx("button",{onClick:()=>{k(z.id)},className:"flex items-center px-3 py-2 text-sm text-red-600 border border-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"Delete"})]})})]},z.id))}),f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Inspection Templates"}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:tT.map(z=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-green-300 transition-colors cursor-pointer",children:[f.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:z.name}),f.jsx("p",{className:"text-sm text-gray-500",children:z.frequency})]},z.id))})]}),f.jsx(eT,{isOpen:l,onClose:W,onSave:S,inspection:g})]})}const nT=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=a=>{try{const o=new Uint8Array(a.target?.result),l=Jo(o,{type:"array"}),h=l.SheetNames[0];if(!h)throw new Error("No sheets found in workbook");const g=l.Sheets[h];if(!g)throw new Error("Worksheet not found");const m=Rr.sheet_to_json(g,{raw:!1}),p=[],w=[];m.forEach((E,A)=>{const T=A+2,_=[],C=M=>{const V=E[M];return typeof V=="string"?V:String(V||"")},S=C("SKU");(!S||S.trim()==="")&&(w.push({row:T,field:"SKU",message:"SKU is required"}),_.push("SKU"));const k=C("Name");(!k||k.trim()==="")&&(w.push({row:T,field:"Name",message:"Name is required"}),_.push("Name"));const N=C("Category");(!N||N.trim()==="")&&(w.push({row:T,field:"Category",message:"Category is required"}),_.push("Category"));const F=C("Unit");(!F||F.trim()==="")&&(w.push({row:T,field:"Unit",message:"Unit is required"}),_.push("Unit"));const W=C("Location");(!W||W.trim()==="")&&(w.push({row:T,field:"Location",message:"Location is required"}),_.push("Location"));const B=parseFloat(C("Current Stock")||"0"),R=parseFloat(C("Min Stock")||"0"),z=parseFloat(C("Max Stock")||"0"),U=C("Unit Cost"),fe=U?parseFloat(U):void 0;if(isNaN(B)&&(w.push({row:T,field:"Current Stock",message:"Must be a valid number"}),_.push("Current Stock")),isNaN(R)&&(w.push({row:T,field:"Min Stock",message:"Must be a valid number"}),_.push("Min Stock")),isNaN(z)&&(w.push({row:T,field:"Max Stock",message:"Must be a valid number"}),_.push("Max Stock")),U&&fe!==void 0&&isNaN(fe)&&(w.push({row:T,field:"Unit Cost",message:"Must be a valid number"}),_.push("Unit Cost")),z<R&&(w.push({row:T,field:"Max Stock",message:"Max stock must be greater than min stock"}),_.push("Max Stock")),_.length===0){const M=B===0?"out_of_stock":B<=R?"low_stock":"in_stock",V=C("Supplier");p.push({sku:S.trim(),name:k.trim(),category:N.trim(),current_stock:B,min_stock:R,max_stock:z,unit:F.trim(),location:W.trim(),supplier:V?.trim()||void 0,unit_cost:fe,status:M,last_updated:new Date().toISOString()})}}),t({records:p,errors:w})}catch(o){r(o)}},n.onerror=a=>r(a),n.readAsArrayBuffer(e)}),aT=()=>{const e=[{SKU:"ITEM-001",Name:"Sample Item",Category:"Raw Materials","Current Stock":"100","Min Stock":"20","Max Stock":"200",Unit:"pieces",Location:"Warehouse A",Supplier:"ABC Suppliers","Unit Cost":"15.50"},{SKU:"ITEM-002",Name:"Another Item",Category:"Spare Parts","Current Stock":"50","Min Stock":"10","Max Stock":"100",Unit:"units",Location:"Warehouse B",Supplier:"XYZ Company","Unit Cost":"25.00"}],t=Rr.json_to_sheet(e);t["!cols"]=[{wch:12},{wch:25},{wch:15},{wch:15},{wch:12},{wch:12},{wch:10},{wch:15},{wch:20},{wch:12}];const r=Rr.book_new();Rr.book_append_sheet(r,t,"Inventory Items"),Ec(r,"inventory_upload_template.xlsx")},sT=e=>{const t=e.map(o=>({SKU:o.sku,Name:o.name,Category:o.category,"Current Stock":o.current_stock,"Min Stock":o.min_stock,"Max Stock":o.max_stock,Unit:o.unit,Location:o.location,Status:o.status,Supplier:o.supplier||"","Unit Cost":o.unit_cost||"","Last Updated":new Date(o.last_updated).toLocaleDateString()})),r=Rr.json_to_sheet(t);r["!cols"]=[{wch:12},{wch:25},{wch:15},{wch:15},{wch:12},{wch:12},{wch:10},{wch:15},{wch:12},{wch:20},{wch:12},{wch:15}];const n=Rr.book_new();Rr.book_append_sheet(n,r,"Inventory");const a=`inventory_export_${new Date().toISOString().split("T")[0]}.xlsx`;Ec(n,a)},iT=({isOpen:e,onClose:t,onUpload:r})=>{const[n,a]=Y.useState(null),[o,l]=Y.useState(!1),[h,g]=Y.useState(!1),[m,p]=Y.useState([]),[w,E]=Y.useState([]),[A,T]=Y.useState(!1);if(!e)return null;const _=F=>{const W=F.target.files?.[0];W&&(a(W),p([]),E([]),T(!1))},C=async()=>{if(n){l(!0);try{const F=await nT(n);p(F.records),E(F.errors)}catch(F){console.error("Failed to parse file:",F),E([{row:0,field:"File",message:"Failed to parse Excel file. Please check the file format."}])}finally{l(!1)}}},S=async()=>{if(m.length!==0){g(!0);try{await r(m),T(!0)}catch(F){console.error("Failed to upload items:",F),E([{row:0,field:"Upload",message:"Failed to upload items. Please try again."}])}finally{g(!1)}}},k=()=>{a(null),p([]),E([]),T(!1),t()},N=()=>{aT()};return f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[f.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 px-6 py-4 flex justify-between items-center",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(Mi,{className:"h-6 w-6 text-white"}),f.jsx("h2",{className:"text-xl font-bold text-white",children:"Bulk Inventory Upload"})]}),f.jsx("button",{onClick:k,className:"text-white hover:text-gray-200 transition-colors",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:A?f.jsxs("div",{className:"text-center py-12",children:[f.jsx(Ga,{className:"h-16 w-16 text-green-600 mx-auto mb-4"}),f.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Upload Complete!"}),f.jsxs("p",{className:"text-gray-600 mb-6",children:["Successfully uploaded ",m.length," inventory item",m.length!==1?"s":"","."]}),f.jsx("button",{onClick:k,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"How to use bulk upload:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[f.jsx("li",{children:"Download the Excel template using the button below"}),f.jsx("li",{children:"Fill in your inventory items following the template format"}),f.jsx("li",{children:"Required fields: SKU, Name, Category, Current Stock, Min Stock, Max Stock, Unit, Location"}),f.jsx("li",{children:"Optional fields: Supplier, Unit Cost"}),f.jsx("li",{children:'Upload the completed file and click "Parse File"'}),f.jsx("li",{children:"Review the parsed data and fix any errors"}),f.jsx("li",{children:'Click "Upload Items" to save to database'})]})]}),f.jsx("div",{className:"mb-6",children:f.jsxs("button",{onClick:N,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Li,{className:"h-5 w-5"}),"Download Excel Template"]})}),f.jsxs("div",{className:"mb-6",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Excel File"}),f.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:_,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-lg file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-50 file:text-blue-700
                    hover:file:bg-blue-100
                    cursor-pointer`}),n&&f.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Selected: ",n.name]})]}),n&&!m.length&&!w.length&&f.jsx("button",{onClick:()=>void C(),disabled:o,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors mb-6",children:o?"Parsing...":"Parse File"}),w.length>0&&f.jsx("div",{className:"mb-6",children:f.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-start gap-2 mb-3",children:[f.jsx(to,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),f.jsxs("div",{children:[f.jsxs("h4",{className:"font-semibold text-red-900",children:[w.length," Error",w.length!==1?"s":""," Found"]}),f.jsx("p",{className:"text-sm text-red-700",children:"Please fix the following errors in your Excel file and try again:"})]})]}),f.jsx("div",{className:"max-h-60 overflow-y-auto",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-red-100",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-left text-red-900",children:"Row"}),f.jsx("th",{className:"px-3 py-2 text-left text-red-900",children:"Field"}),f.jsx("th",{className:"px-3 py-2 text-left text-red-900",children:"Error"})]})}),f.jsx("tbody",{className:"divide-y divide-red-200",children:w.map((F,W)=>f.jsxs("tr",{className:"hover:bg-red-50",children:[f.jsx("td",{className:"px-3 py-2 text-red-800",children:F.row}),f.jsx("td",{className:"px-3 py-2 text-red-800",children:F.field}),f.jsx("td",{className:"px-3 py-2 text-red-700",children:F.message})]},W))})]})})]})}),m.length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-4",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(Ga,{className:"h-5 w-5 text-green-600"}),f.jsxs("p",{className:"font-semibold text-green-900",children:["Successfully parsed ",m.length," item",m.length!==1?"s":""]})]})}),f.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:f.jsx("div",{className:"overflow-x-auto max-h-96",children:f.jsxs("table",{className:"w-full text-sm",children:[f.jsx("thead",{className:"bg-gray-100 sticky top-0",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"SKU"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Name"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Category"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Current"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Min"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Max"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Unit"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Location"}),f.jsx("th",{className:"px-3 py-2 text-left text-gray-900",children:"Status"})]})}),f.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map((F,W)=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-3 py-2 text-gray-900 font-medium",children:F.sku}),f.jsx("td",{className:"px-3 py-2 text-gray-900",children:F.name}),f.jsx("td",{className:"px-3 py-2 text-gray-700",children:F.category}),f.jsx("td",{className:"px-3 py-2 text-gray-700",children:F.current_stock}),f.jsx("td",{className:"px-3 py-2 text-gray-700",children:F.min_stock}),f.jsx("td",{className:"px-3 py-2 text-gray-700",children:F.max_stock}),f.jsx("td",{className:"px-3 py-2 text-gray-700",children:F.unit}),f.jsx("td",{className:"px-3 py-2 text-gray-700",children:F.location}),f.jsx("td",{className:"px-3 py-2",children:f.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${F.status==="in_stock"?"bg-green-100 text-green-800":F.status==="low_stock"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:F.status.replace("_"," ")})})]},W))})]})})})]})]})}),!A&&m.length>0&&w.length===0&&f.jsxs("div",{className:"border-t border-gray-200 px-6 py-4 bg-gray-50 flex justify-end gap-3",children:[f.jsx("button",{onClick:k,disabled:h,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),f.jsx("button",{onClick:()=>void S(),disabled:h,className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:h?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Uploading..."]}):f.jsxs(f.Fragment,{children:[f.jsx(Mi,{className:"h-4 w-4"}),"Upload ",m.length," Item",m.length!==1?"s":""]})})]})]})})};function Te(e,t,r){function n(h,g){var m;Object.defineProperty(h,"_zod",{value:h._zod??{},enumerable:!1}),(m=h._zod).traits??(m.traits=new Set),h._zod.traits.add(e),t(h,g);for(const p in l.prototype)p in h||Object.defineProperty(h,p,{value:l.prototype[p].bind(h)});h._zod.constr=l,h._zod.def=g}const a=r?.Parent??Object;class o extends a{}Object.defineProperty(o,"name",{value:e});function l(h){var g;const m=r?.Parent?new o:this;n(m,h),(g=m._zod).deferred??(g.deferred=[]);for(const p of m._zod.deferred)p();return m}return Object.defineProperty(l,"init",{value:n}),Object.defineProperty(l,Symbol.hasInstance,{value:h=>r?.Parent&&h instanceof r.Parent?!0:h?._zod?.traits?.has(e)}),Object.defineProperty(l,"name",{value:e}),l}class Ks extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class rx extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const nx={};function _s(e){return nx}function oT(e){const t=Object.values(e).filter(n=>typeof n=="number");return Object.entries(e).filter(([n,a])=>t.indexOf(+n)===-1).map(([n,a])=>a)}function Rl(e,t){return typeof t=="bigint"?t.toString():t}function O0(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function R0(e){return e==null}function M0(e){const t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function cT(e,t){const r=(e.toString().split(".")[1]||"").length,n=t.toString();let a=(n.split(".")[1]||"").length;if(a===0&&/\d?e-\d?/.test(n)){const g=n.match(/\d?e-(\d?)/);g?.[1]&&(a=Number.parseInt(g[1]))}const o=r>a?r:a,l=Number.parseInt(e.toFixed(o).replace(".","")),h=Number.parseInt(t.toFixed(o).replace(".",""));return l%h/10**o}const Ff=Symbol("evaluating");function Wt(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==Ff)return n===void 0&&(n=Ff,n=r()),n},set(a){Object.defineProperty(e,t,{value:a})},configurable:!0})}function Is(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function ks(...e){const t={};for(const r of e){const n=Object.getOwnPropertyDescriptors(r);Object.assign(t,n)}return Object.defineProperties({},t)}function Df(e){return JSON.stringify(e)}const ax="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function tc(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const lT=O0(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Ji(e){if(tc(e)===!1)return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(tc(r)===!1||Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")===!1)}function sx(e){return Ji(e)?{...e}:Array.isArray(e)?[...e]:e}const uT=new Set(["string","number","symbol"]);function Ac(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function rs(e,t,r){const n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function Ke(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function fT(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const dT={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function hT(e,t){const r=e._zod.def,n=ks(e._zod.def,{get shape(){const a={};for(const o in t){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&(a[o]=r.shape[o])}return Is(this,"shape",a),a},checks:[]});return rs(e,n)}function xT(e,t){const r=e._zod.def,n=ks(e._zod.def,{get shape(){const a={...e._zod.def.shape};for(const o in t){if(!(o in r.shape))throw new Error(`Unrecognized key: "${o}"`);t[o]&&delete a[o]}return Is(this,"shape",a),a},checks:[]});return rs(e,n)}function mT(e,t){if(!Ji(t))throw new Error("Invalid input to extend: expected a plain object");const r=e._zod.def.checks;if(r&&r.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const a=ks(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return Is(this,"shape",o),o},checks:[]});return rs(e,a)}function gT(e,t){if(!Ji(t))throw new Error("Invalid input to safeExtend: expected a plain object");const r={...e._zod.def,get shape(){const n={...e._zod.def.shape,...t};return Is(this,"shape",n),n},checks:e._zod.def.checks};return rs(e,r)}function pT(e,t){const r=ks(e._zod.def,{get shape(){const n={...e._zod.def.shape,...t._zod.def.shape};return Is(this,"shape",n),n},get catchall(){return t._zod.def.catchall},checks:[]});return rs(e,r)}function vT(e,t,r){const n=ks(t._zod.def,{get shape(){const a=t._zod.def.shape,o={...a};if(r)for(const l in r){if(!(l in a))throw new Error(`Unrecognized key: "${l}"`);r[l]&&(o[l]=e?new e({type:"optional",innerType:a[l]}):a[l])}else for(const l in a)o[l]=e?new e({type:"optional",innerType:a[l]}):a[l];return Is(this,"shape",o),o},checks:[]});return rs(t,n)}function wT(e,t,r){const n=ks(t._zod.def,{get shape(){const a=t._zod.def.shape,o={...a};if(r)for(const l in r){if(!(l in o))throw new Error(`Unrecognized key: "${l}"`);r[l]&&(o[l]=new e({type:"nonoptional",innerType:a[l]}))}else for(const l in a)o[l]=new e({type:"nonoptional",innerType:a[l]});return Is(this,"shape",o),o},checks:[]});return rs(t,n)}function Vs(e,t=0){if(e.aborted===!0)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function ix(e,t){return t.map(r=>{var n;return(n=r).path??(n.path=[]),r.path.unshift(e),r})}function Oo(e){return typeof e=="string"?e:e?.message}function bs(e,t,r){const n={...e,path:e.path??[]};if(!e.message){const a=Oo(e.inst?._zod.def?.error?.(e))??Oo(t?.error?.(e))??Oo(r.customError?.(e))??Oo(r.localeError?.(e))??"Invalid input";n.message=a}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function L0(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function eo(...e){const[t,r,n]=e;return typeof t=="string"?{message:t,code:"custom",input:r,inst:n}:{...t}}const ox=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,Rl,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},cx=Te("$ZodError",ox),lx=Te("$ZodError",ox,{Parent:Error});function yT(e,t=r=>r.message){const r={},n=[];for(const a of e.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}function _T(e,t=r=>r.message){const r={_errors:[]},n=a=>{for(const o of a.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(l=>n({issues:l}));else if(o.code==="invalid_key")n({issues:o.issues});else if(o.code==="invalid_element")n({issues:o.issues});else if(o.path.length===0)r._errors.push(t(o));else{let l=r,h=0;for(;h<o.path.length;){const g=o.path[h];h===o.path.length-1?(l[g]=l[g]||{_errors:[]},l[g]._errors.push(t(o))):l[g]=l[g]||{_errors:[]},l=l[g],h++}}};return n(e),r}const j0=e=>(t,r,n,a)=>{const o=n?Object.assign(n,{async:!1}):{async:!1},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise)throw new Ks;if(l.issues.length){const h=new(a?.Err??e)(l.issues.map(g=>bs(g,o,_s())));throw ax(h,a?.callee),h}return l.value},P0=e=>async(t,r,n,a)=>{const o=n?Object.assign(n,{async:!0}):{async:!0};let l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise&&(l=await l),l.issues.length){const h=new(a?.Err??e)(l.issues.map(g=>bs(g,o,_s())));throw ax(h,a?.callee),h}return l.value},Cc=e=>(t,r,n)=>{const a=n?{...n,async:!1}:{async:!1},o=t._zod.run({value:r,issues:[]},a);if(o instanceof Promise)throw new Ks;return o.issues.length?{success:!1,error:new(e??cx)(o.issues.map(l=>bs(l,a,_s())))}:{success:!0,data:o.value}},bT=Cc(lx),Sc=e=>async(t,r,n)=>{const a=n?Object.assign(n,{async:!0}):{async:!0};let o=t._zod.run({value:r,issues:[]},a);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(l=>bs(l,a,_s())))}:{success:!0,data:o.value}},ET=Sc(lx),AT=e=>(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return j0(e)(t,r,a)},CT=e=>(t,r,n)=>j0(e)(t,r,n),ST=e=>async(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return P0(e)(t,r,a)},TT=e=>async(t,r,n)=>P0(e)(t,r,n),NT=e=>(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Cc(e)(t,r,a)},IT=e=>(t,r,n)=>Cc(e)(t,r,n),kT=e=>async(t,r,n)=>{const a=n?Object.assign(n,{direction:"backward"}):{direction:"backward"};return Sc(e)(t,r,a)},FT=e=>async(t,r,n)=>Sc(e)(t,r,n),DT=/^[cC][^\s-]{8,}$/,OT=/^[0-9a-z]+$/,RT=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,MT=/^[0-9a-vA-V]{20}$/,LT=/^[A-Za-z0-9]{27}$/,jT=/^[a-zA-Z0-9_-]{21}$/,PT=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,BT=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Of=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,UT=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,zT="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function HT(){return new RegExp(zT,"u")}const WT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,VT=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,GT=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,XT=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,YT=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,ux=/^[A-Za-z0-9_-]*$/,ZT=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,$T=/^\+(?:[0-9]){6,14}[0-9]$/,fx="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",qT=new RegExp(`^${fx}$`);function dx(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function KT(e){return new RegExp(`^${dx(e)}$`)}function QT(e){const t=dx({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const n=`${t}(?:${r.join("|")})`;return new RegExp(`^${fx}T(?:${n})$`)}const JT=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},eN=/^-?\d+$/,tN=/^-?\d+(?:\.\d+)?/,rN=/^[^A-Z]*$/,nN=/^[^a-z]*$/,hn=Te("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),hx={number:"number",bigint:"bigint",object:"date"},xx=Te("$ZodCheckLessThan",(e,t)=>{hn.init(e,t);const r=hx[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,o=(t.inclusive?a.maximum:a.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?a.maximum=t.value:a.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),mx=Te("$ZodCheckGreaterThan",(e,t)=>{hn.init(e,t);const r=hx[typeof t.value];e._zod.onattach.push(n=>{const a=n._zod.bag,o=(t.inclusive?a.minimum:a.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?a.minimum=t.value:a.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),aN=Te("$ZodCheckMultipleOf",(e,t)=>{hn.init(e,t),e._zod.onattach.push(r=>{var n;(n=r._zod.bag).multipleOf??(n.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof r.value=="bigint"?r.value%t.value===BigInt(0):cT(r.value,t.value)===0)||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),sN=Te("$ZodCheckNumberFormat",(e,t)=>{hn.init(e,t),t.format=t.format||"float64";const r=t.format?.includes("int"),n=r?"int":"number",[a,o]=dT[t.format];e._zod.onattach.push(l=>{const h=l._zod.bag;h.format=t.format,h.minimum=a,h.maximum=o,r&&(h.pattern=eN)}),e._zod.check=l=>{const h=l.value;if(r){if(!Number.isInteger(h)){l.issues.push({expected:n,format:t.format,code:"invalid_type",continue:!1,input:h,inst:e});return}if(!Number.isSafeInteger(h)){h>0?l.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):l.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}h<a&&l.issues.push({origin:"number",input:h,code:"too_small",minimum:a,inclusive:!0,inst:e,continue:!t.abort}),h>o&&l.issues.push({origin:"number",input:h,code:"too_big",maximum:o,inst:e})}}),iN=Te("$ZodCheckMaxLength",(e,t)=>{var r;hn.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!R0(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<a&&(n._zod.bag.maximum=t.maximum)}),e._zod.check=n=>{const a=n.value;if(a.length<=t.maximum)return;const l=L0(a);n.issues.push({origin:l,code:"too_big",maximum:t.maximum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),oN=Te("$ZodCheckMinLength",(e,t)=>{var r;hn.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!R0(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>a&&(n._zod.bag.minimum=t.minimum)}),e._zod.check=n=>{const a=n.value;if(a.length>=t.minimum)return;const l=L0(a);n.issues.push({origin:l,code:"too_small",minimum:t.minimum,inclusive:!0,input:a,inst:e,continue:!t.abort})}}),cN=Te("$ZodCheckLengthEquals",(e,t)=>{var r;hn.init(e,t),(r=e._zod.def).when??(r.when=n=>{const a=n.value;return!R0(a)&&a.length!==void 0}),e._zod.onattach.push(n=>{const a=n._zod.bag;a.minimum=t.length,a.maximum=t.length,a.length=t.length}),e._zod.check=n=>{const a=n.value,o=a.length;if(o===t.length)return;const l=L0(a),h=o>t.length;n.issues.push({origin:l,...h?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:n.value,inst:e,continue:!t.abort})}}),Tc=Te("$ZodCheckStringFormat",(e,t)=>{var r,n;hn.init(e,t),e._zod.onattach.push(a=>{const o=a._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=a=>{t.pattern.lastIndex=0,!t.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:t.format,input:a.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),lN=Te("$ZodCheckRegex",(e,t)=>{Tc.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),uN=Te("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=rN),Tc.init(e,t)}),fN=Te("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=nN),Tc.init(e,t)}),dN=Te("$ZodCheckIncludes",(e,t)=>{hn.init(e,t);const r=Ac(t.includes),n=new RegExp(typeof t.position=="number"?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(a=>{const o=a._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(n)}),e._zod.check=a=>{a.value.includes(t.includes,t.position)||a.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:a.value,inst:e,continue:!t.abort})}}),hN=Te("$ZodCheckStartsWith",(e,t)=>{hn.init(e,t);const r=new RegExp(`^${Ac(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.startsWith(t.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:n.value,inst:e,continue:!t.abort})}}),xN=Te("$ZodCheckEndsWith",(e,t)=>{hn.init(e,t);const r=new RegExp(`.*${Ac(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(n=>{const a=n._zod.bag;a.patterns??(a.patterns=new Set),a.patterns.add(r)}),e._zod.check=n=>{n.value.endsWith(t.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:n.value,inst:e,continue:!t.abort})}}),mN=Te("$ZodCheckOverwrite",(e,t)=>{hn.init(e,t),e._zod.check=r=>{r.value=t.tx(r.value)}});class gN{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const n=t.split(`
`).filter(l=>l),a=Math.min(...n.map(l=>l.length-l.trimStart().length)),o=n.map(l=>l.slice(a)).map(l=>" ".repeat(this.indent*2)+l);for(const l of o)this.content.push(l)}compile(){const t=Function,r=this?.args,a=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...r,a.join(`
`))}}const pN={major:4,minor:1,patch:12},br=Te("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=pN;const n=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&n.unshift(e);for(const a of n)for(const o of a._zod.onattach)o(e);if(n.length===0)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const a=(l,h,g)=>{let m=Vs(l),p;for(const w of h){if(w._zod.def.when){if(!w._zod.def.when(l))continue}else if(m)continue;const E=l.issues.length,A=w._zod.check(l);if(A instanceof Promise&&g?.async===!1)throw new Ks;if(p||A instanceof Promise)p=(p??Promise.resolve()).then(async()=>{await A,l.issues.length!==E&&(m||(m=Vs(l,E)))});else{if(l.issues.length===E)continue;m||(m=Vs(l,E))}}return p?p.then(()=>l):l},o=(l,h,g)=>{if(Vs(l))return l.aborted=!0,l;const m=a(h,n,g);if(m instanceof Promise){if(g.async===!1)throw new Ks;return m.then(p=>e._zod.parse(p,g))}return e._zod.parse(m,g)};e._zod.run=(l,h)=>{if(h.skipChecks)return e._zod.parse(l,h);if(h.direction==="backward"){const m=e._zod.parse({value:l.value,issues:[]},{...h,skipChecks:!0});return m instanceof Promise?m.then(p=>o(p,l,h)):o(m,l,h)}const g=e._zod.parse(l,h);if(g instanceof Promise){if(h.async===!1)throw new Ks;return g.then(m=>a(m,n,h))}return a(g,n,h)}}e["~standard"]={validate:a=>{try{const o=bT(e,a);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return ET(e,a).then(l=>l.success?{value:l.data}:{issues:l.error?.issues})}},vendor:"zod",version:1}}),B0=Te("$ZodString",(e,t)=>{br.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??JT(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),Qt=Te("$ZodStringFormat",(e,t)=>{Tc.init(e,t),B0.init(e,t)}),vN=Te("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=BT),Qt.init(e,t)}),wN=Te("$ZodUUID",(e,t)=>{if(t.version){const n={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(n===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=Of(n))}else t.pattern??(t.pattern=Of());Qt.init(e,t)}),yN=Te("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=UT),Qt.init(e,t)}),_N=Te("$ZodURL",(e,t)=>{Qt.init(e,t),e._zod.check=r=>{try{const n=r.value.trim(),a=new URL(n);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(a.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:ZT.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(a.protocol.endsWith(":")?a.protocol.slice(0,-1):a.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),t.normalize?r.value=a.href:r.value=n;return}catch{r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),bN=Te("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=HT()),Qt.init(e,t)}),EN=Te("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=jT),Qt.init(e,t)}),AN=Te("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=DT),Qt.init(e,t)}),CN=Te("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=OT),Qt.init(e,t)}),SN=Te("$ZodULID",(e,t)=>{t.pattern??(t.pattern=RT),Qt.init(e,t)}),TN=Te("$ZodXID",(e,t)=>{t.pattern??(t.pattern=MT),Qt.init(e,t)}),NN=Te("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=LT),Qt.init(e,t)}),IN=Te("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=QT(t)),Qt.init(e,t)}),kN=Te("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=qT),Qt.init(e,t)}),FN=Te("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=KT(t)),Qt.init(e,t)}),DN=Te("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=PT),Qt.init(e,t)}),ON=Te("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=WT),Qt.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv4"})}),RN=Te("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=VT),Qt.init(e,t),e._zod.onattach.push(r=>{const n=r._zod.bag;n.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),MN=Te("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=GT),Qt.init(e,t)}),LN=Te("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=XT),Qt.init(e,t),e._zod.check=r=>{const n=r.value.split("/");try{if(n.length!==2)throw new Error;const[a,o]=n;if(!o)throw new Error;const l=Number(o);if(`${l}`!==o)throw new Error;if(l<0||l>128)throw new Error;new URL(`http://[${a}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function gx(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const jN=Te("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=YT),Qt.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{gx(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}});function PN(e){if(!ux.test(e))return!1;const t=e.replace(/[-_]/g,n=>n==="-"?"+":"/"),r=t.padEnd(Math.ceil(t.length/4)*4,"=");return gx(r)}const BN=Te("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=ux),Qt.init(e,t),e._zod.onattach.push(r=>{r._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{PN(r.value)||r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),UN=Te("$ZodE164",(e,t)=>{t.pattern??(t.pattern=$T),Qt.init(e,t)});function zN(e,t=null){try{const r=e.split(".");if(r.length!==3)return!1;const[n]=r;if(!n)return!1;const a=JSON.parse(atob(n));return!("typ"in a&&a?.typ!=="JWT"||!a.alg||t&&(!("alg"in a)||a.alg!==t))}catch{return!1}}const HN=Te("$ZodJWT",(e,t)=>{Qt.init(e,t),e._zod.check=r=>{zN(r.value,t.alg)||r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),px=Te("$ZodNumber",(e,t)=>{br.init(e,t),e._zod.pattern=e._zod.bag.pattern??tN,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch{}const a=r.value;if(typeof a=="number"&&!Number.isNaN(a)&&Number.isFinite(a))return r;const o=typeof a=="number"?Number.isNaN(a)?"NaN":Number.isFinite(a)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:a,inst:e,...o?{received:o}:{}}),r}}),WN=Te("$ZodNumber",(e,t)=>{sN.init(e,t),px.init(e,t)}),VN=Te("$ZodUnknown",(e,t)=>{br.init(e,t),e._zod.parse=r=>r}),GN=Te("$ZodNever",(e,t)=>{br.init(e,t),e._zod.parse=(r,n)=>(r.issues.push({expected:"never",code:"invalid_type",input:r.value,inst:e}),r)});function Rf(e,t,r){e.issues.length&&t.issues.push(...ix(r,e.issues)),t.value[r]=e.value}const XN=Te("$ZodArray",(e,t)=>{br.init(e,t),e._zod.parse=(r,n)=>{const a=r.value;if(!Array.isArray(a))return r.issues.push({expected:"array",code:"invalid_type",input:a,inst:e}),r;r.value=Array(a.length);const o=[];for(let l=0;l<a.length;l++){const h=a[l],g=t.element._zod.run({value:h,issues:[]},n);g instanceof Promise?o.push(g.then(m=>Rf(m,r,l))):Rf(g,r,l)}return o.length?Promise.all(o).then(()=>r):r}});function rc(e,t,r,n){e.issues.length&&t.issues.push(...ix(r,e.issues)),e.value===void 0?r in n&&(t.value[r]=void 0):t.value[r]=e.value}function vx(e){const t=Object.keys(e.shape);for(const n of t)if(!e.shape?.[n]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const r=fT(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(r)}}function wx(e,t,r,n,a,o){const l=[],h=a.keySet,g=a.catchall._zod,m=g.def.type;for(const p of Object.keys(t)){if(h.has(p))continue;if(m==="never"){l.push(p);continue}const w=g.run({value:t[p],issues:[]},n);w instanceof Promise?e.push(w.then(E=>rc(E,r,p,t))):rc(w,r,p,t)}return l.length&&r.issues.push({code:"unrecognized_keys",keys:l,input:t,inst:o}),e.length?Promise.all(e).then(()=>r):r}const YN=Te("$ZodObject",(e,t)=>{if(br.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const h=t.shape;Object.defineProperty(t,"shape",{get:()=>{const g={...h};return Object.defineProperty(t,"shape",{value:g}),g}})}const n=O0(()=>vx(t));Wt(e._zod,"propValues",()=>{const h=t.shape,g={};for(const m in h){const p=h[m]._zod;if(p.values){g[m]??(g[m]=new Set);for(const w of p.values)g[m].add(w)}}return g});const a=tc,o=t.catchall;let l;e._zod.parse=(h,g)=>{l??(l=n.value);const m=h.value;if(!a(m))return h.issues.push({expected:"object",code:"invalid_type",input:m,inst:e}),h;h.value={};const p=[],w=l.shape;for(const E of l.keys){const T=w[E]._zod.run({value:m[E],issues:[]},g);T instanceof Promise?p.push(T.then(_=>rc(_,h,E,m))):rc(T,h,E,m)}return o?wx(p,m,h,g,n.value,e):p.length?Promise.all(p).then(()=>h):h}}),ZN=Te("$ZodObjectJIT",(e,t)=>{YN.init(e,t);const r=e._zod.parse,n=O0(()=>vx(t)),a=E=>{const A=new gN(["shape","payload","ctx"]),T=n.value,_=N=>{const F=Df(N);return`shape[${F}]._zod.run({ value: input[${F}], issues: [] }, ctx)`};A.write("const input = payload.value;");const C=Object.create(null);let S=0;for(const N of T.keys)C[N]=`key_${S++}`;A.write("const newResult = {};");for(const N of T.keys){const F=C[N],W=Df(N);A.write(`const ${F} = ${_(N)};`),A.write(`
        if (${F}.issues.length) {
          payload.issues = payload.issues.concat(${F}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${W}, ...iss.path] : [${W}]
          })));
        }
        
        
        if (${F}.value === undefined) {
          if (${W} in input) {
            newResult[${W}] = undefined;
          }
        } else {
          newResult[${W}] = ${F}.value;
        }
        
      `)}A.write("payload.value = newResult;"),A.write("return payload;");const k=A.compile();return(N,F)=>k(E,N,F)};let o;const l=tc,h=!nx.jitless,m=h&&lT.value,p=t.catchall;let w;e._zod.parse=(E,A)=>{w??(w=n.value);const T=E.value;return l(T)?h&&m&&A?.async===!1&&A.jitless!==!0?(o||(o=a(t.shape)),E=o(E,A),p?wx([],T,E,A,w,e):E):r(E,A):(E.issues.push({expected:"object",code:"invalid_type",input:T,inst:e}),E)}});function Mf(e,t,r,n){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const a=e.filter(o=>!Vs(o));return a.length===1?(t.value=a[0].value,a[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(o=>o.issues.map(l=>bs(l,n,_s())))}),t)}const $N=Te("$ZodUnion",(e,t)=>{br.init(e,t),Wt(e._zod,"optin",()=>t.options.some(a=>a._zod.optin==="optional")?"optional":void 0),Wt(e._zod,"optout",()=>t.options.some(a=>a._zod.optout==="optional")?"optional":void 0),Wt(e._zod,"values",()=>{if(t.options.every(a=>a._zod.values))return new Set(t.options.flatMap(a=>Array.from(a._zod.values)))}),Wt(e._zod,"pattern",()=>{if(t.options.every(a=>a._zod.pattern)){const a=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${a.map(o=>M0(o.source)).join("|")})$`)}});const r=t.options.length===1,n=t.options[0]._zod.run;e._zod.parse=(a,o)=>{if(r)return n(a,o);let l=!1;const h=[];for(const g of t.options){const m=g._zod.run({value:a.value,issues:[]},o);if(m instanceof Promise)h.push(m),l=!0;else{if(m.issues.length===0)return m;h.push(m)}}return l?Promise.all(h).then(g=>Mf(g,a,e,o)):Mf(h,a,e,o)}}),qN=Te("$ZodIntersection",(e,t)=>{br.init(e,t),e._zod.parse=(r,n)=>{const a=r.value,o=t.left._zod.run({value:a,issues:[]},n),l=t.right._zod.run({value:a,issues:[]},n);return o instanceof Promise||l instanceof Promise?Promise.all([o,l]).then(([g,m])=>Lf(r,g,m)):Lf(r,o,l)}});function Ml(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Ji(e)&&Ji(t)){const r=Object.keys(t),n=Object.keys(e).filter(o=>r.indexOf(o)!==-1),a={...e,...t};for(const o of n){const l=Ml(e[o],t[o]);if(!l.valid)return{valid:!1,mergeErrorPath:[o,...l.mergeErrorPath]};a[o]=l.data}return{valid:!0,data:a}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const r=[];for(let n=0;n<e.length;n++){const a=e[n],o=t[n],l=Ml(a,o);if(!l.valid)return{valid:!1,mergeErrorPath:[n,...l.mergeErrorPath]};r.push(l.data)}return{valid:!0,data:r}}return{valid:!1,mergeErrorPath:[]}}function Lf(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),Vs(e))return e;const n=Ml(t.value,r.value);if(!n.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}const KN=Te("$ZodEnum",(e,t)=>{br.init(e,t);const r=oT(t.entries),n=new Set(r);e._zod.values=n,e._zod.pattern=new RegExp(`^(${r.filter(a=>uT.has(typeof a)).map(a=>typeof a=="string"?Ac(a):a.toString()).join("|")})$`),e._zod.parse=(a,o)=>{const l=a.value;return n.has(l)||a.issues.push({code:"invalid_value",values:r,input:l,inst:e}),a}}),QN=Te("$ZodTransform",(e,t)=>{br.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new rx(e.constructor.name);const a=t.transform(r.value,r);if(n.async)return(a instanceof Promise?a:Promise.resolve(a)).then(l=>(r.value=l,r));if(a instanceof Promise)throw new Ks;return r.value=a,r}});function jf(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const JN=Te("$ZodOptional",(e,t)=>{br.init(e,t),e._zod.optin="optional",e._zod.optout="optional",Wt(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),Wt(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${M0(r.source)})?$`):void 0}),e._zod.parse=(r,n)=>{if(t.innerType._zod.optin==="optional"){const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(o=>jf(o,r.value)):jf(a,r.value)}return r.value===void 0?r:t.innerType._zod.run(r,n)}}),e6=Te("$ZodNullable",(e,t)=>{br.init(e,t),Wt(e._zod,"optin",()=>t.innerType._zod.optin),Wt(e._zod,"optout",()=>t.innerType._zod.optout),Wt(e._zod,"pattern",()=>{const r=t.innerType._zod.pattern;return r?new RegExp(`^(${M0(r.source)}|null)$`):void 0}),Wt(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(r,n)=>r.value===null?r:t.innerType._zod.run(r,n)}),t6=Te("$ZodDefault",(e,t)=>{br.init(e,t),e._zod.optin="optional",Wt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);if(r.value===void 0)return r.value=t.defaultValue,r;const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(o=>Pf(o,t)):Pf(a,t)}});function Pf(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const r6=Te("$ZodPrefault",(e,t)=>{br.init(e,t),e._zod.optin="optional",Wt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>(n.direction==="backward"||r.value===void 0&&(r.value=t.defaultValue),t.innerType._zod.run(r,n))}),n6=Te("$ZodNonOptional",(e,t)=>{br.init(e,t),Wt(e._zod,"values",()=>{const r=t.innerType._zod.values;return r?new Set([...r].filter(n=>n!==void 0)):void 0}),e._zod.parse=(r,n)=>{const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(o=>Bf(o,e)):Bf(a,e)}});function Bf(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const a6=Te("$ZodCatch",(e,t)=>{br.init(e,t),Wt(e._zod,"optin",()=>t.innerType._zod.optin),Wt(e._zod,"optout",()=>t.innerType._zod.optout),Wt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(o=>(r.value=o.value,o.issues.length&&(r.value=t.catchValue({...r,error:{issues:o.issues.map(l=>bs(l,n,_s()))},input:r.value}),r.issues=[]),r)):(r.value=a.value,a.issues.length&&(r.value=t.catchValue({...r,error:{issues:a.issues.map(o=>bs(o,n,_s()))},input:r.value}),r.issues=[]),r)}}),s6=Te("$ZodPipe",(e,t)=>{br.init(e,t),Wt(e._zod,"values",()=>t.in._zod.values),Wt(e._zod,"optin",()=>t.in._zod.optin),Wt(e._zod,"optout",()=>t.out._zod.optout),Wt(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(r,n)=>{if(n.direction==="backward"){const o=t.out._zod.run(r,n);return o instanceof Promise?o.then(l=>Ro(l,t.in,n)):Ro(o,t.in,n)}const a=t.in._zod.run(r,n);return a instanceof Promise?a.then(o=>Ro(o,t.out,n)):Ro(a,t.out,n)}});function Ro(e,t,r){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},r)}const i6=Te("$ZodReadonly",(e,t)=>{br.init(e,t),Wt(e._zod,"propValues",()=>t.innerType._zod.propValues),Wt(e._zod,"values",()=>t.innerType._zod.values),Wt(e._zod,"optin",()=>t.innerType._zod.optin),Wt(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(r,n)=>{if(n.direction==="backward")return t.innerType._zod.run(r,n);const a=t.innerType._zod.run(r,n);return a instanceof Promise?a.then(Uf):Uf(a)}});function Uf(e){return e.value=Object.freeze(e.value),e}const o6=Te("$ZodCustom",(e,t)=>{hn.init(e,t),br.init(e,t),e._zod.parse=(r,n)=>r,e._zod.check=r=>{const n=r.value,a=t.fn(n);if(a instanceof Promise)return a.then(o=>zf(o,r,n,e));zf(a,r,n,e)}});function zf(e,t,r,n){if(!e){const a={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(a.params=n._zod.def.params),t.issues.push(eo(a))}}class c6{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...r){const n=r[0];if(this._map.set(t,n),n&&typeof n=="object"&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const r=this._map.get(t);return r&&typeof r=="object"&&"id"in r&&this._idmap.delete(r.id),this._map.delete(t),this}get(t){const r=t._zod.parent;if(r){const n={...this.get(r)??{}};delete n.id;const a={...n,...this._map.get(t)};return Object.keys(a).length?a:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function l6(){return new c6}const Mo=l6();function u6(e,t){return new e({type:"string",...Ke(t)})}function f6(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...Ke(t)})}function Hf(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...Ke(t)})}function d6(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...Ke(t)})}function h6(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...Ke(t)})}function x6(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...Ke(t)})}function m6(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...Ke(t)})}function g6(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...Ke(t)})}function p6(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...Ke(t)})}function v6(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...Ke(t)})}function w6(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...Ke(t)})}function y6(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...Ke(t)})}function _6(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...Ke(t)})}function b6(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...Ke(t)})}function E6(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...Ke(t)})}function A6(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...Ke(t)})}function C6(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...Ke(t)})}function S6(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...Ke(t)})}function T6(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...Ke(t)})}function N6(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...Ke(t)})}function I6(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...Ke(t)})}function k6(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...Ke(t)})}function F6(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...Ke(t)})}function D6(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...Ke(t)})}function O6(e,t){return new e({type:"string",format:"date",check:"string_format",...Ke(t)})}function R6(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...Ke(t)})}function M6(e,t){return new e({type:"string",format:"duration",check:"string_format",...Ke(t)})}function L6(e,t){return new e({type:"number",coerce:!0,checks:[],...Ke(t)})}function j6(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...Ke(t)})}function P6(e){return new e({type:"unknown"})}function B6(e,t){return new e({type:"never",...Ke(t)})}function Wf(e,t){return new xx({check:"less_than",...Ke(t),value:e,inclusive:!1})}function dl(e,t){return new xx({check:"less_than",...Ke(t),value:e,inclusive:!0})}function Vf(e,t){return new mx({check:"greater_than",...Ke(t),value:e,inclusive:!1})}function hl(e,t){return new mx({check:"greater_than",...Ke(t),value:e,inclusive:!0})}function Gf(e,t){return new aN({check:"multiple_of",...Ke(t),value:e})}function yx(e,t){return new iN({check:"max_length",...Ke(t),maximum:e})}function nc(e,t){return new oN({check:"min_length",...Ke(t),minimum:e})}function _x(e,t){return new cN({check:"length_equals",...Ke(t),length:e})}function U6(e,t){return new lN({check:"string_format",format:"regex",...Ke(t),pattern:e})}function z6(e){return new uN({check:"string_format",format:"lowercase",...Ke(e)})}function H6(e){return new fN({check:"string_format",format:"uppercase",...Ke(e)})}function W6(e,t){return new dN({check:"string_format",format:"includes",...Ke(t),includes:e})}function V6(e,t){return new hN({check:"string_format",format:"starts_with",...Ke(t),prefix:e})}function G6(e,t){return new xN({check:"string_format",format:"ends_with",...Ke(t),suffix:e})}function ho(e){return new mN({check:"overwrite",tx:e})}function X6(e){return ho(t=>t.normalize(e))}function Y6(){return ho(e=>e.trim())}function Z6(){return ho(e=>e.toLowerCase())}function $6(){return ho(e=>e.toUpperCase())}function q6(e,t,r){return new e({type:"array",element:t,...Ke(r)})}function K6(e,t,r){return new e({type:"custom",check:"custom",fn:t,...Ke(r)})}function Q6(e){const t=J6(r=>(r.addIssue=n=>{if(typeof n=="string")r.issues.push(eo(n,r.value,t._zod.def));else{const a=n;a.fatal&&(a.continue=!1),a.code??(a.code="custom"),a.input??(a.input=r.value),a.inst??(a.inst=t),a.continue??(a.continue=!t._zod.def.abort),r.issues.push(eo(a))}},e(r.value,r)));return t}function J6(e,t){const r=new hn({check:"custom",...Ke(t)});return r._zod.check=e,r}const e8=Te("ZodISODateTime",(e,t)=>{IN.init(e,t),ar.init(e,t)});function t8(e){return D6(e8,e)}const r8=Te("ZodISODate",(e,t)=>{kN.init(e,t),ar.init(e,t)});function n8(e){return O6(r8,e)}const a8=Te("ZodISOTime",(e,t)=>{FN.init(e,t),ar.init(e,t)});function s8(e){return R6(a8,e)}const i8=Te("ZodISODuration",(e,t)=>{DN.init(e,t),ar.init(e,t)});function o8(e){return M6(i8,e)}const bx=(e,t)=>{cx.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:r=>_T(e,r)},flatten:{value:r=>yT(e,r)},addIssue:{value:r=>{e.issues.push(r),e.message=JSON.stringify(e.issues,Rl,2)}},addIssues:{value:r=>{e.issues.push(...r),e.message=JSON.stringify(e.issues,Rl,2)}},isEmpty:{get(){return e.issues.length===0}}})},c8=Te("ZodError",bx),Hn=Te("ZodError",bx,{Parent:Error}),l8=j0(Hn),u8=P0(Hn),f8=Cc(Hn),d8=Sc(Hn),h8=AT(Hn),x8=CT(Hn),m8=ST(Hn),g8=TT(Hn),p8=NT(Hn),v8=IT(Hn),w8=kT(Hn),y8=FT(Hn),Nr=Te("ZodType",(e,t)=>(br.init(e,t),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone(ks(t,{checks:[...t.checks??[],...r.map(n=>typeof n=="function"?{_zod:{check:n,def:{check:"custom"},onattach:[]}}:n)]})),e.clone=(r,n)=>rs(e,r,n),e.brand=()=>e,e.register=(r,n)=>(r.add(e,n),e),e.parse=(r,n)=>l8(e,r,n,{callee:e.parse}),e.safeParse=(r,n)=>f8(e,r,n),e.parseAsync=async(r,n)=>u8(e,r,n,{callee:e.parseAsync}),e.safeParseAsync=async(r,n)=>d8(e,r,n),e.spa=e.safeParseAsync,e.encode=(r,n)=>h8(e,r,n),e.decode=(r,n)=>x8(e,r,n),e.encodeAsync=async(r,n)=>m8(e,r,n),e.decodeAsync=async(r,n)=>g8(e,r,n),e.safeEncode=(r,n)=>p8(e,r,n),e.safeDecode=(r,n)=>v8(e,r,n),e.safeEncodeAsync=async(r,n)=>w8(e,r,n),e.safeDecodeAsync=async(r,n)=>y8(e,r,n),e.refine=(r,n)=>e.check(lI(r,n)),e.superRefine=r=>e.check(uI(r)),e.overwrite=r=>e.check(ho(r)),e.optional=()=>$f(e),e.nullable=()=>qf(e),e.nullish=()=>$f(qf(e)),e.nonoptional=r=>rI(e,r),e.array=()=>Cx(e),e.or=r=>X8([e,r]),e.and=r=>Z8(e,r),e.transform=r=>Kf(e,q8(r)),e.default=r=>J8(e,r),e.prefault=r=>tI(e,r),e.catch=r=>aI(e,r),e.pipe=r=>Kf(e,r),e.readonly=()=>oI(e),e.describe=r=>{const n=e.clone();return Mo.add(n,{description:r}),n},Object.defineProperty(e,"description",{get(){return Mo.get(e)?.description},configurable:!0}),e.meta=(...r)=>{if(r.length===0)return Mo.get(e);const n=e.clone();return Mo.add(n,r[0]),n},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),Ex=Te("_ZodString",(e,t)=>{B0.init(e,t),Nr.init(e,t);const r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...n)=>e.check(U6(...n)),e.includes=(...n)=>e.check(W6(...n)),e.startsWith=(...n)=>e.check(V6(...n)),e.endsWith=(...n)=>e.check(G6(...n)),e.min=(...n)=>e.check(nc(...n)),e.max=(...n)=>e.check(yx(...n)),e.length=(...n)=>e.check(_x(...n)),e.nonempty=(...n)=>e.check(nc(1,...n)),e.lowercase=n=>e.check(z6(n)),e.uppercase=n=>e.check(H6(n)),e.trim=()=>e.check(Y6()),e.normalize=(...n)=>e.check(X6(...n)),e.toLowerCase=()=>e.check(Z6()),e.toUpperCase=()=>e.check($6())}),_8=Te("ZodString",(e,t)=>{B0.init(e,t),Ex.init(e,t),e.email=r=>e.check(f6(b8,r)),e.url=r=>e.check(g6(E8,r)),e.jwt=r=>e.check(F6(P8,r)),e.emoji=r=>e.check(p6(A8,r)),e.guid=r=>e.check(Hf(Xf,r)),e.uuid=r=>e.check(d6(Lo,r)),e.uuidv4=r=>e.check(h6(Lo,r)),e.uuidv6=r=>e.check(x6(Lo,r)),e.uuidv7=r=>e.check(m6(Lo,r)),e.nanoid=r=>e.check(v6(C8,r)),e.guid=r=>e.check(Hf(Xf,r)),e.cuid=r=>e.check(w6(S8,r)),e.cuid2=r=>e.check(y6(T8,r)),e.ulid=r=>e.check(_6(N8,r)),e.base64=r=>e.check(N6(M8,r)),e.base64url=r=>e.check(I6(L8,r)),e.xid=r=>e.check(b6(I8,r)),e.ksuid=r=>e.check(E6(k8,r)),e.ipv4=r=>e.check(A6(F8,r)),e.ipv6=r=>e.check(C6(D8,r)),e.cidrv4=r=>e.check(S6(O8,r)),e.cidrv6=r=>e.check(T6(R8,r)),e.e164=r=>e.check(k6(j8,r)),e.datetime=r=>e.check(t8(r)),e.date=r=>e.check(n8(r)),e.time=r=>e.check(s8(r)),e.duration=r=>e.check(o8(r))});function zr(e){return u6(_8,e)}const ar=Te("ZodStringFormat",(e,t)=>{Qt.init(e,t),Ex.init(e,t)}),b8=Te("ZodEmail",(e,t)=>{yN.init(e,t),ar.init(e,t)}),Xf=Te("ZodGUID",(e,t)=>{vN.init(e,t),ar.init(e,t)}),Lo=Te("ZodUUID",(e,t)=>{wN.init(e,t),ar.init(e,t)}),E8=Te("ZodURL",(e,t)=>{_N.init(e,t),ar.init(e,t)}),A8=Te("ZodEmoji",(e,t)=>{bN.init(e,t),ar.init(e,t)}),C8=Te("ZodNanoID",(e,t)=>{EN.init(e,t),ar.init(e,t)}),S8=Te("ZodCUID",(e,t)=>{AN.init(e,t),ar.init(e,t)}),T8=Te("ZodCUID2",(e,t)=>{CN.init(e,t),ar.init(e,t)}),N8=Te("ZodULID",(e,t)=>{SN.init(e,t),ar.init(e,t)}),I8=Te("ZodXID",(e,t)=>{TN.init(e,t),ar.init(e,t)}),k8=Te("ZodKSUID",(e,t)=>{NN.init(e,t),ar.init(e,t)}),F8=Te("ZodIPv4",(e,t)=>{ON.init(e,t),ar.init(e,t)}),D8=Te("ZodIPv6",(e,t)=>{RN.init(e,t),ar.init(e,t)}),O8=Te("ZodCIDRv4",(e,t)=>{MN.init(e,t),ar.init(e,t)}),R8=Te("ZodCIDRv6",(e,t)=>{LN.init(e,t),ar.init(e,t)}),M8=Te("ZodBase64",(e,t)=>{jN.init(e,t),ar.init(e,t)}),L8=Te("ZodBase64URL",(e,t)=>{BN.init(e,t),ar.init(e,t)}),j8=Te("ZodE164",(e,t)=>{UN.init(e,t),ar.init(e,t)}),P8=Te("ZodJWT",(e,t)=>{HN.init(e,t),ar.init(e,t)}),Ax=Te("ZodNumber",(e,t)=>{px.init(e,t),Nr.init(e,t),e.gt=(n,a)=>e.check(Vf(n,a)),e.gte=(n,a)=>e.check(hl(n,a)),e.min=(n,a)=>e.check(hl(n,a)),e.lt=(n,a)=>e.check(Wf(n,a)),e.lte=(n,a)=>e.check(dl(n,a)),e.max=(n,a)=>e.check(dl(n,a)),e.int=n=>e.check(Yf(n)),e.safe=n=>e.check(Yf(n)),e.positive=n=>e.check(Vf(0,n)),e.nonnegative=n=>e.check(hl(0,n)),e.negative=n=>e.check(Wf(0,n)),e.nonpositive=n=>e.check(dl(0,n)),e.multipleOf=(n,a)=>e.check(Gf(n,a)),e.step=(n,a)=>e.check(Gf(n,a)),e.finite=()=>e;const r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null}),B8=Te("ZodNumberFormat",(e,t)=>{WN.init(e,t),Ax.init(e,t)});function Yf(e){return j6(B8,e)}const U8=Te("ZodUnknown",(e,t)=>{VN.init(e,t),Nr.init(e,t)});function Zf(){return P6(U8)}const z8=Te("ZodNever",(e,t)=>{GN.init(e,t),Nr.init(e,t)});function H8(e){return B6(z8,e)}const W8=Te("ZodArray",(e,t)=>{XN.init(e,t),Nr.init(e,t),e.element=t.element,e.min=(r,n)=>e.check(nc(r,n)),e.nonempty=r=>e.check(nc(1,r)),e.max=(r,n)=>e.check(yx(r,n)),e.length=(r,n)=>e.check(_x(r,n)),e.unwrap=()=>e.element});function Cx(e,t){return q6(W8,e,t)}const V8=Te("ZodObject",(e,t)=>{ZN.init(e,t),Nr.init(e,t),Wt(e,"shape",()=>t.shape),e.keyof=()=>ac(Object.keys(e._zod.def.shape)),e.catchall=r=>e.clone({...e._zod.def,catchall:r}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Zf()}),e.loose=()=>e.clone({...e._zod.def,catchall:Zf()}),e.strict=()=>e.clone({...e._zod.def,catchall:H8()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=r=>mT(e,r),e.safeExtend=r=>gT(e,r),e.merge=r=>pT(e,r),e.pick=r=>hT(e,r),e.omit=r=>xT(e,r),e.partial=(...r)=>vT(Sx,e,r[0]),e.required=(...r)=>wT(Tx,e,r[0])});function U0(e,t){const r={type:"object",shape:e??{},...Ke(t)};return new V8(r)}const G8=Te("ZodUnion",(e,t)=>{$N.init(e,t),Nr.init(e,t),e.options=t.options});function X8(e,t){return new G8({type:"union",options:e,...Ke(t)})}const Y8=Te("ZodIntersection",(e,t)=>{qN.init(e,t),Nr.init(e,t)});function Z8(e,t){return new Y8({type:"intersection",left:e,right:t})}const Ll=Te("ZodEnum",(e,t)=>{KN.init(e,t),Nr.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);const r=new Set(Object.keys(t.entries));e.extract=(n,a)=>{const o={};for(const l of n)if(r.has(l))o[l]=t.entries[l];else throw new Error(`Key ${l} not found in enum`);return new Ll({...t,checks:[],...Ke(a),entries:o})},e.exclude=(n,a)=>{const o={...t.entries};for(const l of n)if(r.has(l))delete o[l];else throw new Error(`Key ${l} not found in enum`);return new Ll({...t,checks:[],...Ke(a),entries:o})}});function ac(e,t){const r=Array.isArray(e)?Object.fromEntries(e.map(n=>[n,n])):e;return new Ll({type:"enum",entries:r,...Ke(t)})}const $8=Te("ZodTransform",(e,t)=>{QN.init(e,t),Nr.init(e,t),e._zod.parse=(r,n)=>{if(n.direction==="backward")throw new rx(e.constructor.name);r.addIssue=o=>{if(typeof o=="string")r.issues.push(eo(o,r.value,t));else{const l=o;l.fatal&&(l.continue=!1),l.code??(l.code="custom"),l.input??(l.input=r.value),l.inst??(l.inst=e),r.issues.push(eo(l))}};const a=t.transform(r.value,r);return a instanceof Promise?a.then(o=>(r.value=o,r)):(r.value=a,r)}});function q8(e){return new $8({type:"transform",transform:e})}const Sx=Te("ZodOptional",(e,t)=>{JN.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType});function $f(e){return new Sx({type:"optional",innerType:e})}const K8=Te("ZodNullable",(e,t)=>{e6.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType});function qf(e){return new K8({type:"nullable",innerType:e})}const Q8=Te("ZodDefault",(e,t)=>{t6.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function J8(e,t){return new Q8({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():sx(t)}})}const eI=Te("ZodPrefault",(e,t)=>{r6.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType});function tI(e,t){return new eI({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():sx(t)}})}const Tx=Te("ZodNonOptional",(e,t)=>{n6.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType});function rI(e,t){return new Tx({type:"nonoptional",innerType:e,...Ke(t)})}const nI=Te("ZodCatch",(e,t)=>{a6.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function aI(e,t){return new nI({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const sI=Te("ZodPipe",(e,t)=>{s6.init(e,t),Nr.init(e,t),e.in=t.in,e.out=t.out});function Kf(e,t){return new sI({type:"pipe",in:e,out:t})}const iI=Te("ZodReadonly",(e,t)=>{i6.init(e,t),Nr.init(e,t),e.unwrap=()=>e._zod.def.innerType});function oI(e){return new iI({type:"readonly",innerType:e})}const cI=Te("ZodCustom",(e,t)=>{o6.init(e,t),Nr.init(e,t)});function lI(e,t={}){return K6(cI,e,t)}function uI(e){return Q6(e)}function z0(e){return L6(Ax,e)}const xl=e=>z0().min(0,`${e} must be 0 or greater`),fI=U0({sku:zr().trim().min(1,"SKU is required"),name:zr().trim().min(1,"Item name is required"),category:zr().trim().min(1,"Category is required"),current_stock:xl("Current stock"),min_stock:xl("Minimum stock"),max_stock:xl("Maximum stock"),unit:zr().trim().min(1,"Unit is required"),location:zr().trim().min(1,"Location is required")}),dI=U0({title:zr().trim().min(1,"Title is required"),description:zr().trim().min(1,"Description is required"),priority:ac(["low","medium","high"]),assigned_to:zr().trim().min(1,"Assigned to is required"),location:zr().trim().min(1,"Location is required"),estimated_hours:z0().min(1,"Estimated hours must be at least 1"),due_date:zr().min(1,"Due date is required"),tags:Cx(zr()).default([])}),hI=U0({asset_id:zr().min(1,"Equipment selection is required"),equipment_name:zr().trim().min(1,"Equipment name is required"),defect_tag:zr().trim().min(1,"Defect tag is required"),priority:ac(["low","medium","high"]),description:zr().trim().min(1,"Description is required"),estimated_cost:z0().min(0,"Estimated cost must be 0 or greater"),assigned_technician:zr().trim().min(1,"Assigned technician is required"),warranty_status:ac(["in_warranty","out_of_warranty","extended"]),estimated_completion:zr().min(1,"Estimated completion date is required")}),H0=(e,t)=>{try{return{success:!0,data:e.parse(t)}}catch(r){return r instanceof c8?{success:!1,errors:r.issues.reduce((a,o)=>{const l=o.path.join(".");return a[l]=o.message,a},{})}:{success:!1,errors:{general:"Validation failed"}}}};function xr({label:e,name:t,type:r="text",placeholder:n,required:a=!1,error:o,value:l,onChange:h,className:g="",step:m}){const p=w=>{const E=r==="number"?parseFloat(w.target.value)||0:w.target.value;h?.(E)};return f.jsxs("div",{className:`space-y-1 ${g}`,children:[f.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700",children:[e,a&&f.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),f.jsx("input",{id:t,name:t,type:r,value:l??"",onChange:p,placeholder:n,required:a,step:m,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors ${o?"border-red-300 focus:ring-red-500":"border-gray-300 hover:border-gray-400"}`}),o&&f.jsx("p",{className:"text-sm text-red-600 mt-1",children:o})]})}function Nc({size:e="md",color:t="primary",className:r=""}){const n={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"},a={primary:"border-green-600",secondary:"border-gray-600",white:"border-white"};return f.jsx("div",{className:`animate-spin rounded-full border-2 border-t-transparent ${n[e]} ${a[t]} ${r}`,role:"status","aria-label":"Loading",children:f.jsx("span",{className:"sr-only",children:"Loading..."})})}const xI=[{value:"Fluids",label:"Fluids"},{value:"Filters",label:"Filters"},{value:"Engine Parts",label:"Engine Parts"},{value:"Tires",label:"Tires"},{value:"Tools",label:"Tools"},{value:"Safety Equipment",label:"Safety Equipment"},{value:"Electrical",label:"Electrical"},{value:"Hardware",label:"Hardware"}],mI=[{value:"Units",label:"Units"},{value:"Liters",label:"Liters"},{value:"Sets",label:"Sets"},{value:"Boxes",label:"Boxes"},{value:"Meters",label:"Meters"},{value:"Kilograms",label:"Kilograms"}];function gI({isOpen:e,onClose:t,onSubmit:r,item:n,loading:a=!1}){const o=()=>({sku:"",name:"",category:"",current_stock:0,min_stock:0,max_stock:100,unit:"",location:""}),[l,h]=Y.useState(()=>o()),[g,m]=Y.useState({});Y.useEffect(()=>{h(n?{sku:n.sku,name:n.name,category:n.category,current_stock:n.current_stock,min_stock:n.min_stock,max_stock:n.max_stock,unit:n.unit,location:n.location}:o()),m({})},[n,e]);const p=E=>{E.preventDefault();const A=H0(fI,l);if(!A.success||!A.data){m(A.errors??{});return}const T=A.data;if(T.min_stock>=T.max_stock){m({min_stock:"Min stock must be less than max stock"});return}(async()=>{try{await r(T),t()}catch(_){console.error("Failed to submit form:",_)}})()},w=(E,A)=>{const T=A;h(_=>({..._,[E]:T})),g[E]&&m(_=>({..._,[E]:void 0}))};return f.jsx(fo,{isOpen:e,onClose:t,title:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Ha,{className:"h-6 w-6 text-green-600 mr-2"}),n?"Edit Inventory Item":"Add New Inventory Item"]}),size:"lg",children:f.jsxs("form",{onSubmit:p,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsx(xr,{label:"SKU",name:"sku",value:l.sku,onChange:E=>w("sku",E),placeholder:"e.g., HYD-001",required:!0,error:g.sku}),f.jsx(xr,{label:"Item Name",name:"name",value:l.name,onChange:E=>w("name",E),placeholder:"e.g., Hydraulic Fluid - Premium Grade",required:!0,error:g.name}),f.jsx(un,{label:"Category",name:"category",value:l.category,onChange:E=>w("category",E),options:xI,required:!0,error:g.category}),f.jsx(un,{label:"Unit",name:"unit",value:l.unit,onChange:E=>w("unit",E),options:mI,required:!0,error:g.unit}),f.jsx(xr,{label:"Current Stock",name:"current_stock",type:"number",value:l.current_stock,onChange:E=>w("current_stock",E),required:!0,error:g.current_stock}),f.jsx(xr,{label:"Location",name:"location",value:l.location,onChange:E=>w("location",E),placeholder:"e.g., Warehouse A-1",required:!0,error:g.location}),f.jsx(xr,{label:"Minimum Stock",name:"min_stock",type:"number",value:l.min_stock,onChange:E=>w("min_stock",E),required:!0,error:g.min_stock}),f.jsx(xr,{label:"Maximum Stock",name:"max_stock",type:"number",value:l.max_stock,onChange:E=>w("max_stock",E),required:!0,error:g.max_stock})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),f.jsxs("button",{type:"submit",disabled:a,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:opacity-50",children:[a&&f.jsx(Nc,{size:"sm",color:"white",className:"mr-2"}),n?"Update Item":"Create Item"]})]})]})})}var We;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(We||(We={}));var Qf=new Map([[We.QR_CODE,"QR_CODE"],[We.AZTEC,"AZTEC"],[We.CODABAR,"CODABAR"],[We.CODE_39,"CODE_39"],[We.CODE_93,"CODE_93"],[We.CODE_128,"CODE_128"],[We.DATA_MATRIX,"DATA_MATRIX"],[We.MAXICODE,"MAXICODE"],[We.ITF,"ITF"],[We.EAN_13,"EAN_13"],[We.EAN_8,"EAN_8"],[We.PDF_417,"PDF_417"],[We.RSS_14,"RSS_14"],[We.RSS_EXPANDED,"RSS_EXPANDED"],[We.UPC_A,"UPC_A"],[We.UPC_E,"UPC_E"],[We.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),Jf;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(Jf||(Jf={}));function pI(e){return Object.values(We).includes(e)}var qa;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(qa||(qa={}));var Yn=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[qa.SCAN_TYPE_CAMERA,qa.SCAN_TYPE_FILE],e}(),Nx=function(){function e(t,r){this.format=t,this.formatName=r}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!Qf.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,Qf.get(t))},e}(),ed=function(){function e(){}return e.createFromText=function(t){var r={text:t};return{decodedText:t,result:r}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),jl;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(jl||(jl={}));var Ix=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:jl.UNKWOWN_ERROR}},e}(),kx=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,r){(this.verbose||r===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function ia(e){return typeof e>"u"||e===null}function vI(e,t,r){return e>r?r:e<t?t:e}var Gs=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),Rt=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(t){return"Last Match: ".concat(t)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.torchOnButton=function(){return"Switch On Torch"},e.torchOffButton=function(){return"Switch Off Torch"},e.torchOnFailedMessage=function(){return"Failed to turn on torch"},e.torchOffFailedMessage=function(){return"Failed to turn off torch"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),td=function(){function e(){}return e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"},e}(),Fx=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,r){if(typeof t!="object"){var n=typeof t;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],o=new Set(a),l=Object.keys(t),h=0,g=l;h<g.length;h++){var m=g[h];if(o.has(m))return r.logError("".concat(m," is not supported videoConstaints."),!0),!1}return!0},e}(),Pl={exports:{}};(function(e,t){(function(r,n){n(t)})(yi,function(r){function n(D){return D==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,s){D.__proto__=s}||function(D,s){for(var i in s)s.hasOwnProperty(i)&&(D[i]=s[i])};function o(D,s){a(D,s);function i(){this.constructor=D}D.prototype=s===null?Object.create(s):(i.prototype=s.prototype,new i)}function l(D,s){var i=Object.setPrototypeOf;i?i(D,s):D.__proto__=s}function h(D,s){s===void 0&&(s=D.constructor);var i=Error.captureStackTrace;i&&i(D,s)}var g=function(D){o(s,D);function s(i){var c=this.constructor,u=D.call(this,i)||this;return Object.defineProperty(u,"name",{value:c.name,enumerable:!1}),l(u,c.prototype),h(u),u}return s}(Error);class m extends g{constructor(s=void 0){super(s),this.message=s}getKind(){return this.constructor.kind}}m.kind="Exception";class p extends m{}p.kind="ArgumentException";class w extends m{}w.kind="IllegalArgumentException";class E{constructor(s){if(this.binarizer=s,s===null)throw new w("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(s,i){return this.binarizer.getBlackRow(s,i)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(s,i,c,u){const d=this.binarizer.getLuminanceSource().crop(s,i,c,u);return new E(this.binarizer.createBinarizer(d))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new E(this.binarizer.createBinarizer(s))}rotateCounterClockwise45(){const s=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new E(this.binarizer.createBinarizer(s))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class A extends m{static getChecksumInstance(){return new A}}A.kind="ChecksumException";class T{constructor(s){this.source=s}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class _{static arraycopy(s,i,c,u,d){for(;d--;)c[u++]=s[i++]}static currentTimeMillis(){return Date.now()}}class C extends m{}C.kind="IndexOutOfBoundsException";class S extends C{constructor(s=void 0,i=void 0){super(i),this.index=s,this.message=i}}S.kind="ArrayIndexOutOfBoundsException";class k{static fill(s,i){for(let c=0,u=s.length;c<u;c++)s[c]=i}static fillWithin(s,i,c,u){k.rangeCheck(s.length,i,c);for(let d=i;d<c;d++)s[d]=u}static rangeCheck(s,i,c){if(i>c)throw new w("fromIndex("+i+") > toIndex("+c+")");if(i<0)throw new S(i);if(c>s)throw new S(c)}static asList(...s){return s}static create(s,i,c){return Array.from({length:s}).map(d=>Array.from({length:i}).fill(c))}static createInt32Array(s,i,c){return Array.from({length:s}).map(d=>Int32Array.from({length:i}).fill(c))}static equals(s,i){if(!s||!i||!s.length||!i.length||s.length!==i.length)return!1;for(let c=0,u=s.length;c<u;c++)if(s[c]!==i[c])return!1;return!0}static hashCode(s){if(s===null)return 0;let i=1;for(const c of s)i=31*i+c;return i}static fillUint8Array(s,i){for(let c=0;c!==s.length;c++)s[c]=i}static copyOf(s,i){return s.slice(0,i)}static copyOfUint8Array(s,i){if(s.length<=i){const c=new Uint8Array(i);return c.set(s),c}return s.slice(0,i)}static copyOfRange(s,i,c){const u=c-i,d=new Int32Array(u);return _.arraycopy(s,i,d,0,u),d}static binarySearch(s,i,c){c===void 0&&(c=k.numberComparator);let u=0,d=s.length-1;for(;u<=d;){const x=d+u>>1,v=c(i,s[x]);if(v>0)u=x+1;else if(v<0)d=x-1;else return x}return-u-1}static numberComparator(s,i){return s-i}}class N{static numberOfTrailingZeros(s){let i;if(s===0)return 32;let c=31;return i=s<<16,i!==0&&(c-=16,s=i),i=s<<8,i!==0&&(c-=8,s=i),i=s<<4,i!==0&&(c-=4,s=i),i=s<<2,i!==0&&(c-=2,s=i),c-(s<<1>>>31)}static numberOfLeadingZeros(s){if(s===0)return 32;let i=1;return s>>>16||(i+=16,s<<=16),s>>>24||(i+=8,s<<=8),s>>>28||(i+=4,s<<=4),s>>>30||(i+=2,s<<=2),i-=s>>>31,i}static toHexString(s){return s.toString(16)}static toBinaryString(s){return String(parseInt(String(s),2))}static bitCount(s){return s=s-(s>>>1&1431655765),s=(s&858993459)+(s>>>2&858993459),s=s+(s>>>4)&252645135,s=s+(s>>>8),s=s+(s>>>16),s&63}static truncDivision(s,i){return Math.trunc(s/i)}static parseInt(s,i=void 0){return parseInt(s,i)}}N.MIN_VALUE_32_BITS=-2147483648,N.MAX_VALUE=Number.MAX_SAFE_INTEGER;class F{constructor(s,i){s===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=s,i==null?this.bits=F.makeArray(s):this.bits=i)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(s){if(s>this.bits.length*32){const i=F.makeArray(s);_.arraycopy(this.bits,0,i,0,this.bits.length),this.bits=i}}get(s){return(this.bits[Math.floor(s/32)]&1<<(s&31))!==0}set(s){this.bits[Math.floor(s/32)]|=1<<(s&31)}flip(s){this.bits[Math.floor(s/32)]^=1<<(s&31)}getNextSet(s){const i=this.size;if(s>=i)return i;const c=this.bits;let u=Math.floor(s/32),d=c[u];d&=~((1<<(s&31))-1);const x=c.length;for(;d===0;){if(++u===x)return i;d=c[u]}const v=u*32+N.numberOfTrailingZeros(d);return v>i?i:v}getNextUnset(s){const i=this.size;if(s>=i)return i;const c=this.bits;let u=Math.floor(s/32),d=~c[u];d&=~((1<<(s&31))-1);const x=c.length;for(;d===0;){if(++u===x)return i;d=~c[u]}const v=u*32+N.numberOfTrailingZeros(d);return v>i?i:v}setBulk(s,i){this.bits[Math.floor(s/32)]=i}setRange(s,i){if(i<s||s<0||i>this.size)throw new w;if(i===s)return;i--;const c=Math.floor(s/32),u=Math.floor(i/32),d=this.bits;for(let x=c;x<=u;x++){const v=x>c?0:s&31,b=(2<<(x<u?31:i&31))-(1<<v);d[x]|=b}}clear(){const s=this.bits.length,i=this.bits;for(let c=0;c<s;c++)i[c]=0}isRange(s,i,c){if(i<s||s<0||i>this.size)throw new w;if(i===s)return!0;i--;const u=Math.floor(s/32),d=Math.floor(i/32),x=this.bits;for(let v=u;v<=d;v++){const y=v>u?0:s&31,I=(2<<(v<d?31:i&31))-(1<<y)&4294967295;if((x[v]&I)!==(c?I:0))return!1}return!0}appendBit(s){this.ensureCapacity(this.size+1),s&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(s,i){if(i<0||i>32)throw new w("Num bits must be between 0 and 32");this.ensureCapacity(this.size+i);for(let c=i;c>0;c--)this.appendBit((s>>c-1&1)===1)}appendBitArray(s){const i=s.size;this.ensureCapacity(this.size+i);for(let c=0;c<i;c++)this.appendBit(s.get(c))}xor(s){if(this.size!==s.size)throw new w("Sizes don't match");const i=this.bits;for(let c=0,u=i.length;c<u;c++)i[c]^=s.bits[c]}toBytes(s,i,c,u){for(let d=0;d<u;d++){let x=0;for(let v=0;v<8;v++)this.get(s)&&(x|=1<<7-v),s++;i[c+d]=x}}getBitArray(){return this.bits}reverse(){const s=new Int32Array(this.bits.length),i=Math.floor((this.size-1)/32),c=i+1,u=this.bits;for(let d=0;d<c;d++){let x=u[d];x=x>>1&1431655765|(x&1431655765)<<1,x=x>>2&858993459|(x&858993459)<<2,x=x>>4&252645135|(x&252645135)<<4,x=x>>8&16711935|(x&16711935)<<8,x=x>>16&65535|(x&65535)<<16,s[i-d]=x}if(this.size!==c*32){const d=c*32-this.size;let x=s[0]>>>d;for(let v=1;v<c;v++){const y=s[v];x|=y<<32-d,s[v-1]=x,x=y>>>d}s[c-1]=x}this.bits=s}static makeArray(s){return new Int32Array(Math.floor((s+31)/32))}equals(s){if(!(s instanceof F))return!1;const i=s;return this.size===i.size&&k.equals(this.bits,i.bits)}hashCode(){return 31*this.size+k.hashCode(this.bits)}toString(){let s="";for(let i=0,c=this.size;i<c;i++)i&7||(s+=" "),s+=this.get(i)?"X":".";return s}clone(){return new F(this.size,this.bits.slice())}}var W;(function(D){D[D.OTHER=0]="OTHER",D[D.PURE_BARCODE=1]="PURE_BARCODE",D[D.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",D[D.TRY_HARDER=3]="TRY_HARDER",D[D.CHARACTER_SET=4]="CHARACTER_SET",D[D.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",D[D.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",D[D.ASSUME_GS1=7]="ASSUME_GS1",D[D.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",D[D.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",D[D.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(W||(W={}));var B=W;class R extends m{static getFormatInstance(){return new R}}R.kind="FormatException";var z;(function(D){D[D.Cp437=0]="Cp437",D[D.ISO8859_1=1]="ISO8859_1",D[D.ISO8859_2=2]="ISO8859_2",D[D.ISO8859_3=3]="ISO8859_3",D[D.ISO8859_4=4]="ISO8859_4",D[D.ISO8859_5=5]="ISO8859_5",D[D.ISO8859_6=6]="ISO8859_6",D[D.ISO8859_7=7]="ISO8859_7",D[D.ISO8859_8=8]="ISO8859_8",D[D.ISO8859_9=9]="ISO8859_9",D[D.ISO8859_10=10]="ISO8859_10",D[D.ISO8859_11=11]="ISO8859_11",D[D.ISO8859_13=12]="ISO8859_13",D[D.ISO8859_14=13]="ISO8859_14",D[D.ISO8859_15=14]="ISO8859_15",D[D.ISO8859_16=15]="ISO8859_16",D[D.SJIS=16]="SJIS",D[D.Cp1250=17]="Cp1250",D[D.Cp1251=18]="Cp1251",D[D.Cp1252=19]="Cp1252",D[D.Cp1256=20]="Cp1256",D[D.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",D[D.UTF8=22]="UTF8",D[D.ASCII=23]="ASCII",D[D.Big5=24]="Big5",D[D.GB18030=25]="GB18030",D[D.EUC_KR=26]="EUC_KR"})(z||(z={}));class U{constructor(s,i,c,...u){this.valueIdentifier=s,this.name=c,typeof i=="number"?this.values=Int32Array.from([i]):this.values=i,this.otherEncodingNames=u,U.VALUE_IDENTIFIER_TO_ECI.set(s,this),U.NAME_TO_ECI.set(c,this);const d=this.values;for(let x=0,v=d.length;x!==v;x++){const y=d[x];U.VALUES_TO_ECI.set(y,this)}for(const x of u)U.NAME_TO_ECI.set(x,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(s){if(s<0||s>=900)throw new R("incorect value");const i=U.VALUES_TO_ECI.get(s);if(i===void 0)throw new R("incorect value");return i}static getCharacterSetECIByName(s){const i=U.NAME_TO_ECI.get(s);if(i===void 0)throw new R("incorect value");return i}equals(s){if(!(s instanceof U))return!1;const i=s;return this.getName()===i.getName()}}U.VALUE_IDENTIFIER_TO_ECI=new Map,U.VALUES_TO_ECI=new Map,U.NAME_TO_ECI=new Map,U.Cp437=new U(z.Cp437,Int32Array.from([0,2]),"Cp437"),U.ISO8859_1=new U(z.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),U.ISO8859_2=new U(z.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),U.ISO8859_3=new U(z.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),U.ISO8859_4=new U(z.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),U.ISO8859_5=new U(z.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),U.ISO8859_6=new U(z.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),U.ISO8859_7=new U(z.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),U.ISO8859_8=new U(z.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),U.ISO8859_9=new U(z.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),U.ISO8859_10=new U(z.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),U.ISO8859_11=new U(z.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),U.ISO8859_13=new U(z.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),U.ISO8859_14=new U(z.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),U.ISO8859_15=new U(z.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),U.ISO8859_16=new U(z.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),U.SJIS=new U(z.SJIS,20,"SJIS","Shift_JIS"),U.Cp1250=new U(z.Cp1250,21,"Cp1250","windows-1250"),U.Cp1251=new U(z.Cp1251,22,"Cp1251","windows-1251"),U.Cp1252=new U(z.Cp1252,23,"Cp1252","windows-1252"),U.Cp1256=new U(z.Cp1256,24,"Cp1256","windows-1256"),U.UnicodeBigUnmarked=new U(z.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),U.UTF8=new U(z.UTF8,26,"UTF8","UTF-8"),U.ASCII=new U(z.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),U.Big5=new U(z.Big5,28,"Big5"),U.GB18030=new U(z.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),U.EUC_KR=new U(z.EUC_KR,30,"EUC_KR","EUC-KR");class fe extends m{}fe.kind="UnsupportedOperationException";class M{static decode(s,i){const c=this.encodingName(i);return this.customDecoder?this.customDecoder(s,c):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(c)?this.decodeFallback(s,c):new TextDecoder(c).decode(s)}static shouldDecodeOnFallback(s){return!M.isBrowser()&&s==="ISO-8859-1"}static encode(s,i){const c=this.encodingName(i);return this.customEncoder?this.customEncoder(s,c):typeof TextEncoder>"u"?this.encodeFallback(s):new TextEncoder().encode(s)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(s){return typeof s=="string"?s:s.getName()}static encodingCharacterSet(s){return s instanceof U?s:U.getCharacterSetECIByName(s)}static decodeFallback(s,i){const c=this.encodingCharacterSet(i);if(M.isDecodeFallbackSupported(c)){let u="";for(let d=0,x=s.length;d<x;d++){let v=s[d].toString(16);v.length<2&&(v="0"+v),u+="%"+v}return decodeURIComponent(u)}if(c.equals(U.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(s.buffer));throw new fe(`Encoding ${this.encodingName(i)} not supported by fallback.`)}static isDecodeFallbackSupported(s){return s.equals(U.UTF8)||s.equals(U.ISO8859_1)||s.equals(U.ASCII)}static encodeFallback(s){const c=btoa(unescape(encodeURIComponent(s))).split(""),u=[];for(let d=0;d<c.length;d++)u.push(c[d].charCodeAt(0));return new Uint8Array(u)}}class V{static castAsNonUtf8Char(s,i=null){const c=i?i.getName():this.ISO88591;return M.decode(new Uint8Array([s]),c)}static guessEncoding(s,i){if(i!=null&&i.get(B.CHARACTER_SET)!==void 0)return i.get(B.CHARACTER_SET).toString();const c=s.length;let u=!0,d=!0,x=!0,v=0,y=0,b=0,I=0,O=0,j=0,q=0,re=0,ae=0,ue=0,we=0;const Me=s.length>3&&s[0]===239&&s[1]===187&&s[2]===191;for(let je=0;je<c&&(u||d||x);je++){const Fe=s[je]&255;x&&(v>0?Fe&128?v--:x=!1:Fe&128&&(Fe&64?(v++,Fe&32?(v++,Fe&16?(v++,Fe&8?x=!1:I++):b++):y++):x=!1)),u&&(Fe>127&&Fe<160?u=!1:Fe>159&&(Fe<192||Fe===215||Fe===247)&&we++),d&&(O>0?Fe<64||Fe===127||Fe>252?d=!1:O--:Fe===128||Fe===160||Fe>239?d=!1:Fe>160&&Fe<224?(j++,re=0,q++,q>ae&&(ae=q)):Fe>127?(O++,q=0,re++,re>ue&&(ue=re)):(q=0,re=0))}return x&&v>0&&(x=!1),d&&O>0&&(d=!1),x&&(Me||y+b+I>0)?V.UTF8:d&&(V.ASSUME_SHIFT_JIS||ae>=3||ue>=3)?V.SHIFT_JIS:u&&d?ae===2&&j===2||we*10>=c?V.SHIFT_JIS:V.ISO88591:u?V.ISO88591:d?V.SHIFT_JIS:x?V.UTF8:V.PLATFORM_DEFAULT_ENCODING}static format(s,...i){let c=-1;function u(x,v,y,b,I,O){if(x==="%%")return"%";if(i[++c]===void 0)return;x=b?parseInt(b.substr(1)):void 0;let j=I?parseInt(I.substr(1)):void 0,q;switch(O){case"s":q=i[c];break;case"c":q=i[c][0];break;case"f":q=parseFloat(i[c]).toFixed(x);break;case"p":q=parseFloat(i[c]).toPrecision(x);break;case"e":q=parseFloat(i[c]).toExponential(x);break;case"x":q=parseInt(i[c]).toString(j||16);break;case"d":q=parseFloat(parseInt(i[c],j||10).toPrecision(x)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(j);let re=parseInt(y),ae=y&&y[0]+""=="0"?"0":" ";for(;q.length<re;)q=v!==void 0?q+ae:ae+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(d,u)}static getBytes(s,i){return M.encode(s,i)}static getCharCode(s,i=0){return s.charCodeAt(i)}static getCharAt(s){return String.fromCharCode(s)}}V.SHIFT_JIS=U.SJIS.getName(),V.GB2312="GB2312",V.ISO88591=U.ISO8859_1.getName(),V.EUC_JP="EUC_JP",V.UTF8=U.UTF8.getName(),V.PLATFORM_DEFAULT_ENCODING=V.UTF8,V.ASSUME_SHIFT_JIS=!1;class ne{constructor(s=""){this.value=s}enableDecoding(s){return this.encoding=s,this}append(s){return typeof s=="string"?this.value+=s.toString():this.encoding?this.value+=V.castAsNonUtf8Char(s,this.encoding):this.value+=String.fromCharCode(s),this}appendChars(s,i,c){for(let u=i;i<i+c;u++)this.append(s[u]);return this}length(){return this.value.length}charAt(s){return this.value.charAt(s)}deleteCharAt(s){this.value=this.value.substr(0,s)+this.value.substring(s+1)}setCharAt(s,i){this.value=this.value.substr(0,s)+i+this.value.substr(s+1)}substring(s,i){return this.value.substring(s,i)}setLengthToZero(){this.value=""}toString(){return this.value}insert(s,i){this.value=this.value.substr(0,s)+i+this.value.substr(s+i.length)}}class me{constructor(s,i,c,u){if(this.width=s,this.height=i,this.rowSize=c,this.bits=u,i==null&&(i=s),this.height=i,s<1||i<1)throw new w("Both dimensions must be greater than 0");c==null&&(c=Math.floor((s+31)/32)),this.rowSize=c,u==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(s){const i=s.length,c=s[0].length,u=new me(c,i);for(let d=0;d<i;d++){const x=s[d];for(let v=0;v<c;v++)x[v]&&u.set(v,d)}return u}static parseFromString(s,i,c){if(s===null)throw new w("stringRepresentation cannot be null");const u=new Array(s.length);let d=0,x=0,v=-1,y=0,b=0;for(;b<s.length;)if(s.charAt(b)===`
`||s.charAt(b)==="\r"){if(d>x){if(v===-1)v=d-x;else if(d-x!==v)throw new w("row lengths do not match");x=d,y++}b++}else if(s.substring(b,b+i.length)===i)b+=i.length,u[d]=!0,d++;else if(s.substring(b,b+c.length)===c)b+=c.length,u[d]=!1,d++;else throw new w("illegal character encountered: "+s.substring(b));if(d>x){if(v===-1)v=d-x;else if(d-x!==v)throw new w("row lengths do not match");y++}const I=new me(v,y);for(let O=0;O<d;O++)u[O]&&I.set(Math.floor(O%v),Math.floor(O/v));return I}get(s,i){const c=i*this.rowSize+Math.floor(s/32);return(this.bits[c]>>>(s&31)&1)!==0}set(s,i){const c=i*this.rowSize+Math.floor(s/32);this.bits[c]|=1<<(s&31)&4294967295}unset(s,i){const c=i*this.rowSize+Math.floor(s/32);this.bits[c]&=~(1<<(s&31)&4294967295)}flip(s,i){const c=i*this.rowSize+Math.floor(s/32);this.bits[c]^=1<<(s&31)&4294967295}xor(s){if(this.width!==s.getWidth()||this.height!==s.getHeight()||this.rowSize!==s.getRowSize())throw new w("input matrix dimensions do not match");const i=new F(Math.floor(this.width/32)+1),c=this.rowSize,u=this.bits;for(let d=0,x=this.height;d<x;d++){const v=d*c,y=s.getRow(d,i).getBitArray();for(let b=0;b<c;b++)u[v+b]^=y[b]}}clear(){const s=this.bits,i=s.length;for(let c=0;c<i;c++)s[c]=0}setRegion(s,i,c,u){if(i<0||s<0)throw new w("Left and top must be nonnegative");if(u<1||c<1)throw new w("Height and width must be at least 1");const d=s+c,x=i+u;if(x>this.height||d>this.width)throw new w("The region must fit inside the matrix");const v=this.rowSize,y=this.bits;for(let b=i;b<x;b++){const I=b*v;for(let O=s;O<d;O++)y[I+Math.floor(O/32)]|=1<<(O&31)&4294967295}}getRow(s,i){i==null||i.getSize()<this.width?i=new F(this.width):i.clear();const c=this.rowSize,u=this.bits,d=s*c;for(let x=0;x<c;x++)i.setBulk(x*32,u[d+x]);return i}setRow(s,i){_.arraycopy(i.getBitArray(),0,this.bits,s*this.rowSize,this.rowSize)}rotate180(){const s=this.getWidth(),i=this.getHeight();let c=new F(s),u=new F(s);for(let d=0,x=Math.floor((i+1)/2);d<x;d++)c=this.getRow(d,c),u=this.getRow(i-1-d,u),c.reverse(),u.reverse(),this.setRow(d,u),this.setRow(i-1-d,c)}getEnclosingRectangle(){const s=this.width,i=this.height,c=this.rowSize,u=this.bits;let d=s,x=i,v=-1,y=-1;for(let b=0;b<i;b++)for(let I=0;I<c;I++){const O=u[b*c+I];if(O!==0){if(b<x&&(x=b),b>y&&(y=b),I*32<d){let j=0;for(;!(O<<31-j&4294967295);)j++;I*32+j<d&&(d=I*32+j)}if(I*32+31>v){let j=31;for(;!(O>>>j);)j--;I*32+j>v&&(v=I*32+j)}}}return v<d||y<x?null:Int32Array.from([d,x,v-d+1,y-x+1])}getTopLeftOnBit(){const s=this.rowSize,i=this.bits;let c=0;for(;c<i.length&&i[c]===0;)c++;if(c===i.length)return null;const u=c/s;let d=c%s*32;const x=i[c];let v=0;for(;!(x<<31-v&4294967295);)v++;return d+=v,Int32Array.from([d,u])}getBottomRightOnBit(){const s=this.rowSize,i=this.bits;let c=i.length-1;for(;c>=0&&i[c]===0;)c--;if(c<0)return null;const u=Math.floor(c/s);let d=Math.floor(c%s)*32;const x=i[c];let v=31;for(;!(x>>>v);)v--;return d+=v,Int32Array.from([d,u])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(s){if(!(s instanceof me))return!1;const i=s;return this.width===i.width&&this.height===i.height&&this.rowSize===i.rowSize&&k.equals(this.bits,i.bits)}hashCode(){let s=this.width;return s=31*s+this.width,s=31*s+this.height,s=31*s+this.rowSize,s=31*s+k.hashCode(this.bits),s}toString(s="X ",i="  ",c=`
`){return this.buildToString(s,i,c)}buildToString(s,i,c){let u=new ne;for(let d=0,x=this.height;d<x;d++){for(let v=0,y=this.width;v<y;v++)u.append(this.get(v,d)?s:i);u.append(c)}return u.toString()}clone(){return new me(this.width,this.height,this.rowSize,this.bits.slice())}}class J extends m{static getNotFoundInstance(){return new J}}J.kind="NotFoundException";class Ce extends T{constructor(s){super(s),this.luminances=Ce.EMPTY,this.buckets=new Int32Array(Ce.LUMINANCE_BUCKETS)}getBlackRow(s,i){const c=this.getLuminanceSource(),u=c.getWidth();i==null||i.getSize()<u?i=new F(u):i.clear(),this.initArrays(u);const d=c.getRow(s,this.luminances),x=this.buckets;for(let y=0;y<u;y++)x[(d[y]&255)>>Ce.LUMINANCE_SHIFT]++;const v=Ce.estimateBlackPoint(x);if(u<3)for(let y=0;y<u;y++)(d[y]&255)<v&&i.set(y);else{let y=d[0]&255,b=d[1]&255;for(let I=1;I<u-1;I++){const O=d[I+1]&255;(b*4-y-O)/2<v&&i.set(I),y=b,b=O}}return i}getBlackMatrix(){const s=this.getLuminanceSource(),i=s.getWidth(),c=s.getHeight(),u=new me(i,c);this.initArrays(i);const d=this.buckets;for(let y=1;y<5;y++){const b=Math.floor(c*y/5),I=s.getRow(b,this.luminances),O=Math.floor(i*4/5);for(let j=Math.floor(i/5);j<O;j++){const q=I[j]&255;d[q>>Ce.LUMINANCE_SHIFT]++}}const x=Ce.estimateBlackPoint(d),v=s.getMatrix();for(let y=0;y<c;y++){const b=y*i;for(let I=0;I<i;I++)(v[b+I]&255)<x&&u.set(I,y)}return u}createBinarizer(s){return new Ce(s)}initArrays(s){this.luminances.length<s&&(this.luminances=new Uint8ClampedArray(s));const i=this.buckets;for(let c=0;c<Ce.LUMINANCE_BUCKETS;c++)i[c]=0}static estimateBlackPoint(s){const i=s.length;let c=0,u=0,d=0;for(let I=0;I<i;I++)s[I]>d&&(u=I,d=s[I]),s[I]>c&&(c=s[I]);let x=0,v=0;for(let I=0;I<i;I++){const O=I-u,j=s[I]*O*O;j>v&&(x=I,v=j)}if(u>x){const I=u;u=x,x=I}if(x-u<=i/16)throw new J;let y=x-1,b=-1;for(let I=x-1;I>u;I--){const O=I-u,j=O*O*(x-I)*(c-s[I]);j>b&&(y=I,b=j)}return y<<Ce.LUMINANCE_SHIFT}}Ce.LUMINANCE_BITS=5,Ce.LUMINANCE_SHIFT=8-Ce.LUMINANCE_BITS,Ce.LUMINANCE_BUCKETS=1<<Ce.LUMINANCE_BITS,Ce.EMPTY=Uint8ClampedArray.from([0]);class Ae extends Ce{constructor(s){super(s),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const s=this.getLuminanceSource(),i=s.getWidth(),c=s.getHeight();if(i>=Ae.MINIMUM_DIMENSION&&c>=Ae.MINIMUM_DIMENSION){const u=s.getMatrix();let d=i>>Ae.BLOCK_SIZE_POWER;i&Ae.BLOCK_SIZE_MASK&&d++;let x=c>>Ae.BLOCK_SIZE_POWER;c&Ae.BLOCK_SIZE_MASK&&x++;const v=Ae.calculateBlackPoints(u,d,x,i,c),y=new me(i,c);Ae.calculateThresholdForBlock(u,d,x,i,c,v,y),this.matrix=y}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(s){return new Ae(s)}static calculateThresholdForBlock(s,i,c,u,d,x,v){const y=d-Ae.BLOCK_SIZE,b=u-Ae.BLOCK_SIZE;for(let I=0;I<c;I++){let O=I<<Ae.BLOCK_SIZE_POWER;O>y&&(O=y);const j=Ae.cap(I,2,c-3);for(let q=0;q<i;q++){let re=q<<Ae.BLOCK_SIZE_POWER;re>b&&(re=b);const ae=Ae.cap(q,2,i-3);let ue=0;for(let Me=-2;Me<=2;Me++){const je=x[j+Me];ue+=je[ae-2]+je[ae-1]+je[ae]+je[ae+1]+je[ae+2]}const we=ue/25;Ae.thresholdBlock(s,re,O,we,u,v)}}}static cap(s,i,c){return s<i?i:s>c?c:s}static thresholdBlock(s,i,c,u,d,x){for(let v=0,y=c*d+i;v<Ae.BLOCK_SIZE;v++,y+=d)for(let b=0;b<Ae.BLOCK_SIZE;b++)(s[y+b]&255)<=u&&x.set(i+b,c+v)}static calculateBlackPoints(s,i,c,u,d){const x=d-Ae.BLOCK_SIZE,v=u-Ae.BLOCK_SIZE,y=new Array(c);for(let b=0;b<c;b++){y[b]=new Int32Array(i);let I=b<<Ae.BLOCK_SIZE_POWER;I>x&&(I=x);for(let O=0;O<i;O++){let j=O<<Ae.BLOCK_SIZE_POWER;j>v&&(j=v);let q=0,re=255,ae=0;for(let we=0,Me=I*u+j;we<Ae.BLOCK_SIZE;we++,Me+=u){for(let je=0;je<Ae.BLOCK_SIZE;je++){const Fe=s[Me+je]&255;q+=Fe,Fe<re&&(re=Fe),Fe>ae&&(ae=Fe)}if(ae-re>Ae.MIN_DYNAMIC_RANGE)for(we++,Me+=u;we<Ae.BLOCK_SIZE;we++,Me+=u)for(let je=0;je<Ae.BLOCK_SIZE;je++)q+=s[Me+je]&255}let ue=q>>Ae.BLOCK_SIZE_POWER*2;if(ae-re<=Ae.MIN_DYNAMIC_RANGE&&(ue=re/2,b>0&&O>0)){const we=(y[b-1][O]+2*y[b][O-1]+y[b-1][O-1])/4;re<we&&(ue=we)}y[b][O]=ue}}return y}}Ae.BLOCK_SIZE_POWER=3,Ae.BLOCK_SIZE=1<<Ae.BLOCK_SIZE_POWER,Ae.BLOCK_SIZE_MASK=Ae.BLOCK_SIZE-1,Ae.MINIMUM_DIMENSION=Ae.BLOCK_SIZE*5,Ae.MIN_DYNAMIC_RANGE=24;class at{constructor(s,i){this.width=s,this.height=i}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(s,i,c,u){throw new fe("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new fe("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new fe("This luminance source does not support rotation by 45 degrees.")}toString(){const s=new Uint8ClampedArray(this.width);let i=new ne;for(let c=0;c<this.height;c++){const u=this.getRow(c,s);for(let d=0;d<this.width;d++){const x=u[d]&255;let v;x<64?v="#":x<128?v="+":x<192?v=".":v=" ",i.append(v)}i.append(`
`)}return i.toString()}}class he extends at{constructor(s){super(s.getWidth(),s.getHeight()),this.delegate=s}getRow(s,i){const c=this.delegate.getRow(s,i),u=this.getWidth();for(let d=0;d<u;d++)c[d]=255-(c[d]&255);return c}getMatrix(){const s=this.delegate.getMatrix(),i=this.getWidth()*this.getHeight(),c=new Uint8ClampedArray(i);for(let u=0;u<i;u++)c[u]=255-(s[u]&255);return c}isCropSupported(){return this.delegate.isCropSupported()}crop(s,i,c,u){return new he(this.delegate.crop(s,i,c,u))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new he(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new he(this.delegate.rotateCounterClockwise45())}}class Ve extends at{constructor(s){super(s.width,s.height),this.canvas=s,this.tempCanvasElement=null,this.buffer=Ve.makeBufferFromCanvasImageData(s)}static makeBufferFromCanvasImageData(s){const i=s.getContext("2d").getImageData(0,0,s.width,s.height);return Ve.toGrayscaleBuffer(i.data,s.width,s.height)}static toGrayscaleBuffer(s,i,c){const u=new Uint8ClampedArray(i*c);for(let d=0,x=0,v=s.length;d<v;d+=4,x++){let y;if(s[d+3]===0)y=255;else{const I=s[d],O=s[d+1],j=s[d+2];y=306*I+601*O+117*j+512>>10}u[x]=y}return u}getRow(s,i){if(s<0||s>=this.getHeight())throw new w("Requested row is outside the image: "+s);const c=this.getWidth(),u=s*c;return i===null?i=this.buffer.slice(u,u+c):(i.length<c&&(i=new Uint8ClampedArray(c)),i.set(this.buffer.slice(u,u+c))),i}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(s,i,c,u){return super.crop(s,i,c,u),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const s=this.canvas.ownerDocument.createElement("canvas");s.width=this.canvas.width,s.height=this.canvas.height,this.tempCanvasElement=s}return this.tempCanvasElement}rotate(s){const i=this.getTempCanvasElement(),c=i.getContext("2d"),u=s*Ve.DEGREE_TO_RADIANS,d=this.canvas.width,x=this.canvas.height,v=Math.ceil(Math.abs(Math.cos(u))*d+Math.abs(Math.sin(u))*x),y=Math.ceil(Math.abs(Math.sin(u))*d+Math.abs(Math.cos(u))*x);return i.width=v,i.height=y,c.translate(v/2,y/2),c.rotate(u),c.drawImage(this.canvas,d/-2,x/-2),this.buffer=Ve.makeBufferFromCanvasImageData(i),this}invert(){return new he(this)}}Ve.DEGREE_TO_RADIANS=Math.PI/180;class Xe{constructor(s,i,c){this.deviceId=s,this.label=i,this.kind="videoinput",this.groupId=c||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Q=(globalThis||yi||self||window||void 0)&&(globalThis||yi||self||window||void 0).__awaiter||function(D,s,i,c){function u(d){return d instanceof i?d:new i(function(x){x(d)})}return new(i||(i=Promise))(function(d,x){function v(I){try{b(c.next(I))}catch(O){x(O)}}function y(I){try{b(c.throw(I))}catch(O){x(O)}}function b(I){I.done?d(I.value):u(I.value).then(v,y)}b((c=c.apply(D,s||[])).next())})};class oe{constructor(s,i=500,c){this.reader=s,this.timeBetweenScansMillis=i,this._hints=c,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(s){this._timeBetweenDecodingAttempts=s<0?0:s}set hints(s){this._hints=s||null}get hints(){return this._hints}listVideoInputDevices(){return Q(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const s=yield navigator.mediaDevices.enumerateDevices(),i=[];for(const c of s){const u=c.kind==="video"?"videoinput":c.kind;if(u!=="videoinput")continue;const d=c.deviceId||c.id,x=c.label||`Video device ${i.length+1}`,v=c.groupId,y={deviceId:d,label:x,kind:u,groupId:v};i.push(y)}return i})}getVideoInputDevices(){return Q(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(i=>new Xe(i.deviceId,i.label))})}findDeviceById(s){return Q(this,void 0,void 0,function*(){const i=yield this.listVideoInputDevices();return i?i.find(c=>c.deviceId===s):null})}decodeFromInputVideoDevice(s,i){return Q(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(s,i)})}decodeOnceFromVideoDevice(s,i){return Q(this,void 0,void 0,function*(){this.reset();let c;s?c={deviceId:{exact:s}}:c={facingMode:"environment"};const u={video:c};return yield this.decodeOnceFromConstraints(u,i)})}decodeOnceFromConstraints(s,i){return Q(this,void 0,void 0,function*(){const c=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeOnceFromStream(c,i)})}decodeOnceFromStream(s,i){return Q(this,void 0,void 0,function*(){this.reset();const c=yield this.attachStreamToVideo(s,i);return yield this.decodeOnce(c)})}decodeFromInputVideoDeviceContinuously(s,i,c){return Q(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(s,i,c)})}decodeFromVideoDevice(s,i,c){return Q(this,void 0,void 0,function*(){let u;s?u={deviceId:{exact:s}}:u={facingMode:"environment"};const d={video:u};return yield this.decodeFromConstraints(d,i,c)})}decodeFromConstraints(s,i,c){return Q(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(s);return yield this.decodeFromStream(u,i,c)})}decodeFromStream(s,i,c){return Q(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(s,i);return yield this.decodeContinuously(u,c)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(s,i){return Q(this,void 0,void 0,function*(){const c=this.prepareVideoElement(i);return this.addVideoSource(c,s),this.videoElement=c,this.stream=s,yield this.playVideoOnLoadAsync(c),c})}playVideoOnLoadAsync(s){return new Promise((i,c)=>this.playVideoOnLoad(s,()=>i()))}playVideoOnLoad(s,i){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(s),s.addEventListener("ended",this.videoEndedListener),s.addEventListener("canplay",this.videoCanPlayListener),s.addEventListener("playing",i),this.tryPlayVideo(s)}isVideoPlaying(s){return s.currentTime>0&&!s.paused&&!s.ended&&s.readyState>2}tryPlayVideo(s){return Q(this,void 0,void 0,function*(){if(this.isVideoPlaying(s)){console.warn("Trying to play video that is already playing.");return}try{yield s.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(s,i){const c=document.getElementById(s);if(!c)throw new p(`element with id '${s}' not found`);if(c.nodeName.toLowerCase()!==i.toLowerCase())throw new p(`element with id '${s}' must be an ${i} element`);return c}decodeFromImage(s,i){if(!s&&!i)throw new p("either imageElement with a src set or an url must be provided");return i&&!s?this.decodeFromImageUrl(i):this.decodeFromImageElement(s)}decodeFromVideo(s,i){if(!s&&!i)throw new p("Either an element with a src set or an URL must be provided");return i&&!s?this.decodeFromVideoUrl(i):this.decodeFromVideoElement(s)}decodeFromVideoContinuously(s,i,c){if(s===void 0&&i===void 0)throw new p("Either an element with a src set or an URL must be provided");return i&&!s?this.decodeFromVideoUrlContinuously(i,c):this.decodeFromVideoElementContinuously(s,c)}decodeFromImageElement(s){if(!s)throw new p("An image element must be provided.");this.reset();const i=this.prepareImageElement(s);this.imageElement=i;let c;return this.isImageLoaded(i)?c=this.decodeOnce(i,!1,!0):c=this._decodeOnLoadImage(i),c}decodeFromVideoElement(s){const i=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideo(i)}decodeFromVideoElementContinuously(s,i){const c=this._decodeFromVideoElementSetup(s);return this._decodeOnLoadVideoContinuously(c,i)}_decodeFromVideoElementSetup(s){if(!s)throw new p("A video element must be provided.");this.reset();const i=this.prepareVideoElement(s);return this.videoElement=i,i}decodeFromImageUrl(s){if(!s)throw new p("An URL must be provided.");this.reset();const i=this.prepareImageElement();this.imageElement=i;const c=this._decodeOnLoadImage(i);return i.src=s,c}decodeFromVideoUrl(s){if(!s)throw new p("An URL must be provided.");this.reset();const i=this.prepareVideoElement(),c=this.decodeFromVideoElement(i);return i.src=s,c}decodeFromVideoUrlContinuously(s,i){if(!s)throw new p("An URL must be provided.");this.reset();const c=this.prepareVideoElement(),u=this.decodeFromVideoElementContinuously(c,i);return c.src=s,u}_decodeOnLoadImage(s){return new Promise((i,c)=>{this.imageLoadedListener=()=>this.decodeOnce(s,!1,!0).then(i,c),s.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(s){return Q(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(s),yield this.decodeOnce(s)})}_decodeOnLoadVideoContinuously(s,i){return Q(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(s),this.decodeContinuously(s,i)})}isImageLoaded(s){return!(!s.complete||s.naturalWidth===0)}prepareImageElement(s){let i;return typeof s>"u"&&(i=document.createElement("img"),i.width=200,i.height=200),typeof s=="string"&&(i=this.getMediaElement(s,"img")),s instanceof HTMLImageElement&&(i=s),i}prepareVideoElement(s){let i;return!s&&typeof document<"u"&&(i=document.createElement("video"),i.width=200,i.height=200),typeof s=="string"&&(i=this.getMediaElement(s,"video")),s instanceof HTMLVideoElement&&(i=s),i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),i.setAttribute("playsinline","true"),i}decodeOnce(s,i=!0,c=!0){this._stopAsyncDecode=!1;const u=(d,x)=>{if(this._stopAsyncDecode){x(new J("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const v=this.decode(s);d(v)}catch(v){const y=i&&v instanceof J,I=(v instanceof A||v instanceof R)&&c;if(y||I)return setTimeout(u,this._timeBetweenDecodingAttempts,d,x);x(v)}};return new Promise((d,x)=>u(d,x))}decodeContinuously(s,i){this._stopContinuousDecode=!1;const c=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const u=this.decode(s);i(u,null),setTimeout(c,this.timeBetweenScansMillis)}catch(u){i(null,u);const d=u instanceof A||u instanceof R,x=u instanceof J;(d||x)&&setTimeout(c,this._timeBetweenDecodingAttempts)}};c()}decode(s){const i=this.createBinaryBitmap(s);return this.decodeBitmap(i)}_isHTMLVideoElement(s){return s.videoWidth!==0}drawFrameOnCanvas(s,i,c){i||(i={sx:0,sy:0,sWidth:s.videoWidth,sHeight:s.videoHeight,dx:0,dy:0,dWidth:s.videoWidth,dHeight:s.videoHeight}),c||(c=this.captureCanvasContext),c.drawImage(s,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}drawImageOnCanvas(s,i,c=this.captureCanvasContext){i||(i={sx:0,sy:0,sWidth:s.naturalWidth,sHeight:s.naturalHeight,dx:0,dy:0,dWidth:s.naturalWidth,dHeight:s.naturalHeight}),c||(c=this.captureCanvasContext),c.drawImage(s,i.sx,i.sy,i.sWidth,i.sHeight,i.dx,i.dy,i.dWidth,i.dHeight)}createBinaryBitmap(s){this.getCaptureCanvasContext(s),this._isHTMLVideoElement(s)?this.drawFrameOnCanvas(s):this.drawImageOnCanvas(s);const i=this.getCaptureCanvas(s),c=new Ve(i),u=new Ae(c);return new E(u)}getCaptureCanvasContext(s){if(!this.captureCanvasContext){const c=this.getCaptureCanvas(s).getContext("2d");this.captureCanvasContext=c}return this.captureCanvasContext}getCaptureCanvas(s){if(!this.captureCanvas){const i=this.createCaptureCanvas(s);this.captureCanvas=i}return this.captureCanvas}decodeBitmap(s){return this.reader.decode(s,this._hints)}createCaptureCanvas(s){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const i=document.createElement("canvas");let c,u;return typeof s<"u"&&(s instanceof HTMLVideoElement?(c=s.videoWidth,u=s.videoHeight):s instanceof HTMLImageElement&&(c=s.naturalWidth||s.width,u=s.naturalHeight||s.height)),i.style.width=c+"px",i.style.height=u+"px",i.width=c,i.height=u,i}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(s=>s.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(s,i){try{s.srcObject=i}catch{s.src=URL.createObjectURL(i)}}cleanVideoSource(s){try{s.srcObject=null}catch{s.src=""}this.videoElement.removeAttribute("src")}}class te{constructor(s,i,c=i==null?0:8*i.length,u,d,x=_.currentTimeMillis()){this.text=s,this.rawBytes=i,this.numBits=c,this.resultPoints=u,this.format=d,this.timestamp=x,this.text=s,this.rawBytes=i,c==null?this.numBits=i==null?0:8*i.length:this.numBits=c,this.resultPoints=u,this.format=d,this.resultMetadata=null,x==null?this.timestamp=_.currentTimeMillis():this.timestamp=x}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(s,i){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(s,i)}putAllMetadata(s){s!==null&&(this.resultMetadata===null?this.resultMetadata=s:this.resultMetadata=new Map(s))}addResultPoints(s){const i=this.resultPoints;if(i===null)this.resultPoints=s;else if(s!==null&&s.length>0){const c=new Array(i.length+s.length);_.arraycopy(i,0,c,0,i.length),_.arraycopy(s,0,c,i.length,s.length),this.resultPoints=c}}getTimestamp(){return this.timestamp}toString(){return this.text}}var se;(function(D){D[D.AZTEC=0]="AZTEC",D[D.CODABAR=1]="CODABAR",D[D.CODE_39=2]="CODE_39",D[D.CODE_93=3]="CODE_93",D[D.CODE_128=4]="CODE_128",D[D.DATA_MATRIX=5]="DATA_MATRIX",D[D.EAN_8=6]="EAN_8",D[D.EAN_13=7]="EAN_13",D[D.ITF=8]="ITF",D[D.MAXICODE=9]="MAXICODE",D[D.PDF_417=10]="PDF_417",D[D.QR_CODE=11]="QR_CODE",D[D.RSS_14=12]="RSS_14",D[D.RSS_EXPANDED=13]="RSS_EXPANDED",D[D.UPC_A=14]="UPC_A",D[D.UPC_E=15]="UPC_E",D[D.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(se||(se={}));var ce=se,ie;(function(D){D[D.OTHER=0]="OTHER",D[D.ORIENTATION=1]="ORIENTATION",D[D.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",D[D.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",D[D.ISSUE_NUMBER=4]="ISSUE_NUMBER",D[D.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",D[D.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",D[D.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",D[D.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",D[D.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",D[D.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ie||(ie={}));var ye=ie;class Se{constructor(s,i,c,u,d=-1,x=-1){this.rawBytes=s,this.text=i,this.byteSegments=c,this.ecLevel=u,this.structuredAppendSequenceNumber=d,this.structuredAppendParity=x,this.numBits=s==null?0:8*s.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(s){this.numBits=s}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(s){this.errorsCorrected=s}getErasures(){return this.erasures}setErasures(s){this.erasures=s}getOther(){return this.other}setOther(s){this.other=s}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class Ne{exp(s){return this.expTable[s]}log(s){if(s===0)throw new w;return this.logTable[s]}static addOrSubtract(s,i){return s^i}}class Ye{constructor(s,i){if(i.length===0)throw new w;this.field=s;const c=i.length;if(c>1&&i[0]===0){let u=1;for(;u<c&&i[u]===0;)u++;u===c?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(c-u),_.arraycopy(i,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);const i=this.coefficients;let c;if(s===1){c=0;for(let x=0,v=i.length;x!==v;x++){const y=i[x];c=Ne.addOrSubtract(c,y)}return c}c=i[0];const u=i.length,d=this.field;for(let x=1;x<u;x++)c=Ne.addOrSubtract(d.multiply(s,c),i[x]);return c}addOrSubtract(s){if(!this.field.equals(s.field))throw new w("GenericGFPolys do not have same GenericGF field");if(this.isZero())return s;if(s.isZero())return this;let i=this.coefficients,c=s.coefficients;if(i.length>c.length){const x=i;i=c,c=x}let u=new Int32Array(c.length);const d=c.length-i.length;_.arraycopy(c,0,u,0,d);for(let x=d;x<c.length;x++)u[x]=Ne.addOrSubtract(i[x-d],c[x]);return new Ye(this.field,u)}multiply(s){if(!this.field.equals(s.field))throw new w("GenericGFPolys do not have same GenericGF field");if(this.isZero()||s.isZero())return this.field.getZero();const i=this.coefficients,c=i.length,u=s.coefficients,d=u.length,x=new Int32Array(c+d-1),v=this.field;for(let y=0;y<c;y++){const b=i[y];for(let I=0;I<d;I++)x[y+I]=Ne.addOrSubtract(x[y+I],v.multiply(b,u[I]))}return new Ye(v,x)}multiplyScalar(s){if(s===0)return this.field.getZero();if(s===1)return this;const i=this.coefficients.length,c=this.field,u=new Int32Array(i),d=this.coefficients;for(let x=0;x<i;x++)u[x]=c.multiply(d[x],s);return new Ye(c,u)}multiplyByMonomial(s,i){if(s<0)throw new w;if(i===0)return this.field.getZero();const c=this.coefficients,u=c.length,d=new Int32Array(u+s),x=this.field;for(let v=0;v<u;v++)d[v]=x.multiply(c[v],i);return new Ye(x,d)}divide(s){if(!this.field.equals(s.field))throw new w("GenericGFPolys do not have same GenericGF field");if(s.isZero())throw new w("Divide by 0");const i=this.field;let c=i.getZero(),u=this;const d=s.getCoefficient(s.getDegree()),x=i.inverse(d);for(;u.getDegree()>=s.getDegree()&&!u.isZero();){const v=u.getDegree()-s.getDegree(),y=i.multiply(u.getCoefficient(u.getDegree()),x),b=s.multiplyByMonomial(v,y),I=i.buildMonomial(v,y);c=c.addOrSubtract(I),u=u.addOrSubtract(b)}return[c,u]}toString(){let s="";for(let i=this.getDegree();i>=0;i--){let c=this.getCoefficient(i);if(c!==0){if(c<0?(s+=" - ",c=-c):s.length>0&&(s+=" + "),i===0||c!==1){const u=this.field.log(c);u===0?s+="1":u===1?s+="a":(s+="a^",s+=u)}i!==0&&(i===1?s+="x":(s+="x^",s+=i))}}return s}}class ee extends m{}ee.kind="ArithmeticException";class Ge extends Ne{constructor(s,i,c){super(),this.primitive=s,this.size=i,this.generatorBase=c;const u=new Int32Array(i);let d=1;for(let v=0;v<i;v++)u[v]=d,d*=2,d>=i&&(d^=s,d&=i-1);this.expTable=u;const x=new Int32Array(i);for(let v=0;v<i-1;v++)x[u[v]]=v;this.logTable=x,this.zero=new Ye(this,Int32Array.from([0])),this.one=new Ye(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,i){if(s<0)throw new w;if(i===0)return this.zero;const c=new Int32Array(s+1);return c[0]=i,new Ye(this,c)}inverse(s){if(s===0)throw new ee;return this.expTable[this.size-this.logTable[s]-1]}multiply(s,i){return s===0||i===0?0:this.expTable[(this.logTable[s]+this.logTable[i])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+N.toHexString(this.primitive)+","+this.size+")"}equals(s){return s===this}}Ge.AZTEC_DATA_12=new Ge(4201,4096,1),Ge.AZTEC_DATA_10=new Ge(1033,1024,1),Ge.AZTEC_DATA_6=new Ge(67,64,1),Ge.AZTEC_PARAM=new Ge(19,16,1),Ge.QR_CODE_FIELD_256=new Ge(285,256,0),Ge.DATA_MATRIX_FIELD_256=new Ge(301,256,1),Ge.AZTEC_DATA_8=Ge.DATA_MATRIX_FIELD_256,Ge.MAXICODE_FIELD_64=Ge.AZTEC_DATA_6;class ft extends m{}ft.kind="ReedSolomonException";class _t extends m{}_t.kind="IllegalStateException";class ot{constructor(s){this.field=s}decode(s,i){const c=this.field,u=new Ye(c,s),d=new Int32Array(i);let x=!0;for(let q=0;q<i;q++){const re=u.evaluateAt(c.exp(q+c.getGeneratorBase()));d[d.length-1-q]=re,re!==0&&(x=!1)}if(x)return;const v=new Ye(c,d),y=this.runEuclideanAlgorithm(c.buildMonomial(i,1),v,i),b=y[0],I=y[1],O=this.findErrorLocations(b),j=this.findErrorMagnitudes(I,O);for(let q=0;q<O.length;q++){const re=s.length-1-c.log(O[q]);if(re<0)throw new ft("Bad error location");s[re]=Ge.addOrSubtract(s[re],j[q])}}runEuclideanAlgorithm(s,i,c){if(s.getDegree()<i.getDegree()){const q=s;s=i,i=q}const u=this.field;let d=s,x=i,v=u.getZero(),y=u.getOne();for(;x.getDegree()>=(c/2|0);){let q=d,re=v;if(d=x,v=y,d.isZero())throw new ft("r_{i-1} was zero");x=q;let ae=u.getZero();const ue=d.getCoefficient(d.getDegree()),we=u.inverse(ue);for(;x.getDegree()>=d.getDegree()&&!x.isZero();){const Me=x.getDegree()-d.getDegree(),je=u.multiply(x.getCoefficient(x.getDegree()),we);ae=ae.addOrSubtract(u.buildMonomial(Me,je)),x=x.addOrSubtract(d.multiplyByMonomial(Me,je))}if(y=ae.multiply(v).addOrSubtract(re),x.getDegree()>=d.getDegree())throw new _t("Division algorithm failed to reduce polynomial?")}const b=y.getCoefficient(0);if(b===0)throw new ft("sigmaTilde(0) was zero");const I=u.inverse(b),O=y.multiplyScalar(I),j=x.multiplyScalar(I);return[O,j]}findErrorLocations(s){const i=s.getDegree();if(i===1)return Int32Array.from([s.getCoefficient(1)]);const c=new Int32Array(i);let u=0;const d=this.field;for(let x=1;x<d.getSize()&&u<i;x++)s.evaluateAt(x)===0&&(c[u]=d.inverse(x),u++);if(u!==i)throw new ft("Error locator degree does not match number of roots");return c}findErrorMagnitudes(s,i){const c=i.length,u=new Int32Array(c),d=this.field;for(let x=0;x<c;x++){const v=d.inverse(i[x]);let y=1;for(let b=0;b<c;b++)if(x!==b){const I=d.multiply(i[b],v),O=I&1?I&-2:I|1;y=d.multiply(y,O)}u[x]=d.multiply(s.evaluateAt(v),d.inverse(y)),d.getGeneratorBase()!==0&&(u[x]=d.multiply(u[x],v))}return u}}var Oe;(function(D){D[D.UPPER=0]="UPPER",D[D.LOWER=1]="LOWER",D[D.MIXED=2]="MIXED",D[D.DIGIT=3]="DIGIT",D[D.PUNCT=4]="PUNCT",D[D.BINARY=5]="BINARY"})(Oe||(Oe={}));class rt{decode(s){this.ddata=s;let i=s.getBits(),c=this.extractBits(i),u=this.correctBits(c),d=rt.convertBoolArrayToByteArray(u),x=rt.getEncodedData(u),v=new Se(d,x,null,null);return v.setNumBits(u.length),v}static highLevelDecode(s){return this.getEncodedData(s)}static getEncodedData(s){let i=s.length,c=Oe.UPPER,u=Oe.UPPER,d="",x=0;for(;x<i;)if(u===Oe.BINARY){if(i-x<5)break;let v=rt.readCode(s,x,5);if(x+=5,v===0){if(i-x<11)break;v=rt.readCode(s,x,11)+31,x+=11}for(let y=0;y<v;y++){if(i-x<8){x=i;break}const b=rt.readCode(s,x,8);d+=V.castAsNonUtf8Char(b),x+=8}u=c}else{let v=u===Oe.DIGIT?4:5;if(i-x<v)break;let y=rt.readCode(s,x,v);x+=v;let b=rt.getCharacter(u,y);b.startsWith("CTRL_")?(c=u,u=rt.getTable(b.charAt(5)),b.charAt(6)==="L"&&(c=u)):(d+=b,u=c)}return d}static getTable(s){switch(s){case"L":return Oe.LOWER;case"P":return Oe.PUNCT;case"M":return Oe.MIXED;case"D":return Oe.DIGIT;case"B":return Oe.BINARY;case"U":default:return Oe.UPPER}}static getCharacter(s,i){switch(s){case Oe.UPPER:return rt.UPPER_TABLE[i];case Oe.LOWER:return rt.LOWER_TABLE[i];case Oe.MIXED:return rt.MIXED_TABLE[i];case Oe.PUNCT:return rt.PUNCT_TABLE[i];case Oe.DIGIT:return rt.DIGIT_TABLE[i];default:throw new _t("Bad table")}}correctBits(s){let i,c;this.ddata.getNbLayers()<=2?(c=6,i=Ge.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(c=8,i=Ge.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(c=10,i=Ge.AZTEC_DATA_10):(c=12,i=Ge.AZTEC_DATA_12);let u=this.ddata.getNbDatablocks(),d=s.length/c;if(d<u)throw new R;let x=s.length%c,v=new Int32Array(d);for(let j=0;j<d;j++,x+=c)v[j]=rt.readCode(s,x,c);try{new ot(i).decode(v,d-u)}catch(j){throw new R(j)}let y=(1<<c)-1,b=0;for(let j=0;j<u;j++){let q=v[j];if(q===0||q===y)throw new R;(q===1||q===y-1)&&b++}let I=new Array(u*c-b),O=0;for(let j=0;j<u;j++){let q=v[j];if(q===1||q===y-1)I.fill(q>1,O,O+c-1),O+=c-1;else for(let re=c-1;re>=0;--re)I[O++]=(q&1<<re)!==0}return I}extractBits(s){let i=this.ddata.isCompact(),c=this.ddata.getNbLayers(),u=(i?11:14)+c*4,d=new Int32Array(u),x=new Array(this.totalBitsInLayer(c,i));if(i)for(let v=0;v<d.length;v++)d[v]=v;else{let v=u+1+2*N.truncDivision(N.truncDivision(u,2)-1,15),y=u/2,b=N.truncDivision(v,2);for(let I=0;I<y;I++){let O=I+N.truncDivision(I,15);d[y-I-1]=b-O-1,d[y+I]=b+O+1}}for(let v=0,y=0;v<c;v++){let b=(c-v)*4+(i?9:12),I=v*2,O=u-1-I;for(let j=0;j<b;j++){let q=j*2;for(let re=0;re<2;re++)x[y+q+re]=s.get(d[I+re],d[I+j]),x[y+2*b+q+re]=s.get(d[I+j],d[O-re]),x[y+4*b+q+re]=s.get(d[O-re],d[O-j]),x[y+6*b+q+re]=s.get(d[O-j],d[I+re])}y+=b*8}return x}static readCode(s,i,c){let u=0;for(let d=i;d<i+c;d++)u<<=1,s[d]&&(u|=1);return u}static readByte(s,i){let c=s.length-i;return c>=8?rt.readCode(s,i,8):rt.readCode(s,i,c)<<8-c}static convertBoolArrayToByteArray(s){let i=new Uint8Array((s.length+7)/8);for(let c=0;c<i.length;c++)i[c]=rt.readByte(s,8*c);return i}totalBitsInLayer(s,i){return((i?88:112)+16*s)*s}}rt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],rt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],rt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],rt.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],rt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class it{constructor(){}static round(s){return s===NaN?0:s<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:s>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:s+(s<0?-.5:.5)|0}static distance(s,i,c,u){const d=s-c,x=i-u;return Math.sqrt(d*d+x*x)}static sum(s){let i=0;for(let c=0,u=s.length;c!==u;c++){const d=s[c];i+=d}return i}}class Jr{static floatToIntBits(s){return s}}Jr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class He{constructor(s,i){this.x=s,this.y=i}getX(){return this.x}getY(){return this.y}equals(s){if(s instanceof He){const i=s;return this.x===i.x&&this.y===i.y}return!1}hashCode(){return 31*Jr.floatToIntBits(this.x)+Jr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(s){const i=this.distance(s[0],s[1]),c=this.distance(s[1],s[2]),u=this.distance(s[0],s[2]);let d,x,v;if(c>=i&&c>=u?(x=s[0],d=s[1],v=s[2]):u>=c&&u>=i?(x=s[1],d=s[0],v=s[2]):(x=s[2],d=s[0],v=s[1]),this.crossProductZ(d,x,v)<0){const y=d;d=v,v=y}s[0]=d,s[1]=x,s[2]=v}static distance(s,i){return it.distance(s.x,s.y,i.x,i.y)}static crossProductZ(s,i,c){const u=i.x,d=i.y;return(c.x-u)*(s.y-d)-(c.y-d)*(s.x-u)}}class Jn{constructor(s,i){this.bits=s,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class Wn extends Jn{constructor(s,i,c,u,d){super(s,i),this.compact=c,this.nbDatablocks=u,this.nbLayers=d}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Jt{constructor(s,i,c,u){this.image=s,this.height=s.getHeight(),this.width=s.getWidth(),i==null&&(i=Jt.INIT_SIZE),c==null&&(c=s.getWidth()/2|0),u==null&&(u=s.getHeight()/2|0);const d=i/2|0;if(this.leftInit=c-d,this.rightInit=c+d,this.upInit=u-d,this.downInit=u+d,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new J}detect(){let s=this.leftInit,i=this.rightInit,c=this.upInit,u=this.downInit,d=!1,x=!0,v=!1,y=!1,b=!1,I=!1,O=!1;const j=this.width,q=this.height;for(;x;){x=!1;let re=!0;for(;(re||!y)&&i<j;)re=this.containsBlackPoint(c,u,i,!1),re?(i++,x=!0,y=!0):y||i++;if(i>=j){d=!0;break}let ae=!0;for(;(ae||!b)&&u<q;)ae=this.containsBlackPoint(s,i,u,!0),ae?(u++,x=!0,b=!0):b||u++;if(u>=q){d=!0;break}let ue=!0;for(;(ue||!I)&&s>=0;)ue=this.containsBlackPoint(c,u,s,!1),ue?(s--,x=!0,I=!0):I||s--;if(s<0){d=!0;break}let we=!0;for(;(we||!O)&&c>=0;)we=this.containsBlackPoint(s,i,c,!0),we?(c--,x=!0,O=!0):O||c--;if(c<0){d=!0;break}x&&(v=!0)}if(!d&&v){const re=i-s;let ae=null;for(let je=1;ae===null&&je<re;je++)ae=this.getBlackPointOnSegment(s,u-je,s+je,u);if(ae==null)throw new J;let ue=null;for(let je=1;ue===null&&je<re;je++)ue=this.getBlackPointOnSegment(s,c+je,s+je,c);if(ue==null)throw new J;let we=null;for(let je=1;we===null&&je<re;je++)we=this.getBlackPointOnSegment(i,c+je,i-je,c);if(we==null)throw new J;let Me=null;for(let je=1;Me===null&&je<re;je++)Me=this.getBlackPointOnSegment(i,u-je,i-je,u);if(Me==null)throw new J;return this.centerEdges(Me,ae,we,ue)}else throw new J}getBlackPointOnSegment(s,i,c,u){const d=it.round(it.distance(s,i,c,u)),x=(c-s)/d,v=(u-i)/d,y=this.image;for(let b=0;b<d;b++){const I=it.round(s+b*x),O=it.round(i+b*v);if(y.get(I,O))return new He(I,O)}return null}centerEdges(s,i,c,u){const d=s.getX(),x=s.getY(),v=i.getX(),y=i.getY(),b=c.getX(),I=c.getY(),O=u.getX(),j=u.getY(),q=Jt.CORR;return d<this.width/2?[new He(O-q,j+q),new He(v+q,y+q),new He(b-q,I-q),new He(d+q,x-q)]:[new He(O+q,j+q),new He(v+q,y-q),new He(b-q,I+q),new He(d-q,x-q)]}containsBlackPoint(s,i,c,u){const d=this.image;if(u){for(let x=s;x<=i;x++)if(d.get(x,c))return!0}else for(let x=s;x<=i;x++)if(d.get(c,x))return!0;return!1}}Jt.INIT_SIZE=10,Jt.CORR=1;class xn{static checkAndNudgePoints(s,i){const c=s.getWidth(),u=s.getHeight();let d=!0;for(let x=0;x<i.length&&d;x+=2){const v=Math.floor(i[x]),y=Math.floor(i[x+1]);if(v<-1||v>c||y<-1||y>u)throw new J;d=!1,v===-1?(i[x]=0,d=!0):v===c&&(i[x]=c-1,d=!0),y===-1?(i[x+1]=0,d=!0):y===u&&(i[x+1]=u-1,d=!0)}d=!0;for(let x=i.length-2;x>=0&&d;x-=2){const v=Math.floor(i[x]),y=Math.floor(i[x+1]);if(v<-1||v>c||y<-1||y>u)throw new J;d=!1,v===-1?(i[x]=0,d=!0):v===c&&(i[x]=c-1,d=!0),y===-1?(i[x+1]=0,d=!0):y===u&&(i[x+1]=u-1,d=!0)}}}class vr{constructor(s,i,c,u,d,x,v,y,b){this.a11=s,this.a21=i,this.a31=c,this.a12=u,this.a22=d,this.a32=x,this.a13=v,this.a23=y,this.a33=b}static quadrilateralToQuadrilateral(s,i,c,u,d,x,v,y,b,I,O,j,q,re,ae,ue){const we=vr.quadrilateralToSquare(s,i,c,u,d,x,v,y);return vr.squareToQuadrilateral(b,I,O,j,q,re,ae,ue).times(we)}transformPoints(s){const i=s.length,c=this.a11,u=this.a12,d=this.a13,x=this.a21,v=this.a22,y=this.a23,b=this.a31,I=this.a32,O=this.a33;for(let j=0;j<i;j+=2){const q=s[j],re=s[j+1],ae=d*q+y*re+O;s[j]=(c*q+x*re+b)/ae,s[j+1]=(u*q+v*re+I)/ae}}transformPointsWithValues(s,i){const c=this.a11,u=this.a12,d=this.a13,x=this.a21,v=this.a22,y=this.a23,b=this.a31,I=this.a32,O=this.a33,j=s.length;for(let q=0;q<j;q++){const re=s[q],ae=i[q],ue=d*re+y*ae+O;s[q]=(c*re+x*ae+b)/ue,i[q]=(u*re+v*ae+I)/ue}}static squareToQuadrilateral(s,i,c,u,d,x,v,y){const b=s-c+d-v,I=i-u+x-y;if(b===0&&I===0)return new vr(c-s,d-c,s,u-i,x-u,i,0,0,1);{const O=c-d,j=v-d,q=u-x,re=y-x,ae=O*re-j*q,ue=(b*re-j*I)/ae,we=(O*I-b*q)/ae;return new vr(c-s+ue*c,v-s+we*v,s,u-i+ue*u,y-i+we*y,i,ue,we,1)}}static quadrilateralToSquare(s,i,c,u,d,x,v,y){return vr.squareToQuadrilateral(s,i,c,u,d,x,v,y).buildAdjoint()}buildAdjoint(){return new vr(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(s){return new vr(this.a11*s.a11+this.a21*s.a12+this.a31*s.a13,this.a11*s.a21+this.a21*s.a22+this.a31*s.a23,this.a11*s.a31+this.a21*s.a32+this.a31*s.a33,this.a12*s.a11+this.a22*s.a12+this.a32*s.a13,this.a12*s.a21+this.a22*s.a22+this.a32*s.a23,this.a12*s.a31+this.a22*s.a32+this.a32*s.a33,this.a13*s.a11+this.a23*s.a12+this.a33*s.a13,this.a13*s.a21+this.a23*s.a22+this.a33*s.a23,this.a13*s.a31+this.a23*s.a32+this.a33*s.a33)}}class Ta extends xn{sampleGrid(s,i,c,u,d,x,v,y,b,I,O,j,q,re,ae,ue,we,Me,je){const Fe=vr.quadrilateralToQuadrilateral(u,d,x,v,y,b,I,O,j,q,re,ae,ue,we,Me,je);return this.sampleGridWithTransform(s,i,c,Fe)}sampleGridWithTransform(s,i,c,u){if(i<=0||c<=0)throw new J;const d=new me(i,c),x=new Float32Array(2*i);for(let v=0;v<c;v++){const y=x.length,b=v+.5;for(let I=0;I<y;I+=2)x[I]=I/2+.5,x[I+1]=b;u.transformPoints(x),xn.checkAndNudgePoints(s,x);try{for(let I=0;I<y;I+=2)s.get(Math.floor(x[I]),Math.floor(x[I+1]))&&d.set(I/2,v)}catch{throw new J}}return d}}class qt{static setGridSampler(s){qt.gridSampler=s}static getInstance(){return qt.gridSampler}}qt.gridSampler=new Ta;class Ut{constructor(s,i){this.x=s,this.y=i}toResultPoint(){return new He(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class dt{constructor(s){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=s}detect(){return this.detectMirror(!1)}detectMirror(s){let i=this.getMatrixCenter(),c=this.getBullsEyeCorners(i);if(s){let x=c[0];c[0]=c[2],c[2]=x}this.extractParameters(c);let u=this.sampleGrid(this.image,c[this.shift%4],c[(this.shift+1)%4],c[(this.shift+2)%4],c[(this.shift+3)%4]),d=this.getMatrixCornerPoints(c);return new Wn(u,d,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(s){if(!this.isValidPoint(s[0])||!this.isValidPoint(s[1])||!this.isValidPoint(s[2])||!this.isValidPoint(s[3]))throw new J;let i=2*this.nbCenterLayers,c=new Int32Array([this.sampleLine(s[0],s[1],i),this.sampleLine(s[1],s[2],i),this.sampleLine(s[2],s[3],i),this.sampleLine(s[3],s[0],i)]);this.shift=this.getRotation(c,i);let u=0;for(let x=0;x<4;x++){let v=c[(this.shift+x)%4];this.compact?(u<<=7,u+=v>>1&127):(u<<=10,u+=(v>>2&992)+(v>>1&31))}let d=this.getCorrectedParameterData(u,this.compact);this.compact?(this.nbLayers=(d>>6)+1,this.nbDataBlocks=(d&63)+1):(this.nbLayers=(d>>11)+1,this.nbDataBlocks=(d&2047)+1)}getRotation(s,i){let c=0;s.forEach((u,d,x)=>{let v=(u>>i-2<<1)+(u&1);c=(c<<3)+v}),c=((c&1)<<11)+(c>>1);for(let u=0;u<4;u++)if(N.bitCount(c^this.EXPECTED_CORNER_BITS[u])<=2)return u;throw new J}getCorrectedParameterData(s,i){let c,u;i?(c=7,u=2):(c=10,u=4);let d=c-u,x=new Int32Array(c);for(let y=c-1;y>=0;--y)x[y]=s&15,s>>=4;try{new ot(Ge.AZTEC_PARAM).decode(x,d)}catch{throw new J}let v=0;for(let y=0;y<u;y++)v=(v<<4)+x[y];return v}getBullsEyeCorners(s){let i=s,c=s,u=s,d=s,x=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let O=this.getFirstDifferent(i,x,1,-1),j=this.getFirstDifferent(c,x,1,1),q=this.getFirstDifferent(u,x,-1,1),re=this.getFirstDifferent(d,x,-1,-1);if(this.nbCenterLayers>2){let ae=this.distancePoint(re,O)*this.nbCenterLayers/(this.distancePoint(d,i)*(this.nbCenterLayers+2));if(ae<.75||ae>1.25||!this.isWhiteOrBlackRectangle(O,j,q,re))break}i=O,c=j,u=q,d=re,x=!x}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new J;this.compact=this.nbCenterLayers===5;let v=new He(i.getX()+.5,i.getY()-.5),y=new He(c.getX()+.5,c.getY()+.5),b=new He(u.getX()-.5,u.getY()+.5),I=new He(d.getX()-.5,d.getY()-.5);return this.expandSquare([v,y,b,I],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let s,i,c,u;try{let v=new Jt(this.image).detect();s=v[0],i=v[1],c=v[2],u=v[3]}catch{let y=this.image.getWidth()/2,b=this.image.getHeight()/2;s=this.getFirstDifferent(new Ut(y+7,b-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Ut(y+7,b+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Ut(y-7,b+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Ut(y-7,b-7),!1,-1,-1).toResultPoint()}let d=it.round((s.getX()+u.getX()+i.getX()+c.getX())/4),x=it.round((s.getY()+u.getY()+i.getY()+c.getY())/4);try{let v=new Jt(this.image,15,d,x).detect();s=v[0],i=v[1],c=v[2],u=v[3]}catch{s=this.getFirstDifferent(new Ut(d+7,x-7),!1,1,-1).toResultPoint(),i=this.getFirstDifferent(new Ut(d+7,x+7),!1,1,1).toResultPoint(),c=this.getFirstDifferent(new Ut(d-7,x+7),!1,-1,1).toResultPoint(),u=this.getFirstDifferent(new Ut(d-7,x-7),!1,-1,-1).toResultPoint()}return d=it.round((s.getX()+u.getX()+i.getX()+c.getX())/4),x=it.round((s.getY()+u.getY()+i.getY()+c.getY())/4),new Ut(d,x)}getMatrixCornerPoints(s){return this.expandSquare(s,2*this.nbCenterLayers,this.getDimension())}sampleGrid(s,i,c,u,d){let x=qt.getInstance(),v=this.getDimension(),y=v/2-this.nbCenterLayers,b=v/2+this.nbCenterLayers;return x.sampleGrid(s,v,v,y,y,b,y,b,b,y,b,i.getX(),i.getY(),c.getX(),c.getY(),u.getX(),u.getY(),d.getX(),d.getY())}sampleLine(s,i,c){let u=0,d=this.distanceResultPoint(s,i),x=d/c,v=s.getX(),y=s.getY(),b=x*(i.getX()-s.getX())/d,I=x*(i.getY()-s.getY())/d;for(let O=0;O<c;O++)this.image.get(it.round(v+O*b),it.round(y+O*I))&&(u|=1<<c-O-1);return u}isWhiteOrBlackRectangle(s,i,c,u){let d=3;s=new Ut(s.getX()-d,s.getY()+d),i=new Ut(i.getX()-d,i.getY()-d),c=new Ut(c.getX()+d,c.getY()-d),u=new Ut(u.getX()+d,u.getY()+d);let x=this.getColor(u,s);if(x===0)return!1;let v=this.getColor(s,i);return v!==x||(v=this.getColor(i,c),v!==x)?!1:(v=this.getColor(c,u),v===x)}getColor(s,i){let c=this.distancePoint(s,i),u=(i.getX()-s.getX())/c,d=(i.getY()-s.getY())/c,x=0,v=s.getX(),y=s.getY(),b=this.image.get(s.getX(),s.getY()),I=Math.ceil(c);for(let j=0;j<I;j++)v+=u,y+=d,this.image.get(it.round(v),it.round(y))!==b&&x++;let O=x/c;return O>.1&&O<.9?0:O<=.1===b?1:-1}getFirstDifferent(s,i,c,u){let d=s.getX()+c,x=s.getY()+u;for(;this.isValid(d,x)&&this.image.get(d,x)===i;)d+=c,x+=u;for(d-=c,x-=u;this.isValid(d,x)&&this.image.get(d,x)===i;)d+=c;for(d-=c;this.isValid(d,x)&&this.image.get(d,x)===i;)x+=u;return x-=u,new Ut(d,x)}expandSquare(s,i,c){let u=c/(2*i),d=s[0].getX()-s[2].getX(),x=s[0].getY()-s[2].getY(),v=(s[0].getX()+s[2].getX())/2,y=(s[0].getY()+s[2].getY())/2,b=new He(v+u*d,y+u*x),I=new He(v-u*d,y-u*x);d=s[1].getX()-s[3].getX(),x=s[1].getY()-s[3].getY(),v=(s[1].getX()+s[3].getX())/2,y=(s[1].getY()+s[3].getY())/2;let O=new He(v+u*d,y+u*x),j=new He(v-u*d,y-u*x);return[b,O,I,j]}isValid(s,i){return s>=0&&s<this.image.getWidth()&&i>0&&i<this.image.getHeight()}isValidPoint(s){let i=it.round(s.getX()),c=it.round(s.getY());return this.isValid(i,c)}distancePoint(s,i){return it.distance(s.getX(),s.getY(),i.getX(),i.getY())}distanceResultPoint(s,i){return it.distance(s.getX(),s.getY(),i.getX(),i.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(N.truncDivision(this.nbLayers-4,8)+1)+15}}class zt{decode(s,i=null){let c=null,u=new dt(s.getBlackMatrix()),d=null,x=null;try{let I=u.detectMirror(!1);d=I.getPoints(),this.reportFoundResultPoints(i,d),x=new rt().decode(I)}catch(I){c=I}if(x==null)try{let I=u.detectMirror(!0);d=I.getPoints(),this.reportFoundResultPoints(i,d),x=new rt().decode(I)}catch(I){throw c??I}let v=new te(x.getText(),x.getRawBytes(),x.getNumBits(),d,ce.AZTEC,_.currentTimeMillis()),y=x.getByteSegments();y!=null&&v.putMetadata(ye.BYTE_SEGMENTS,y);let b=x.getECLevel();return b!=null&&v.putMetadata(ye.ERROR_CORRECTION_LEVEL,b),v}reportFoundResultPoints(s,i){if(s!=null){let c=s.get(B.NEED_RESULT_POINT_CALLBACK);c!=null&&i.forEach((u,d,x)=>{c.foundPossibleResultPoint(u)})}}reset(){}}class an extends oe{constructor(s=500){super(new zt,s)}}class xt{decode(s,i){try{return this.doDecode(s,i)}catch{if(i&&i.get(B.TRY_HARDER)===!0&&s.isRotateSupported()){const d=s.rotateCounterClockwise(),x=this.doDecode(d,i),v=x.getResultMetadata();let y=270;v!==null&&v.get(ye.ORIENTATION)===!0&&(y=y+v.get(ye.ORIENTATION)%360),x.putMetadata(ye.ORIENTATION,y);const b=x.getResultPoints();if(b!==null){const I=d.getHeight();for(let O=0;O<b.length;O++)b[O]=new He(I-b[O].getY()-1,b[O].getX())}return x}else throw new J}}reset(){}doDecode(s,i){const c=s.getWidth(),u=s.getHeight();let d=new F(c);const x=i&&i.get(B.TRY_HARDER)===!0,v=Math.max(1,u>>(x?8:5));let y;x?y=u:y=15;const b=Math.trunc(u/2);for(let I=0;I<y;I++){const O=Math.trunc((I+1)/2),j=(I&1)===0,q=b+v*(j?O:-O);if(q<0||q>=u)break;try{d=s.getBlackRow(q,d)}catch{continue}for(let re=0;re<2;re++){if(re===1&&(d.reverse(),i&&i.get(B.NEED_RESULT_POINT_CALLBACK)===!0)){const ae=new Map;i.forEach((ue,we)=>ae.set(we,ue)),ae.delete(B.NEED_RESULT_POINT_CALLBACK),i=ae}try{const ae=this.decodeRow(q,d,i);if(re===1){ae.putMetadata(ye.ORIENTATION,180);const ue=ae.getResultPoints();ue!==null&&(ue[0]=new He(c-ue[0].getX()-1,ue[0].getY()),ue[1]=new He(c-ue[1].getX()-1,ue[1].getY()))}return ae}catch{}}}throw new J}static recordPattern(s,i,c){const u=c.length;for(let b=0;b<u;b++)c[b]=0;const d=s.getSize();if(i>=d)throw new J;let x=!s.get(i),v=0,y=i;for(;y<d;){if(s.get(y)!==x)c[v]++;else{if(++v===u)break;c[v]=1,x=!x}y++}if(!(v===u||v===u-1&&y===d))throw new J}static recordPatternInReverse(s,i,c){let u=c.length,d=s.get(i);for(;i>0&&u>=0;)s.get(--i)!==d&&(u--,d=!d);if(u>=0)throw new J;xt.recordPattern(s,i+1,c)}static patternMatchVariance(s,i,c){const u=s.length;let d=0,x=0;for(let b=0;b<u;b++)d+=s[b],x+=i[b];if(d<x)return Number.POSITIVE_INFINITY;const v=d/x;c*=v;let y=0;for(let b=0;b<u;b++){const I=s[b],O=i[b]*v,j=I>O?I-O:O-I;if(j>c)return Number.POSITIVE_INFINITY;y+=j}return y/d}}class Pe extends xt{static findStartPattern(s){const i=s.getSize(),c=s.getNextSet(0);let u=0,d=Int32Array.from([0,0,0,0,0,0]),x=c,v=!1;const y=6;for(let b=c;b<i;b++)if(s.get(b)!==v)d[u]++;else{if(u===y-1){let I=Pe.MAX_AVG_VARIANCE,O=-1;for(let j=Pe.CODE_START_A;j<=Pe.CODE_START_C;j++){const q=xt.patternMatchVariance(d,Pe.CODE_PATTERNS[j],Pe.MAX_INDIVIDUAL_VARIANCE);q<I&&(I=q,O=j)}if(O>=0&&s.isRange(Math.max(0,x-(b-x)/2),x,!1))return Int32Array.from([x,b,O]);x+=d[0]+d[1],d=d.slice(2,d.length-1),d[u-1]=0,d[u]=0,u--}else u++;d[u]=1,v=!v}throw new J}static decodeCode(s,i,c){xt.recordPattern(s,c,i);let u=Pe.MAX_AVG_VARIANCE,d=-1;for(let x=0;x<Pe.CODE_PATTERNS.length;x++){const v=Pe.CODE_PATTERNS[x],y=this.patternMatchVariance(i,v,Pe.MAX_INDIVIDUAL_VARIANCE);y<u&&(u=y,d=x)}if(d>=0)return d;throw new J}decodeRow(s,i,c){const u=c&&c.get(B.ASSUME_GS1)===!0,d=Pe.findStartPattern(i),x=d[2];let v=0;const y=new Uint8Array(20);y[v++]=x;let b;switch(x){case Pe.CODE_START_A:b=Pe.CODE_CODE_A;break;case Pe.CODE_START_B:b=Pe.CODE_CODE_B;break;case Pe.CODE_START_C:b=Pe.CODE_CODE_C;break;default:throw new R}let I=!1,O=!1,j="",q=d[0],re=d[1];const ae=Int32Array.from([0,0,0,0,0,0]);let ue=0,we=0,Me=x,je=0,Fe=!0,At=!1,lt=!1;for(;!I;){const js=O;switch(O=!1,ue=we,we=Pe.decodeCode(i,ae,re),y[v++]=we,we!==Pe.CODE_STOP&&(Fe=!0),we!==Pe.CODE_STOP&&(je++,Me+=je*we),q=re,re+=ae.reduce((am,sm)=>am+sm,0),we){case Pe.CODE_START_A:case Pe.CODE_START_B:case Pe.CODE_START_C:throw new R}switch(b){case Pe.CODE_CODE_A:if(we<64)lt===At?j+=String.fromCharCode(32+we):j+=String.fromCharCode(32+we+128),lt=!1;else if(we<96)lt===At?j+=String.fromCharCode(we-64):j+=String.fromCharCode(we+64),lt=!1;else switch(we!==Pe.CODE_STOP&&(Fe=!1),we){case Pe.CODE_FNC_1:u&&(j.length===0?j+="]C1":j+="");break;case Pe.CODE_FNC_2:case Pe.CODE_FNC_3:break;case Pe.CODE_FNC_4_A:!At&&lt?(At=!0,lt=!1):At&&lt?(At=!1,lt=!1):lt=!0;break;case Pe.CODE_SHIFT:O=!0,b=Pe.CODE_CODE_B;break;case Pe.CODE_CODE_B:b=Pe.CODE_CODE_B;break;case Pe.CODE_CODE_C:b=Pe.CODE_CODE_C;break;case Pe.CODE_STOP:I=!0;break}break;case Pe.CODE_CODE_B:if(we<96)lt===At?j+=String.fromCharCode(32+we):j+=String.fromCharCode(32+we+128),lt=!1;else switch(we!==Pe.CODE_STOP&&(Fe=!1),we){case Pe.CODE_FNC_1:u&&(j.length===0?j+="]C1":j+="");break;case Pe.CODE_FNC_2:case Pe.CODE_FNC_3:break;case Pe.CODE_FNC_4_B:!At&&lt?(At=!0,lt=!1):At&&lt?(At=!1,lt=!1):lt=!0;break;case Pe.CODE_SHIFT:O=!0,b=Pe.CODE_CODE_A;break;case Pe.CODE_CODE_A:b=Pe.CODE_CODE_A;break;case Pe.CODE_CODE_C:b=Pe.CODE_CODE_C;break;case Pe.CODE_STOP:I=!0;break}break;case Pe.CODE_CODE_C:if(we<100)we<10&&(j+="0"),j+=we;else switch(we!==Pe.CODE_STOP&&(Fe=!1),we){case Pe.CODE_FNC_1:u&&(j.length===0?j+="]C1":j+="");break;case Pe.CODE_CODE_A:b=Pe.CODE_CODE_A;break;case Pe.CODE_CODE_B:b=Pe.CODE_CODE_B;break;case Pe.CODE_STOP:I=!0;break}break}js&&(b=b===Pe.CODE_CODE_A?Pe.CODE_CODE_B:Pe.CODE_CODE_A)}const on=re-q;if(re=i.getNextUnset(re),!i.isRange(re,Math.min(i.getSize(),re+(re-q)/2),!1))throw new J;if(Me-=je*ue,Me%103!==ue)throw new A;const Gn=j.length;if(Gn===0)throw new J;Gn>0&&Fe&&(b===Pe.CODE_CODE_C?j=j.substring(0,Gn-2):j=j.substring(0,Gn-1));const cn=(d[1]+d[0])/2,Bt=q+on/2,Pr=y.length,pn=new Uint8Array(Pr);for(let js=0;js<Pr;js++)pn[js]=y[js];const Ls=[new He(cn,s),new He(Bt,s)];return new te(j,pn,0,Ls,ce.CODE_128,new Date().getTime())}}Pe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Pe.MAX_AVG_VARIANCE=.25,Pe.MAX_INDIVIDUAL_VARIANCE=.7,Pe.CODE_SHIFT=98,Pe.CODE_CODE_C=99,Pe.CODE_CODE_B=100,Pe.CODE_CODE_A=101,Pe.CODE_FNC_1=102,Pe.CODE_FNC_2=97,Pe.CODE_FNC_3=96,Pe.CODE_FNC_4_A=101,Pe.CODE_FNC_4_B=100,Pe.CODE_START_A=103,Pe.CODE_START_B=104,Pe.CODE_START_C=105,Pe.CODE_STOP=106;class sr extends xt{constructor(s=!1,i=!1){super(),this.usingCheckDigit=s,this.extendedMode=i,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(s,i,c){let u=this.counters;u.fill(0),this.decodeRowResult="";let d=sr.findAsteriskPattern(i,u),x=i.getNextSet(d[1]),v=i.getSize(),y,b;do{sr.recordPattern(i,x,u);let ae=sr.toNarrowWidePattern(u);if(ae<0)throw new J;y=sr.patternToChar(ae),this.decodeRowResult+=y,b=x;for(let ue of u)x+=ue;x=i.getNextSet(x)}while(y!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let I=0;for(let ae of u)I+=ae;let O=x-b-I;if(x!==v&&O*2<I)throw new J;if(this.usingCheckDigit){let ae=this.decodeRowResult.length-1,ue=0;for(let we=0;we<ae;we++)ue+=sr.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(we));if(this.decodeRowResult.charAt(ae)!==sr.ALPHABET_STRING.charAt(ue%43))throw new A;this.decodeRowResult=this.decodeRowResult.substring(0,ae)}if(this.decodeRowResult.length===0)throw new J;let j;this.extendedMode?j=sr.decodeExtended(this.decodeRowResult):j=this.decodeRowResult;let q=(d[1]+d[0])/2,re=b+I/2;return new te(j,null,0,[new He(q,s),new He(re,s)],ce.CODE_39,new Date().getTime())}static findAsteriskPattern(s,i){let c=s.getSize(),u=s.getNextSet(0),d=0,x=u,v=!1,y=i.length;for(let b=u;b<c;b++)if(s.get(b)!==v)i[d]++;else{if(d===y-1){if(this.toNarrowWidePattern(i)===sr.ASTERISK_ENCODING&&s.isRange(Math.max(0,x-Math.floor((b-x)/2)),x,!1))return[x,b];x+=i[0]+i[1],i.copyWithin(0,2,2+d-1),i[d-1]=0,i[d]=0,d--}else d++;i[d]=1,v=!v}throw new J}static toNarrowWidePattern(s){let i=s.length,c=0,u;do{let d=2147483647;for(let y of s)y<d&&y>c&&(d=y);c=d,u=0;let x=0,v=0;for(let y=0;y<i;y++){let b=s[y];b>c&&(v|=1<<i-1-y,u++,x+=b)}if(u===3){for(let y=0;y<i&&u>0;y++){let b=s[y];if(b>c&&(u--,b*2>=x))return-1}return v}}while(u>3);return-1}static patternToChar(s){for(let i=0;i<sr.CHARACTER_ENCODINGS.length;i++)if(sr.CHARACTER_ENCODINGS[i]===s)return sr.ALPHABET_STRING.charAt(i);if(s===sr.ASTERISK_ENCODING)return"*";throw new J}static decodeExtended(s){let i=s.length,c="";for(let u=0;u<i;u++){let d=s.charAt(u);if(d==="+"||d==="$"||d==="%"||d==="/"){let x=s.charAt(u+1),v="\0";switch(d){case"+":if(x>="A"&&x<="Z")v=String.fromCharCode(x.charCodeAt(0)+32);else throw new R;break;case"$":if(x>="A"&&x<="Z")v=String.fromCharCode(x.charCodeAt(0)-64);else throw new R;break;case"%":if(x>="A"&&x<="E")v=String.fromCharCode(x.charCodeAt(0)-38);else if(x>="F"&&x<="J")v=String.fromCharCode(x.charCodeAt(0)-11);else if(x>="K"&&x<="O")v=String.fromCharCode(x.charCodeAt(0)+16);else if(x>="P"&&x<="T")v=String.fromCharCode(x.charCodeAt(0)+43);else if(x==="U")v="\0";else if(x==="V")v="@";else if(x==="W")v="`";else if(x==="X"||x==="Y"||x==="Z")v="";else throw new R;break;case"/":if(x>="A"&&x<="O")v=String.fromCharCode(x.charCodeAt(0)-32);else if(x==="Z")v=":";else throw new R;break}c+=v,u++}else c+=d}return c}}sr.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",sr.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],sr.ASTERISK_ENCODING=148;class Ft extends xt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(s,i,c){let u=this.decodeStart(i),d=this.decodeEnd(i),x=new ne;Ft.decodeMiddle(i,u[1],d[0],x);let v=x.toString(),y=null;c!=null&&(y=c.get(B.ALLOWED_LENGTHS)),y==null&&(y=Ft.DEFAULT_ALLOWED_LENGTHS);let b=v.length,I=!1,O=0;for(let re of y){if(b===re){I=!0;break}re>O&&(O=re)}if(!I&&b>O&&(I=!0),!I)throw new R;const j=[new He(u[1],s),new He(d[0],s)];return new te(v,null,0,j,ce.ITF,new Date().getTime())}static decodeMiddle(s,i,c,u){let d=new Int32Array(10),x=new Int32Array(5),v=new Int32Array(5);for(d.fill(0),x.fill(0),v.fill(0);i<c;){xt.recordPattern(s,i,d);for(let b=0;b<5;b++){let I=2*b;x[b]=d[I],v[b]=d[I+1]}let y=Ft.decodeDigit(x);u.append(y.toString()),y=this.decodeDigit(v),u.append(y.toString()),d.forEach(function(b){i+=b})}}decodeStart(s){let i=Ft.skipWhiteSpace(s),c=Ft.findGuardPattern(s,i,Ft.START_PATTERN);return this.narrowLineWidth=(c[1]-c[0])/4,this.validateQuietZone(s,c[0]),c}validateQuietZone(s,i){let c=this.narrowLineWidth*10;c=c<i?c:i;for(let u=i-1;c>0&&u>=0&&!s.get(u);u--)c--;if(c!==0)throw new J}static skipWhiteSpace(s){const i=s.getSize(),c=s.getNextSet(0);if(c===i)throw new J;return c}decodeEnd(s){s.reverse();try{let i=Ft.skipWhiteSpace(s),c;try{c=Ft.findGuardPattern(s,i,Ft.END_PATTERN_REVERSED[0])}catch(d){d instanceof J&&(c=Ft.findGuardPattern(s,i,Ft.END_PATTERN_REVERSED[1]))}this.validateQuietZone(s,c[0]);let u=c[0];return c[0]=s.getSize()-c[1],c[1]=s.getSize()-u,c}finally{s.reverse()}}static findGuardPattern(s,i,c){let u=c.length,d=new Int32Array(u),x=s.getSize(),v=!1,y=0,b=i;d.fill(0);for(let I=i;I<x;I++)if(s.get(I)!==v)d[y]++;else{if(y===u-1){if(xt.patternMatchVariance(d,c,Ft.MAX_INDIVIDUAL_VARIANCE)<Ft.MAX_AVG_VARIANCE)return[b,I];b+=d[0]+d[1],_.arraycopy(d,2,d,0,y-1),d[y-1]=0,d[y]=0,y--}else y++;d[y]=1,v=!v}throw new J}static decodeDigit(s){let i=Ft.MAX_AVG_VARIANCE,c=-1,u=Ft.PATTERNS.length;for(let d=0;d<u;d++){let x=Ft.PATTERNS[d],v=xt.patternMatchVariance(s,x,Ft.MAX_INDIVIDUAL_VARIANCE);v<i?(i=v,c=d):v===i&&(c=-1)}if(c>=0)return c%10;throw new J}}Ft.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ft.MAX_AVG_VARIANCE=.38,Ft.MAX_INDIVIDUAL_VARIANCE=.5,Ft.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ft.START_PATTERN=Int32Array.from([1,1,1,1]),Ft.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Kt extends xt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(s){let i=!1,c,u=0,d=Int32Array.from([0,0,0]);for(;!i;){d=Int32Array.from([0,0,0]),c=Kt.findGuardPattern(s,u,!1,this.START_END_PATTERN,d);let x=c[0];u=c[1];let v=x-(u-x);v>=0&&(i=s.isRange(v,x,!1))}return c}static checkChecksum(s){return Kt.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let i=s.length;if(i===0)return!1;let c=parseInt(s.charAt(i-1),10);return Kt.getStandardUPCEANChecksum(s.substring(0,i-1))===c}static getStandardUPCEANChecksum(s){let i=s.length,c=0;for(let u=i-1;u>=0;u-=2){let d=s.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new R;c+=d}c*=3;for(let u=i-2;u>=0;u-=2){let d=s.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new R;c+=d}return(1e3-c)%10}static decodeEnd(s,i){return Kt.findGuardPattern(s,i,!1,Kt.START_END_PATTERN,new Int32Array(Kt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(s,i,c,u){return this.findGuardPattern(s,i,c,u,new Int32Array(u.length))}static findGuardPattern(s,i,c,u,d){let x=s.getSize();i=c?s.getNextUnset(i):s.getNextSet(i);let v=0,y=i,b=u.length,I=c;for(let O=i;O<x;O++)if(s.get(O)!==I)d[v]++;else{if(v===b-1){if(xt.patternMatchVariance(d,u,Kt.MAX_INDIVIDUAL_VARIANCE)<Kt.MAX_AVG_VARIANCE)return Int32Array.from([y,O]);y+=d[0]+d[1];let j=d.slice(2,d.length-1);for(let q=0;q<v-1;q++)d[q]=j[q];d[v-1]=0,d[v]=0,v--}else v++;d[v]=1,I=!I}throw new J}static decodeDigit(s,i,c,u){this.recordPattern(s,c,i);let d=this.MAX_AVG_VARIANCE,x=-1,v=u.length;for(let y=0;y<v;y++){let b=u[y],I=xt.patternMatchVariance(i,b,Kt.MAX_INDIVIDUAL_VARIANCE);I<d&&(d=I,x=y)}if(x>=0)return x;throw new J}}Kt.MAX_AVG_VARIANCE=.48,Kt.MAX_INDIVIDUAL_VARIANCE=.7,Kt.START_END_PATTERN=Int32Array.from([1,1,1]),Kt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Kt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Kt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Na{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,i,c){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(i,c,u),x=u.toString(),v=Na.parseExtensionString(x),y=[new He((c[0]+c[1])/2,s),new He(d,s)],b=new te(x,null,0,y,ce.UPC_EAN_EXTENSION,new Date().getTime());return v!=null&&b.putAllMetadata(v),b}decodeMiddle(s,i,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=s.getSize(),x=i[1],v=0;for(let b=0;b<5&&x<d;b++){let I=Kt.decodeDigit(s,u,x,Kt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+I%10);for(let O of u)x+=O;I>=10&&(v|=1<<4-b),b!==4&&(x=s.getNextSet(x),x=s.getNextUnset(x))}if(c.length!==5)throw new J;let y=this.determineCheckDigit(v);if(Na.extensionChecksum(c.toString())!==y)throw new J;return x}static extensionChecksum(s){let i=s.length,c=0;for(let u=i-2;u>=0;u-=2)c+=s.charAt(u).charCodeAt(0)-48;c*=3;for(let u=i-1;u>=0;u-=2)c+=s.charAt(u).charCodeAt(0)-48;return c*=3,c%10}determineCheckDigit(s){for(let i=0;i<10;i++)if(s===this.CHECK_DIGIT_ENCODINGS[i])return i;throw new J}static parseExtensionString(s){if(s.length!==5)return null;let i=Na.parseExtension5String(s);return i==null?null:new Map([[ye.SUGGESTED_PRICE,i]])}static parseExtension5String(s){let i;switch(s.charAt(0)){case"0":i="Â£";break;case"5":i="$";break;case"9":switch(s){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}i="";break;default:i="";break}let c=parseInt(s.substring(1)),u=(c/100).toString(),d=c%100,x=d<10?"0"+d:d.toString();return i+u+"."+x}}class Fs{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(s,i,c){let u=this.decodeRowStringBuffer,d=this.decodeMiddle(i,c,u),x=u.toString(),v=Fs.parseExtensionString(x),y=[new He((c[0]+c[1])/2,s),new He(d,s)],b=new te(x,null,0,y,ce.UPC_EAN_EXTENSION,new Date().getTime());return v!=null&&b.putAllMetadata(v),b}decodeMiddle(s,i,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=s.getSize(),x=i[1],v=0;for(let y=0;y<2&&x<d;y++){let b=Kt.decodeDigit(s,u,x,Kt.L_AND_G_PATTERNS);c+=String.fromCharCode(48+b%10);for(let I of u)x+=I;b>=10&&(v|=1<<1-y),y!==1&&(x=s.getNextSet(x),x=s.getNextUnset(x))}if(c.length!==2)throw new J;if(parseInt(c.toString())%4!==v)throw new J;return x}static parseExtensionString(s){return s.length!==2?null:new Map([[ye.ISSUE_NUMBER,parseInt(s)]])}}class li{static decodeRow(s,i,c){let u=Kt.findGuardPattern(i,c,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new Na().decodeRow(s,i,u)}catch{return new Fs().decodeRow(s,i,u)}}}li.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class St extends Kt{constructor(){super(),this.decodeRowStringBuffer="",St.L_AND_G_PATTERNS=St.L_PATTERNS.map(s=>Int32Array.from(s));for(let s=10;s<20;s++){let i=St.L_PATTERNS[s-10],c=new Int32Array(i.length);for(let u=0;u<i.length;u++)c[u]=i[i.length-u-1];St.L_AND_G_PATTERNS[s]=c}}decodeRow(s,i,c){let u=St.findStartGuardPattern(i),d=c==null?null:c.get(B.NEED_RESULT_POINT_CALLBACK);if(d!=null){const Fe=new He((u[0]+u[1])/2,s);d.foundPossibleResultPoint(Fe)}let x=this.decodeMiddle(i,u,this.decodeRowStringBuffer),v=x.rowOffset,y=x.resultString;if(d!=null){const Fe=new He(v,s);d.foundPossibleResultPoint(Fe)}let b=this.decodeEnd(i,v);if(d!=null){const Fe=new He((b[0]+b[1])/2,s);d.foundPossibleResultPoint(Fe)}let I=b[1],O=I+(I-b[0]);if(O>=i.getSize()||!i.isRange(I,O,!1))throw new J;let j=y.toString();if(j.length<8)throw new R;if(!St.checkChecksum(j))throw new A;let q=(u[1]+u[0])/2,re=(b[1]+b[0])/2,ae=this.getBarcodeFormat(),ue=[new He(q,s),new He(re,s)],we=new te(j,null,0,ue,ae,new Date().getTime()),Me=0;try{let Fe=li.decodeRow(s,i,b[1]);we.putMetadata(ye.UPC_EAN_EXTENSION,Fe.getText()),we.putAllMetadata(Fe.getResultMetadata()),we.addResultPoints(Fe.getResultPoints()),Me=Fe.getText().length}catch{}let je=c==null?null:c.get(B.ALLOWED_EAN_EXTENSIONS);if(je!=null){let Fe=!1;for(let At in je)if(Me.toString()===At){Fe=!0;break}if(!Fe)throw new J}return we}decodeEnd(s,i){return St.findGuardPattern(s,i,!1,St.START_END_PATTERN,new Int32Array(St.START_END_PATTERN.length).fill(0))}static checkChecksum(s){return St.checkStandardUPCEANChecksum(s)}static checkStandardUPCEANChecksum(s){let i=s.length;if(i===0)return!1;let c=parseInt(s.charAt(i-1),10);return St.getStandardUPCEANChecksum(s.substring(0,i-1))===c}static getStandardUPCEANChecksum(s){let i=s.length,c=0;for(let u=i-1;u>=0;u-=2){let d=s.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new R;c+=d}c*=3;for(let u=i-2;u>=0;u-=2){let d=s.charAt(u).charCodeAt(0)-48;if(d<0||d>9)throw new R;c+=d}return(1e3-c)%10}}class ha extends St{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,i,c){let u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=s.getSize(),x=i[1],v=0;for(let b=0;b<6&&x<d;b++){let I=St.decodeDigit(s,u,x,St.L_AND_G_PATTERNS);c+=String.fromCharCode(48+I%10);for(let O of u)x+=O;I>=10&&(v|=1<<5-b)}c=ha.determineFirstDigit(c,v),x=St.findGuardPattern(s,x,!0,St.MIDDLE_PATTERN,new Int32Array(St.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<6&&x<d;b++){let I=St.decodeDigit(s,u,x,St.L_PATTERNS);c+=String.fromCharCode(48+I);for(let O of u)x+=O}return{rowOffset:x,resultString:c}}getBarcodeFormat(){return ce.EAN_13}static determineFirstDigit(s,i){for(let c=0;c<10;c++)if(i===this.FIRST_DIGIT_ENCODINGS[c])return s=String.fromCharCode(48+c)+s,s;throw new J}}ha.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ns extends St{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(s,i,c){const u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=s.getSize(),x=i[1];for(let y=0;y<4&&x<d;y++){let b=St.decodeDigit(s,u,x,St.L_PATTERNS);c+=String.fromCharCode(48+b);for(let I of u)x+=I}x=St.findGuardPattern(s,x,!0,St.MIDDLE_PATTERN,new Int32Array(St.MIDDLE_PATTERN.length).fill(0))[1];for(let y=0;y<4&&x<d;y++){let b=St.decodeDigit(s,u,x,St.L_PATTERNS);c+=String.fromCharCode(48+b);for(let I of u)x+=I}return{rowOffset:x,resultString:c}}getBarcodeFormat(){return ce.EAN_8}}class xo extends St{constructor(){super(...arguments),this.ean13Reader=new ha}getBarcodeFormat(){return ce.UPC_A}decode(s,i){return this.maybeReturnResult(this.ean13Reader.decode(s))}decodeRow(s,i,c){return this.maybeReturnResult(this.ean13Reader.decodeRow(s,i,c))}decodeMiddle(s,i,c){return this.ean13Reader.decodeMiddle(s,i,c)}maybeReturnResult(s){let i=s.getText();if(i.charAt(0)==="0"){let c=new te(i.substring(1),null,null,s.getResultPoints(),ce.UPC_A);return s.getResultMetadata()!=null&&c.putAllMetadata(s.getResultMetadata()),c}else throw new J}reset(){this.ean13Reader.reset()}}class mn extends St{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(s,i,c){const u=this.decodeMiddleCounters.map(b=>b);u[0]=0,u[1]=0,u[2]=0,u[3]=0;const d=s.getSize();let x=i[1],v=0;for(let b=0;b<6&&x<d;b++){const I=mn.decodeDigit(s,u,x,mn.L_AND_G_PATTERNS);c+=String.fromCharCode(48+I%10);for(let O of u)x+=O;I>=10&&(v|=1<<5-b)}let y=mn.determineNumSysAndCheckDigit(c,v);return{rowOffset:x,resultString:y}}decodeEnd(s,i){return mn.findGuardPatternWithoutCounters(s,i,!0,mn.MIDDLE_END_PATTERN)}checkChecksum(s){return St.checkChecksum(mn.convertUPCEtoUPCA(s))}static determineNumSysAndCheckDigit(s,i){for(let c=0;c<=1;c++)for(let u=0;u<10;u++)if(i===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[c][u]){let d=String.fromCharCode(48+c),x=String.fromCharCode(48+u);return d+s+x}throw J.getNotFoundInstance()}getBarcodeFormat(){return ce.UPC_E}static convertUPCEtoUPCA(s){const i=s.slice(1,7).split("").map(d=>d.charCodeAt(0)),c=new ne;c.append(s.charAt(0));let u=i[5];switch(u){case 0:case 1:case 2:c.appendChars(i,0,2),c.append(u),c.append("0000"),c.appendChars(i,2,3);break;case 3:c.appendChars(i,0,3),c.append("00000"),c.appendChars(i,3,2);break;case 4:c.appendChars(i,0,4),c.append("00000"),c.append(i[4]);break;default:c.appendChars(i,0,5),c.append("0000"),c.append(u);break}return s.length>=8&&c.append(s.charAt(7)),c.toString()}}mn.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),mn.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class ui extends xt{constructor(s){super();let i=s==null?null:s.get(B.POSSIBLE_FORMATS),c=[];n(i)?(c.push(new ha),c.push(new xo),c.push(new ns),c.push(new mn)):(i.indexOf(ce.EAN_13)>-1&&c.push(new ha),i.indexOf(ce.UPC_A)>-1&&c.push(new xo),i.indexOf(ce.EAN_8)>-1&&c.push(new ns),i.indexOf(ce.UPC_E)>-1&&c.push(new mn)),this.readers=c}decodeRow(s,i,c){for(let u of this.readers)try{const d=u.decodeRow(s,i,c),x=d.getBarcodeFormat()===ce.EAN_13&&d.getText().charAt(0)==="0",v=c==null?null:c.get(B.POSSIBLE_FORMATS),y=v==null||v.includes(ce.UPC_A);if(x&&y){const b=d.getRawBytes(),I=new te(d.getText().substring(1),b,b?b.length:null,d.getResultPoints(),ce.UPC_A);return I.putAllMetadata(d.getResultMetadata()),I}return d}catch{}throw new J}reset(){for(let s of this.readers)s.reset()}}class Ir extends xt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(s,i){for(let c=0;c<i.length;c++)if(xt.patternMatchVariance(s,i[c],Ir.MAX_INDIVIDUAL_VARIANCE)<Ir.MAX_AVG_VARIANCE)return c;throw new J}static count(s){return it.sum(new Int32Array(s))}static increment(s,i){let c=0,u=i[0];for(let d=1;d<s.length;d++)i[d]>u&&(u=i[d],c=d);s[c]++}static decrement(s,i){let c=0,u=i[0];for(let d=1;d<s.length;d++)i[d]<u&&(u=i[d],c=d);s[c]--}static isFinderPattern(s){let i=s[0]+s[1],c=i+s[2]+s[3],u=i/c;if(u>=Ir.MIN_FINDER_PATTERN_RATIO&&u<=Ir.MAX_FINDER_PATTERN_RATIO){let d=Number.MAX_SAFE_INTEGER,x=Number.MIN_SAFE_INTEGER;for(let v of s)v>x&&(x=v),v<d&&(d=v);return x<10*d}return!1}}Ir.MAX_AVG_VARIANCE=.2,Ir.MAX_INDIVIDUAL_VARIANCE=.45,Ir.MIN_FINDER_PATTERN_RATIO=9.5/12,Ir.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ia{constructor(s,i){this.value=s,this.checksumPortion=i}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(s){if(!(s instanceof Ia))return!1;const i=s;return this.value===i.value&&this.checksumPortion===i.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Ds{constructor(s,i,c,u,d){this.value=s,this.startEnd=i,this.value=s,this.startEnd=i,this.resultPoints=new Array,this.resultPoints.push(new He(c,d)),this.resultPoints.push(new He(u,d))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(s){if(!(s instanceof Ds))return!1;const i=s;return this.value===i.value}hashCode(){return this.value}}class Tn{constructor(){}static getRSSvalue(s,i,c){let u=0;for(let y of s)u+=y;let d=0,x=0,v=s.length;for(let y=0;y<v-1;y++){let b;for(b=1,x|=1<<y;b<s[y];b++,x&=~(1<<y)){let I=Tn.combins(u-b-1,v-y-2);if(c&&x===0&&u-b-(v-y-1)>=v-y-1&&(I-=Tn.combins(u-b-(v-y),v-y-2)),v-y-1>1){let O=0;for(let j=u-b-(v-y-2);j>i;j--)O+=Tn.combins(u-b-j-1,v-y-3);I-=O*(v-1-y)}else u-b>i&&I--;d+=I}u-=b}return d}static combins(s,i){let c,u;s-i>i?(u=i,c=s-i):(u=s-i,c=i);let d=1,x=1;for(let v=s;v>c;v--)d*=v,x<=u&&(d/=x,x++);for(;x<=u;)d/=x,x++;return d}}class Ic{static buildBitArray(s){let i=s.length*2-1;s[s.length-1].getRightChar()==null&&(i-=1);let c=12*i,u=new F(c),d=0,v=s[0].getRightChar().getValue();for(let y=11;y>=0;--y)v&1<<y&&u.set(d),d++;for(let y=1;y<s.length;++y){let b=s[y],I=b.getLeftChar().getValue();for(let O=11;O>=0;--O)I&1<<O&&u.set(d),d++;if(b.getRightChar()!=null){let O=b.getRightChar().getValue();for(let j=11;j>=0;--j)O&1<<j&&u.set(d),d++}}return u}}class Vn{constructor(s,i){i?this.decodedInformation=null:(this.finished=s,this.decodedInformation=i)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class fi{constructor(s){this.newPosition=s}getNewPosition(){return this.newPosition}}class Wr extends fi{constructor(s,i){super(s),this.value=i}getValue(){return this.value}isFNC1(){return this.value===Wr.FNC1}}Wr.FNC1="$";class xa extends fi{constructor(s,i,c){super(s),c?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=i}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class L extends fi{constructor(s,i,c){if(super(s),i<0||i>10||c<0||c>10)throw new R;this.firstDigit=i,this.secondDigit=c}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===L.FNC1}isSecondDigitFNC1(){return this.secondDigit===L.FNC1}isAnyFNC1(){return this.firstDigit===L.FNC1||this.secondDigit===L.FNC1}}L.FNC1=10;class P{constructor(){}static parseFieldsInGeneralPurpose(s){if(!s)return null;if(s.length<2)throw new J;let i=s.substring(0,2);for(let d of P.TWO_DIGIT_DATA_LENGTH)if(d[0]===i)return d[1]===P.VARIABLE_LENGTH?P.processVariableAI(2,d[2],s):P.processFixedAI(2,d[1],s);if(s.length<3)throw new J;let c=s.substring(0,3);for(let d of P.THREE_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===P.VARIABLE_LENGTH?P.processVariableAI(3,d[2],s):P.processFixedAI(3,d[1],s);for(let d of P.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(d[0]===c)return d[1]===P.VARIABLE_LENGTH?P.processVariableAI(4,d[2],s):P.processFixedAI(4,d[1],s);if(s.length<4)throw new J;let u=s.substring(0,4);for(let d of P.FOUR_DIGIT_DATA_LENGTH)if(d[0]===u)return d[1]===P.VARIABLE_LENGTH?P.processVariableAI(4,d[2],s):P.processFixedAI(4,d[1],s);throw new J}static processFixedAI(s,i,c){if(c.length<s)throw new J;let u=c.substring(0,s);if(c.length<s+i)throw new J;let d=c.substring(s,s+i),x=c.substring(s+i),v="("+u+")"+d,y=P.parseFieldsInGeneralPurpose(x);return y==null?v:v+y}static processVariableAI(s,i,c){let u=c.substring(0,s),d;c.length<s+i?d=c.length:d=s+i;let x=c.substring(s,d),v=c.substring(d),y="("+u+")"+x,b=P.parseFieldsInGeneralPurpose(v);return b==null?y:y+b}}P.VARIABLE_LENGTH=[],P.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",P.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",P.VARIABLE_LENGTH,20],["22",P.VARIABLE_LENGTH,29],["30",P.VARIABLE_LENGTH,8],["37",P.VARIABLE_LENGTH,8],["90",P.VARIABLE_LENGTH,30],["91",P.VARIABLE_LENGTH,30],["92",P.VARIABLE_LENGTH,30],["93",P.VARIABLE_LENGTH,30],["94",P.VARIABLE_LENGTH,30],["95",P.VARIABLE_LENGTH,30],["96",P.VARIABLE_LENGTH,30],["97",P.VARIABLE_LENGTH,3],["98",P.VARIABLE_LENGTH,30],["99",P.VARIABLE_LENGTH,30]],P.THREE_DIGIT_DATA_LENGTH=[["240",P.VARIABLE_LENGTH,30],["241",P.VARIABLE_LENGTH,30],["242",P.VARIABLE_LENGTH,6],["250",P.VARIABLE_LENGTH,30],["251",P.VARIABLE_LENGTH,30],["253",P.VARIABLE_LENGTH,17],["254",P.VARIABLE_LENGTH,20],["400",P.VARIABLE_LENGTH,30],["401",P.VARIABLE_LENGTH,30],["402",17],["403",P.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",P.VARIABLE_LENGTH,20],["421",P.VARIABLE_LENGTH,15],["422",3],["423",P.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],P.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",P.VARIABLE_LENGTH,15],["391",P.VARIABLE_LENGTH,18],["392",P.VARIABLE_LENGTH,15],["393",P.VARIABLE_LENGTH,18],["703",P.VARIABLE_LENGTH,30]],P.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",P.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",P.VARIABLE_LENGTH,20],["8003",P.VARIABLE_LENGTH,30],["8004",P.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",P.VARIABLE_LENGTH,30],["8008",P.VARIABLE_LENGTH,12],["8018",18],["8020",P.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",P.VARIABLE_LENGTH,70],["8200",P.VARIABLE_LENGTH,70]];class H{constructor(s){this.buffer=new ne,this.information=s}decodeAllCodes(s,i){let c=i,u=null;do{let d=this.decodeGeneralPurposeField(c,u),x=P.parseFieldsInGeneralPurpose(d.getNewString());if(x!=null&&s.append(x),d.isRemaining()?u=""+d.getRemainingValue():u=null,c===d.getNewPosition())break;c=d.getNewPosition()}while(!0);return s.toString()}isStillNumeric(s){if(s+7>this.information.getSize())return s+4<=this.information.getSize();for(let i=s;i<s+3;++i)if(this.information.get(i))return!0;return this.information.get(s+3)}decodeNumeric(s){if(s+7>this.information.getSize()){let d=this.extractNumericValueFromBitArray(s,4);return d===0?new L(this.information.getSize(),L.FNC1,L.FNC1):new L(this.information.getSize(),d-1,L.FNC1)}let i=this.extractNumericValueFromBitArray(s,7),c=(i-8)/11,u=(i-8)%11;return new L(s+7,c,u)}extractNumericValueFromBitArray(s,i){return H.extractNumericValueFromBitArray(this.information,s,i)}static extractNumericValueFromBitArray(s,i,c){let u=0;for(let d=0;d<c;++d)s.get(i+d)&&(u|=1<<c-d-1);return u}decodeGeneralPurposeField(s,i){this.buffer.setLengthToZero(),i!=null&&this.buffer.append(i),this.current.setPosition(s);let c=this.parseBlocks();return c!=null&&c.isRemaining()?new xa(this.current.getPosition(),this.buffer.toString(),c.getRemainingValue()):new xa(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let s,i;do{let c=this.current.getPosition();if(this.current.isAlpha()?(i=this.parseAlphaBlock(),s=i.isFinished()):this.current.isIsoIec646()?(i=this.parseIsoIec646Block(),s=i.isFinished()):(i=this.parseNumericBlock(),s=i.isFinished()),!(c!==this.current.getPosition())&&!s)break}while(!s);return i.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let s=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFirstDigitFNC1()){let i;return s.isSecondDigitFNC1()?i=new xa(this.current.getPosition(),this.buffer.toString()):i=new xa(this.current.getPosition(),this.buffer.toString(),s.getSecondDigit()),new Vn(!0,i)}if(this.buffer.append(s.getFirstDigit()),s.isSecondDigitFNC1()){let i=new xa(this.current.getPosition(),this.buffer.toString());return new Vn(!0,i)}this.buffer.append(s.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Vn(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let s=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let i=new xa(this.current.getPosition(),this.buffer.toString());return new Vn(!0,i)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Vn(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let s=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(s.getNewPosition()),s.isFNC1()){let i=new xa(this.current.getPosition(),this.buffer.toString());return new Vn(!0,i)}this.buffer.append(s.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Vn(!1)}isStillIsoIec646(s){if(s+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(s,5);if(i>=5&&i<16)return!0;if(s+7>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(s,7);if(c>=64&&c<116)return!0;if(s+8>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(s,8);return u>=232&&u<253}decodeIsoIec646(s){let i=this.extractNumericValueFromBitArray(s,5);if(i===15)return new Wr(s+5,Wr.FNC1);if(i>=5&&i<15)return new Wr(s+5,"0"+(i-5));let c=this.extractNumericValueFromBitArray(s,7);if(c>=64&&c<90)return new Wr(s+7,""+(c+1));if(c>=90&&c<116)return new Wr(s+7,""+(c+7));let u=this.extractNumericValueFromBitArray(s,8),d;switch(u){case 232:d="!";break;case 233:d='"';break;case 234:d="%";break;case 235:d="&";break;case 236:d="'";break;case 237:d="(";break;case 238:d=")";break;case 239:d="*";break;case 240:d="+";break;case 241:d=",";break;case 242:d="-";break;case 243:d=".";break;case 244:d="/";break;case 245:d=":";break;case 246:d=";";break;case 247:d="<";break;case 248:d="=";break;case 249:d=">";break;case 250:d="?";break;case 251:d="_";break;case 252:d=" ";break;default:throw new R}return new Wr(s+8,d)}isStillAlpha(s){if(s+5>this.information.getSize())return!1;let i=this.extractNumericValueFromBitArray(s,5);if(i>=5&&i<16)return!0;if(s+6>this.information.getSize())return!1;let c=this.extractNumericValueFromBitArray(s,6);return c>=16&&c<63}decodeAlphanumeric(s){let i=this.extractNumericValueFromBitArray(s,5);if(i===15)return new Wr(s+5,Wr.FNC1);if(i>=5&&i<15)return new Wr(s+5,"0"+(i-5));let c=this.extractNumericValueFromBitArray(s,6);if(c>=32&&c<58)return new Wr(s+6,""+(c+33));let u;switch(c){case 58:u="*";break;case 59:u=",";break;case 60:u="-";break;case 61:u=".";break;case 62:u="/";break;default:throw new _t("Decoding invalid alphanumeric value: "+c)}return new Wr(s+6,u)}isAlphaTo646ToAlphaLatch(s){if(s+1>this.information.getSize())return!1;for(let i=0;i<5&&i+s<this.information.getSize();++i)if(i===2){if(!this.information.get(s+2))return!1}else if(this.information.get(s+i))return!1;return!0}isAlphaOr646ToNumericLatch(s){if(s+3>this.information.getSize())return!1;for(let i=s;i<s+3;++i)if(this.information.get(i))return!1;return!0}isNumericToAlphaNumericLatch(s){if(s+1>this.information.getSize())return!1;for(let i=0;i<4&&i+s<this.information.getSize();++i)if(this.information.get(s+i))return!1;return!0}}class G{constructor(s){this.information=s,this.generalDecoder=new H(s)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Z extends G{constructor(s){super(s)}encodeCompressedGtin(s,i){s.append("(01)");let c=s.length();s.append("9"),this.encodeCompressedGtinWithoutAI(s,i,c)}encodeCompressedGtinWithoutAI(s,i,c){for(let u=0;u<4;++u){let d=this.getGeneralDecoder().extractNumericValueFromBitArray(i+10*u,10);d/100===0&&s.append("0"),d/10===0&&s.append("0"),s.append(d)}Z.appendCheckDigit(s,c)}static appendCheckDigit(s,i){let c=0;for(let u=0;u<13;u++){let d=s.charAt(u+i).charCodeAt(0)-48;c+=u&1?d:3*d}c=10-c%10,c===10&&(c=0),s.append(c)}}Z.GTIN_SIZE=40;class K extends Z{constructor(s){super(s)}parseInformation(){let s=new ne;s.append("(01)");let i=s.length(),c=this.getGeneralDecoder().extractNumericValueFromBitArray(K.HEADER_SIZE,4);return s.append(c),this.encodeCompressedGtinWithoutAI(s,K.HEADER_SIZE+4,i),this.getGeneralDecoder().decodeAllCodes(s,K.HEADER_SIZE+44)}}K.HEADER_SIZE=4;class xe extends G{constructor(s){super(s)}parseInformation(){let s=new ne;return this.getGeneralDecoder().decodeAllCodes(s,xe.HEADER_SIZE)}}xe.HEADER_SIZE=5;class Ee extends Z{constructor(s){super(s)}encodeCompressedWeight(s,i,c){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(i,c);this.addWeightCode(s,u);let d=this.checkWeight(u),x=1e5;for(let v=0;v<5;++v)d/x===0&&s.append("0"),x/=10;s.append(d)}}class le extends Ee{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()!=le.HEADER_SIZE+Ee.GTIN_SIZE+le.WEIGHT_SIZE)throw new J;let s=new ne;return this.encodeCompressedGtin(s,le.HEADER_SIZE),this.encodeCompressedWeight(s,le.HEADER_SIZE+Ee.GTIN_SIZE,le.WEIGHT_SIZE),s.toString()}}le.HEADER_SIZE=5,le.WEIGHT_SIZE=15;class ge extends le{constructor(s){super(s)}addWeightCode(s,i){s.append("(3103)")}checkWeight(s){return s}}class pe extends le{constructor(s){super(s)}addWeightCode(s,i){i<1e4?s.append("(3202)"):s.append("(3203)")}checkWeight(s){return s<1e4?s:s-1e4}}class ke extends Z{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<ke.HEADER_SIZE+Z.GTIN_SIZE)throw new J;let s=new ne;this.encodeCompressedGtin(s,ke.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(ke.HEADER_SIZE+Z.GTIN_SIZE,ke.LAST_DIGIT_SIZE);s.append("(392"),s.append(i),s.append(")");let c=this.getGeneralDecoder().decodeGeneralPurposeField(ke.HEADER_SIZE+Z.GTIN_SIZE+ke.LAST_DIGIT_SIZE,null);return s.append(c.getNewString()),s.toString()}}ke.HEADER_SIZE=8,ke.LAST_DIGIT_SIZE=2;class De extends Z{constructor(s){super(s)}parseInformation(){if(this.getInformation().getSize()<De.HEADER_SIZE+Z.GTIN_SIZE)throw new J;let s=new ne;this.encodeCompressedGtin(s,De.HEADER_SIZE);let i=this.getGeneralDecoder().extractNumericValueFromBitArray(De.HEADER_SIZE+Z.GTIN_SIZE,De.LAST_DIGIT_SIZE);s.append("(393"),s.append(i),s.append(")");let c=this.getGeneralDecoder().extractNumericValueFromBitArray(De.HEADER_SIZE+Z.GTIN_SIZE+De.LAST_DIGIT_SIZE,De.FIRST_THREE_DIGITS_SIZE);c/100==0&&s.append("0"),c/10==0&&s.append("0"),s.append(c);let u=this.getGeneralDecoder().decodeGeneralPurposeField(De.HEADER_SIZE+Z.GTIN_SIZE+De.LAST_DIGIT_SIZE+De.FIRST_THREE_DIGITS_SIZE,null);return s.append(u.getNewString()),s.toString()}}De.HEADER_SIZE=8,De.LAST_DIGIT_SIZE=2,De.FIRST_THREE_DIGITS_SIZE=10;class Re extends Ee{constructor(s,i,c){super(s),this.dateCode=c,this.firstAIdigits=i}parseInformation(){if(this.getInformation().getSize()!=Re.HEADER_SIZE+Re.GTIN_SIZE+Re.WEIGHT_SIZE+Re.DATE_SIZE)throw new J;let s=new ne;return this.encodeCompressedGtin(s,Re.HEADER_SIZE),this.encodeCompressedWeight(s,Re.HEADER_SIZE+Re.GTIN_SIZE,Re.WEIGHT_SIZE),this.encodeCompressedDate(s,Re.HEADER_SIZE+Re.GTIN_SIZE+Re.WEIGHT_SIZE),s.toString()}encodeCompressedDate(s,i){let c=this.getGeneralDecoder().extractNumericValueFromBitArray(i,Re.DATE_SIZE);if(c==38400)return;s.append("("),s.append(this.dateCode),s.append(")");let u=c%32;c/=32;let d=c%12+1;c/=12;let x=c;x/10==0&&s.append("0"),s.append(x),d/10==0&&s.append("0"),s.append(d),u/10==0&&s.append("0"),s.append(u)}addWeightCode(s,i){s.append("("),s.append(this.firstAIdigits),s.append(i/1e5),s.append(")")}checkWeight(s){return s%1e5}}Re.HEADER_SIZE=8,Re.WEIGHT_SIZE=20,Re.DATE_SIZE=16;function Le(D){try{if(D.get(1))return new K(D);if(!D.get(2))return new xe(D);switch(H.extractNumericValueFromBitArray(D,1,4)){case 4:return new ge(D);case 5:return new pe(D)}switch(H.extractNumericValueFromBitArray(D,1,5)){case 12:return new ke(D);case 13:return new De(D)}switch(H.extractNumericValueFromBitArray(D,1,7)){case 56:return new Re(D,"310","11");case 57:return new Re(D,"320","11");case 58:return new Re(D,"310","13");case 59:return new Re(D,"320","13");case 60:return new Re(D,"310","15");case 61:return new Re(D,"320","15");case 62:return new Re(D,"310","17");case 63:return new Re(D,"320","17")}}catch(s){throw console.log(s),new _t("unknown decoder: "+D)}}class ze{constructor(s,i,c,u){this.leftchar=s,this.rightchar=i,this.finderpattern=c,this.maybeLast=u}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(s,i){return s instanceof ze?ze.equalsOrNull(s.leftchar,i.leftchar)&&ze.equalsOrNull(s.rightchar,i.rightchar)&&ze.equalsOrNull(s.finderpattern,i.finderpattern):!1}static equalsOrNull(s,i){return s===null?i===null:ze.equals(s,i)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class st{constructor(s,i,c){this.pairs=s,this.rowNumber=i,this.wasReversed=c}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(s){return this.checkEqualitity(this,s)}toString(){return"{ "+this.pairs+" }"}equals(s,i){return s instanceof st?this.checkEqualitity(s,i)&&s.wasReversed===i.wasReversed:!1}checkEqualitity(s,i){if(!s||!i)return;let c;return s.forEach((u,d)=>{i.forEach(x=>{u.getLeftChar().getValue()===x.getLeftChar().getValue()&&u.getRightChar().getValue()===x.getRightChar().getValue()&&u.getFinderPatter().getValue()===x.getFinderPatter().getValue()&&(c=!0)})}),c}}class _e extends Ir{constructor(s){super(...arguments),this.pairs=new Array(_e.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=s===!0}decodeRow(s,i,c){this.pairs.length=0,this.startFromEven=!1;try{return _e.constructResult(this.decodeRow2pairs(s,i))}catch(u){this.verbose&&console.log(u)}return this.pairs.length=0,this.startFromEven=!0,_e.constructResult(this.decodeRow2pairs(s,i))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(s,i){let c=!1;for(;!c;)try{this.pairs.push(this.retrieveNextPair(i,this.pairs,s))}catch(d){if(d instanceof J){if(!this.pairs.length)throw new J;c=!0}}if(this.checkChecksum())return this.pairs;let u;if(this.rows.length?u=!0:u=!1,this.storeRow(s,!1),u){let d=this.checkRowsBoolean(!1);if(d!=null||(d=this.checkRowsBoolean(!0),d!=null))return d}throw new J}checkRowsBoolean(s){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,s&&(this.rows=this.rows.reverse());let i=null;try{i=this.checkRows(new Array,0)}catch(c){this.verbose&&console.log(c)}return s&&(this.rows=this.rows.reverse()),i}checkRows(s,i){for(let c=i;c<this.rows.length;c++){let u=this.rows[c];this.pairs.length=0;for(let x of s)this.pairs.push(x.getPairs());if(this.pairs.push(u.getPairs()),!_e.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let d=new Array(s);d.push(u);try{return this.checkRows(d,c+1)}catch(x){this.verbose&&console.log(x)}}throw new J}static isValidSequence(s){for(let i of _e.FINDER_PATTERN_SEQUENCES){if(s.length>i.length)continue;let c=!0;for(let u=0;u<s.length;u++)if(s[u].getFinderPattern().getValue()!=i[u]){c=!1;break}if(c)return!0}return!1}storeRow(s,i){let c=0,u=!1,d=!1;for(;c<this.rows.length;){let x=this.rows[c];if(x.getRowNumber()>s){d=x.isEquivalent(this.pairs);break}u=x.isEquivalent(this.pairs),c++}d||u||_e.isPartialRow(this.pairs,this.rows)||(this.rows.push(c,new st(this.pairs,s,i)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(s,i){for(let c of i)if(c.getPairs().length!==s.length){for(let u of c.getPairs())for(let d of s)if(ze.equals(u,d))break}}static isPartialRow(s,i){for(let c of i){let u=!0;for(let d of s){let x=!1;for(let v of c.getPairs())if(d.equals(v)){x=!0;break}if(!x){u=!1;break}}if(u)return!0}return!1}getRows(){return this.rows}static constructResult(s){let i=Ic.buildBitArray(s),u=Le(i).parseInformation(),d=s[0].getFinderPattern().getResultPoints(),x=s[s.length-1].getFinderPattern().getResultPoints(),v=[d[0],d[1],x[0],x[1]];return new te(u,null,null,v,ce.RSS_EXPANDED,null)}checkChecksum(){let s=this.pairs.get(0),i=s.getLeftChar(),c=s.getRightChar();if(c==null)return!1;let u=c.getChecksumPortion(),d=2;for(let v=1;v<this.pairs.size();++v){let y=this.pairs.get(v);u+=y.getLeftChar().getChecksumPortion(),d++;let b=y.getRightChar();b!=null&&(u+=b.getChecksumPortion(),d++)}return u%=211,211*(d-4)+u==i.getValue()}static getNextSecondBar(s,i){let c;return s.get(i)?(c=s.getNextUnset(i),c=s.getNextSet(c)):(c=s.getNextSet(i),c=s.getNextUnset(c)),c}retrieveNextPair(s,i,c){let u=i.length%2==0;this.startFromEven&&(u=!u);let d,x=!0,v=-1;do this.findNextPair(s,i,v),d=this.parseFoundFinderPattern(s,c,u),d==null?v=_e.getNextSecondBar(s,this.startEnd[0]):x=!1;while(x);let y=this.decodeDataCharacter(s,d,u,!0);if(!this.isEmptyPair(i)&&i[i.length-1].mustBeLast())throw new J;let b;try{b=this.decodeDataCharacter(s,d,u,!1)}catch(I){b=null,this.verbose&&console.log(I)}return new ze(y,b,d,!0)}isEmptyPair(s){return s.length===0}findNextPair(s,i,c){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let d=s.getSize(),x;c>=0?x=c:this.isEmptyPair(i)?x=0:x=i[i.length-1].getFinderPattern().getStartEnd()[1];let v=i.length%2!=0;this.startFromEven&&(v=!v);let y=!1;for(;x<d&&(y=!s.get(x),!!y);)x++;let b=0,I=x;for(let O=x;O<d;O++)if(s.get(O)!=y)u[b]++;else{if(b==3){if(v&&_e.reverseCounters(u),_e.isFinderPattern(u)){this.startEnd[0]=I,this.startEnd[1]=O;return}v&&_e.reverseCounters(u),I+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,b--}else b++;u[b]=1,y=!y}throw new J}static reverseCounters(s){let i=s.length;for(let c=0;c<i/2;++c){let u=s[c];s[c]=s[i-c-1],s[i-c-1]=u}}parseFoundFinderPattern(s,i,c){let u,d,x;if(c){let b=this.startEnd[0]-1;for(;b>=0&&!s.get(b);)b--;b++,u=this.startEnd[0]-b,d=b,x=this.startEnd[1]}else d=this.startEnd[0],x=s.getNextUnset(this.startEnd[1]+1),u=x-this.startEnd[1];let v=this.getDecodeFinderCounters();_.arraycopy(v,0,v,1,v.length-1),v[0]=u;let y;try{y=this.parseFinderValue(v,_e.FINDER_PATTERNS)}catch{return null}return new Ds(y,[d,x],d,x,i)}decodeDataCharacter(s,i,c,u){let d=this.getDataCharacterCounters();for(let Bt=0;Bt<d.length;Bt++)d[Bt]=0;if(u)_e.recordPatternInReverse(s,i.getStartEnd()[0],d);else{_e.recordPattern(s,i.getStartEnd()[1],d);for(let Bt=0,Pr=d.length-1;Bt<Pr;Bt++,Pr--){let pn=d[Bt];d[Bt]=d[Pr],d[Pr]=pn}}let x=17,v=it.sum(new Int32Array(d))/x,y=(i.getStartEnd()[1]-i.getStartEnd()[0])/15;if(Math.abs(v-y)/y>.3)throw new J;let b=this.getOddCounts(),I=this.getEvenCounts(),O=this.getOddRoundingErrors(),j=this.getEvenRoundingErrors();for(let Bt=0;Bt<d.length;Bt++){let Pr=1*d[Bt]/v,pn=Pr+.5;if(pn<1){if(Pr<.3)throw new J;pn=1}else if(pn>8){if(Pr>8.7)throw new J;pn=8}let Ls=Bt/2;Bt&1?(I[Ls]=pn,j[Ls]=Pr-pn):(b[Ls]=pn,O[Ls]=Pr-pn)}this.adjustOddEvenCounts(x);let q=4*i.getValue()+(c?0:2)+(u?0:1)-1,re=0,ae=0;for(let Bt=b.length-1;Bt>=0;Bt--){if(_e.isNotA1left(i,c,u)){let Pr=_e.WEIGHTS[q][2*Bt];ae+=b[Bt]*Pr}re+=b[Bt]}let ue=0;for(let Bt=I.length-1;Bt>=0;Bt--)if(_e.isNotA1left(i,c,u)){let Pr=_e.WEIGHTS[q][2*Bt+1];ue+=I[Bt]*Pr}let we=ae+ue;if(re&1||re>13||re<4)throw new J;let Me=(13-re)/2,je=_e.SYMBOL_WIDEST[Me],Fe=9-je,At=Tn.getRSSvalue(b,je,!0),lt=Tn.getRSSvalue(I,Fe,!1),on=_e.EVEN_TOTAL_SUBSET[Me],Gn=_e.GSUM[Me],cn=At*on+lt+Gn;return new Ia(cn,we)}static isNotA1left(s,i,c){return!(s.getValue()==0&&i&&c)}adjustOddEvenCounts(s){let i=it.sum(new Int32Array(this.getOddCounts())),c=it.sum(new Int32Array(this.getEvenCounts())),u=!1,d=!1;i>13?d=!0:i<4&&(u=!0);let x=!1,v=!1;c>13?v=!0:c<4&&(x=!0);let y=i+c-s,b=(i&1)==1,I=(c&1)==0;if(y==1)if(b){if(I)throw new J;d=!0}else{if(!I)throw new J;v=!0}else if(y==-1)if(b){if(I)throw new J;u=!0}else{if(!I)throw new J;x=!0}else if(y==0){if(b){if(!I)throw new J;i<c?(u=!0,v=!0):(d=!0,x=!0)}else if(I)throw new J}else throw new J;if(u){if(d)throw new J;_e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(d&&_e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),x){if(v)throw new J;_e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}v&&_e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}_e.SYMBOL_WIDEST=[7,5,4,3,1],_e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],_e.GSUM=[0,348,1388,2948,3988],_e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],_e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],_e.FINDER_PAT_A=0,_e.FINDER_PAT_B=1,_e.FINDER_PAT_C=2,_e.FINDER_PAT_D=3,_e.FINDER_PAT_E=4,_e.FINDER_PAT_F=5,_e.FINDER_PATTERN_SEQUENCES=[[_e.FINDER_PAT_A,_e.FINDER_PAT_A],[_e.FINDER_PAT_A,_e.FINDER_PAT_B,_e.FINDER_PAT_B],[_e.FINDER_PAT_A,_e.FINDER_PAT_C,_e.FINDER_PAT_B,_e.FINDER_PAT_D],[_e.FINDER_PAT_A,_e.FINDER_PAT_E,_e.FINDER_PAT_B,_e.FINDER_PAT_D,_e.FINDER_PAT_C],[_e.FINDER_PAT_A,_e.FINDER_PAT_E,_e.FINDER_PAT_B,_e.FINDER_PAT_D,_e.FINDER_PAT_D,_e.FINDER_PAT_F],[_e.FINDER_PAT_A,_e.FINDER_PAT_E,_e.FINDER_PAT_B,_e.FINDER_PAT_D,_e.FINDER_PAT_E,_e.FINDER_PAT_F,_e.FINDER_PAT_F],[_e.FINDER_PAT_A,_e.FINDER_PAT_A,_e.FINDER_PAT_B,_e.FINDER_PAT_B,_e.FINDER_PAT_C,_e.FINDER_PAT_C,_e.FINDER_PAT_D,_e.FINDER_PAT_D],[_e.FINDER_PAT_A,_e.FINDER_PAT_A,_e.FINDER_PAT_B,_e.FINDER_PAT_B,_e.FINDER_PAT_C,_e.FINDER_PAT_C,_e.FINDER_PAT_D,_e.FINDER_PAT_E,_e.FINDER_PAT_E],[_e.FINDER_PAT_A,_e.FINDER_PAT_A,_e.FINDER_PAT_B,_e.FINDER_PAT_B,_e.FINDER_PAT_C,_e.FINDER_PAT_C,_e.FINDER_PAT_D,_e.FINDER_PAT_E,_e.FINDER_PAT_F,_e.FINDER_PAT_F],[_e.FINDER_PAT_A,_e.FINDER_PAT_A,_e.FINDER_PAT_B,_e.FINDER_PAT_B,_e.FINDER_PAT_C,_e.FINDER_PAT_D,_e.FINDER_PAT_D,_e.FINDER_PAT_E,_e.FINDER_PAT_E,_e.FINDER_PAT_F,_e.FINDER_PAT_F]],_e.MAX_PAIRS=11;class Vt extends Ia{constructor(s,i,c){super(s,i),this.count=0,this.finderPattern=c}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class gt extends Ir{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(s,i,c){const u=this.decodePair(i,!1,s,c);gt.addOrTally(this.possibleLeftPairs,u),i.reverse();let d=this.decodePair(i,!0,s,c);gt.addOrTally(this.possibleRightPairs,d),i.reverse();for(let x of this.possibleLeftPairs)if(x.getCount()>1){for(let v of this.possibleRightPairs)if(v.getCount()>1&&gt.checkChecksum(x,v))return gt.constructResult(x,v)}throw new J}static addOrTally(s,i){if(i==null)return;let c=!1;for(let u of s)if(u.getValue()===i.getValue()){u.incrementCount(),c=!0;break}c||s.push(i)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(s,i){let c=4537077*s.getValue()+i.getValue(),u=new String(c).toString(),d=new ne;for(let b=13-u.length;b>0;b--)d.append("0");d.append(u);let x=0;for(let b=0;b<13;b++){let I=d.charAt(b).charCodeAt(0)-48;x+=b&1?I:3*I}x=10-x%10,x===10&&(x=0),d.append(x.toString());let v=s.getFinderPattern().getResultPoints(),y=i.getFinderPattern().getResultPoints();return new te(d.toString(),null,0,[v[0],v[1],y[0],y[1]],ce.RSS_14,new Date().getTime())}static checkChecksum(s,i){let c=(s.getChecksumPortion()+16*i.getChecksumPortion())%79,u=9*s.getFinderPattern().getValue()+i.getFinderPattern().getValue();return u>72&&u--,u>8&&u--,c===u}decodePair(s,i,c,u){try{let d=this.findFinderPattern(s,i),x=this.parseFoundFinderPattern(s,c,i,d),v=u==null?null:u.get(B.NEED_RESULT_POINT_CALLBACK);if(v!=null){let I=(d[0]+d[1])/2;i&&(I=s.getSize()-1-I),v.foundPossibleResultPoint(new He(I,c))}let y=this.decodeDataCharacter(s,x,!0),b=this.decodeDataCharacter(s,x,!1);return new Vt(1597*y.getValue()+b.getValue(),y.getChecksumPortion()+4*b.getChecksumPortion(),x)}catch{return null}}decodeDataCharacter(s,i,c){let u=this.getDataCharacterCounters();for(let ue=0;ue<u.length;ue++)u[ue]=0;if(c)xt.recordPatternInReverse(s,i.getStartEnd()[0],u);else{xt.recordPattern(s,i.getStartEnd()[1]+1,u);for(let ue=0,we=u.length-1;ue<we;ue++,we--){let Me=u[ue];u[ue]=u[we],u[we]=Me}}let d=c?16:15,x=it.sum(new Int32Array(u))/d,v=this.getOddCounts(),y=this.getEvenCounts(),b=this.getOddRoundingErrors(),I=this.getEvenRoundingErrors();for(let ue=0;ue<u.length;ue++){let we=u[ue]/x,Me=Math.floor(we+.5);Me<1?Me=1:Me>8&&(Me=8);let je=Math.floor(ue/2);ue&1?(y[je]=Me,I[je]=we-Me):(v[je]=Me,b[je]=we-Me)}this.adjustOddEvenCounts(c,d);let O=0,j=0;for(let ue=v.length-1;ue>=0;ue--)j*=9,j+=v[ue],O+=v[ue];let q=0,re=0;for(let ue=y.length-1;ue>=0;ue--)q*=9,q+=y[ue],re+=y[ue];let ae=j+3*q;if(c){if(O&1||O>12||O<4)throw new J;let ue=(12-O)/2,we=gt.OUTSIDE_ODD_WIDEST[ue],Me=9-we,je=Tn.getRSSvalue(v,we,!1),Fe=Tn.getRSSvalue(y,Me,!0),At=gt.OUTSIDE_EVEN_TOTAL_SUBSET[ue],lt=gt.OUTSIDE_GSUM[ue];return new Ia(je*At+Fe+lt,ae)}else{if(re&1||re>10||re<4)throw new J;let ue=(10-re)/2,we=gt.INSIDE_ODD_WIDEST[ue],Me=9-we,je=Tn.getRSSvalue(v,we,!0),Fe=Tn.getRSSvalue(y,Me,!1),At=gt.INSIDE_ODD_TOTAL_SUBSET[ue],lt=gt.INSIDE_GSUM[ue];return new Ia(Fe*At+je+lt,ae)}}findFinderPattern(s,i){let c=this.getDecodeFinderCounters();c[0]=0,c[1]=0,c[2]=0,c[3]=0;let u=s.getSize(),d=!1,x=0;for(;x<u&&(d=!s.get(x),i!==d);)x++;let v=0,y=x;for(let b=x;b<u;b++)if(s.get(b)!==d)c[v]++;else{if(v===3){if(Ir.isFinderPattern(c))return[y,b];y+=c[0]+c[1],c[0]=c[2],c[1]=c[3],c[2]=0,c[3]=0,v--}else v++;c[v]=1,d=!d}throw new J}parseFoundFinderPattern(s,i,c,u){let d=s.get(u[0]),x=u[0]-1;for(;x>=0&&d!==s.get(x);)x--;x++;const v=u[0]-x,y=this.getDecodeFinderCounters(),b=new Int32Array(y.length);_.arraycopy(y,0,b,1,y.length-1),b[0]=v;const I=this.parseFinderValue(b,gt.FINDER_PATTERNS);let O=x,j=u[1];return c&&(O=s.getSize()-1-O,j=s.getSize()-1-j),new Ds(I,[x,u[1]],O,j,i)}adjustOddEvenCounts(s,i){let c=it.sum(new Int32Array(this.getOddCounts())),u=it.sum(new Int32Array(this.getEvenCounts())),d=!1,x=!1,v=!1,y=!1;s?(c>12?x=!0:c<4&&(d=!0),u>12?y=!0:u<4&&(v=!0)):(c>11?x=!0:c<5&&(d=!0),u>10?y=!0:u<4&&(v=!0));let b=c+u-i,I=(c&1)===(s?1:0),O=(u&1)===1;if(b===1)if(I){if(O)throw new J;x=!0}else{if(!O)throw new J;y=!0}else if(b===-1)if(I){if(O)throw new J;d=!0}else{if(!O)throw new J;v=!0}else if(b===0){if(I){if(!O)throw new J;c<u?(d=!0,y=!0):(x=!0,v=!0)}else if(O)throw new J}else throw new J;if(d){if(x)throw new J;Ir.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(x&&Ir.decrement(this.getOddCounts(),this.getOddRoundingErrors()),v){if(y)throw new J;Ir.increment(this.getEvenCounts(),this.getOddRoundingErrors())}y&&Ir.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}gt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],gt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],gt.OUTSIDE_GSUM=[0,161,961,2015,2715],gt.INSIDE_GSUM=[0,336,1036,1516],gt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],gt.INSIDE_ODD_WIDEST=[2,4,6,8],gt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Nn extends xt{constructor(s,i){super(),this.readers=[],this.verbose=i===!0;const c=s?s.get(B.POSSIBLE_FORMATS):null,u=s&&s.get(B.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;c?((c.includes(ce.EAN_13)||c.includes(ce.UPC_A)||c.includes(ce.EAN_8)||c.includes(ce.UPC_E))&&this.readers.push(new ui(s)),c.includes(ce.CODE_39)&&this.readers.push(new sr(u)),c.includes(ce.CODE_128)&&this.readers.push(new Pe),c.includes(ce.ITF)&&this.readers.push(new Ft),c.includes(ce.RSS_14)&&this.readers.push(new gt),c.includes(ce.RSS_EXPANDED)&&this.readers.push(new _e(this.verbose))):(this.readers.push(new ui(s)),this.readers.push(new sr),this.readers.push(new ui(s)),this.readers.push(new Pe),this.readers.push(new Ft),this.readers.push(new gt),this.readers.push(new _e(this.verbose)))}decodeRow(s,i,c){for(let u=0;u<this.readers.length;u++)try{return this.readers[u].decodeRow(s,i,c)}catch{}throw new J}reset(){this.readers.forEach(s=>s.reset())}}class as extends oe{constructor(s=500,i){super(new Nn(i),s,i)}}class Et{constructor(s,i,c){this.ecCodewords=s,this.ecBlocks=[i],c&&this.ecBlocks.push(c)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class pt{constructor(s,i){this.count=s,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class vt{constructor(s,i,c,u,d,x){this.versionNumber=s,this.symbolSizeRows=i,this.symbolSizeColumns=c,this.dataRegionSizeRows=u,this.dataRegionSizeColumns=d,this.ecBlocks=x;let v=0;const y=x.getECCodewords(),b=x.getECBlocks();for(let I of b)v+=I.getCount()*(I.getDataCodewords()+y);this.totalCodewords=v}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(s,i){if(s&1||i&1)throw new R;for(let c of vt.VERSIONS)if(c.symbolSizeRows===s&&c.symbolSizeColumns===i)return c;throw new R}toString(){return""+this.versionNumber}static buildVersions(){return[new vt(1,10,10,8,8,new Et(5,new pt(1,3))),new vt(2,12,12,10,10,new Et(7,new pt(1,5))),new vt(3,14,14,12,12,new Et(10,new pt(1,8))),new vt(4,16,16,14,14,new Et(12,new pt(1,12))),new vt(5,18,18,16,16,new Et(14,new pt(1,18))),new vt(6,20,20,18,18,new Et(18,new pt(1,22))),new vt(7,22,22,20,20,new Et(20,new pt(1,30))),new vt(8,24,24,22,22,new Et(24,new pt(1,36))),new vt(9,26,26,24,24,new Et(28,new pt(1,44))),new vt(10,32,32,14,14,new Et(36,new pt(1,62))),new vt(11,36,36,16,16,new Et(42,new pt(1,86))),new vt(12,40,40,18,18,new Et(48,new pt(1,114))),new vt(13,44,44,20,20,new Et(56,new pt(1,144))),new vt(14,48,48,22,22,new Et(68,new pt(1,174))),new vt(15,52,52,24,24,new Et(42,new pt(2,102))),new vt(16,64,64,14,14,new Et(56,new pt(2,140))),new vt(17,72,72,16,16,new Et(36,new pt(4,92))),new vt(18,80,80,18,18,new Et(48,new pt(4,114))),new vt(19,88,88,20,20,new Et(56,new pt(4,144))),new vt(20,96,96,22,22,new Et(68,new pt(4,174))),new vt(21,104,104,24,24,new Et(56,new pt(6,136))),new vt(22,120,120,18,18,new Et(68,new pt(6,175))),new vt(23,132,132,20,20,new Et(62,new pt(8,163))),new vt(24,144,144,22,22,new Et(62,new pt(8,156),new pt(2,155))),new vt(25,8,18,6,16,new Et(7,new pt(1,5))),new vt(26,8,32,6,14,new Et(11,new pt(1,10))),new vt(27,12,26,10,24,new Et(14,new pt(1,16))),new vt(28,12,36,10,16,new Et(18,new pt(1,22))),new vt(29,16,36,14,16,new Et(24,new pt(1,32))),new vt(30,16,48,14,22,new Et(28,new pt(1,49)))]}}vt.VERSIONS=vt.buildVersions();class gn{constructor(s){const i=s.getHeight();if(i<8||i>144||i&1)throw new R;this.version=gn.readVersion(s),this.mappingBitMatrix=this.extractDataRegion(s),this.readMappingMatrix=new me(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(s){const i=s.getHeight(),c=s.getWidth();return vt.getVersionForDimensions(i,c)}readCodewords(){const s=new Int8Array(this.version.getTotalCodewords());let i=0,c=4,u=0;const d=this.mappingBitMatrix.getHeight(),x=this.mappingBitMatrix.getWidth();let v=!1,y=!1,b=!1,I=!1;do if(c===d&&u===0&&!v)s[i++]=this.readCorner1(d,x)&255,c-=2,u+=2,v=!0;else if(c===d-2&&u===0&&x&3&&!y)s[i++]=this.readCorner2(d,x)&255,c-=2,u+=2,y=!0;else if(c===d+4&&u===2&&!(x&7)&&!b)s[i++]=this.readCorner3(d,x)&255,c-=2,u+=2,b=!0;else if(c===d-2&&u===0&&(x&7)===4&&!I)s[i++]=this.readCorner4(d,x)&255,c-=2,u+=2,I=!0;else{do c<d&&u>=0&&!this.readMappingMatrix.get(u,c)&&(s[i++]=this.readUtah(c,u,d,x)&255),c-=2,u+=2;while(c>=0&&u<x);c+=1,u+=3;do c>=0&&u<x&&!this.readMappingMatrix.get(u,c)&&(s[i++]=this.readUtah(c,u,d,x)&255),c+=2,u-=2;while(c<d&&u>=0);c+=3,u+=1}while(c<d||u<x);if(i!==this.version.getTotalCodewords())throw new R;return s}readModule(s,i,c,u){return s<0&&(s+=c,i+=4-(c+4&7)),i<0&&(i+=u,s+=4-(u+4&7)),this.readMappingMatrix.set(i,s),this.mappingBitMatrix.get(i,s)}readUtah(s,i,c,u){let d=0;return this.readModule(s-2,i-2,c,u)&&(d|=1),d<<=1,this.readModule(s-2,i-1,c,u)&&(d|=1),d<<=1,this.readModule(s-1,i-2,c,u)&&(d|=1),d<<=1,this.readModule(s-1,i-1,c,u)&&(d|=1),d<<=1,this.readModule(s-1,i,c,u)&&(d|=1),d<<=1,this.readModule(s,i-2,c,u)&&(d|=1),d<<=1,this.readModule(s,i-1,c,u)&&(d|=1),d<<=1,this.readModule(s,i,c,u)&&(d|=1),d}readCorner1(s,i){let c=0;return this.readModule(s-1,0,s,i)&&(c|=1),c<<=1,this.readModule(s-1,1,s,i)&&(c|=1),c<<=1,this.readModule(s-1,2,s,i)&&(c|=1),c<<=1,this.readModule(0,i-2,s,i)&&(c|=1),c<<=1,this.readModule(0,i-1,s,i)&&(c|=1),c<<=1,this.readModule(1,i-1,s,i)&&(c|=1),c<<=1,this.readModule(2,i-1,s,i)&&(c|=1),c<<=1,this.readModule(3,i-1,s,i)&&(c|=1),c}readCorner2(s,i){let c=0;return this.readModule(s-3,0,s,i)&&(c|=1),c<<=1,this.readModule(s-2,0,s,i)&&(c|=1),c<<=1,this.readModule(s-1,0,s,i)&&(c|=1),c<<=1,this.readModule(0,i-4,s,i)&&(c|=1),c<<=1,this.readModule(0,i-3,s,i)&&(c|=1),c<<=1,this.readModule(0,i-2,s,i)&&(c|=1),c<<=1,this.readModule(0,i-1,s,i)&&(c|=1),c<<=1,this.readModule(1,i-1,s,i)&&(c|=1),c}readCorner3(s,i){let c=0;return this.readModule(s-1,0,s,i)&&(c|=1),c<<=1,this.readModule(s-1,i-1,s,i)&&(c|=1),c<<=1,this.readModule(0,i-3,s,i)&&(c|=1),c<<=1,this.readModule(0,i-2,s,i)&&(c|=1),c<<=1,this.readModule(0,i-1,s,i)&&(c|=1),c<<=1,this.readModule(1,i-3,s,i)&&(c|=1),c<<=1,this.readModule(1,i-2,s,i)&&(c|=1),c<<=1,this.readModule(1,i-1,s,i)&&(c|=1),c}readCorner4(s,i){let c=0;return this.readModule(s-3,0,s,i)&&(c|=1),c<<=1,this.readModule(s-2,0,s,i)&&(c|=1),c<<=1,this.readModule(s-1,0,s,i)&&(c|=1),c<<=1,this.readModule(0,i-2,s,i)&&(c|=1),c<<=1,this.readModule(0,i-1,s,i)&&(c|=1),c<<=1,this.readModule(1,i-1,s,i)&&(c|=1),c<<=1,this.readModule(2,i-1,s,i)&&(c|=1),c<<=1,this.readModule(3,i-1,s,i)&&(c|=1),c}extractDataRegion(s){const i=this.version.getSymbolSizeRows(),c=this.version.getSymbolSizeColumns();if(s.getHeight()!==i)throw new w("Dimension of bitMatrix must match the version size");const u=this.version.getDataRegionSizeRows(),d=this.version.getDataRegionSizeColumns(),x=i/u|0,v=c/d|0,y=x*u,b=v*d,I=new me(b,y);for(let O=0;O<x;++O){const j=O*u;for(let q=0;q<v;++q){const re=q*d;for(let ae=0;ae<u;++ae){const ue=O*(u+2)+1+ae,we=j+ae;for(let Me=0;Me<d;++Me){const je=q*(d+2)+1+Me;if(s.get(je,ue)){const Fe=re+Me;I.set(Fe,we)}}}}}return I}}class kc{constructor(s,i){this.numDataCodewords=s,this.codewords=i}static getDataBlocks(s,i){const c=i.getECBlocks();let u=0;const d=c.getECBlocks();for(let ae of d)u+=ae.getCount();const x=new Array(u);let v=0;for(let ae of d)for(let ue=0;ue<ae.getCount();ue++){const we=ae.getDataCodewords(),Me=c.getECCodewords()+we;x[v++]=new kc(we,new Uint8Array(Me))}const b=x[0].codewords.length-c.getECCodewords(),I=b-1;let O=0;for(let ae=0;ae<I;ae++)for(let ue=0;ue<v;ue++)x[ue].codewords[ae]=s[O++];const j=i.getVersionNumber()===24,q=j?8:v;for(let ae=0;ae<q;ae++)x[ae].codewords[b-1]=s[O++];const re=x[0].codewords.length;for(let ae=b;ae<re;ae++)for(let ue=0;ue<v;ue++){const we=j?(ue+8)%v:ue,Me=j&&we>7?ae-1:ae;x[we].codewords[Me]=s[O++]}if(O!==s.length)throw new w;return x}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Fc{constructor(s){this.bytes=s,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(s){if(s<1||s>32||s>this.available())throw new w(""+s);let i=0,c=this.bitOffset,u=this.byteOffset;const d=this.bytes;if(c>0){const x=8-c,v=s<x?s:x,y=x-v,b=255>>8-v<<y;i=(d[u]&b)>>y,s-=v,c+=v,c===8&&(c=0,u++)}if(s>0){for(;s>=8;)i=i<<8|d[u]&255,u++,s-=8;if(s>0){const x=8-s,v=255>>x<<x;i=i<<s|(d[u]&v)>>x,c+=s}}return this.bitOffset=c,this.byteOffset=u,i}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Er;(function(D){D[D.PAD_ENCODE=0]="PAD_ENCODE",D[D.ASCII_ENCODE=1]="ASCII_ENCODE",D[D.C40_ENCODE=2]="C40_ENCODE",D[D.TEXT_ENCODE=3]="TEXT_ENCODE",D[D.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",D[D.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",D[D.BASE256_ENCODE=6]="BASE256_ENCODE"})(Er||(Er={}));class ka{static decode(s){const i=new Fc(s),c=new ne,u=new ne,d=new Array;let x=Er.ASCII_ENCODE;do if(x===Er.ASCII_ENCODE)x=this.decodeAsciiSegment(i,c,u);else{switch(x){case Er.C40_ENCODE:this.decodeC40Segment(i,c);break;case Er.TEXT_ENCODE:this.decodeTextSegment(i,c);break;case Er.ANSIX12_ENCODE:this.decodeAnsiX12Segment(i,c);break;case Er.EDIFACT_ENCODE:this.decodeEdifactSegment(i,c);break;case Er.BASE256_ENCODE:this.decodeBase256Segment(i,c,d);break;default:throw new R}x=Er.ASCII_ENCODE}while(x!==Er.PAD_ENCODE&&i.available()>0);return u.length()>0&&c.append(u.toString()),new Se(s,c.toString(),d.length===0?null:d,null)}static decodeAsciiSegment(s,i,c){let u=!1;do{let d=s.readBits(8);if(d===0)throw new R;if(d<=128)return u&&(d+=128),i.append(String.fromCharCode(d-1)),Er.ASCII_ENCODE;if(d===129)return Er.PAD_ENCODE;if(d<=229){const x=d-130;x<10&&i.append("0"),i.append(""+x)}else switch(d){case 230:return Er.C40_ENCODE;case 231:return Er.BASE256_ENCODE;case 232:i.append("");break;case 233:case 234:break;case 235:u=!0;break;case 236:i.append("[)>05"),c.insert(0,"");break;case 237:i.append("[)>06"),c.insert(0,"");break;case 238:return Er.ANSIX12_ENCODE;case 239:return Er.TEXT_ENCODE;case 240:return Er.EDIFACT_ENCODE;case 241:break;default:if(d!==254||s.available()!==0)throw new R;break}}while(s.available()>0);return Er.ASCII_ENCODE}static decodeC40Segment(s,i){let c=!1;const u=[];let d=0;do{if(s.available()===8)return;const x=s.readBits(8);if(x===254)return;this.parseTwoBytes(x,s.readBits(8),u);for(let v=0;v<3;v++){const y=u[v];switch(d){case 0:if(y<3)d=y+1;else if(y<this.C40_BASIC_SET_CHARS.length){const b=this.C40_BASIC_SET_CHARS[y];c?(i.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):i.append(b)}else throw new R;break;case 1:c?(i.append(String.fromCharCode(y+128)),c=!1):i.append(String.fromCharCode(y)),d=0;break;case 2:if(y<this.C40_SHIFT2_SET_CHARS.length){const b=this.C40_SHIFT2_SET_CHARS[y];c?(i.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):i.append(b)}else switch(y){case 27:i.append("");break;case 30:c=!0;break;default:throw new R}d=0;break;case 3:c?(i.append(String.fromCharCode(y+224)),c=!1):i.append(String.fromCharCode(y+96)),d=0;break;default:throw new R}}}while(s.available()>0)}static decodeTextSegment(s,i){let c=!1,u=[],d=0;do{if(s.available()===8)return;const x=s.readBits(8);if(x===254)return;this.parseTwoBytes(x,s.readBits(8),u);for(let v=0;v<3;v++){const y=u[v];switch(d){case 0:if(y<3)d=y+1;else if(y<this.TEXT_BASIC_SET_CHARS.length){const b=this.TEXT_BASIC_SET_CHARS[y];c?(i.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):i.append(b)}else throw new R;break;case 1:c?(i.append(String.fromCharCode(y+128)),c=!1):i.append(String.fromCharCode(y)),d=0;break;case 2:if(y<this.TEXT_SHIFT2_SET_CHARS.length){const b=this.TEXT_SHIFT2_SET_CHARS[y];c?(i.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):i.append(b)}else switch(y){case 27:i.append("");break;case 30:c=!0;break;default:throw new R}d=0;break;case 3:if(y<this.TEXT_SHIFT3_SET_CHARS.length){const b=this.TEXT_SHIFT3_SET_CHARS[y];c?(i.append(String.fromCharCode(b.charCodeAt(0)+128)),c=!1):i.append(b),d=0}else throw new R;break;default:throw new R}}}while(s.available()>0)}static decodeAnsiX12Segment(s,i){const c=[];do{if(s.available()===8)return;const u=s.readBits(8);if(u===254)return;this.parseTwoBytes(u,s.readBits(8),c);for(let d=0;d<3;d++){const x=c[d];switch(x){case 0:i.append("\r");break;case 1:i.append("*");break;case 2:i.append(">");break;case 3:i.append(" ");break;default:if(x<14)i.append(String.fromCharCode(x+44));else if(x<40)i.append(String.fromCharCode(x+51));else throw new R;break}}}while(s.available()>0)}static parseTwoBytes(s,i,c){let u=(s<<8)+i-1,d=Math.floor(u/1600);c[0]=d,u-=d*1600,d=Math.floor(u/40),c[1]=d,c[2]=u-d*40}static decodeEdifactSegment(s,i){do{if(s.available()<=16)return;for(let c=0;c<4;c++){let u=s.readBits(6);if(u===31){const d=8-s.getBitOffset();d!==8&&s.readBits(d);return}u&32||(u|=64),i.append(String.fromCharCode(u))}}while(s.available()>0)}static decodeBase256Segment(s,i,c){let u=1+s.getByteOffset();const d=this.unrandomize255State(s.readBits(8),u++);let x;if(d===0?x=s.available()/8|0:d<250?x=d:x=250*(d-249)+this.unrandomize255State(s.readBits(8),u++),x<0)throw new R;const v=new Uint8Array(x);for(let y=0;y<x;y++){if(s.available()<8)throw new R;v[y]=this.unrandomize255State(s.readBits(8),u++)}c.push(v);try{i.append(M.decode(v,V.ISO88591))}catch(y){throw new _t("Platform does not support required encoding: "+y.message)}}static unrandomize255State(s,i){const c=149*i%255+1,u=s-c;return u>=0?u:u+256}}ka.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],ka.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],ka.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ka.TEXT_SHIFT2_SET_CHARS=ka.C40_SHIFT2_SET_CHARS,ka.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Mx{constructor(){this.rsDecoder=new ot(Ge.DATA_MATRIX_FIELD_256)}decode(s){const i=new gn(s),c=i.getVersion(),u=i.readCodewords(),d=kc.getDataBlocks(u,c);let x=0;for(let b of d)x+=b.getNumDataCodewords();const v=new Uint8Array(x),y=d.length;for(let b=0;b<y;b++){const I=d[b],O=I.getCodewords(),j=I.getNumDataCodewords();this.correctErrors(O,j);for(let q=0;q<j;q++)v[q*y+b]=O[q]}return ka.decode(v)}correctErrors(s,i){const c=new Int32Array(s);try{this.rsDecoder.decode(c,s.length-i)}catch{throw new A}for(let u=0;u<i;u++)s[u]=c[u]}}class fr{constructor(s){this.image=s,this.rectangleDetector=new Jt(this.image)}detect(){const s=this.rectangleDetector.detect();let i=this.detectSolid1(s);if(i=this.detectSolid2(i),i[3]=this.correctTopRight(i),!i[3])throw new J;i=this.shiftToModuleCenter(i);const c=i[0],u=i[1],d=i[2],x=i[3];let v=this.transitionsBetween(c,x)+1,y=this.transitionsBetween(d,x)+1;(v&1)===1&&(v+=1),(y&1)===1&&(y+=1),4*v<7*y&&4*y<7*v&&(v=y=Math.max(v,y));let b=fr.sampleGrid(this.image,c,u,d,x,v,y);return new Jn(b,[c,u,d,x])}static shiftPoint(s,i,c){let u=(i.getX()-s.getX())/(c+1),d=(i.getY()-s.getY())/(c+1);return new He(s.getX()+u,s.getY()+d)}static moveAway(s,i,c){let u=s.getX(),d=s.getY();return u<i?u-=1:u+=1,d<c?d-=1:d+=1,new He(u,d)}detectSolid1(s){let i=s[0],c=s[1],u=s[3],d=s[2],x=this.transitionsBetween(i,c),v=this.transitionsBetween(c,u),y=this.transitionsBetween(u,d),b=this.transitionsBetween(d,i),I=x,O=[d,i,c,u];return I>v&&(I=v,O[0]=i,O[1]=c,O[2]=u,O[3]=d),I>y&&(I=y,O[0]=c,O[1]=u,O[2]=d,O[3]=i),I>b&&(O[0]=u,O[1]=d,O[2]=i,O[3]=c),O}detectSolid2(s){let i=s[0],c=s[1],u=s[2],d=s[3],x=this.transitionsBetween(i,d),v=fr.shiftPoint(c,u,(x+1)*4),y=fr.shiftPoint(u,c,(x+1)*4),b=this.transitionsBetween(v,i),I=this.transitionsBetween(y,d);return b<I?(s[0]=i,s[1]=c,s[2]=u,s[3]=d):(s[0]=c,s[1]=u,s[2]=d,s[3]=i),s}correctTopRight(s){let i=s[0],c=s[1],u=s[2],d=s[3],x=this.transitionsBetween(i,d),v=this.transitionsBetween(c,d),y=fr.shiftPoint(i,c,(v+1)*4),b=fr.shiftPoint(u,c,(x+1)*4);x=this.transitionsBetween(y,d),v=this.transitionsBetween(b,d);let I=new He(d.getX()+(u.getX()-c.getX())/(x+1),d.getY()+(u.getY()-c.getY())/(x+1)),O=new He(d.getX()+(i.getX()-c.getX())/(v+1),d.getY()+(i.getY()-c.getY())/(v+1));if(!this.isValid(I))return this.isValid(O)?O:null;if(!this.isValid(O))return I;let j=this.transitionsBetween(y,I)+this.transitionsBetween(b,I),q=this.transitionsBetween(y,O)+this.transitionsBetween(b,O);return j>q?I:O}shiftToModuleCenter(s){let i=s[0],c=s[1],u=s[2],d=s[3],x=this.transitionsBetween(i,d)+1,v=this.transitionsBetween(u,d)+1,y=fr.shiftPoint(i,c,v*4),b=fr.shiftPoint(u,c,x*4);x=this.transitionsBetween(y,d)+1,v=this.transitionsBetween(b,d)+1,(x&1)===1&&(x+=1),(v&1)===1&&(v+=1);let I=(i.getX()+c.getX()+u.getX()+d.getX())/4,O=(i.getY()+c.getY()+u.getY()+d.getY())/4;i=fr.moveAway(i,I,O),c=fr.moveAway(c,I,O),u=fr.moveAway(u,I,O),d=fr.moveAway(d,I,O);let j,q;return y=fr.shiftPoint(i,c,v*4),y=fr.shiftPoint(y,d,x*4),j=fr.shiftPoint(c,i,v*4),j=fr.shiftPoint(j,u,x*4),b=fr.shiftPoint(u,d,v*4),b=fr.shiftPoint(b,c,x*4),q=fr.shiftPoint(d,u,v*4),q=fr.shiftPoint(q,i,x*4),[y,j,b,q]}isValid(s){return s.getX()>=0&&s.getX()<this.image.getWidth()&&s.getY()>0&&s.getY()<this.image.getHeight()}static sampleGrid(s,i,c,u,d,x,v){return qt.getInstance().sampleGrid(s,x,v,.5,.5,x-.5,.5,x-.5,v-.5,.5,v-.5,i.getX(),i.getY(),d.getX(),d.getY(),u.getX(),u.getY(),c.getX(),c.getY())}transitionsBetween(s,i){let c=Math.trunc(s.getX()),u=Math.trunc(s.getY()),d=Math.trunc(i.getX()),x=Math.trunc(i.getY()),v=Math.abs(x-u)>Math.abs(d-c);if(v){let ae=c;c=u,u=ae,ae=d,d=x,x=ae}let y=Math.abs(d-c),b=Math.abs(x-u),I=-y/2,O=u<x?1:-1,j=c<d?1:-1,q=0,re=this.image.get(v?u:c,v?c:u);for(let ae=c,ue=u;ae!==d;ae+=j){let we=this.image.get(v?ue:ae,v?ae:ue);if(we!==re&&(q++,re=we),I+=b,I>0){if(ue===x)break;ue+=O,I-=y}}return q}}class Fa{constructor(){this.decoder=new Mx}decode(s,i=null){let c,u;if(i!=null&&i.has(B.PURE_BARCODE)){const b=Fa.extractPureBits(s.getBlackMatrix());c=this.decoder.decode(b),u=Fa.NO_POINTS}else{const b=new fr(s.getBlackMatrix()).detect();c=this.decoder.decode(b.getBits()),u=b.getPoints()}const d=c.getRawBytes(),x=new te(c.getText(),d,8*d.length,u,ce.DATA_MATRIX,_.currentTimeMillis()),v=c.getByteSegments();v!=null&&x.putMetadata(ye.BYTE_SEGMENTS,v);const y=c.getECLevel();return y!=null&&x.putMetadata(ye.ERROR_CORRECTION_LEVEL,y),x}reset(){}static extractPureBits(s){const i=s.getTopLeftOnBit(),c=s.getBottomRightOnBit();if(i==null||c==null)throw new J;const u=this.moduleSize(i,s);let d=i[1];const x=c[1];let v=i[0];const b=(c[0]-v+1)/u,I=(x-d+1)/u;if(b<=0||I<=0)throw new J;const O=u/2;d+=O,v+=O;const j=new me(b,I);for(let q=0;q<I;q++){const re=d+q*u;for(let ae=0;ae<b;ae++)s.get(v+ae*u,re)&&j.set(ae,q)}return j}static moduleSize(s,i){const c=i.getWidth();let u=s[0];const d=s[1];for(;u<c&&i.get(u,d);)u++;if(u===c)throw new J;const x=u-s[0];if(x===0)throw new J;return x}}Fa.NO_POINTS=[];class Lx extends oe{constructor(s=500){super(new Fa,s)}}var Os;(function(D){D[D.L=0]="L",D[D.M=1]="M",D[D.Q=2]="Q",D[D.H=3]="H"})(Os||(Os={}));class Ht{constructor(s,i,c){this.value=s,this.stringValue=i,this.bits=c,Ht.FOR_BITS.set(c,this),Ht.FOR_VALUE.set(s,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(s){switch(s){case"L":return Ht.L;case"M":return Ht.M;case"Q":return Ht.Q;case"H":return Ht.H;default:throw new p(s+"not available")}}toString(){return this.stringValue}equals(s){if(!(s instanceof Ht))return!1;const i=s;return this.value===i.value}static forBits(s){if(s<0||s>=Ht.FOR_BITS.size)throw new w;return Ht.FOR_BITS.get(s)}}Ht.FOR_BITS=new Map,Ht.FOR_VALUE=new Map,Ht.L=new Ht(Os.L,"L",1),Ht.M=new Ht(Os.M,"M",0),Ht.Q=new Ht(Os.Q,"Q",3),Ht.H=new Ht(Os.H,"H",2);class Vr{constructor(s){this.errorCorrectionLevel=Ht.forBits(s>>3&3),this.dataMask=s&7}static numBitsDiffering(s,i){return N.bitCount(s^i)}static decodeFormatInformation(s,i){const c=Vr.doDecodeFormatInformation(s,i);return c!==null?c:Vr.doDecodeFormatInformation(s^Vr.FORMAT_INFO_MASK_QR,i^Vr.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(s,i){let c=Number.MAX_SAFE_INTEGER,u=0;for(const d of Vr.FORMAT_INFO_DECODE_LOOKUP){const x=d[0];if(x===s||x===i)return new Vr(d[1]);let v=Vr.numBitsDiffering(s,x);v<c&&(u=d[1],c=v),s!==i&&(v=Vr.numBitsDiffering(i,x),v<c&&(u=d[1],c=v))}return c<=3?new Vr(u):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(s){if(!(s instanceof Vr))return!1;const i=s;return this.errorCorrectionLevel===i.errorCorrectionLevel&&this.dataMask===i.dataMask}}Vr.FORMAT_INFO_MASK_QR=21522,Vr.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class de{constructor(s,...i){this.ecCodewordsPerBlock=s,this.ecBlocks=i}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let s=0;const i=this.ecBlocks;for(const c of i)s+=c.getCount();return s}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class X{constructor(s,i){this.count=s,this.dataCodewords=i}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ze{constructor(s,i,...c){this.versionNumber=s,this.alignmentPatternCenters=i,this.ecBlocks=c;let u=0;const d=c[0].getECCodewordsPerBlock(),x=c[0].getECBlocks();for(const v of x)u+=v.getCount()*(v.getDataCodewords()+d);this.totalCodewords=u}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(s){return this.ecBlocks[s.getValue()]}static getProvisionalVersionForDimension(s){if(s%4!==1)throw new R;try{return this.getVersionForNumber((s-17)/4)}catch{throw new R}}static getVersionForNumber(s){if(s<1||s>40)throw new w;return Ze.VERSIONS[s-1]}static decodeVersionInformation(s){let i=Number.MAX_SAFE_INTEGER,c=0;for(let u=0;u<Ze.VERSION_DECODE_INFO.length;u++){const d=Ze.VERSION_DECODE_INFO[u];if(d===s)return Ze.getVersionForNumber(u+7);const x=Vr.numBitsDiffering(s,d);x<i&&(c=u+7,i=x)}return i<=3?Ze.getVersionForNumber(c):null}buildFunctionPattern(){const s=this.getDimensionForVersion(),i=new me(s);i.setRegion(0,0,9,9),i.setRegion(s-8,0,8,9),i.setRegion(0,s-8,9,8);const c=this.alignmentPatternCenters.length;for(let u=0;u<c;u++){const d=this.alignmentPatternCenters[u]-2;for(let x=0;x<c;x++)u===0&&(x===0||x===c-1)||u===c-1&&x===0||i.setRegion(this.alignmentPatternCenters[x]-2,d,5,5)}return i.setRegion(6,9,1,s-17),i.setRegion(9,6,s-17,1),this.versionNumber>6&&(i.setRegion(s-11,0,3,6),i.setRegion(0,s-11,6,3)),i}toString(){return""+this.versionNumber}}Ze.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ze.VERSIONS=[new Ze(1,new Int32Array(0),new de(7,new X(1,19)),new de(10,new X(1,16)),new de(13,new X(1,13)),new de(17,new X(1,9))),new Ze(2,Int32Array.from([6,18]),new de(10,new X(1,34)),new de(16,new X(1,28)),new de(22,new X(1,22)),new de(28,new X(1,16))),new Ze(3,Int32Array.from([6,22]),new de(15,new X(1,55)),new de(26,new X(1,44)),new de(18,new X(2,17)),new de(22,new X(2,13))),new Ze(4,Int32Array.from([6,26]),new de(20,new X(1,80)),new de(18,new X(2,32)),new de(26,new X(2,24)),new de(16,new X(4,9))),new Ze(5,Int32Array.from([6,30]),new de(26,new X(1,108)),new de(24,new X(2,43)),new de(18,new X(2,15),new X(2,16)),new de(22,new X(2,11),new X(2,12))),new Ze(6,Int32Array.from([6,34]),new de(18,new X(2,68)),new de(16,new X(4,27)),new de(24,new X(4,19)),new de(28,new X(4,15))),new Ze(7,Int32Array.from([6,22,38]),new de(20,new X(2,78)),new de(18,new X(4,31)),new de(18,new X(2,14),new X(4,15)),new de(26,new X(4,13),new X(1,14))),new Ze(8,Int32Array.from([6,24,42]),new de(24,new X(2,97)),new de(22,new X(2,38),new X(2,39)),new de(22,new X(4,18),new X(2,19)),new de(26,new X(4,14),new X(2,15))),new Ze(9,Int32Array.from([6,26,46]),new de(30,new X(2,116)),new de(22,new X(3,36),new X(2,37)),new de(20,new X(4,16),new X(4,17)),new de(24,new X(4,12),new X(4,13))),new Ze(10,Int32Array.from([6,28,50]),new de(18,new X(2,68),new X(2,69)),new de(26,new X(4,43),new X(1,44)),new de(24,new X(6,19),new X(2,20)),new de(28,new X(6,15),new X(2,16))),new Ze(11,Int32Array.from([6,30,54]),new de(20,new X(4,81)),new de(30,new X(1,50),new X(4,51)),new de(28,new X(4,22),new X(4,23)),new de(24,new X(3,12),new X(8,13))),new Ze(12,Int32Array.from([6,32,58]),new de(24,new X(2,92),new X(2,93)),new de(22,new X(6,36),new X(2,37)),new de(26,new X(4,20),new X(6,21)),new de(28,new X(7,14),new X(4,15))),new Ze(13,Int32Array.from([6,34,62]),new de(26,new X(4,107)),new de(22,new X(8,37),new X(1,38)),new de(24,new X(8,20),new X(4,21)),new de(22,new X(12,11),new X(4,12))),new Ze(14,Int32Array.from([6,26,46,66]),new de(30,new X(3,115),new X(1,116)),new de(24,new X(4,40),new X(5,41)),new de(20,new X(11,16),new X(5,17)),new de(24,new X(11,12),new X(5,13))),new Ze(15,Int32Array.from([6,26,48,70]),new de(22,new X(5,87),new X(1,88)),new de(24,new X(5,41),new X(5,42)),new de(30,new X(5,24),new X(7,25)),new de(24,new X(11,12),new X(7,13))),new Ze(16,Int32Array.from([6,26,50,74]),new de(24,new X(5,98),new X(1,99)),new de(28,new X(7,45),new X(3,46)),new de(24,new X(15,19),new X(2,20)),new de(30,new X(3,15),new X(13,16))),new Ze(17,Int32Array.from([6,30,54,78]),new de(28,new X(1,107),new X(5,108)),new de(28,new X(10,46),new X(1,47)),new de(28,new X(1,22),new X(15,23)),new de(28,new X(2,14),new X(17,15))),new Ze(18,Int32Array.from([6,30,56,82]),new de(30,new X(5,120),new X(1,121)),new de(26,new X(9,43),new X(4,44)),new de(28,new X(17,22),new X(1,23)),new de(28,new X(2,14),new X(19,15))),new Ze(19,Int32Array.from([6,30,58,86]),new de(28,new X(3,113),new X(4,114)),new de(26,new X(3,44),new X(11,45)),new de(26,new X(17,21),new X(4,22)),new de(26,new X(9,13),new X(16,14))),new Ze(20,Int32Array.from([6,34,62,90]),new de(28,new X(3,107),new X(5,108)),new de(26,new X(3,41),new X(13,42)),new de(30,new X(15,24),new X(5,25)),new de(28,new X(15,15),new X(10,16))),new Ze(21,Int32Array.from([6,28,50,72,94]),new de(28,new X(4,116),new X(4,117)),new de(26,new X(17,42)),new de(28,new X(17,22),new X(6,23)),new de(30,new X(19,16),new X(6,17))),new Ze(22,Int32Array.from([6,26,50,74,98]),new de(28,new X(2,111),new X(7,112)),new de(28,new X(17,46)),new de(30,new X(7,24),new X(16,25)),new de(24,new X(34,13))),new Ze(23,Int32Array.from([6,30,54,78,102]),new de(30,new X(4,121),new X(5,122)),new de(28,new X(4,47),new X(14,48)),new de(30,new X(11,24),new X(14,25)),new de(30,new X(16,15),new X(14,16))),new Ze(24,Int32Array.from([6,28,54,80,106]),new de(30,new X(6,117),new X(4,118)),new de(28,new X(6,45),new X(14,46)),new de(30,new X(11,24),new X(16,25)),new de(30,new X(30,16),new X(2,17))),new Ze(25,Int32Array.from([6,32,58,84,110]),new de(26,new X(8,106),new X(4,107)),new de(28,new X(8,47),new X(13,48)),new de(30,new X(7,24),new X(22,25)),new de(30,new X(22,15),new X(13,16))),new Ze(26,Int32Array.from([6,30,58,86,114]),new de(28,new X(10,114),new X(2,115)),new de(28,new X(19,46),new X(4,47)),new de(28,new X(28,22),new X(6,23)),new de(30,new X(33,16),new X(4,17))),new Ze(27,Int32Array.from([6,34,62,90,118]),new de(30,new X(8,122),new X(4,123)),new de(28,new X(22,45),new X(3,46)),new de(30,new X(8,23),new X(26,24)),new de(30,new X(12,15),new X(28,16))),new Ze(28,Int32Array.from([6,26,50,74,98,122]),new de(30,new X(3,117),new X(10,118)),new de(28,new X(3,45),new X(23,46)),new de(30,new X(4,24),new X(31,25)),new de(30,new X(11,15),new X(31,16))),new Ze(29,Int32Array.from([6,30,54,78,102,126]),new de(30,new X(7,116),new X(7,117)),new de(28,new X(21,45),new X(7,46)),new de(30,new X(1,23),new X(37,24)),new de(30,new X(19,15),new X(26,16))),new Ze(30,Int32Array.from([6,26,52,78,104,130]),new de(30,new X(5,115),new X(10,116)),new de(28,new X(19,47),new X(10,48)),new de(30,new X(15,24),new X(25,25)),new de(30,new X(23,15),new X(25,16))),new Ze(31,Int32Array.from([6,30,56,82,108,134]),new de(30,new X(13,115),new X(3,116)),new de(28,new X(2,46),new X(29,47)),new de(30,new X(42,24),new X(1,25)),new de(30,new X(23,15),new X(28,16))),new Ze(32,Int32Array.from([6,34,60,86,112,138]),new de(30,new X(17,115)),new de(28,new X(10,46),new X(23,47)),new de(30,new X(10,24),new X(35,25)),new de(30,new X(19,15),new X(35,16))),new Ze(33,Int32Array.from([6,30,58,86,114,142]),new de(30,new X(17,115),new X(1,116)),new de(28,new X(14,46),new X(21,47)),new de(30,new X(29,24),new X(19,25)),new de(30,new X(11,15),new X(46,16))),new Ze(34,Int32Array.from([6,34,62,90,118,146]),new de(30,new X(13,115),new X(6,116)),new de(28,new X(14,46),new X(23,47)),new de(30,new X(44,24),new X(7,25)),new de(30,new X(59,16),new X(1,17))),new Ze(35,Int32Array.from([6,30,54,78,102,126,150]),new de(30,new X(12,121),new X(7,122)),new de(28,new X(12,47),new X(26,48)),new de(30,new X(39,24),new X(14,25)),new de(30,new X(22,15),new X(41,16))),new Ze(36,Int32Array.from([6,24,50,76,102,128,154]),new de(30,new X(6,121),new X(14,122)),new de(28,new X(6,47),new X(34,48)),new de(30,new X(46,24),new X(10,25)),new de(30,new X(2,15),new X(64,16))),new Ze(37,Int32Array.from([6,28,54,80,106,132,158]),new de(30,new X(17,122),new X(4,123)),new de(28,new X(29,46),new X(14,47)),new de(30,new X(49,24),new X(10,25)),new de(30,new X(24,15),new X(46,16))),new Ze(38,Int32Array.from([6,32,58,84,110,136,162]),new de(30,new X(4,122),new X(18,123)),new de(28,new X(13,46),new X(32,47)),new de(30,new X(48,24),new X(14,25)),new de(30,new X(42,15),new X(32,16))),new Ze(39,Int32Array.from([6,26,54,82,110,138,166]),new de(30,new X(20,117),new X(4,118)),new de(28,new X(40,47),new X(7,48)),new de(30,new X(43,24),new X(22,25)),new de(30,new X(10,15),new X(67,16))),new Ze(40,Int32Array.from([6,30,58,86,114,142,170]),new de(30,new X(19,118),new X(6,119)),new de(28,new X(18,47),new X(31,48)),new de(30,new X(34,24),new X(34,25)),new de(30,new X(20,15),new X(61,16)))];var kr;(function(D){D[D.DATA_MASK_000=0]="DATA_MASK_000",D[D.DATA_MASK_001=1]="DATA_MASK_001",D[D.DATA_MASK_010=2]="DATA_MASK_010",D[D.DATA_MASK_011=3]="DATA_MASK_011",D[D.DATA_MASK_100=4]="DATA_MASK_100",D[D.DATA_MASK_101=5]="DATA_MASK_101",D[D.DATA_MASK_110=6]="DATA_MASK_110",D[D.DATA_MASK_111=7]="DATA_MASK_111"})(kr||(kr={}));class In{constructor(s,i){this.value=s,this.isMasked=i}unmaskBitMatrix(s,i){for(let c=0;c<i;c++)for(let u=0;u<i;u++)this.isMasked(c,u)&&s.flip(u,c)}}In.values=new Map([[kr.DATA_MASK_000,new In(kr.DATA_MASK_000,(D,s)=>(D+s&1)===0)],[kr.DATA_MASK_001,new In(kr.DATA_MASK_001,(D,s)=>(D&1)===0)],[kr.DATA_MASK_010,new In(kr.DATA_MASK_010,(D,s)=>s%3===0)],[kr.DATA_MASK_011,new In(kr.DATA_MASK_011,(D,s)=>(D+s)%3===0)],[kr.DATA_MASK_100,new In(kr.DATA_MASK_100,(D,s)=>(Math.floor(D/2)+Math.floor(s/3)&1)===0)],[kr.DATA_MASK_101,new In(kr.DATA_MASK_101,(D,s)=>D*s%6===0)],[kr.DATA_MASK_110,new In(kr.DATA_MASK_110,(D,s)=>D*s%6<3)],[kr.DATA_MASK_111,new In(kr.DATA_MASK_111,(D,s)=>(D+s+D*s%3&1)===0)]]);class jx{constructor(s){const i=s.getHeight();if(i<21||(i&3)!==1)throw new R;this.bitMatrix=s}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let s=0;for(let d=0;d<6;d++)s=this.copyBit(d,8,s);s=this.copyBit(7,8,s),s=this.copyBit(8,8,s),s=this.copyBit(8,7,s);for(let d=5;d>=0;d--)s=this.copyBit(8,d,s);const i=this.bitMatrix.getHeight();let c=0;const u=i-7;for(let d=i-1;d>=u;d--)c=this.copyBit(8,d,c);for(let d=i-8;d<i;d++)c=this.copyBit(d,8,c);if(this.parsedFormatInfo=Vr.decodeFormatInformation(s,c),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new R}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const s=this.bitMatrix.getHeight(),i=Math.floor((s-17)/4);if(i<=6)return Ze.getVersionForNumber(i);let c=0;const u=s-11;for(let x=5;x>=0;x--)for(let v=s-9;v>=u;v--)c=this.copyBit(v,x,c);let d=Ze.decodeVersionInformation(c);if(d!==null&&d.getDimensionForVersion()===s)return this.parsedVersion=d,d;c=0;for(let x=5;x>=0;x--)for(let v=s-9;v>=u;v--)c=this.copyBit(x,v,c);if(d=Ze.decodeVersionInformation(c),d!==null&&d.getDimensionForVersion()===s)return this.parsedVersion=d,d;throw new R}copyBit(s,i,c){return(this.isMirror?this.bitMatrix.get(i,s):this.bitMatrix.get(s,i))?c<<1|1:c<<1}readCodewords(){const s=this.readFormatInformation(),i=this.readVersion(),c=In.values.get(s.getDataMask()),u=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,u);const d=i.buildFunctionPattern();let x=!0;const v=new Uint8Array(i.getTotalCodewords());let y=0,b=0,I=0;for(let O=u-1;O>0;O-=2){O===6&&O--;for(let j=0;j<u;j++){const q=x?u-1-j:j;for(let re=0;re<2;re++)d.get(O-re,q)||(I++,b<<=1,this.bitMatrix.get(O-re,q)&&(b|=1),I===8&&(v[y++]=b,I=0,b=0))}x=!x}if(y!==i.getTotalCodewords())throw new R;return v}remask(){if(this.parsedFormatInfo===null)return;const s=In.values[this.parsedFormatInfo.getDataMask()],i=this.bitMatrix.getHeight();s.unmaskBitMatrix(this.bitMatrix,i)}setMirror(s){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=s}mirror(){const s=this.bitMatrix;for(let i=0,c=s.getWidth();i<c;i++)for(let u=i+1,d=s.getHeight();u<d;u++)s.get(i,u)!==s.get(u,i)&&(s.flip(u,i),s.flip(i,u))}}class Dc{constructor(s,i){this.numDataCodewords=s,this.codewords=i}static getDataBlocks(s,i,c){if(s.length!==i.getTotalCodewords())throw new w;const u=i.getECBlocksForLevel(c);let d=0;const x=u.getECBlocks();for(const re of x)d+=re.getCount();const v=new Array(d);let y=0;for(const re of x)for(let ae=0;ae<re.getCount();ae++){const ue=re.getDataCodewords(),we=u.getECCodewordsPerBlock()+ue;v[y++]=new Dc(ue,new Uint8Array(we))}const b=v[0].codewords.length;let I=v.length-1;for(;I>=0&&v[I].codewords.length!==b;)I--;I++;const O=b-u.getECCodewordsPerBlock();let j=0;for(let re=0;re<O;re++)for(let ae=0;ae<y;ae++)v[ae].codewords[re]=s[j++];for(let re=I;re<y;re++)v[re].codewords[O]=s[j++];const q=v[0].codewords.length;for(let re=O;re<q;re++)for(let ae=0;ae<y;ae++){const ue=ae<I?re:re+1;v[ae].codewords[ue]=s[j++]}return v}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var kn;(function(D){D[D.TERMINATOR=0]="TERMINATOR",D[D.NUMERIC=1]="NUMERIC",D[D.ALPHANUMERIC=2]="ALPHANUMERIC",D[D.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",D[D.BYTE=4]="BYTE",D[D.ECI=5]="ECI",D[D.KANJI=6]="KANJI",D[D.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",D[D.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",D[D.HANZI=9]="HANZI"})(kn||(kn={}));class qe{constructor(s,i,c,u){this.value=s,this.stringValue=i,this.characterCountBitsForVersions=c,this.bits=u,qe.FOR_BITS.set(u,this),qe.FOR_VALUE.set(s,this)}static forBits(s){const i=qe.FOR_BITS.get(s);if(i===void 0)throw new w;return i}getCharacterCountBits(s){const i=s.getVersionNumber();let c;return i<=9?c=0:i<=26?c=1:c=2,this.characterCountBitsForVersions[c]}getValue(){return this.value}getBits(){return this.bits}equals(s){if(!(s instanceof qe))return!1;const i=s;return this.value===i.value}toString(){return this.stringValue}}qe.FOR_BITS=new Map,qe.FOR_VALUE=new Map,qe.TERMINATOR=new qe(kn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),qe.NUMERIC=new qe(kn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),qe.ALPHANUMERIC=new qe(kn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),qe.STRUCTURED_APPEND=new qe(kn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),qe.BYTE=new qe(kn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),qe.ECI=new qe(kn.ECI,"ECI",Int32Array.from([0,0,0]),7),qe.KANJI=new qe(kn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),qe.FNC1_FIRST_POSITION=new qe(kn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),qe.FNC1_SECOND_POSITION=new qe(kn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),qe.HANZI=new qe(kn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class er{static decode(s,i,c,u){const d=new Fc(s);let x=new ne;const v=new Array;let y=-1,b=-1;try{let I=null,O=!1,j;do{if(d.available()<4)j=qe.TERMINATOR;else{const q=d.readBits(4);j=qe.forBits(q)}switch(j){case qe.TERMINATOR:break;case qe.FNC1_FIRST_POSITION:case qe.FNC1_SECOND_POSITION:O=!0;break;case qe.STRUCTURED_APPEND:if(d.available()<16)throw new R;y=d.readBits(8),b=d.readBits(8);break;case qe.ECI:const q=er.parseECIValue(d);if(I=U.getCharacterSetECIByValue(q),I===null)throw new R;break;case qe.HANZI:const re=d.readBits(4),ae=d.readBits(j.getCharacterCountBits(i));re===er.GB2312_SUBSET&&er.decodeHanziSegment(d,x,ae);break;default:const ue=d.readBits(j.getCharacterCountBits(i));switch(j){case qe.NUMERIC:er.decodeNumericSegment(d,x,ue);break;case qe.ALPHANUMERIC:er.decodeAlphanumericSegment(d,x,ue,O);break;case qe.BYTE:er.decodeByteSegment(d,x,ue,I,v,u);break;case qe.KANJI:er.decodeKanjiSegment(d,x,ue);break;default:throw new R}break}}while(j!==qe.TERMINATOR)}catch{throw new R}return new Se(s,x.toString(),v.length===0?null:v,c===null?null:c.toString(),y,b)}static decodeHanziSegment(s,i,c){if(c*13>s.available())throw new R;const u=new Uint8Array(2*c);let d=0;for(;c>0;){const x=s.readBits(13);let v=x/96<<8&4294967295|x%96;v<959?v+=41377:v+=42657,u[d]=v>>8&255,u[d+1]=v&255,d+=2,c--}try{i.append(M.decode(u,V.GB2312))}catch(x){throw new R(x)}}static decodeKanjiSegment(s,i,c){if(c*13>s.available())throw new R;const u=new Uint8Array(2*c);let d=0;for(;c>0;){const x=s.readBits(13);let v=x/192<<8&4294967295|x%192;v<7936?v+=33088:v+=49472,u[d]=v>>8,u[d+1]=v,d+=2,c--}try{i.append(M.decode(u,V.SHIFT_JIS))}catch(x){throw new R(x)}}static decodeByteSegment(s,i,c,u,d,x){if(8*c>s.available())throw new R;const v=new Uint8Array(c);for(let b=0;b<c;b++)v[b]=s.readBits(8);let y;u===null?y=V.guessEncoding(v,x):y=u.getName();try{i.append(M.decode(v,y))}catch(b){throw new R(b)}d.push(v)}static toAlphaNumericChar(s){if(s>=er.ALPHANUMERIC_CHARS.length)throw new R;return er.ALPHANUMERIC_CHARS[s]}static decodeAlphanumericSegment(s,i,c,u){const d=i.length();for(;c>1;){if(s.available()<11)throw new R;const x=s.readBits(11);i.append(er.toAlphaNumericChar(Math.floor(x/45))),i.append(er.toAlphaNumericChar(x%45)),c-=2}if(c===1){if(s.available()<6)throw new R;i.append(er.toAlphaNumericChar(s.readBits(6)))}if(u)for(let x=d;x<i.length();x++)i.charAt(x)==="%"&&(x<i.length()-1&&i.charAt(x+1)==="%"?i.deleteCharAt(x+1):i.setCharAt(x,""))}static decodeNumericSegment(s,i,c){for(;c>=3;){if(s.available()<10)throw new R;const u=s.readBits(10);if(u>=1e3)throw new R;i.append(er.toAlphaNumericChar(Math.floor(u/100))),i.append(er.toAlphaNumericChar(Math.floor(u/10)%10)),i.append(er.toAlphaNumericChar(u%10)),c-=3}if(c===2){if(s.available()<7)throw new R;const u=s.readBits(7);if(u>=100)throw new R;i.append(er.toAlphaNumericChar(Math.floor(u/10))),i.append(er.toAlphaNumericChar(u%10))}else if(c===1){if(s.available()<4)throw new R;const u=s.readBits(4);if(u>=10)throw new R;i.append(er.toAlphaNumericChar(u))}}static parseECIValue(s){const i=s.readBits(8);if(!(i&128))return i&127;if((i&192)===128){const c=s.readBits(8);return(i&63)<<8&4294967295|c}if((i&224)===192){const c=s.readBits(16);return(i&31)<<16&4294967295|c}throw new R}}er.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",er.GB2312_SUBSET=1;class X0{constructor(s){this.mirrored=s}isMirrored(){return this.mirrored}applyMirroredCorrection(s){if(!this.mirrored||s===null||s.length<3)return;const i=s[0];s[0]=s[2],s[2]=i}}class Px{constructor(){this.rsDecoder=new ot(Ge.QR_CODE_FIELD_256)}decodeBooleanArray(s,i){return this.decodeBitMatrix(me.parseFromBooleanArray(s),i)}decodeBitMatrix(s,i){const c=new jx(s);let u=null;try{return this.decodeBitMatrixParser(c,i)}catch(d){u=d}try{c.remask(),c.setMirror(!0),c.readVersion(),c.readFormatInformation(),c.mirror();const d=this.decodeBitMatrixParser(c,i);return d.setOther(new X0(!0)),d}catch(d){throw u!==null?u:d}}decodeBitMatrixParser(s,i){const c=s.readVersion(),u=s.readFormatInformation().getErrorCorrectionLevel(),d=s.readCodewords(),x=Dc.getDataBlocks(d,c,u);let v=0;for(const I of x)v+=I.getNumDataCodewords();const y=new Uint8Array(v);let b=0;for(const I of x){const O=I.getCodewords(),j=I.getNumDataCodewords();this.correctErrors(O,j);for(let q=0;q<j;q++)y[b++]=O[q]}return er.decode(y,c,u,i)}correctErrors(s,i){const c=new Int32Array(s);try{this.rsDecoder.decode(c,s.length-i)}catch{throw new A}for(let u=0;u<i;u++)s[u]=c[u]}}class Oc extends He{constructor(s,i,c){super(s,i),this.estimatedModuleSize=c}aboutEquals(s,i,c){if(Math.abs(i-this.getY())<=s&&Math.abs(c-this.getX())<=s){const u=Math.abs(s-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(s,i,c){const u=(this.getX()+i)/2,d=(this.getY()+s)/2,x=(this.estimatedModuleSize+c)/2;return new Oc(u,d,x)}}class mo{constructor(s,i,c,u,d,x,v){this.image=s,this.startX=i,this.startY=c,this.width=u,this.height=d,this.moduleSize=x,this.resultPointCallback=v,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const s=this.startX,i=this.height,c=this.width,u=s+c,d=this.startY+i/2,x=new Int32Array(3),v=this.image;for(let y=0;y<i;y++){const b=d+(y&1?-Math.floor((y+1)/2):Math.floor((y+1)/2));x[0]=0,x[1]=0,x[2]=0;let I=s;for(;I<u&&!v.get(I,b);)I++;let O=0;for(;I<u;){if(v.get(I,b))if(O===1)x[1]++;else if(O===2){if(this.foundPatternCross(x)){const j=this.handlePossibleCenter(x,b,I);if(j!==null)return j}x[0]=x[2],x[1]=1,x[2]=0,O=1}else x[++O]++;else O===1&&O++,x[O]++;I++}if(this.foundPatternCross(x)){const j=this.handlePossibleCenter(x,b,u);if(j!==null)return j}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new J}static centerFromEnd(s,i){return i-s[2]-s[1]/2}foundPatternCross(s){const i=this.moduleSize,c=i/2;for(let u=0;u<3;u++)if(Math.abs(i-s[u])>=c)return!1;return!0}crossCheckVertical(s,i,c,u){const d=this.image,x=d.getHeight(),v=this.crossCheckStateCount;v[0]=0,v[1]=0,v[2]=0;let y=s;for(;y>=0&&d.get(i,y)&&v[1]<=c;)v[1]++,y--;if(y<0||v[1]>c)return NaN;for(;y>=0&&!d.get(i,y)&&v[0]<=c;)v[0]++,y--;if(v[0]>c)return NaN;for(y=s+1;y<x&&d.get(i,y)&&v[1]<=c;)v[1]++,y++;if(y===x||v[1]>c)return NaN;for(;y<x&&!d.get(i,y)&&v[2]<=c;)v[2]++,y++;if(v[2]>c)return NaN;const b=v[0]+v[1]+v[2];return 5*Math.abs(b-u)>=2*u?NaN:this.foundPatternCross(v)?mo.centerFromEnd(v,y):NaN}handlePossibleCenter(s,i,c){const u=s[0]+s[1]+s[2],d=mo.centerFromEnd(s,c),x=this.crossCheckVertical(i,d,2*s[1],u);if(!isNaN(x)){const v=(s[0]+s[1]+s[2])/3;for(const b of this.possibleCenters)if(b.aboutEquals(v,x,d))return b.combineEstimate(x,d,v);const y=new Oc(d,x,v);this.possibleCenters.push(y),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(y)}return null}}class Rc extends He{constructor(s,i,c,u){super(s,i),this.estimatedModuleSize=c,this.count=u,u===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(s,i,c){if(Math.abs(i-this.getY())<=s&&Math.abs(c-this.getX())<=s){const u=Math.abs(s-this.estimatedModuleSize);return u<=1||u<=this.estimatedModuleSize}return!1}combineEstimate(s,i,c){const u=this.count+1,d=(this.count*this.getX()+i)/u,x=(this.count*this.getY()+s)/u,v=(this.count*this.estimatedModuleSize+c)/u;return new Rc(d,x,v,u)}}class Bx{constructor(s){this.bottomLeft=s[0],this.topLeft=s[1],this.topRight=s[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Fr{constructor(s,i){this.image=s,this.resultPointCallback=i,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=i}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(s){const i=s!=null&&s.get(B.TRY_HARDER)!==void 0,c=s!=null&&s.get(B.PURE_BARCODE)!==void 0,u=this.image,d=u.getHeight(),x=u.getWidth();let v=Math.floor(3*d/(4*Fr.MAX_MODULES));(v<Fr.MIN_SKIP||i)&&(v=Fr.MIN_SKIP);let y=!1;const b=new Int32Array(5);for(let O=v-1;O<d&&!y;O+=v){b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0;let j=0;for(let q=0;q<x;q++)if(u.get(q,O))(j&1)===1&&j++,b[j]++;else if(j&1)b[j]++;else if(j===4)if(Fr.foundPatternCross(b)){if(this.handlePossibleCenter(b,O,q,c)===!0)if(v=2,this.hasSkipped===!0)y=this.haveMultiplyConfirmedCenters();else{const ae=this.findRowSkip();ae>b[2]&&(O+=ae-b[2]-v,q=x-1)}else{b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,j=3;continue}j=0,b[0]=0,b[1]=0,b[2]=0,b[3]=0,b[4]=0}else b[0]=b[2],b[1]=b[3],b[2]=b[4],b[3]=1,b[4]=0,j=3;else b[++j]++;Fr.foundPatternCross(b)&&this.handlePossibleCenter(b,O,x,c)===!0&&(v=b[0],this.hasSkipped&&(y=this.haveMultiplyConfirmedCenters()))}const I=this.selectBestPatterns();return He.orderBestPatterns(I),new Bx(I)}static centerFromEnd(s,i){return i-s[4]-s[3]-s[2]/2}static foundPatternCross(s){let i=0;for(let d=0;d<5;d++){const x=s[d];if(x===0)return!1;i+=x}if(i<7)return!1;const c=i/7,u=c/2;return Math.abs(c-s[0])<u&&Math.abs(c-s[1])<u&&Math.abs(3*c-s[2])<3*u&&Math.abs(c-s[3])<u&&Math.abs(c-s[4])<u}getCrossCheckStateCount(){const s=this.crossCheckStateCount;return s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s}crossCheckDiagonal(s,i,c,u){const d=this.getCrossCheckStateCount();let x=0;const v=this.image;for(;s>=x&&i>=x&&v.get(i-x,s-x);)d[2]++,x++;if(s<x||i<x)return!1;for(;s>=x&&i>=x&&!v.get(i-x,s-x)&&d[1]<=c;)d[1]++,x++;if(s<x||i<x||d[1]>c)return!1;for(;s>=x&&i>=x&&v.get(i-x,s-x)&&d[0]<=c;)d[0]++,x++;if(d[0]>c)return!1;const y=v.getHeight(),b=v.getWidth();for(x=1;s+x<y&&i+x<b&&v.get(i+x,s+x);)d[2]++,x++;if(s+x>=y||i+x>=b)return!1;for(;s+x<y&&i+x<b&&!v.get(i+x,s+x)&&d[3]<c;)d[3]++,x++;if(s+x>=y||i+x>=b||d[3]>=c)return!1;for(;s+x<y&&i+x<b&&v.get(i+x,s+x)&&d[4]<c;)d[4]++,x++;if(d[4]>=c)return!1;const I=d[0]+d[1]+d[2]+d[3]+d[4];return Math.abs(I-u)<2*u&&Fr.foundPatternCross(d)}crossCheckVertical(s,i,c,u){const d=this.image,x=d.getHeight(),v=this.getCrossCheckStateCount();let y=s;for(;y>=0&&d.get(i,y);)v[2]++,y--;if(y<0)return NaN;for(;y>=0&&!d.get(i,y)&&v[1]<=c;)v[1]++,y--;if(y<0||v[1]>c)return NaN;for(;y>=0&&d.get(i,y)&&v[0]<=c;)v[0]++,y--;if(v[0]>c)return NaN;for(y=s+1;y<x&&d.get(i,y);)v[2]++,y++;if(y===x)return NaN;for(;y<x&&!d.get(i,y)&&v[3]<c;)v[3]++,y++;if(y===x||v[3]>=c)return NaN;for(;y<x&&d.get(i,y)&&v[4]<c;)v[4]++,y++;if(v[4]>=c)return NaN;const b=v[0]+v[1]+v[2]+v[3]+v[4];return 5*Math.abs(b-u)>=2*u?NaN:Fr.foundPatternCross(v)?Fr.centerFromEnd(v,y):NaN}crossCheckHorizontal(s,i,c,u){const d=this.image,x=d.getWidth(),v=this.getCrossCheckStateCount();let y=s;for(;y>=0&&d.get(y,i);)v[2]++,y--;if(y<0)return NaN;for(;y>=0&&!d.get(y,i)&&v[1]<=c;)v[1]++,y--;if(y<0||v[1]>c)return NaN;for(;y>=0&&d.get(y,i)&&v[0]<=c;)v[0]++,y--;if(v[0]>c)return NaN;for(y=s+1;y<x&&d.get(y,i);)v[2]++,y++;if(y===x)return NaN;for(;y<x&&!d.get(y,i)&&v[3]<c;)v[3]++,y++;if(y===x||v[3]>=c)return NaN;for(;y<x&&d.get(y,i)&&v[4]<c;)v[4]++,y++;if(v[4]>=c)return NaN;const b=v[0]+v[1]+v[2]+v[3]+v[4];return 5*Math.abs(b-u)>=u?NaN:Fr.foundPatternCross(v)?Fr.centerFromEnd(v,y):NaN}handlePossibleCenter(s,i,c,u){const d=s[0]+s[1]+s[2]+s[3]+s[4];let x=Fr.centerFromEnd(s,c),v=this.crossCheckVertical(i,Math.floor(x),s[2],d);if(!isNaN(v)&&(x=this.crossCheckHorizontal(Math.floor(x),Math.floor(v),s[2],d),!isNaN(x)&&(!u||this.crossCheckDiagonal(Math.floor(v),Math.floor(x),s[2],d)))){const y=d/7;let b=!1;const I=this.possibleCenters;for(let O=0,j=I.length;O<j;O++){const q=I[O];if(q.aboutEquals(y,v,x)){I[O]=q.combineEstimate(v,x,y),b=!0;break}}if(!b){const O=new Rc(x,v,y);I.push(O),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(O)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let i=null;for(const c of this.possibleCenters)if(c.getCount()>=Fr.CENTER_QUORUM)if(i==null)i=c;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-c.getX())-Math.abs(i.getY()-c.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let s=0,i=0;const c=this.possibleCenters.length;for(const x of this.possibleCenters)x.getCount()>=Fr.CENTER_QUORUM&&(s++,i+=x.getEstimatedModuleSize());if(s<3)return!1;const u=i/c;let d=0;for(const x of this.possibleCenters)d+=Math.abs(x.getEstimatedModuleSize()-u);return d<=.05*i}selectBestPatterns(){const s=this.possibleCenters.length;if(s<3)throw new J;const i=this.possibleCenters;let c;if(s>3){let u=0,d=0;for(const y of this.possibleCenters){const b=y.getEstimatedModuleSize();u+=b,d+=b*b}c=u/s;let x=Math.sqrt(d/s-c*c);i.sort((y,b)=>{const I=Math.abs(b.getEstimatedModuleSize()-c),O=Math.abs(y.getEstimatedModuleSize()-c);return I<O?-1:I>O?1:0});const v=Math.max(.2*c,x);for(let y=0;y<i.length&&i.length>3;y++){const b=i[y];Math.abs(b.getEstimatedModuleSize()-c)>v&&(i.splice(y,1),y--)}}if(i.length>3){let u=0;for(const d of i)u+=d.getEstimatedModuleSize();c=u/i.length,i.sort((d,x)=>{if(x.getCount()===d.getCount()){const v=Math.abs(x.getEstimatedModuleSize()-c),y=Math.abs(d.getEstimatedModuleSize()-c);return v<y?1:v>y?-1:0}else return x.getCount()-d.getCount()}),i.splice(3)}return[i[0],i[1],i[2]]}}Fr.CENTER_QUORUM=2,Fr.MIN_SKIP=3,Fr.MAX_MODULES=57;class di{constructor(s){this.image=s}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(s){this.resultPointCallback=s==null?null:s.get(B.NEED_RESULT_POINT_CALLBACK);const c=new Fr(this.image,this.resultPointCallback).find(s);return this.processFinderPatternInfo(c)}processFinderPatternInfo(s){const i=s.getTopLeft(),c=s.getTopRight(),u=s.getBottomLeft(),d=this.calculateModuleSize(i,c,u);if(d<1)throw new J("No pattern found in proccess finder.");const x=di.computeDimension(i,c,u,d),v=Ze.getProvisionalVersionForDimension(x),y=v.getDimensionForVersion()-7;let b=null;if(v.getAlignmentPatternCenters().length>0){const q=c.getX()-i.getX()+u.getX(),re=c.getY()-i.getY()+u.getY(),ae=1-3/y,ue=Math.floor(i.getX()+ae*(q-i.getX())),we=Math.floor(i.getY()+ae*(re-i.getY()));for(let Me=4;Me<=16;Me<<=1)try{b=this.findAlignmentInRegion(d,ue,we,Me);break}catch(je){if(!(je instanceof J))throw je}}const I=di.createTransform(i,c,u,b,x),O=di.sampleGrid(this.image,I,x);let j;return b===null?j=[u,i,c]:j=[u,i,c,b],new Jn(O,j)}static createTransform(s,i,c,u,d){const x=d-3.5;let v,y,b,I;return u!==null?(v=u.getX(),y=u.getY(),b=x-3,I=b):(v=i.getX()-s.getX()+c.getX(),y=i.getY()-s.getY()+c.getY(),b=x,I=x),vr.quadrilateralToQuadrilateral(3.5,3.5,x,3.5,b,I,3.5,x,s.getX(),s.getY(),i.getX(),i.getY(),v,y,c.getX(),c.getY())}static sampleGrid(s,i,c){return qt.getInstance().sampleGridWithTransform(s,c,c,i)}static computeDimension(s,i,c,u){const d=it.round(He.distance(s,i)/u),x=it.round(He.distance(s,c)/u);let v=Math.floor((d+x)/2)+7;switch(v&3){case 0:v++;break;case 2:v--;break;case 3:throw new J("Dimensions could be not found.")}return v}calculateModuleSize(s,i,c){return(this.calculateModuleSizeOneWay(s,i)+this.calculateModuleSizeOneWay(s,c))/2}calculateModuleSizeOneWay(s,i){const c=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(s.getX()),Math.floor(s.getY()),Math.floor(i.getX()),Math.floor(i.getY())),u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(i.getX()),Math.floor(i.getY()),Math.floor(s.getX()),Math.floor(s.getY()));return isNaN(c)?u/7:isNaN(u)?c/7:(c+u)/14}sizeOfBlackWhiteBlackRunBothWays(s,i,c,u){let d=this.sizeOfBlackWhiteBlackRun(s,i,c,u),x=1,v=s-(c-s);v<0?(x=s/(s-v),v=0):v>=this.image.getWidth()&&(x=(this.image.getWidth()-1-s)/(v-s),v=this.image.getWidth()-1);let y=Math.floor(i-(u-i)*x);return x=1,y<0?(x=i/(i-y),y=0):y>=this.image.getHeight()&&(x=(this.image.getHeight()-1-i)/(y-i),y=this.image.getHeight()-1),v=Math.floor(s+(v-s)*x),d+=this.sizeOfBlackWhiteBlackRun(s,i,v,y),d-1}sizeOfBlackWhiteBlackRun(s,i,c,u){const d=Math.abs(u-i)>Math.abs(c-s);if(d){let q=s;s=i,i=q,q=c,c=u,u=q}const x=Math.abs(c-s),v=Math.abs(u-i);let y=-x/2;const b=s<c?1:-1,I=i<u?1:-1;let O=0;const j=c+b;for(let q=s,re=i;q!==j;q+=b){const ae=d?re:q,ue=d?q:re;if(O===1===this.image.get(ae,ue)){if(O===2)return it.distance(q,re,s,i);O++}if(y+=v,y>0){if(re===u)break;re+=I,y-=x}}return O===2?it.distance(c+b,u,s,i):NaN}findAlignmentInRegion(s,i,c,u){const d=Math.floor(u*s),x=Math.max(0,i-d),v=Math.min(this.image.getWidth()-1,i+d);if(v-x<s*3)throw new J("Alignment top exceeds estimated module size.");const y=Math.max(0,c-d),b=Math.min(this.image.getHeight()-1,c+d);if(b-y<s*3)throw new J("Alignment bottom exceeds estimated module size.");return new mo(this.image,x,y,v-x,b-y,s,this.resultPointCallback).find()}}class Da{constructor(){this.decoder=new Px}getDecoder(){return this.decoder}decode(s,i){let c,u;if(i!=null&&i.get(B.PURE_BARCODE)!==void 0){const y=Da.extractPureBits(s.getBlackMatrix());c=this.decoder.decodeBitMatrix(y,i),u=Da.NO_POINTS}else{const y=new di(s.getBlackMatrix()).detect(i);c=this.decoder.decodeBitMatrix(y.getBits(),i),u=y.getPoints()}c.getOther()instanceof X0&&c.getOther().applyMirroredCorrection(u);const d=new te(c.getText(),c.getRawBytes(),void 0,u,ce.QR_CODE,void 0),x=c.getByteSegments();x!==null&&d.putMetadata(ye.BYTE_SEGMENTS,x);const v=c.getECLevel();return v!==null&&d.putMetadata(ye.ERROR_CORRECTION_LEVEL,v),c.hasStructuredAppend()&&(d.putMetadata(ye.STRUCTURED_APPEND_SEQUENCE,c.getStructuredAppendSequenceNumber()),d.putMetadata(ye.STRUCTURED_APPEND_PARITY,c.getStructuredAppendParity())),d}reset(){}static extractPureBits(s){const i=s.getTopLeftOnBit(),c=s.getBottomRightOnBit();if(i===null||c===null)throw new J;const u=this.moduleSize(i,s);let d=i[1],x=c[1],v=i[0],y=c[0];if(v>=y||d>=x)throw new J;if(x-d!==y-v&&(y=v+(x-d),y>=s.getWidth()))throw new J;const b=Math.round((y-v+1)/u),I=Math.round((x-d+1)/u);if(b<=0||I<=0)throw new J;if(I!==b)throw new J;const O=Math.floor(u/2);d+=O,v+=O;const j=v+Math.floor((b-1)*u)-y;if(j>0){if(j>O)throw new J;v-=j}const q=d+Math.floor((I-1)*u)-x;if(q>0){if(q>O)throw new J;d-=q}const re=new me(b,I);for(let ae=0;ae<I;ae++){const ue=d+Math.floor(ae*u);for(let we=0;we<b;we++)s.get(v+Math.floor(we*u),ue)&&re.set(we,ae)}return re}static moduleSize(s,i){const c=i.getHeight(),u=i.getWidth();let d=s[0],x=s[1],v=!0,y=0;for(;d<u&&x<c;){if(v!==i.get(d,x)){if(++y===5)break;v=!v}d++,x++}if(d===u||x===c)throw new J;return(d-s[0])/7}}Da.NO_POINTS=new Array;class et{PDF417Common(){}static getBitCountSum(s){return it.sum(s)}static toIntArray(s){if(s==null||!s.length)return et.EMPTY_INT_ARRAY;const i=new Int32Array(s.length);let c=0;for(const u of s)i[c++]=u;return i}static getCodeword(s){const i=k.binarySearch(et.SYMBOL_TABLE,s&262143);return i<0?-1:(et.CODEWORD_TABLE[i]-1)%et.NUMBER_OF_CODEWORDS}}et.NUMBER_OF_CODEWORDS=929,et.MAX_CODEWORDS_IN_BARCODE=et.NUMBER_OF_CODEWORDS-1,et.MIN_ROWS_IN_BARCODE=3,et.MAX_ROWS_IN_BARCODE=90,et.MODULES_IN_CODEWORD=17,et.MODULES_IN_STOP_PATTERN=18,et.BARS_IN_MODULE=8,et.EMPTY_INT_ARRAY=new Int32Array([]),et.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),et.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ux{constructor(s,i){this.bits=s,this.points=i}getBits(){return this.bits}getPoints(){return this.points}}class mt{static detectMultiple(s,i,c){let u=s.getBlackMatrix(),d=mt.detect(c,u);return d.length||(u=u.clone(),u.rotate180(),d=mt.detect(c,u)),new Ux(u,d)}static detect(s,i){const c=new Array;let u=0,d=0,x=!1;for(;u<i.getHeight();){const v=mt.findVertices(i,u,d);if(v[0]==null&&v[3]==null){if(!x)break;x=!1,d=0;for(const y of c)y[1]!=null&&(u=Math.trunc(Math.max(u,y[1].getY()))),y[3]!=null&&(u=Math.max(u,Math.trunc(y[3].getY())));u+=mt.ROW_STEP;continue}if(x=!0,c.push(v),!s)break;v[2]!=null?(d=Math.trunc(v[2].getX()),u=Math.trunc(v[2].getY())):(d=Math.trunc(v[4].getX()),u=Math.trunc(v[4].getY()))}return c}static findVertices(s,i,c){const u=s.getHeight(),d=s.getWidth(),x=new Array(8);return mt.copyToResult(x,mt.findRowsWithPattern(s,u,d,i,c,mt.START_PATTERN),mt.INDEXES_START_PATTERN),x[4]!=null&&(c=Math.trunc(x[4].getX()),i=Math.trunc(x[4].getY())),mt.copyToResult(x,mt.findRowsWithPattern(s,u,d,i,c,mt.STOP_PATTERN),mt.INDEXES_STOP_PATTERN),x}static copyToResult(s,i,c){for(let u=0;u<c.length;u++)s[c[u]]=i[u]}static findRowsWithPattern(s,i,c,u,d,x){const v=new Array(4);let y=!1;const b=new Int32Array(x.length);for(;u<i;u+=mt.ROW_STEP){let O=mt.findGuardPattern(s,d,u,c,!1,x,b);if(O!=null){for(;u>0;){const j=mt.findGuardPattern(s,d,--u,c,!1,x,b);if(j!=null)O=j;else{u++;break}}v[0]=new He(O[0],u),v[1]=new He(O[1],u),y=!0;break}}let I=u+1;if(y){let O=0,j=Int32Array.from([Math.trunc(v[0].getX()),Math.trunc(v[1].getX())]);for(;I<i;I++){const q=mt.findGuardPattern(s,j[0],I,c,!1,x,b);if(q!=null&&Math.abs(j[0]-q[0])<mt.MAX_PATTERN_DRIFT&&Math.abs(j[1]-q[1])<mt.MAX_PATTERN_DRIFT)j=q,O=0;else{if(O>mt.SKIPPED_ROW_COUNT_MAX)break;O++}}I-=O+1,v[2]=new He(j[0],I),v[3]=new He(j[1],I)}return I-u<mt.BARCODE_MIN_HEIGHT&&k.fill(v,null),v}static findGuardPattern(s,i,c,u,d,x,v){k.fillWithin(v,0,v.length,0);let y=i,b=0;for(;s.get(y,c)&&y>0&&b++<mt.MAX_PIXEL_DRIFT;)y--;let I=y,O=0,j=x.length;for(let q=d;I<u;I++)if(s.get(I,c)!==q)v[O]++;else{if(O===j-1){if(mt.patternMatchVariance(v,x,mt.MAX_INDIVIDUAL_VARIANCE)<mt.MAX_AVG_VARIANCE)return new Int32Array([y,I]);y+=v[0]+v[1],_.arraycopy(v,2,v,0,O-1),v[O-1]=0,v[O]=0,O--}else O++;v[O]=1,q=!q}return O===j-1&&mt.patternMatchVariance(v,x,mt.MAX_INDIVIDUAL_VARIANCE)<mt.MAX_AVG_VARIANCE?new Int32Array([y,I-1]):null}static patternMatchVariance(s,i,c){let u=s.length,d=0,x=0;for(let b=0;b<u;b++)d+=s[b],x+=i[b];if(d<x)return 1/0;let v=d/x;c*=v;let y=0;for(let b=0;b<u;b++){let I=s[b],O=i[b]*v,j=I>O?I-O:O-I;if(j>c)return 1/0;y+=j}return y/d}}mt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),mt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),mt.MAX_AVG_VARIANCE=.42,mt.MAX_INDIVIDUAL_VARIANCE=.8,mt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),mt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),mt.MAX_PIXEL_DRIFT=3,mt.MAX_PATTERN_DRIFT=5,mt.SKIPPED_ROW_COUNT_MAX=25,mt.ROW_STEP=5,mt.BARCODE_MIN_HEIGHT=10;class Lr{constructor(s,i){if(i.length===0)throw new w;this.field=s;let c=i.length;if(c>1&&i[0]===0){let u=1;for(;u<c&&i[u]===0;)u++;u===c?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(c-u),_.arraycopy(i,u,this.coefficients,0,this.coefficients.length))}else this.coefficients=i}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(s){return this.coefficients[this.coefficients.length-1-s]}evaluateAt(s){if(s===0)return this.getCoefficient(0);if(s===1){let u=0;for(let d of this.coefficients)u=this.field.add(u,d);return u}let i=this.coefficients[0],c=this.coefficients.length;for(let u=1;u<c;u++)i=this.field.add(this.field.multiply(s,i),this.coefficients[u]);return i}add(s){if(!this.field.equals(s.field))throw new w("ModulusPolys do not have same ModulusGF field");if(this.isZero())return s;if(s.isZero())return this;let i=this.coefficients,c=s.coefficients;if(i.length>c.length){let x=i;i=c,c=x}let u=new Int32Array(c.length),d=c.length-i.length;_.arraycopy(c,0,u,0,d);for(let x=d;x<c.length;x++)u[x]=this.field.add(i[x-d],c[x]);return new Lr(this.field,u)}subtract(s){if(!this.field.equals(s.field))throw new w("ModulusPolys do not have same ModulusGF field");return s.isZero()?this:this.add(s.negative())}multiply(s){return s instanceof Lr?this.multiplyOther(s):this.multiplyScalar(s)}multiplyOther(s){if(!this.field.equals(s.field))throw new w("ModulusPolys do not have same ModulusGF field");if(this.isZero()||s.isZero())return new Lr(this.field,new Int32Array([0]));let i=this.coefficients,c=i.length,u=s.coefficients,d=u.length,x=new Int32Array(c+d-1);for(let v=0;v<c;v++){let y=i[v];for(let b=0;b<d;b++)x[v+b]=this.field.add(x[v+b],this.field.multiply(y,u[b]))}return new Lr(this.field,x)}negative(){let s=this.coefficients.length,i=new Int32Array(s);for(let c=0;c<s;c++)i[c]=this.field.subtract(0,this.coefficients[c]);return new Lr(this.field,i)}multiplyScalar(s){if(s===0)return new Lr(this.field,new Int32Array([0]));if(s===1)return this;let i=this.coefficients.length,c=new Int32Array(i);for(let u=0;u<i;u++)c[u]=this.field.multiply(this.coefficients[u],s);return new Lr(this.field,c)}multiplyByMonomial(s,i){if(s<0)throw new w;if(i===0)return new Lr(this.field,new Int32Array([0]));let c=this.coefficients.length,u=new Int32Array(c+s);for(let d=0;d<c;d++)u[d]=this.field.multiply(this.coefficients[d],i);return new Lr(this.field,u)}toString(){let s=new ne;for(let i=this.getDegree();i>=0;i--){let c=this.getCoefficient(i);c!==0&&(c<0?(s.append(" - "),c=-c):s.length()>0&&s.append(" + "),(i===0||c!==1)&&s.append(c),i!==0&&(i===1?s.append("x"):(s.append("x^"),s.append(i))))}return s.toString()}}class zx{add(s,i){return(s+i)%this.modulus}subtract(s,i){return(this.modulus+s-i)%this.modulus}exp(s){return this.expTable[s]}log(s){if(s===0)throw new w;return this.logTable[s]}inverse(s){if(s===0)throw new ee;return this.expTable[this.modulus-this.logTable[s]-1]}multiply(s,i){return s===0||i===0?0:this.expTable[(this.logTable[s]+this.logTable[i])%(this.modulus-1)]}getSize(){return this.modulus}equals(s){return s===this}}class Mc extends zx{constructor(s,i){super(),this.modulus=s,this.expTable=new Int32Array(s),this.logTable=new Int32Array(s);let c=1;for(let u=0;u<s;u++)this.expTable[u]=c,c=c*i%s;for(let u=0;u<s-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new Lr(this,new Int32Array([0])),this.one=new Lr(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(s,i){if(s<0)throw new w;if(i===0)return this.zero;let c=new Int32Array(s+1);return c[0]=i,new Lr(this,c)}}Mc.PDF417_GF=new Mc(et.NUMBER_OF_CODEWORDS,3);class Y0{constructor(){this.field=Mc.PDF417_GF}decode(s,i,c){let u=new Lr(this.field,s),d=new Int32Array(i),x=!1;for(let re=i;re>0;re--){let ae=u.evaluateAt(this.field.exp(re));d[i-re]=ae,ae!==0&&(x=!0)}if(!x)return 0;let v=this.field.getOne();if(c!=null)for(const re of c){let ae=this.field.exp(s.length-1-re),ue=new Lr(this.field,new Int32Array([this.field.subtract(0,ae),1]));v=v.multiply(ue)}let y=new Lr(this.field,d),b=this.runEuclideanAlgorithm(this.field.buildMonomial(i,1),y,i),I=b[0],O=b[1],j=this.findErrorLocations(I),q=this.findErrorMagnitudes(O,I,j);for(let re=0;re<j.length;re++){let ae=s.length-1-this.field.log(j[re]);if(ae<0)throw A.getChecksumInstance();s[ae]=this.field.subtract(s[ae],q[re])}return j.length}runEuclideanAlgorithm(s,i,c){if(s.getDegree()<i.getDegree()){let j=s;s=i,i=j}let u=s,d=i,x=this.field.getZero(),v=this.field.getOne();for(;d.getDegree()>=Math.round(c/2);){let j=u,q=x;if(u=d,x=v,u.isZero())throw A.getChecksumInstance();d=j;let re=this.field.getZero(),ae=u.getCoefficient(u.getDegree()),ue=this.field.inverse(ae);for(;d.getDegree()>=u.getDegree()&&!d.isZero();){let we=d.getDegree()-u.getDegree(),Me=this.field.multiply(d.getCoefficient(d.getDegree()),ue);re=re.add(this.field.buildMonomial(we,Me)),d=d.subtract(u.multiplyByMonomial(we,Me))}v=re.multiply(x).subtract(q).negative()}let y=v.getCoefficient(0);if(y===0)throw A.getChecksumInstance();let b=this.field.inverse(y),I=v.multiply(b),O=d.multiply(b);return[I,O]}findErrorLocations(s){let i=s.getDegree(),c=new Int32Array(i),u=0;for(let d=1;d<this.field.getSize()&&u<i;d++)s.evaluateAt(d)===0&&(c[u]=this.field.inverse(d),u++);if(u!==i)throw A.getChecksumInstance();return c}findErrorMagnitudes(s,i,c){let u=i.getDegree(),d=new Int32Array(u);for(let b=1;b<=u;b++)d[u-b]=this.field.multiply(b,i.getCoefficient(b));let x=new Lr(this.field,d),v=c.length,y=new Int32Array(v);for(let b=0;b<v;b++){let I=this.field.inverse(c[b]),O=this.field.subtract(0,s.evaluateAt(I)),j=this.field.inverse(x.evaluateAt(I));y[b]=this.field.multiply(O,j)}return y}}class ss{constructor(s,i,c,u,d){s instanceof ss?this.constructor_2(s):this.constructor_1(s,i,c,u,d)}constructor_1(s,i,c,u,d){const x=i==null||c==null,v=u==null||d==null;if(x&&v)throw new J;x?(i=new He(0,u.getY()),c=new He(0,d.getY())):v&&(u=new He(s.getWidth()-1,i.getY()),d=new He(s.getWidth()-1,c.getY())),this.image=s,this.topLeft=i,this.bottomLeft=c,this.topRight=u,this.bottomRight=d,this.minX=Math.trunc(Math.min(i.getX(),c.getX())),this.maxX=Math.trunc(Math.max(u.getX(),d.getX())),this.minY=Math.trunc(Math.min(i.getY(),u.getY())),this.maxY=Math.trunc(Math.max(c.getY(),d.getY()))}constructor_2(s){this.image=s.image,this.topLeft=s.getTopLeft(),this.bottomLeft=s.getBottomLeft(),this.topRight=s.getTopRight(),this.bottomRight=s.getBottomRight(),this.minX=s.getMinX(),this.maxX=s.getMaxX(),this.minY=s.getMinY(),this.maxY=s.getMaxY()}static merge(s,i){return s==null?i:i==null?s:new ss(s.image,s.topLeft,s.bottomLeft,i.topRight,i.bottomRight)}addMissingRows(s,i,c){let u=this.topLeft,d=this.bottomLeft,x=this.topRight,v=this.bottomRight;if(s>0){let y=c?this.topLeft:this.topRight,b=Math.trunc(y.getY()-s);b<0&&(b=0);let I=new He(y.getX(),b);c?u=I:x=I}if(i>0){let y=c?this.bottomLeft:this.bottomRight,b=Math.trunc(y.getY()+i);b>=this.image.getHeight()&&(b=this.image.getHeight()-1);let I=new He(y.getX(),b);c?d=I:v=I}return new ss(this.image,u,d,x,v)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Hx{constructor(s,i,c,u){this.columnCount=s,this.errorCorrectionLevel=u,this.rowCountUpperPart=i,this.rowCountLowerPart=c,this.rowCount=i+c}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class hi{constructor(){this.buffer=""}static form(s,i){let c=-1;function u(x,v,y,b,I,O){if(x==="%%")return"%";if(i[++c]===void 0)return;x=b?parseInt(b.substr(1)):void 0;let j=I?parseInt(I.substr(1)):void 0,q;switch(O){case"s":q=i[c];break;case"c":q=i[c][0];break;case"f":q=parseFloat(i[c]).toFixed(x);break;case"p":q=parseFloat(i[c]).toPrecision(x);break;case"e":q=parseFloat(i[c]).toExponential(x);break;case"x":q=parseInt(i[c]).toString(j||16);break;case"d":q=parseFloat(parseInt(i[c],j||10).toPrecision(x)).toFixed(0);break}q=typeof q=="object"?JSON.stringify(q):(+q).toString(j);let re=parseInt(y),ae=y&&y[0]+""=="0"?"0":" ";for(;q.length<re;)q=v!==void 0?q+ae:ae+q;return q}let d=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return s.replace(d,u)}format(s,...i){this.buffer+=hi.form(s,i)}toString(){return this.buffer}}class xi{constructor(s){this.boundingBox=new ss(s),this.codewords=new Array(s.getMaxY()-s.getMinY()+1)}getCodewordNearby(s){let i=this.getCodeword(s);if(i!=null)return i;for(let c=1;c<xi.MAX_NEARBY_DISTANCE;c++){let u=this.imageRowToCodewordIndex(s)-c;if(u>=0&&(i=this.codewords[u],i!=null)||(u=this.imageRowToCodewordIndex(s)+c,u<this.codewords.length&&(i=this.codewords[u],i!=null)))return i}return null}imageRowToCodewordIndex(s){return s-this.boundingBox.getMinY()}setCodeword(s,i){this.codewords[this.imageRowToCodewordIndex(s)]=i}getCodeword(s){return this.codewords[this.imageRowToCodewordIndex(s)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const s=new hi;let i=0;for(const c of this.codewords){if(c==null){s.format("%3d:    |   %n",i++);continue}s.format("%3d: %3d|%3d%n",i++,c.getRowNumber(),c.getValue())}return s.toString()}}xi.MAX_NEARBY_DISTANCE=5;class mi{constructor(){this.values=new Map}setValue(s){s=Math.trunc(s);let i=this.values.get(s);i==null&&(i=0),i++,this.values.set(s,i)}getValue(){let s=-1,i=new Array;for(const[c,u]of this.values.entries()){const d={getKey:()=>c,getValue:()=>u};d.getValue()>s?(s=d.getValue(),i=[],i.push(d.getKey())):d.getValue()===s&&i.push(d.getKey())}return et.toIntArray(i)}getConfidence(s){return this.values.get(s)}}class Z0 extends xi{constructor(s,i){super(s),this._isLeft=i}setRowNumbers(){for(let s of this.getCodewords())s?.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(s){let i=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(i,s);let c=this.getBoundingBox(),u=this._isLeft?c.getTopLeft():c.getTopRight(),d=this._isLeft?c.getBottomLeft():c.getBottomRight(),x=this.imageRowToCodewordIndex(Math.trunc(u.getY())),v=this.imageRowToCodewordIndex(Math.trunc(d.getY())),y=-1,b=1,I=0;for(let O=x;O<v;O++){if(i[O]==null)continue;let j=i[O],q=j.getRowNumber()-y;if(q===0)I++;else if(q===1)b=Math.max(b,I),I=1,y=j.getRowNumber();else if(q<0||j.getRowNumber()>=s.getRowCount()||q>O)i[O]=null;else{let re;b>2?re=(b-2)*q:re=q;let ae=re>=O;for(let ue=1;ue<=re&&!ae;ue++)ae=i[O-ue]!=null;ae?i[O]=null:(y=j.getRowNumber(),I=1)}}}getRowHeights(){let s=this.getBarcodeMetadata();if(s==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(s);let i=new Int32Array(s.getRowCount());for(let c of this.getCodewords())if(c!=null){let u=c.getRowNumber();if(u>=i.length)continue;i[u]++}return i}adjustIncompleteIndicatorColumnRowNumbers(s){let i=this.getBoundingBox(),c=this._isLeft?i.getTopLeft():i.getTopRight(),u=this._isLeft?i.getBottomLeft():i.getBottomRight(),d=this.imageRowToCodewordIndex(Math.trunc(c.getY())),x=this.imageRowToCodewordIndex(Math.trunc(u.getY())),v=this.getCodewords(),y=-1;for(let b=d;b<x;b++){if(v[b]==null)continue;let I=v[b];I.setRowNumberAsRowIndicatorColumn();let O=I.getRowNumber()-y;O===0||(O===1?y=I.getRowNumber():I.getRowNumber()>=s.getRowCount()?v[b]=null:y=I.getRowNumber())}}getBarcodeMetadata(){let s=this.getCodewords(),i=new mi,c=new mi,u=new mi,d=new mi;for(let v of s){if(v==null)continue;v.setRowNumberAsRowIndicatorColumn();let y=v.getValue()%30,b=v.getRowNumber();switch(this._isLeft||(b+=2),b%3){case 0:c.setValue(y*3+1);break;case 1:d.setValue(y/3),u.setValue(y%3);break;case 2:i.setValue(y+1);break}}if(i.getValue().length===0||c.getValue().length===0||u.getValue().length===0||d.getValue().length===0||i.getValue()[0]<1||c.getValue()[0]+u.getValue()[0]<et.MIN_ROWS_IN_BARCODE||c.getValue()[0]+u.getValue()[0]>et.MAX_ROWS_IN_BARCODE)return null;let x=new Hx(i.getValue()[0],c.getValue()[0],u.getValue()[0],d.getValue()[0]);return this.removeIncorrectCodewords(s,x),x}removeIncorrectCodewords(s,i){for(let c=0;c<s.length;c++){let u=s[c];if(s[c]==null)continue;let d=u.getValue()%30,x=u.getRowNumber();if(x>i.getRowCount()){s[c]=null;continue}switch(this._isLeft||(x+=2),x%3){case 0:d*3+1!==i.getRowCountUpperPart()&&(s[c]=null);break;case 1:(Math.trunc(d/3)!==i.getErrorCorrectionLevel()||d%3!==i.getRowCountLowerPart())&&(s[c]=null);break;case 2:d+1!==i.getColumnCount()&&(s[c]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class gi{constructor(s,i){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=s,this.barcodeColumnCount=s.getColumnCount(),this.boundingBox=i,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let s=et.MAX_CODEWORDS_IN_BARCODE,i;do i=s,s=this.adjustRowNumbersAndGetCount();while(s>0&&s<i);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(s){s?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let s=this.adjustRowNumbersByRow();if(s===0)return 0;for(let i=1;i<this.barcodeColumnCount+1;i++){let c=this.detectionResultColumns[i].getCodewords();for(let u=0;u<c.length;u++)c[u]!=null&&(c[u].hasValidRowNumber()||this.adjustRowNumbers(i,u,c))}return s}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let s=this.detectionResultColumns[0].getCodewords(),i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<s.length;c++)if(s[c]!=null&&i[c]!=null&&s[c].getRowNumber()===i[c].getRowNumber())for(let u=1;u<=this.barcodeColumnCount;u++){let d=this.detectionResultColumns[u].getCodewords()[c];d!=null&&(d.setRowNumber(s[c].getRowNumber()),d.hasValidRowNumber()||(this.detectionResultColumns[u].getCodewords()[c]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let s=0,i=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let c=0;c<i.length;c++){if(i[c]==null)continue;let u=i[c].getRowNumber(),d=0;for(let x=this.barcodeColumnCount+1;x>0&&d<this.ADJUST_ROW_NUMBER_SKIP;x--){let v=this.detectionResultColumns[x].getCodewords()[c];v!=null&&(d=gi.adjustRowNumberIfValid(u,d,v),v.hasValidRowNumber()||s++)}}return s}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let s=0,i=this.detectionResultColumns[0].getCodewords();for(let c=0;c<i.length;c++){if(i[c]==null)continue;let u=i[c].getRowNumber(),d=0;for(let x=1;x<this.barcodeColumnCount+1&&d<this.ADJUST_ROW_NUMBER_SKIP;x++){let v=this.detectionResultColumns[x].getCodewords()[c];v!=null&&(d=gi.adjustRowNumberIfValid(u,d,v),v.hasValidRowNumber()||s++)}}return s}static adjustRowNumberIfValid(s,i,c){return c==null||c.hasValidRowNumber()||(c.isValidRowNumber(s)?(c.setRowNumber(s),i=0):++i),i}adjustRowNumbers(s,i,c){if(!this.detectionResultColumns[s-1])return;let u=c[i],d=this.detectionResultColumns[s-1].getCodewords(),x=d;this.detectionResultColumns[s+1]!=null&&(x=this.detectionResultColumns[s+1].getCodewords());let v=new Array(14);v[2]=d[i],v[3]=x[i],i>0&&(v[0]=c[i-1],v[4]=d[i-1],v[5]=x[i-1]),i>1&&(v[8]=c[i-2],v[10]=d[i-2],v[11]=x[i-2]),i<c.length-1&&(v[1]=c[i+1],v[6]=d[i+1],v[7]=x[i+1]),i<c.length-2&&(v[9]=c[i+2],v[12]=d[i+2],v[13]=x[i+2]);for(let y of v)if(gi.adjustRowNumber(u,y))return}static adjustRowNumber(s,i){return i==null?!1:i.hasValidRowNumber()&&i.getBucket()===s.getBucket()?(s.setRowNumber(i.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(s){this.boundingBox=s}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(s,i){this.detectionResultColumns[s]=i}getDetectionResultColumn(s){return this.detectionResultColumns[s]}toString(){let s=this.detectionResultColumns[0];s==null&&(s=this.detectionResultColumns[this.barcodeColumnCount+1]);let i=new hi;for(let c=0;c<s.getCodewords().length;c++){i.format("CW %3d:",c);for(let u=0;u<this.barcodeColumnCount+2;u++){if(this.detectionResultColumns[u]==null){i.format("    |   ");continue}let d=this.detectionResultColumns[u].getCodewords()[c];if(d==null){i.format("    |   ");continue}i.format(" %3d|%3d",d.getRowNumber(),d.getValue())}i.format("%n")}return i.toString()}}class pi{constructor(s,i,c,u){this.rowNumber=pi.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(s),this.endX=Math.trunc(i),this.bucket=Math.trunc(c),this.value=Math.trunc(u)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(s){return s!==pi.BARCODE_ROW_UNKNOWN&&this.bucket===s%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(s){this.rowNumber=s}toString(){return this.rowNumber+"|"+this.value}}pi.BARCODE_ROW_UNKNOWN=-1;class sn{static initialize(){for(let s=0;s<et.SYMBOL_TABLE.length;s++){let i=et.SYMBOL_TABLE[s],c=i&1;for(let u=0;u<et.BARS_IN_MODULE;u++){let d=0;for(;(i&1)===c;)d+=1,i>>=1;c=i&1,sn.RATIOS_TABLE[s]||(sn.RATIOS_TABLE[s]=new Array(et.BARS_IN_MODULE)),sn.RATIOS_TABLE[s][et.BARS_IN_MODULE-u-1]=Math.fround(d/et.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(s){let i=sn.getDecodedCodewordValue(sn.sampleBitCounts(s));return i!==-1?i:sn.getClosestDecodedValue(s)}static sampleBitCounts(s){let i=it.sum(s),c=new Int32Array(et.BARS_IN_MODULE),u=0,d=0;for(let x=0;x<et.MODULES_IN_CODEWORD;x++){let v=i/(2*et.MODULES_IN_CODEWORD)+x*i/et.MODULES_IN_CODEWORD;d+s[u]<=v&&(d+=s[u],u++),c[u]++}return c}static getDecodedCodewordValue(s){let i=sn.getBitValue(s);return et.getCodeword(i)===-1?-1:i}static getBitValue(s){let i=0;for(let c=0;c<s.length;c++)for(let u=0;u<s[c];u++)i=i<<1|(c%2===0?1:0);return Math.trunc(i)}static getClosestDecodedValue(s){let i=it.sum(s),c=new Array(et.BARS_IN_MODULE);if(i>1)for(let x=0;x<c.length;x++)c[x]=Math.fround(s[x]/i);let u=Jr.MAX_VALUE,d=-1;this.bSymbolTableReady||sn.initialize();for(let x=0;x<sn.RATIOS_TABLE.length;x++){let v=0,y=sn.RATIOS_TABLE[x];for(let b=0;b<et.BARS_IN_MODULE;b++){let I=Math.fround(y[b]-c[b]);if(v+=Math.fround(I*I),v>=u)break}v<u&&(u=v,d=et.SYMBOL_TABLE[x])}return d}}sn.bSymbolTableReady=!1,sn.RATIOS_TABLE=new Array(et.SYMBOL_TABLE.length).map(D=>new Array(et.BARS_IN_MODULE));class $0{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(s){this.segmentIndex=s}getFileId(){return this.fileId}setFileId(s){this.fileId=s}getOptionalData(){return this.optionalData}setOptionalData(s){this.optionalData=s}isLastSegment(){return this.lastSegment}setLastSegment(s){this.lastSegment=s}getSegmentCount(){return this.segmentCount}setSegmentCount(s){this.segmentCount=s}getSender(){return this.sender||null}setSender(s){this.sender=s}getAddressee(){return this.addressee||null}setAddressee(s){this.addressee=s}getFileName(){return this.fileName}setFileName(s){this.fileName=s}getFileSize(){return this.fileSize}setFileSize(s){this.fileSize=s}getChecksum(){return this.checksum}setChecksum(s){this.checksum=s}getTimestamp(){return this.timestamp}setTimestamp(s){this.timestamp=s}}class q0{static parseLong(s,i=void 0){return parseInt(s,i)}}class K0 extends m{}K0.kind="NullPointerException";class Wx{writeBytes(s){this.writeBytesOffset(s,0,s.length)}writeBytesOffset(s,i,c){if(s==null)throw new K0;if(i<0||i>s.length||c<0||i+c>s.length||i+c<0)throw new C;if(c===0)return;for(let u=0;u<c;u++)this.write(s[i+u])}flush(){}close(){}}class Vx extends m{}class Gx extends Wx{constructor(s=32){if(super(),this.count=0,s<0)throw new w("Negative initial size: "+s);this.buf=new Uint8Array(s)}ensureCapacity(s){s-this.buf.length>0&&this.grow(s)}grow(s){let c=this.buf.length<<1;if(c-s<0&&(c=s),c<0){if(s<0)throw new Vx;c=N.MAX_VALUE}this.buf=k.copyOfUint8Array(this.buf,c)}write(s){this.ensureCapacity(this.count+1),this.buf[this.count]=s,this.count+=1}writeBytesOffset(s,i,c){if(i<0||i>s.length||c<0||i+c-s.length>0)throw new C;this.ensureCapacity(this.count+c),_.arraycopy(s,i,this.buf,this.count,c),this.count+=c}writeTo(s){s.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return k.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(s){return s?typeof s=="string"?this.toString_string(s):this.toString_number(s):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(s){return new String(this.buf).toString()}toString_number(s){return new String(this.buf).toString()}close(){}}var Lt;(function(D){D[D.ALPHA=0]="ALPHA",D[D.LOWER=1]="LOWER",D[D.MIXED=2]="MIXED",D[D.PUNCT=3]="PUNCT",D[D.ALPHA_SHIFT=4]="ALPHA_SHIFT",D[D.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Lt||(Lt={}));function Q0(){if(typeof window<"u")return window.BigInt||null;if(typeof yi<"u")return yi.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let go;function Oa(D){if(typeof go>"u"&&(go=Q0()),go===null)throw new Error("BigInt is not supported!");return go(D)}function Xx(){let D=[];D[0]=Oa(1);let s=Oa(900);D[1]=s;for(let i=2;i<16;i++)D[i]=D[i-1]*s;return D}class ve{static decode(s,i){let c=new ne(""),u=U.ISO8859_1;c.enableDecoding(u);let d=1,x=s[d++],v=new $0;for(;d<s[0];){switch(x){case ve.TEXT_COMPACTION_MODE_LATCH:d=ve.textCompaction(s,d,c);break;case ve.BYTE_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH_6:d=ve.byteCompaction(x,s,u,d,c);break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:c.append(s[d++]);break;case ve.NUMERIC_COMPACTION_MODE_LATCH:d=ve.numericCompaction(s,d,c);break;case ve.ECI_CHARSET:U.getCharacterSetECIByValue(s[d++]);break;case ve.ECI_GENERAL_PURPOSE:d+=2;break;case ve.ECI_USER_DEFINED:d++;break;case ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:d=ve.decodeMacroBlock(s,d,v);break;case ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ve.MACRO_PDF417_TERMINATOR:throw new R;default:d--,d=ve.textCompaction(s,d,c);break}if(d<s.length)x=s[d++];else throw R.getFormatInstance()}if(c.length()===0)throw R.getFormatInstance();let y=new Se(null,c.toString(),null,i);return y.setOther(v),y}static decodeMacroBlock(s,i,c){if(i+ve.NUMBER_OF_SEQUENCE_CODEWORDS>s[0])throw R.getFormatInstance();let u=new Int32Array(ve.NUMBER_OF_SEQUENCE_CODEWORDS);for(let v=0;v<ve.NUMBER_OF_SEQUENCE_CODEWORDS;v++,i++)u[v]=s[i];c.setSegmentIndex(N.parseInt(ve.decodeBase900toBase10(u,ve.NUMBER_OF_SEQUENCE_CODEWORDS)));let d=new ne;i=ve.textCompaction(s,i,d),c.setFileId(d.toString());let x=-1;for(s[i]===ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(x=i+1);i<s[0];)switch(s[i]){case ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(i++,s[i]){case ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let v=new ne;i=ve.textCompaction(s,i+1,v),c.setFileName(v.toString());break;case ve.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let y=new ne;i=ve.textCompaction(s,i+1,y),c.setSender(y.toString());break;case ve.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let b=new ne;i=ve.textCompaction(s,i+1,b),c.setAddressee(b.toString());break;case ve.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let I=new ne;i=ve.numericCompaction(s,i+1,I),c.setSegmentCount(N.parseInt(I.toString()));break;case ve.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let O=new ne;i=ve.numericCompaction(s,i+1,O),c.setTimestamp(q0.parseLong(O.toString()));break;case ve.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let j=new ne;i=ve.numericCompaction(s,i+1,j),c.setChecksum(N.parseInt(j.toString()));break;case ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let q=new ne;i=ve.numericCompaction(s,i+1,q),c.setFileSize(q0.parseLong(q.toString()));break;default:throw R.getFormatInstance()}break;case ve.MACRO_PDF417_TERMINATOR:i++,c.setLastSegment(!0);break;default:throw R.getFormatInstance()}if(x!==-1){let v=i-x;c.isLastSegment()&&v--,c.setOptionalData(k.copyOfRange(s,x,x+v))}return i}static textCompaction(s,i,c){let u=new Int32Array((s[0]-i)*2),d=new Int32Array((s[0]-i)*2),x=0,v=!1;for(;i<s[0]&&!v;){let y=s[i++];if(y<ve.TEXT_COMPACTION_MODE_LATCH)u[x]=y/30,u[x+1]=y%30,x+=2;else switch(y){case ve.TEXT_COMPACTION_MODE_LATCH:u[x++]=ve.TEXT_COMPACTION_MODE_LATCH;break;case ve.BYTE_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH_6:case ve.NUMERIC_COMPACTION_MODE_LATCH:case ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ve.MACRO_PDF417_TERMINATOR:i--,v=!0;break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u[x]=ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,y=s[i++],d[x]=y,x++;break}}return ve.decodeTextCompaction(u,d,x,c),i}static decodeTextCompaction(s,i,c,u){let d=Lt.ALPHA,x=Lt.ALPHA,v=0;for(;v<c;){let y=s[v],b="";switch(d){case Lt.ALPHA:if(y<26)b=String.fromCharCode(65+y);else switch(y){case 26:b=" ";break;case ve.LL:d=Lt.LOWER;break;case ve.ML:d=Lt.MIXED;break;case ve.PS:x=d,d=Lt.PUNCT_SHIFT;break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(i[v]);break;case ve.TEXT_COMPACTION_MODE_LATCH:d=Lt.ALPHA;break}break;case Lt.LOWER:if(y<26)b=String.fromCharCode(97+y);else switch(y){case 26:b=" ";break;case ve.AS:x=d,d=Lt.ALPHA_SHIFT;break;case ve.ML:d=Lt.MIXED;break;case ve.PS:x=d,d=Lt.PUNCT_SHIFT;break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(i[v]);break;case ve.TEXT_COMPACTION_MODE_LATCH:d=Lt.ALPHA;break}break;case Lt.MIXED:if(y<ve.PL)b=ve.MIXED_CHARS[y];else switch(y){case ve.PL:d=Lt.PUNCT;break;case 26:b=" ";break;case ve.LL:d=Lt.LOWER;break;case ve.AL:d=Lt.ALPHA;break;case ve.PS:x=d,d=Lt.PUNCT_SHIFT;break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(i[v]);break;case ve.TEXT_COMPACTION_MODE_LATCH:d=Lt.ALPHA;break}break;case Lt.PUNCT:if(y<ve.PAL)b=ve.PUNCT_CHARS[y];else switch(y){case ve.PAL:d=Lt.ALPHA;break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(i[v]);break;case ve.TEXT_COMPACTION_MODE_LATCH:d=Lt.ALPHA;break}break;case Lt.ALPHA_SHIFT:if(d=x,y<26)b=String.fromCharCode(65+y);else switch(y){case 26:b=" ";break;case ve.TEXT_COMPACTION_MODE_LATCH:d=Lt.ALPHA;break}break;case Lt.PUNCT_SHIFT:if(d=x,y<ve.PAL)b=ve.PUNCT_CHARS[y];else switch(y){case ve.PAL:d=Lt.ALPHA;break;case ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(i[v]);break;case ve.TEXT_COMPACTION_MODE_LATCH:d=Lt.ALPHA;break}break}b!==""&&u.append(b),v++}}static byteCompaction(s,i,c,u,d){let x=new Gx,v=0,y=0,b=!1;switch(s){case ve.BYTE_COMPACTION_MODE_LATCH:let I=new Int32Array(6),O=i[u++];for(;u<i[0]&&!b;)switch(I[v++]=O,y=900*y+O,O=i[u++],O){case ve.TEXT_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH:case ve.NUMERIC_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH_6:case ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ve.MACRO_PDF417_TERMINATOR:u--,b=!0;break;default:if(v%5===0&&v>0){for(let j=0;j<6;++j)x.write(Number(Oa(y)>>Oa(8*(5-j))));y=0,v=0}break}u===i[0]&&O<ve.TEXT_COMPACTION_MODE_LATCH&&(I[v++]=O);for(let j=0;j<v;j++)x.write(I[j]);break;case ve.BYTE_COMPACTION_MODE_LATCH_6:for(;u<i[0]&&!b;){let j=i[u++];if(j<ve.TEXT_COMPACTION_MODE_LATCH)v++,y=900*y+j;else switch(j){case ve.TEXT_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH:case ve.NUMERIC_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH_6:case ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ve.MACRO_PDF417_TERMINATOR:u--,b=!0;break}if(v%5===0&&v>0){for(let q=0;q<6;++q)x.write(Number(Oa(y)>>Oa(8*(5-q))));y=0,v=0}}break}return d.append(M.decode(x.toByteArray(),c)),u}static numericCompaction(s,i,c){let u=0,d=!1,x=new Int32Array(ve.MAX_NUMERIC_CODEWORDS);for(;i<s[0]&&!d;){let v=s[i++];if(i===s[0]&&(d=!0),v<ve.TEXT_COMPACTION_MODE_LATCH)x[u]=v,u++;else switch(v){case ve.TEXT_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH:case ve.BYTE_COMPACTION_MODE_LATCH_6:case ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ve.MACRO_PDF417_TERMINATOR:i--,d=!0;break}(u%ve.MAX_NUMERIC_CODEWORDS===0||v===ve.NUMERIC_COMPACTION_MODE_LATCH||d)&&u>0&&(c.append(ve.decodeBase900toBase10(x,u)),u=0)}return i}static decodeBase900toBase10(s,i){let c=Oa(0);for(let d=0;d<i;d++)c+=ve.EXP900[i-d-1]*Oa(s[d]);let u=c.toString();if(u.charAt(0)!=="1")throw new R;return u.substring(1)}}ve.TEXT_COMPACTION_MODE_LATCH=900,ve.BYTE_COMPACTION_MODE_LATCH=901,ve.NUMERIC_COMPACTION_MODE_LATCH=902,ve.BYTE_COMPACTION_MODE_LATCH_6=924,ve.ECI_USER_DEFINED=925,ve.ECI_GENERAL_PURPOSE=926,ve.ECI_CHARSET=927,ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ve.MACRO_PDF417_TERMINATOR=922,ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ve.MAX_NUMERIC_CODEWORDS=15,ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ve.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ve.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ve.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ve.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ve.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ve.PL=25,ve.LL=27,ve.AS=27,ve.ML=28,ve.AL=28,ve.PS=29,ve.PAL=29,ve.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ve.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ve.EXP900=Q0()?Xx():[],ve.NUMBER_OF_SEQUENCE_CODEWORDS=2;class wt{constructor(){}static decode(s,i,c,u,d,x,v){let y=new ss(s,i,c,u,d),b=null,I=null,O;for(let re=!0;;re=!1){if(i!=null&&(b=wt.getRowIndicatorColumn(s,y,i,!0,x,v)),u!=null&&(I=wt.getRowIndicatorColumn(s,y,u,!1,x,v)),O=wt.merge(b,I),O==null)throw J.getNotFoundInstance();let ae=O.getBoundingBox();if(re&&ae!=null&&(ae.getMinY()<y.getMinY()||ae.getMaxY()>y.getMaxY()))y=ae;else break}O.setBoundingBox(y);let j=O.getBarcodeColumnCount()+1;O.setDetectionResultColumn(0,b),O.setDetectionResultColumn(j,I);let q=b!=null;for(let re=1;re<=j;re++){let ae=q?re:j-re;if(O.getDetectionResultColumn(ae)!==void 0)continue;let ue;ae===0||ae===j?ue=new Z0(y,ae===0):ue=new xi(y),O.setDetectionResultColumn(ae,ue);let we=-1,Me=we;for(let je=y.getMinY();je<=y.getMaxY();je++){if(we=wt.getStartColumn(O,ae,je,q),we<0||we>y.getMaxX()){if(Me===-1)continue;we=Me}let Fe=wt.detectCodeword(s,y.getMinX(),y.getMaxX(),q,we,je,x,v);Fe!=null&&(ue.setCodeword(je,Fe),Me=we,x=Math.min(x,Fe.getWidth()),v=Math.max(v,Fe.getWidth()))}}return wt.createDecoderResult(O)}static merge(s,i){if(s==null&&i==null)return null;let c=wt.getBarcodeMetadata(s,i);if(c==null)return null;let u=ss.merge(wt.adjustBoundingBox(s),wt.adjustBoundingBox(i));return new gi(c,u)}static adjustBoundingBox(s){if(s==null)return null;let i=s.getRowHeights();if(i==null)return null;let c=wt.getMax(i),u=0;for(let v of i)if(u+=c-v,v>0)break;let d=s.getCodewords();for(let v=0;u>0&&d[v]==null;v++)u--;let x=0;for(let v=i.length-1;v>=0&&(x+=c-i[v],!(i[v]>0));v--);for(let v=d.length-1;x>0&&d[v]==null;v--)x--;return s.getBoundingBox().addMissingRows(u,x,s.isLeft())}static getMax(s){let i=-1;for(let c of s)i=Math.max(i,c);return i}static getBarcodeMetadata(s,i){let c;if(s==null||(c=s.getBarcodeMetadata())==null)return i==null?null:i.getBarcodeMetadata();let u;return i==null||(u=i.getBarcodeMetadata())==null?c:c.getColumnCount()!==u.getColumnCount()&&c.getErrorCorrectionLevel()!==u.getErrorCorrectionLevel()&&c.getRowCount()!==u.getRowCount()?null:c}static getRowIndicatorColumn(s,i,c,u,d,x){let v=new Z0(i,u);for(let y=0;y<2;y++){let b=y===0?1:-1,I=Math.trunc(Math.trunc(c.getX()));for(let O=Math.trunc(Math.trunc(c.getY()));O<=i.getMaxY()&&O>=i.getMinY();O+=b){let j=wt.detectCodeword(s,0,s.getWidth(),u,I,O,d,x);j!=null&&(v.setCodeword(O,j),u?I=j.getStartX():I=j.getEndX())}}return v}static adjustCodewordCount(s,i){let c=i[0][1],u=c.getValue(),d=s.getBarcodeColumnCount()*s.getBarcodeRowCount()-wt.getNumberOfECCodeWords(s.getBarcodeECLevel());if(u.length===0){if(d<1||d>et.MAX_CODEWORDS_IN_BARCODE)throw J.getNotFoundInstance();c.setValue(d)}else u[0]!==d&&c.setValue(d)}static createDecoderResult(s){let i=wt.createBarcodeMatrix(s);wt.adjustCodewordCount(s,i);let c=new Array,u=new Int32Array(s.getBarcodeRowCount()*s.getBarcodeColumnCount()),d=[],x=new Array;for(let y=0;y<s.getBarcodeRowCount();y++)for(let b=0;b<s.getBarcodeColumnCount();b++){let I=i[y][b+1].getValue(),O=y*s.getBarcodeColumnCount()+b;I.length===0?c.push(O):I.length===1?u[O]=I[0]:(x.push(O),d.push(I))}let v=new Array(d.length);for(let y=0;y<v.length;y++)v[y]=d[y];return wt.createDecoderResultFromAmbiguousValues(s.getBarcodeECLevel(),u,et.toIntArray(c),et.toIntArray(x),v)}static createDecoderResultFromAmbiguousValues(s,i,c,u,d){let x=new Int32Array(u.length),v=100;for(;v-- >0;){for(let y=0;y<x.length;y++)i[u[y]]=d[y][x[y]];try{return wt.decodeCodewords(i,s,c)}catch(y){if(!(y instanceof A))throw y}if(x.length===0)throw A.getChecksumInstance();for(let y=0;y<x.length;y++)if(x[y]<d[y].length-1){x[y]++;break}else if(x[y]=0,y===x.length-1)throw A.getChecksumInstance()}throw A.getChecksumInstance()}static createBarcodeMatrix(s){let i=Array.from({length:s.getBarcodeRowCount()},()=>new Array(s.getBarcodeColumnCount()+2));for(let u=0;u<i.length;u++)for(let d=0;d<i[u].length;d++)i[u][d]=new mi;let c=0;for(let u of s.getDetectionResultColumns()){if(u!=null){for(let d of u.getCodewords())if(d!=null){let x=d.getRowNumber();if(x>=0){if(x>=i.length)continue;i[x][c].setValue(d.getValue())}}}c++}return i}static isValidBarcodeColumn(s,i){return i>=0&&i<=s.getBarcodeColumnCount()+1}static getStartColumn(s,i,c,u){let d=u?1:-1,x=null;if(wt.isValidBarcodeColumn(s,i-d)&&(x=s.getDetectionResultColumn(i-d).getCodeword(c)),x!=null)return u?x.getEndX():x.getStartX();if(x=s.getDetectionResultColumn(i).getCodewordNearby(c),x!=null)return u?x.getStartX():x.getEndX();if(wt.isValidBarcodeColumn(s,i-d)&&(x=s.getDetectionResultColumn(i-d).getCodewordNearby(c)),x!=null)return u?x.getEndX():x.getStartX();let v=0;for(;wt.isValidBarcodeColumn(s,i-d);){i-=d;for(let y of s.getDetectionResultColumn(i).getCodewords())if(y!=null)return(u?y.getEndX():y.getStartX())+d*v*(y.getEndX()-y.getStartX());v++}return u?s.getBoundingBox().getMinX():s.getBoundingBox().getMaxX()}static detectCodeword(s,i,c,u,d,x,v,y){d=wt.adjustCodewordStartColumn(s,i,c,u,d,x);let b=wt.getModuleBitCount(s,i,c,u,d,x);if(b==null)return null;let I,O=it.sum(b);if(u)I=d+O;else{for(let re=0;re<b.length/2;re++){let ae=b[re];b[re]=b[b.length-1-re],b[b.length-1-re]=ae}I=d,d=I-O}if(!wt.checkCodewordSkew(O,v,y))return null;let j=sn.getDecodedValue(b),q=et.getCodeword(j);return q===-1?null:new pi(d,I,wt.getCodewordBucketNumber(j),q)}static getModuleBitCount(s,i,c,u,d,x){let v=d,y=new Int32Array(8),b=0,I=u?1:-1,O=u;for(;(u?v<c:v>=i)&&b<y.length;)s.get(v,x)===O?(y[b]++,v+=I):(b++,O=!O);return b===y.length||v===(u?c:i)&&b===y.length-1?y:null}static getNumberOfECCodeWords(s){return 2<<s}static adjustCodewordStartColumn(s,i,c,u,d,x){let v=d,y=u?-1:1;for(let b=0;b<2;b++){for(;(u?v>=i:v<c)&&u===s.get(v,x);){if(Math.abs(d-v)>wt.CODEWORD_SKEW_SIZE)return d;v+=y}y=-y,u=!u}return v}static checkCodewordSkew(s,i,c){return i-wt.CODEWORD_SKEW_SIZE<=s&&s<=c+wt.CODEWORD_SKEW_SIZE}static decodeCodewords(s,i,c){if(s.length===0)throw R.getFormatInstance();let u=1<<i+1,d=wt.correctErrors(s,c,u);wt.verifyCodewordCount(s,u);let x=ve.decode(s,""+i);return x.setErrorsCorrected(d),x.setErasures(c.length),x}static correctErrors(s,i,c){if(i!=null&&i.length>c/2+wt.MAX_ERRORS||c<0||c>wt.MAX_EC_CODEWORDS)throw A.getChecksumInstance();return wt.errorCorrection.decode(s,c,i)}static verifyCodewordCount(s,i){if(s.length<4)throw R.getFormatInstance();let c=s[0];if(c>s.length)throw R.getFormatInstance();if(c===0)if(i<s.length)s[0]=s.length-i;else throw R.getFormatInstance()}static getBitCountForCodeword(s){let i=new Int32Array(8),c=0,u=i.length-1;for(;!((s&1)!==c&&(c=s&1,u--,u<0));)i[u]++,s>>=1;return i}static getCodewordBucketNumber(s){return s instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(s):this.getCodewordBucketNumber_number(s)}static getCodewordBucketNumber_number(s){return wt.getCodewordBucketNumber(wt.getBitCountForCodeword(s))}static getCodewordBucketNumber_Int32Array(s){return(s[0]-s[2]+s[4]-s[6]+9)%9}static toString(s){let i=new hi;for(let c=0;c<s.length;c++){i.format("Row %2d: ",c);for(let u=0;u<s[c].length;u++){let d=s[c][u];d.getValue().length===0?i.format("        ",null):i.format("%4d(%2d)",d.getValue()[0],d.getConfidence(d.getValue()[0]))}i.format("%n")}return i.toString()}}wt.CODEWORD_SKEW_SIZE=2,wt.MAX_ERRORS=3,wt.MAX_EC_CODEWORDS=512,wt.errorCorrection=new Y0;class jr{decode(s,i=null){let c=jr.decode(s,i,!1);if(c==null||c.length===0||c[0]==null)throw J.getNotFoundInstance();return c[0]}decodeMultiple(s,i=null){try{return jr.decode(s,i,!0)}catch(c){throw c instanceof R||c instanceof A?J.getNotFoundInstance():c}}static decode(s,i,c){const u=new Array,d=mt.detectMultiple(s,i,c);for(const x of d.getPoints()){const v=wt.decode(d.getBits(),x[4],x[5],x[6],x[7],jr.getMinCodewordWidth(x),jr.getMaxCodewordWidth(x)),y=new te(v.getText(),v.getRawBytes(),void 0,x,ce.PDF_417);y.putMetadata(ye.ERROR_CORRECTION_LEVEL,v.getECLevel());const b=v.getOther();b!=null&&y.putMetadata(ye.PDF417_EXTRA_METADATA,b),u.push(y)}return u.map(x=>x)}static getMaxWidth(s,i){return s==null||i==null?0:Math.trunc(Math.abs(s.getX()-i.getX()))}static getMinWidth(s,i){return s==null||i==null?N.MAX_VALUE:Math.trunc(Math.abs(s.getX()-i.getX()))}static getMaxCodewordWidth(s){return Math.floor(Math.max(Math.max(jr.getMaxWidth(s[0],s[4]),jr.getMaxWidth(s[6],s[2])*et.MODULES_IN_CODEWORD/et.MODULES_IN_STOP_PATTERN),Math.max(jr.getMaxWidth(s[1],s[5]),jr.getMaxWidth(s[7],s[3])*et.MODULES_IN_CODEWORD/et.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(s){return Math.floor(Math.min(Math.min(jr.getMinWidth(s[0],s[4]),jr.getMinWidth(s[6],s[2])*et.MODULES_IN_CODEWORD/et.MODULES_IN_STOP_PATTERN),Math.min(jr.getMinWidth(s[1],s[5]),jr.getMinWidth(s[7],s[3])*et.MODULES_IN_CODEWORD/et.MODULES_IN_STOP_PATTERN)))}reset(){}}class po extends m{}po.kind="ReaderException";class J0{constructor(s,i){this.verbose=s===!0,i&&this.setHints(i)}decode(s,i){return i&&this.setHints(i),this.decodeInternal(s)}decodeWithState(s){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(s)}setHints(s){this.hints=s;const i=!n(s)&&s.get(B.TRY_HARDER)===!0,c=n(s)?null:s.get(B.POSSIBLE_FORMATS),u=new Array;if(!n(c)){const d=c.some(x=>x===ce.UPC_A||x===ce.UPC_E||x===ce.EAN_13||x===ce.EAN_8||x===ce.CODABAR||x===ce.CODE_39||x===ce.CODE_93||x===ce.CODE_128||x===ce.ITF||x===ce.RSS_14||x===ce.RSS_EXPANDED);d&&!i&&u.push(new Nn(s,this.verbose)),c.includes(ce.QR_CODE)&&u.push(new Da),c.includes(ce.DATA_MATRIX)&&u.push(new Fa),c.includes(ce.AZTEC)&&u.push(new zt),c.includes(ce.PDF_417)&&u.push(new jr),d&&i&&u.push(new Nn(s,this.verbose))}u.length===0&&(i||u.push(new Nn(s,this.verbose)),u.push(new Da),u.push(new Fa),u.push(new zt),u.push(new jr),i&&u.push(new Nn(s,this.verbose))),this.readers=u}reset(){if(this.readers!==null)for(const s of this.readers)s.reset()}decodeInternal(s){if(this.readers===null)throw new po("No readers where selected, nothing can be read.");for(const i of this.readers)try{return i.decode(s,this.hints)}catch(c){if(c instanceof po)continue}throw new J("No MultiFormat Readers were able to detect the code.")}}class Yx extends oe{constructor(s=null,i=500){const c=new J0;c.setHints(s),super(c,i)}decodeBitmap(s){return this.reader.decodeWithState(s)}}class Zx extends oe{constructor(s=500){super(new jr,s)}}class $x extends oe{constructor(s=500){super(new Da,s)}}var Lc;(function(D){D[D.ERROR_CORRECTION=0]="ERROR_CORRECTION",D[D.CHARACTER_SET=1]="CHARACTER_SET",D[D.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",D[D.MIN_SIZE=3]="MIN_SIZE",D[D.MAX_SIZE=4]="MAX_SIZE",D[D.MARGIN=5]="MARGIN",D[D.PDF417_COMPACT=6]="PDF417_COMPACT",D[D.PDF417_COMPACTION=7]="PDF417_COMPACTION",D[D.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",D[D.AZTEC_LAYERS=9]="AZTEC_LAYERS",D[D.QR_VERSION=10]="QR_VERSION"})(Lc||(Lc={}));var Ar=Lc;class jc{constructor(s){this.field=s,this.cachedGenerators=[],this.cachedGenerators.push(new Ye(s,Int32Array.from([1])))}buildGenerator(s){const i=this.cachedGenerators;if(s>=i.length){let c=i[i.length-1];const u=this.field;for(let d=i.length;d<=s;d++){const x=c.multiply(new Ye(u,Int32Array.from([1,u.exp(d-1+u.getGeneratorBase())])));i.push(x),c=x}}return i[s]}encode(s,i){if(i===0)throw new w("No error correction bytes");const c=s.length-i;if(c<=0)throw new w("No data bytes provided");const u=this.buildGenerator(i),d=new Int32Array(c);_.arraycopy(s,0,d,0,c);let x=new Ye(this.field,d);x=x.multiplyByMonomial(i,1);const y=x.divide(u)[1].getCoefficients(),b=i-y.length;for(let I=0;I<b;I++)s[c+I]=0;_.arraycopy(y,0,s,c+b,y.length)}}class ir{constructor(){}static applyMaskPenaltyRule1(s){return ir.applyMaskPenaltyRule1Internal(s,!0)+ir.applyMaskPenaltyRule1Internal(s,!1)}static applyMaskPenaltyRule2(s){let i=0;const c=s.getArray(),u=s.getWidth(),d=s.getHeight();for(let x=0;x<d-1;x++){const v=c[x];for(let y=0;y<u-1;y++){const b=v[y];b===v[y+1]&&b===c[x+1][y]&&b===c[x+1][y+1]&&i++}}return ir.N2*i}static applyMaskPenaltyRule3(s){let i=0;const c=s.getArray(),u=s.getWidth(),d=s.getHeight();for(let x=0;x<d;x++)for(let v=0;v<u;v++){const y=c[x];v+6<u&&y[v]===1&&y[v+1]===0&&y[v+2]===1&&y[v+3]===1&&y[v+4]===1&&y[v+5]===0&&y[v+6]===1&&(ir.isWhiteHorizontal(y,v-4,v)||ir.isWhiteHorizontal(y,v+7,v+11))&&i++,x+6<d&&c[x][v]===1&&c[x+1][v]===0&&c[x+2][v]===1&&c[x+3][v]===1&&c[x+4][v]===1&&c[x+5][v]===0&&c[x+6][v]===1&&(ir.isWhiteVertical(c,v,x-4,x)||ir.isWhiteVertical(c,v,x+7,x+11))&&i++}return i*ir.N3}static isWhiteHorizontal(s,i,c){i=Math.max(i,0),c=Math.min(c,s.length);for(let u=i;u<c;u++)if(s[u]===1)return!1;return!0}static isWhiteVertical(s,i,c,u){c=Math.max(c,0),u=Math.min(u,s.length);for(let d=c;d<u;d++)if(s[d][i]===1)return!1;return!0}static applyMaskPenaltyRule4(s){let i=0;const c=s.getArray(),u=s.getWidth(),d=s.getHeight();for(let y=0;y<d;y++){const b=c[y];for(let I=0;I<u;I++)b[I]===1&&i++}const x=s.getHeight()*s.getWidth();return Math.floor(Math.abs(i*2-x)*10/x)*ir.N4}static getDataMaskBit(s,i,c){let u,d;switch(s){case 0:u=c+i&1;break;case 1:u=c&1;break;case 2:u=i%3;break;case 3:u=(c+i)%3;break;case 4:u=Math.floor(c/2)+Math.floor(i/3)&1;break;case 5:d=c*i,u=(d&1)+d%3;break;case 6:d=c*i,u=(d&1)+d%3&1;break;case 7:d=c*i,u=d%3+(c+i&1)&1;break;default:throw new w("Invalid mask pattern: "+s)}return u===0}static applyMaskPenaltyRule1Internal(s,i){let c=0;const u=i?s.getHeight():s.getWidth(),d=i?s.getWidth():s.getHeight(),x=s.getArray();for(let v=0;v<u;v++){let y=0,b=-1;for(let I=0;I<d;I++){const O=i?x[v][I]:x[I][v];O===b?y++:(y>=5&&(c+=ir.N1+(y-5)),y=1,b=O)}y>=5&&(c+=ir.N1+(y-5))}return c}}ir.N1=3,ir.N2=3,ir.N3=40,ir.N4=10;class vo{constructor(s,i){this.width=s,this.height=i;const c=new Array(i);for(let u=0;u!==i;u++)c[u]=new Uint8Array(s);this.bytes=c}getHeight(){return this.height}getWidth(){return this.width}get(s,i){return this.bytes[i][s]}getArray(){return this.bytes}setNumber(s,i,c){this.bytes[i][s]=c}setBoolean(s,i,c){this.bytes[i][s]=c?1:0}clear(s){for(const i of this.bytes)k.fill(i,s)}equals(s){if(!(s instanceof vo))return!1;const i=s;if(this.width!==i.width||this.height!==i.height)return!1;for(let c=0,u=this.height;c<u;++c){const d=this.bytes[c],x=i.bytes[c];for(let v=0,y=this.width;v<y;++v)if(d[v]!==x[v])return!1}return!0}toString(){const s=new ne;for(let i=0,c=this.height;i<c;++i){const u=this.bytes[i];for(let d=0,x=this.width;d<x;++d)switch(u[d]){case 0:s.append(" 0");break;case 1:s.append(" 1");break;default:s.append("  ");break}s.append(`
`)}return s.toString()}}class is{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const s=new ne;return s.append(`<<
`),s.append(" mode: "),s.append(this.mode?this.mode.toString():"null"),s.append(`
 ecLevel: `),s.append(this.ecLevel?this.ecLevel.toString():"null"),s.append(`
 version: `),s.append(this.version?this.version.toString():"null"),s.append(`
 maskPattern: `),s.append(this.maskPattern.toString()),this.matrix?(s.append(`
 matrix:
`),s.append(this.matrix.toString())):s.append(`
 matrix: null
`),s.append(`>>
`),s.toString()}setMode(s){this.mode=s}setECLevel(s){this.ecLevel=s}setVersion(s){this.version=s}setMaskPattern(s){this.maskPattern=s}setMatrix(s){this.matrix=s}static isValidMaskPattern(s){return s>=0&&s<is.NUM_MASK_PATTERNS}}is.NUM_MASK_PATTERNS=8;class Pt extends m{}Pt.kind="WriterException";class Qe{constructor(){}static clearMatrix(s){s.clear(255)}static buildMatrix(s,i,c,u,d){Qe.clearMatrix(d),Qe.embedBasicPatterns(c,d),Qe.embedTypeInfo(i,u,d),Qe.maybeEmbedVersionInfo(c,d),Qe.embedDataBits(s,u,d)}static embedBasicPatterns(s,i){Qe.embedPositionDetectionPatternsAndSeparators(i),Qe.embedDarkDotAtLeftBottomCorner(i),Qe.maybeEmbedPositionAdjustmentPatterns(s,i),Qe.embedTimingPatterns(i)}static embedTypeInfo(s,i,c){const u=new F;Qe.makeTypeInfoBits(s,i,u);for(let d=0,x=u.getSize();d<x;++d){const v=u.get(u.getSize()-1-d),y=Qe.TYPE_INFO_COORDINATES[d],b=y[0],I=y[1];if(c.setBoolean(b,I,v),d<8){const O=c.getWidth()-d-1;c.setBoolean(O,8,v)}else{const j=c.getHeight()-7+(d-8);c.setBoolean(8,j,v)}}}static maybeEmbedVersionInfo(s,i){if(s.getVersionNumber()<7)return;const c=new F;Qe.makeVersionInfoBits(s,c);let u=6*3-1;for(let d=0;d<6;++d)for(let x=0;x<3;++x){const v=c.get(u);u--,i.setBoolean(d,i.getHeight()-11+x,v),i.setBoolean(i.getHeight()-11+x,d,v)}}static embedDataBits(s,i,c){let u=0,d=-1,x=c.getWidth()-1,v=c.getHeight()-1;for(;x>0;){for(x===6&&(x-=1);v>=0&&v<c.getHeight();){for(let y=0;y<2;++y){const b=x-y;if(!Qe.isEmpty(c.get(b,v)))continue;let I;u<s.getSize()?(I=s.get(u),++u):I=!1,i!==255&&ir.getDataMaskBit(i,b,v)&&(I=!I),c.setBoolean(b,v,I)}v+=d}d=-d,v+=d,x-=2}if(u!==s.getSize())throw new Pt("Not all bits consumed: "+u+"/"+s.getSize())}static findMSBSet(s){return 32-N.numberOfLeadingZeros(s)}static calculateBCHCode(s,i){if(i===0)throw new w("0 polynomial");const c=Qe.findMSBSet(i);for(s<<=c-1;Qe.findMSBSet(s)>=c;)s^=i<<Qe.findMSBSet(s)-c;return s}static makeTypeInfoBits(s,i,c){if(!is.isValidMaskPattern(i))throw new Pt("Invalid mask pattern");const u=s.getBits()<<3|i;c.appendBits(u,5);const d=Qe.calculateBCHCode(u,Qe.TYPE_INFO_POLY);c.appendBits(d,10);const x=new F;if(x.appendBits(Qe.TYPE_INFO_MASK_PATTERN,15),c.xor(x),c.getSize()!==15)throw new Pt("should not happen but we got: "+c.getSize())}static makeVersionInfoBits(s,i){i.appendBits(s.getVersionNumber(),6);const c=Qe.calculateBCHCode(s.getVersionNumber(),Qe.VERSION_INFO_POLY);if(i.appendBits(c,12),i.getSize()!==18)throw new Pt("should not happen but we got: "+i.getSize())}static isEmpty(s){return s===255}static embedTimingPatterns(s){for(let i=8;i<s.getWidth()-8;++i){const c=(i+1)%2;Qe.isEmpty(s.get(i,6))&&s.setNumber(i,6,c),Qe.isEmpty(s.get(6,i))&&s.setNumber(6,i,c)}}static embedDarkDotAtLeftBottomCorner(s){if(s.get(8,s.getHeight()-8)===0)throw new Pt;s.setNumber(8,s.getHeight()-8,1)}static embedHorizontalSeparationPattern(s,i,c){for(let u=0;u<8;++u){if(!Qe.isEmpty(c.get(s+u,i)))throw new Pt;c.setNumber(s+u,i,0)}}static embedVerticalSeparationPattern(s,i,c){for(let u=0;u<7;++u){if(!Qe.isEmpty(c.get(s,i+u)))throw new Pt;c.setNumber(s,i+u,0)}}static embedPositionAdjustmentPattern(s,i,c){for(let u=0;u<5;++u){const d=Qe.POSITION_ADJUSTMENT_PATTERN[u];for(let x=0;x<5;++x)c.setNumber(s+x,i+u,d[x])}}static embedPositionDetectionPattern(s,i,c){for(let u=0;u<7;++u){const d=Qe.POSITION_DETECTION_PATTERN[u];for(let x=0;x<7;++x)c.setNumber(s+x,i+u,d[x])}}static embedPositionDetectionPatternsAndSeparators(s){const i=Qe.POSITION_DETECTION_PATTERN[0].length;Qe.embedPositionDetectionPattern(0,0,s),Qe.embedPositionDetectionPattern(s.getWidth()-i,0,s),Qe.embedPositionDetectionPattern(0,s.getWidth()-i,s);const c=8;Qe.embedHorizontalSeparationPattern(0,c-1,s),Qe.embedHorizontalSeparationPattern(s.getWidth()-c,c-1,s),Qe.embedHorizontalSeparationPattern(0,s.getWidth()-c,s);const u=7;Qe.embedVerticalSeparationPattern(u,0,s),Qe.embedVerticalSeparationPattern(s.getHeight()-u-1,0,s),Qe.embedVerticalSeparationPattern(u,s.getHeight()-u,s)}static maybeEmbedPositionAdjustmentPatterns(s,i){if(s.getVersionNumber()<2)return;const c=s.getVersionNumber()-1,u=Qe.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[c];for(let d=0,x=u.length;d!==x;d++){const v=u[d];if(v>=0)for(let y=0;y!==x;y++){const b=u[y];b>=0&&Qe.isEmpty(i.get(b,v))&&Qe.embedPositionAdjustmentPattern(b-2,v-2,i)}}}}Qe.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Qe.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Qe.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Qe.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Qe.VERSION_INFO_POLY=7973,Qe.TYPE_INFO_POLY=1335,Qe.TYPE_INFO_MASK_PATTERN=21522;class qx{constructor(s,i){this.dataBytes=s,this.errorCorrectionBytes=i}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Gt{constructor(){}static calculateMaskPenalty(s){return ir.applyMaskPenaltyRule1(s)+ir.applyMaskPenaltyRule2(s)+ir.applyMaskPenaltyRule3(s)+ir.applyMaskPenaltyRule4(s)}static encode(s,i,c=null){let u=Gt.DEFAULT_BYTE_MODE_ENCODING;const d=c!==null&&c.get(Ar.CHARACTER_SET)!==void 0;d&&(u=c.get(Ar.CHARACTER_SET).toString());const x=this.chooseMode(s,u),v=new F;if(x===qe.BYTE&&(d||Gt.DEFAULT_BYTE_MODE_ENCODING!==u)){const je=U.getCharacterSetECIByName(u);je!==void 0&&this.appendECI(je,v)}this.appendModeInfo(x,v);const y=new F;this.appendBytes(s,x,y,u);let b;if(c!==null&&c.get(Ar.QR_VERSION)!==void 0){const je=Number.parseInt(c.get(Ar.QR_VERSION).toString(),10);b=Ze.getVersionForNumber(je);const Fe=this.calculateBitsNeeded(x,v,y,b);if(!this.willFit(Fe,b,i))throw new Pt("Data too big for requested version")}else b=this.recommendVersion(i,x,v,y);const I=new F;I.appendBitArray(v);const O=x===qe.BYTE?y.getSizeInBytes():s.length;this.appendLengthInfo(O,b,x,I),I.appendBitArray(y);const j=b.getECBlocksForLevel(i),q=b.getTotalCodewords()-j.getTotalECCodewords();this.terminateBits(q,I);const re=this.interleaveWithECBytes(I,b.getTotalCodewords(),q,j.getNumBlocks()),ae=new is;ae.setECLevel(i),ae.setMode(x),ae.setVersion(b);const ue=b.getDimensionForVersion(),we=new vo(ue,ue),Me=this.chooseMaskPattern(re,i,b,we);return ae.setMaskPattern(Me),Qe.buildMatrix(re,i,b,Me,we),ae.setMatrix(we),ae}static recommendVersion(s,i,c,u){const d=this.calculateBitsNeeded(i,c,u,Ze.getVersionForNumber(1)),x=this.chooseVersion(d,s),v=this.calculateBitsNeeded(i,c,u,x);return this.chooseVersion(v,s)}static calculateBitsNeeded(s,i,c,u){return i.getSize()+s.getCharacterCountBits(u)+c.getSize()}static getAlphanumericCode(s){return s<Gt.ALPHANUMERIC_TABLE.length?Gt.ALPHANUMERIC_TABLE[s]:-1}static chooseMode(s,i=null){if(U.SJIS.getName()===i&&this.isOnlyDoubleByteKanji(s))return qe.KANJI;let c=!1,u=!1;for(let d=0,x=s.length;d<x;++d){const v=s.charAt(d);if(Gt.isDigit(v))c=!0;else if(this.getAlphanumericCode(v.charCodeAt(0))!==-1)u=!0;else return qe.BYTE}return u?qe.ALPHANUMERIC:c?qe.NUMERIC:qe.BYTE}static isOnlyDoubleByteKanji(s){let i;try{i=M.encode(s,U.SJIS)}catch{return!1}const c=i.length;if(c%2!==0)return!1;for(let u=0;u<c;u+=2){const d=i[u]&255;if((d<129||d>159)&&(d<224||d>235))return!1}return!0}static chooseMaskPattern(s,i,c,u){let d=Number.MAX_SAFE_INTEGER,x=-1;for(let v=0;v<is.NUM_MASK_PATTERNS;v++){Qe.buildMatrix(s,i,c,v,u);let y=this.calculateMaskPenalty(u);y<d&&(d=y,x=v)}return x}static chooseVersion(s,i){for(let c=1;c<=40;c++){const u=Ze.getVersionForNumber(c);if(Gt.willFit(s,u,i))return u}throw new Pt("Data too big")}static willFit(s,i,c){const u=i.getTotalCodewords(),x=i.getECBlocksForLevel(c).getTotalECCodewords(),v=u-x,y=(s+7)/8;return v>=y}static terminateBits(s,i){const c=s*8;if(i.getSize()>c)throw new Pt("data bits cannot fit in the QR Code"+i.getSize()+" > "+c);for(let x=0;x<4&&i.getSize()<c;++x)i.appendBit(!1);const u=i.getSize()&7;if(u>0)for(let x=u;x<8;x++)i.appendBit(!1);const d=s-i.getSizeInBytes();for(let x=0;x<d;++x)i.appendBits(x&1?17:236,8);if(i.getSize()!==c)throw new Pt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(s,i,c,u,d,x){if(u>=c)throw new Pt("Block ID too large");const v=s%c,y=c-v,b=Math.floor(s/c),I=b+1,O=Math.floor(i/c),j=O+1,q=b-O,re=I-j;if(q!==re)throw new Pt("EC bytes mismatch");if(c!==y+v)throw new Pt("RS blocks mismatch");if(s!==(O+q)*y+(j+re)*v)throw new Pt("Total bytes mismatch");u<y?(d[0]=O,x[0]=q):(d[0]=j,x[0]=re)}static interleaveWithECBytes(s,i,c,u){if(s.getSizeInBytes()!==c)throw new Pt("Number of bits and data bytes does not match");let d=0,x=0,v=0;const y=new Array;for(let I=0;I<u;++I){const O=new Int32Array(1),j=new Int32Array(1);Gt.getNumDataBytesAndNumECBytesForBlockID(i,c,u,I,O,j);const q=O[0],re=new Uint8Array(q);s.toBytes(8*d,re,0,q);const ae=Gt.generateECBytes(re,j[0]);y.push(new qx(re,ae)),x=Math.max(x,q),v=Math.max(v,ae.length),d+=O[0]}if(c!==d)throw new Pt("Data bytes does not match offset");const b=new F;for(let I=0;I<x;++I)for(const O of y){const j=O.getDataBytes();I<j.length&&b.appendBits(j[I],8)}for(let I=0;I<v;++I)for(const O of y){const j=O.getErrorCorrectionBytes();I<j.length&&b.appendBits(j[I],8)}if(i!==b.getSizeInBytes())throw new Pt("Interleaving error: "+i+" and "+b.getSizeInBytes()+" differ.");return b}static generateECBytes(s,i){const c=s.length,u=new Int32Array(c+i);for(let x=0;x<c;x++)u[x]=s[x]&255;new jc(Ge.QR_CODE_FIELD_256).encode(u,i);const d=new Uint8Array(i);for(let x=0;x<i;x++)d[x]=u[c+x];return d}static appendModeInfo(s,i){i.appendBits(s.getBits(),4)}static appendLengthInfo(s,i,c,u){const d=c.getCharacterCountBits(i);if(s>=1<<d)throw new Pt(s+" is bigger than "+((1<<d)-1));u.appendBits(s,d)}static appendBytes(s,i,c,u){switch(i){case qe.NUMERIC:Gt.appendNumericBytes(s,c);break;case qe.ALPHANUMERIC:Gt.appendAlphanumericBytes(s,c);break;case qe.BYTE:Gt.append8BitBytes(s,c,u);break;case qe.KANJI:Gt.appendKanjiBytes(s,c);break;default:throw new Pt("Invalid mode: "+i)}}static getDigit(s){return s.charCodeAt(0)-48}static isDigit(s){const i=Gt.getDigit(s);return i>=0&&i<=9}static appendNumericBytes(s,i){const c=s.length;let u=0;for(;u<c;){const d=Gt.getDigit(s.charAt(u));if(u+2<c){const x=Gt.getDigit(s.charAt(u+1)),v=Gt.getDigit(s.charAt(u+2));i.appendBits(d*100+x*10+v,10),u+=3}else if(u+1<c){const x=Gt.getDigit(s.charAt(u+1));i.appendBits(d*10+x,7),u+=2}else i.appendBits(d,4),u++}}static appendAlphanumericBytes(s,i){const c=s.length;let u=0;for(;u<c;){const d=Gt.getAlphanumericCode(s.charCodeAt(u));if(d===-1)throw new Pt;if(u+1<c){const x=Gt.getAlphanumericCode(s.charCodeAt(u+1));if(x===-1)throw new Pt;i.appendBits(d*45+x,11),u+=2}else i.appendBits(d,6),u++}}static append8BitBytes(s,i,c){let u;try{u=M.encode(s,c)}catch(d){throw new Pt(d)}for(let d=0,x=u.length;d!==x;d++){const v=u[d];i.appendBits(v,8)}}static appendKanjiBytes(s,i){let c;try{c=M.encode(s,U.SJIS)}catch(d){throw new Pt(d)}const u=c.length;for(let d=0;d<u;d+=2){const x=c[d]&255,v=c[d+1]&255,y=x<<8&4294967295|v;let b=-1;if(y>=33088&&y<=40956?b=y-33088:y>=57408&&y<=60351&&(b=y-49472),b===-1)throw new Pt("Invalid byte sequence");const I=(b>>8)*192+(b&255);i.appendBits(I,13)}}static appendECI(s,i){i.appendBits(qe.ECI.getBits(),4),i.appendBits(s.getValue(),8)}}Gt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Gt.DEFAULT_BYTE_MODE_ENCODING=U.UTF8.getName();class os{write(s,i,c,u=null){if(s.length===0)throw new w("Found empty contents");if(i<0||c<0)throw new w("Requested dimensions are too small: "+i+"x"+c);let d=Ht.L,x=os.QUIET_ZONE_SIZE;u!==null&&(u.get(Ar.ERROR_CORRECTION)!==void 0&&(d=Ht.fromString(u.get(Ar.ERROR_CORRECTION).toString())),u.get(Ar.MARGIN)!==void 0&&(x=Number.parseInt(u.get(Ar.MARGIN).toString(),10)));const v=Gt.encode(s,d,u);return this.renderResult(v,i,c,x)}writeToDom(s,i,c,u,d=null){typeof s=="string"&&(s=document.querySelector(s));const x=this.write(i,c,u,d);s&&s.appendChild(x)}renderResult(s,i,c,u){const d=s.getMatrix();if(d===null)throw new _t;const x=d.getWidth(),v=d.getHeight(),y=x+u*2,b=v+u*2,I=Math.max(i,y),O=Math.max(c,b),j=Math.min(Math.floor(I/y),Math.floor(O/b)),q=Math.floor((I-x*j)/2),re=Math.floor((O-v*j)/2),ae=this.createSVGElement(I,O);for(let ue=0,we=re;ue<v;ue++,we+=j)for(let Me=0,je=q;Me<x;Me++,je+=j)if(d.get(Me,ue)===1){const Fe=this.createSvgRectElement(je,we,j,j);ae.appendChild(Fe)}return ae}createSVGElement(s,i){const c=document.createElementNS(os.SVG_NS,"svg");return c.setAttributeNS(null,"height",s.toString()),c.setAttributeNS(null,"width",i.toString()),c}createSvgRectElement(s,i,c,u){const d=document.createElementNS(os.SVG_NS,"rect");return d.setAttributeNS(null,"x",s.toString()),d.setAttributeNS(null,"y",i.toString()),d.setAttributeNS(null,"height",c.toString()),d.setAttributeNS(null,"width",u.toString()),d.setAttributeNS(null,"fill","#000000"),d}}os.QUIET_ZONE_SIZE=4,os.SVG_NS="http://www.w3.org/2000/svg";class Rs{encode(s,i,c,u,d){if(s.length===0)throw new w("Found empty contents");if(i!==ce.QR_CODE)throw new w("Can only encode QR_CODE, but got "+i);if(c<0||u<0)throw new w(`Requested dimensions are too small: ${c}x${u}`);let x=Ht.L,v=Rs.QUIET_ZONE_SIZE;d!==null&&(d.get(Ar.ERROR_CORRECTION)!==void 0&&(x=Ht.fromString(d.get(Ar.ERROR_CORRECTION).toString())),d.get(Ar.MARGIN)!==void 0&&(v=Number.parseInt(d.get(Ar.MARGIN).toString(),10)));const y=Gt.encode(s,x,d);return Rs.renderResult(y,c,u,v)}static renderResult(s,i,c,u){const d=s.getMatrix();if(d===null)throw new _t;const x=d.getWidth(),v=d.getHeight(),y=x+u*2,b=v+u*2,I=Math.max(i,y),O=Math.max(c,b),j=Math.min(Math.floor(I/y),Math.floor(O/b)),q=Math.floor((I-x*j)/2),re=Math.floor((O-v*j)/2),ae=new me(I,O);for(let ue=0,we=re;ue<v;ue++,we+=j)for(let Me=0,je=q;Me<x;Me++,je+=j)d.get(Me,ue)===1&&ae.setRegion(je,we,j,j);return ae}}Rs.QUIET_ZONE_SIZE=4;class Kx{encode(s,i,c,u,d){let x;switch(i){case ce.QR_CODE:x=new Rs;break;default:throw new w("No encoder available for format "+i)}return x.encode(s,i,c,u,d)}}class ea extends at{constructor(s,i,c,u,d,x,v,y){if(super(x,v),this.yuvData=s,this.dataWidth=i,this.dataHeight=c,this.left=u,this.top=d,u+x>i||d+v>c)throw new w("Crop rectangle does not fit within image data.");y&&this.reverseHorizontal(x,v)}getRow(s,i){if(s<0||s>=this.getHeight())throw new w("Requested row is outside the image: "+s);const c=this.getWidth();(i==null||i.length<c)&&(i=new Uint8ClampedArray(c));const u=(s+this.top)*this.dataWidth+this.left;return _.arraycopy(this.yuvData,u,i,0,c),i}getMatrix(){const s=this.getWidth(),i=this.getHeight();if(s===this.dataWidth&&i===this.dataHeight)return this.yuvData;const c=s*i,u=new Uint8ClampedArray(c);let d=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return _.arraycopy(this.yuvData,d,u,0,c),u;for(let x=0;x<i;x++){const v=x*s;_.arraycopy(this.yuvData,d,u,v,s),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(s,i,c,u){return new ea(this.yuvData,this.dataWidth,this.dataHeight,this.left+s,this.top+i,c,u,!1)}renderThumbnail(){const s=this.getWidth()/ea.THUMBNAIL_SCALE_FACTOR,i=this.getHeight()/ea.THUMBNAIL_SCALE_FACTOR,c=new Int32Array(s*i),u=this.yuvData;let d=this.top*this.dataWidth+this.left;for(let x=0;x<i;x++){const v=x*s;for(let y=0;y<s;y++){const b=u[d+y*ea.THUMBNAIL_SCALE_FACTOR]&255;c[v+y]=4278190080|b*65793}d+=this.dataWidth*ea.THUMBNAIL_SCALE_FACTOR}return c}getThumbnailWidth(){return this.getWidth()/ea.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/ea.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(s,i){const c=this.yuvData;for(let u=0,d=this.top*this.dataWidth+this.left;u<i;u++,d+=this.dataWidth){const x=d+s/2;for(let v=d,y=d+s-1;v<x;v++,y--){const b=c[v];c[v]=c[y],c[y]=b}}}invert(){return new he(this)}}ea.THUMBNAIL_SCALE_FACTOR=2;class Pc extends at{constructor(s,i,c,u,d,x,v){if(super(i,c),this.dataWidth=u,this.dataHeight=d,this.left=x,this.top=v,s.BYTES_PER_ELEMENT===4){const y=i*c,b=new Uint8ClampedArray(y);for(let I=0;I<y;I++){const O=s[I],j=O>>16&255,q=O>>7&510,re=O&255;b[I]=(j+q+re)/4&255}this.luminances=b}else this.luminances=s;if(u===void 0&&(this.dataWidth=i),d===void 0&&(this.dataHeight=c),x===void 0&&(this.left=0),v===void 0&&(this.top=0),this.left+i>this.dataWidth||this.top+c>this.dataHeight)throw new w("Crop rectangle does not fit within image data.")}getRow(s,i){if(s<0||s>=this.getHeight())throw new w("Requested row is outside the image: "+s);const c=this.getWidth();(i==null||i.length<c)&&(i=new Uint8ClampedArray(c));const u=(s+this.top)*this.dataWidth+this.left;return _.arraycopy(this.luminances,u,i,0,c),i}getMatrix(){const s=this.getWidth(),i=this.getHeight();if(s===this.dataWidth&&i===this.dataHeight)return this.luminances;const c=s*i,u=new Uint8ClampedArray(c);let d=this.top*this.dataWidth+this.left;if(s===this.dataWidth)return _.arraycopy(this.luminances,d,u,0,c),u;for(let x=0;x<i;x++){const v=x*s;_.arraycopy(this.luminances,d,u,v,s),d+=this.dataWidth}return u}isCropSupported(){return!0}crop(s,i,c,u){return new Pc(this.luminances,c,u,this.dataWidth,this.dataHeight,this.left+s,this.top+i)}invert(){return new he(this)}}class eu extends U{static forName(s){return this.getCharacterSetECIByName(s)}}class Bc{}Bc.ISO_8859_1=U.ISO8859_1;class tu{isCompact(){return this.compact}setCompact(s){this.compact=s}getSize(){return this.size}setSize(s){this.size=s}getLayers(){return this.layers}setLayers(s){this.layers=s}getCodeWords(){return this.codeWords}setCodeWords(s){this.codeWords=s}getMatrix(){return this.matrix}setMatrix(s){this.matrix=s}}class ru{static singletonList(s){return[s]}static min(s,i){return s.sort(i)[0]}}class Qx{constructor(s){this.previous=s}getPrevious(){return this.previous}}class Ms extends Qx{constructor(s,i,c){super(s),this.value=i,this.bitCount=c}appendTo(s,i){s.appendBits(this.value,this.bitCount)}add(s,i){return new Ms(this,s,i)}addBinaryShift(s,i){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Ms(this,s,i)}toString(){let s=this.value&(1<<this.bitCount)-1;return s|=1<<this.bitCount,"<"+N.toBinaryString(s|1<<this.bitCount).substring(1)+">"}}class Uc extends Ms{constructor(s,i,c){super(s,0,0),this.binaryShiftStart=i,this.binaryShiftByteCount=c}appendTo(s,i){for(let c=0;c<this.binaryShiftByteCount;c++)(c===0||c===31&&this.binaryShiftByteCount<=62)&&(s.appendBits(31,5),this.binaryShiftByteCount>62?s.appendBits(this.binaryShiftByteCount-31,16):c===0?s.appendBits(Math.min(this.binaryShiftByteCount,31),5):s.appendBits(this.binaryShiftByteCount-31,5)),s.appendBits(i[this.binaryShiftStart+c],8)}addBinaryShift(s,i){return new Uc(this,s,i)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Jx(D,s,i){return new Uc(D,s,i)}function vi(D,s,i){return new Ms(D,s,i)}const em=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Ra=0,wo=1,Fn=2,nu=3,ta=4,tm=new Ms(null,0,0),zc=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function rm(D){for(let s of D)k.fill(s,-1);return D[Ra][ta]=0,D[wo][ta]=0,D[wo][Ra]=28,D[nu][ta]=0,D[Fn][ta]=0,D[Fn][Ra]=15,D}const au=rm(k.createInt32Array(6,6));class ra{constructor(s,i,c,u){this.token=s,this.mode=i,this.binaryShiftByteCount=c,this.bitCount=u}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(s,i){let c=this.bitCount,u=this.token;if(s!==this.mode){let x=zc[this.mode][s];u=vi(u,x&65535,x>>16),c+=x>>16}let d=s===Fn?4:5;return u=vi(u,i,d),new ra(u,s,0,c+d)}shiftAndAppend(s,i){let c=this.token,u=this.mode===Fn?4:5;return c=vi(c,au[this.mode][s],u),c=vi(c,i,5),new ra(c,this.mode,0,this.bitCount+u+5)}addBinaryShiftChar(s){let i=this.token,c=this.mode,u=this.bitCount;if(this.mode===ta||this.mode===Fn){let v=zc[c][Ra];i=vi(i,v&65535,v>>16),u+=v>>16,c=Ra}let d=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,x=new ra(i,c,this.binaryShiftByteCount+1,u+d);return x.binaryShiftByteCount===2078&&(x=x.endBinaryShift(s+1)),x}endBinaryShift(s){if(this.binaryShiftByteCount===0)return this;let i=this.token;return i=Jx(i,s-this.binaryShiftByteCount,this.binaryShiftByteCount),new ra(i,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(s){let i=this.bitCount+(zc[this.mode][s.mode]>>16);return this.binaryShiftByteCount<s.binaryShiftByteCount?i+=ra.calculateBinaryShiftCost(s)-ra.calculateBinaryShiftCost(this):this.binaryShiftByteCount>s.binaryShiftByteCount&&s.binaryShiftByteCount>0&&(i+=10),i<=s.bitCount}toBitArray(s){let i=[];for(let u=this.endBinaryShift(s.length).token;u!==null;u=u.getPrevious())i.unshift(u);let c=new F;for(const u of i)u.appendTo(c,s);return c}toString(){return V.format("%s bits=%d bytes=%d",em[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(s){return s.binaryShiftByteCount>62?21:s.binaryShiftByteCount>31?20:s.binaryShiftByteCount>0?10:0}}ra.INITIAL_STATE=new ra(tm,Ra,0,0);function nm(D){const s=V.getCharCode(" "),i=V.getCharCode("."),c=V.getCharCode(",");D[Ra][s]=1;const u=V.getCharCode("Z"),d=V.getCharCode("A");for(let j=d;j<=u;j++)D[Ra][j]=j-d+2;D[wo][s]=1;const x=V.getCharCode("z"),v=V.getCharCode("a");for(let j=v;j<=x;j++)D[wo][j]=j-v+2;D[Fn][s]=1;const y=V.getCharCode("9"),b=V.getCharCode("0");for(let j=b;j<=y;j++)D[Fn][j]=j-b+2;D[Fn][c]=12,D[Fn][i]=13;const I=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let j=0;j<I.length;j++)D[nu][V.getCharCode(I[j])]=j;const O=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let j=0;j<O.length;j++)V.getCharCode(O[j])>0&&(D[ta][V.getCharCode(O[j])]=j);return D}const Hc=nm(k.createInt32Array(5,256));class wi{constructor(s){this.text=s}encode(){const s=V.getCharCode(" "),i=V.getCharCode(`
`);let c=ru.singletonList(ra.INITIAL_STATE);for(let d=0;d<this.text.length;d++){let x,v=d+1<this.text.length?this.text[d+1]:0;switch(this.text[d]){case V.getCharCode("\r"):x=v===i?2:0;break;case V.getCharCode("."):x=v===s?3:0;break;case V.getCharCode(","):x=v===s?4:0;break;case V.getCharCode(":"):x=v===s?5:0;break;default:x=0}x>0?(c=wi.updateStateListForPair(c,d,x),d++):c=this.updateStateListForChar(c,d)}return ru.min(c,(d,x)=>d.getBitCount()-x.getBitCount()).toBitArray(this.text)}updateStateListForChar(s,i){const c=[];for(let u of s)this.updateStateForChar(u,i,c);return wi.simplifyStates(c)}updateStateForChar(s,i,c){let u=this.text[i]&255,d=Hc[s.getMode()][u]>0,x=null;for(let v=0;v<=ta;v++){let y=Hc[v][u];if(y>0){if(x==null&&(x=s.endBinaryShift(i)),!d||v===s.getMode()||v===Fn){const b=x.latchAndAppend(v,y);c.push(b)}if(!d&&au[s.getMode()][v]>=0){const b=x.shiftAndAppend(v,y);c.push(b)}}}if(s.getBinaryShiftByteCount()>0||Hc[s.getMode()][u]===0){let v=s.addBinaryShiftChar(i);c.push(v)}}static updateStateListForPair(s,i,c){const u=[];for(let d of s)this.updateStateForPair(d,i,c,u);return this.simplifyStates(u)}static updateStateForPair(s,i,c,u){let d=s.endBinaryShift(i);if(u.push(d.latchAndAppend(ta,c)),s.getMode()!==ta&&u.push(d.shiftAndAppend(ta,c)),c===3||c===4){let x=d.latchAndAppend(Fn,16-c).latchAndAppend(Fn,1);u.push(x)}if(s.getBinaryShiftByteCount()>0){let x=s.addBinaryShiftChar(i).addBinaryShiftChar(i+1);u.push(x)}}static simplifyStates(s){let i=[];for(const c of s){let u=!0;for(const d of i){if(d.isBetterThanOrEqualTo(c)){u=!1;break}c.isBetterThanOrEqualTo(d)&&(i=i.filter(x=>x!==d))}u&&i.push(c)}return i}}class Tt{constructor(){}static encodeBytes(s){return Tt.encode(s,Tt.DEFAULT_EC_PERCENT,Tt.DEFAULT_AZTEC_LAYERS)}static encode(s,i,c){let u=new wi(s).encode(),d=N.truncDivision(u.getSize()*i,100)+11,x=u.getSize()+d,v,y,b,I,O;if(c!==Tt.DEFAULT_AZTEC_LAYERS){if(v=c<0,y=Math.abs(c),y>(v?Tt.MAX_NB_BITS_COMPACT:Tt.MAX_NB_BITS))throw new w(V.format("Illegal value %s for layers",c));b=Tt.totalBitsInLayer(y,v),I=Tt.WORD_SIZE[y];let Fe=b-b%I;if(O=Tt.stuffBits(u,I),O.getSize()+d>Fe)throw new w("Data to large for user specified layer");if(v&&O.getSize()>I*64)throw new w("Data to large for user specified layer")}else{I=0,O=null;for(let Fe=0;;Fe++){if(Fe>Tt.MAX_NB_BITS)throw new w("Data too large for an Aztec code");if(v=Fe<=3,y=v?Fe+1:Fe,b=Tt.totalBitsInLayer(y,v),x>b)continue;(O==null||I!==Tt.WORD_SIZE[y])&&(I=Tt.WORD_SIZE[y],O=Tt.stuffBits(u,I));let At=b-b%I;if(!(v&&O.getSize()>I*64)&&O.getSize()+d<=At)break}}let j=Tt.generateCheckWords(O,b,I),q=O.getSize()/I,re=Tt.generateModeMessage(v,y,q),ae=(v?11:14)+y*4,ue=new Int32Array(ae),we;if(v){we=ae;for(let Fe=0;Fe<ue.length;Fe++)ue[Fe]=Fe}else{we=ae+1+2*N.truncDivision(N.truncDivision(ae,2)-1,15);let Fe=N.truncDivision(ae,2),At=N.truncDivision(we,2);for(let lt=0;lt<Fe;lt++){let on=lt+N.truncDivision(lt,15);ue[Fe-lt-1]=At-on-1,ue[Fe+lt]=At+on+1}}let Me=new me(we);for(let Fe=0,At=0;Fe<y;Fe++){let lt=(y-Fe)*4+(v?9:12);for(let on=0;on<lt;on++){let Gn=on*2;for(let cn=0;cn<2;cn++)j.get(At+Gn+cn)&&Me.set(ue[Fe*2+cn],ue[Fe*2+on]),j.get(At+lt*2+Gn+cn)&&Me.set(ue[Fe*2+on],ue[ae-1-Fe*2-cn]),j.get(At+lt*4+Gn+cn)&&Me.set(ue[ae-1-Fe*2-cn],ue[ae-1-Fe*2-on]),j.get(At+lt*6+Gn+cn)&&Me.set(ue[ae-1-Fe*2-on],ue[Fe*2+cn])}At+=lt*8}if(Tt.drawModeMessage(Me,v,we,re),v)Tt.drawBullsEye(Me,N.truncDivision(we,2),5);else{Tt.drawBullsEye(Me,N.truncDivision(we,2),7);for(let Fe=0,At=0;Fe<N.truncDivision(ae,2)-1;Fe+=15,At+=16)for(let lt=N.truncDivision(we,2)&1;lt<we;lt+=2)Me.set(N.truncDivision(we,2)-At,lt),Me.set(N.truncDivision(we,2)+At,lt),Me.set(lt,N.truncDivision(we,2)-At),Me.set(lt,N.truncDivision(we,2)+At)}let je=new tu;return je.setCompact(v),je.setSize(we),je.setLayers(y),je.setCodeWords(q),je.setMatrix(Me),je}static drawBullsEye(s,i,c){for(let u=0;u<c;u+=2)for(let d=i-u;d<=i+u;d++)s.set(d,i-u),s.set(d,i+u),s.set(i-u,d),s.set(i+u,d);s.set(i-c,i-c),s.set(i-c+1,i-c),s.set(i-c,i-c+1),s.set(i+c,i-c),s.set(i+c,i-c+1),s.set(i+c,i+c-1)}static generateModeMessage(s,i,c){let u=new F;return s?(u.appendBits(i-1,2),u.appendBits(c-1,6),u=Tt.generateCheckWords(u,28,4)):(u.appendBits(i-1,5),u.appendBits(c-1,11),u=Tt.generateCheckWords(u,40,4)),u}static drawModeMessage(s,i,c,u){let d=N.truncDivision(c,2);if(i)for(let x=0;x<7;x++){let v=d-3+x;u.get(x)&&s.set(v,d-5),u.get(x+7)&&s.set(d+5,v),u.get(20-x)&&s.set(v,d+5),u.get(27-x)&&s.set(d-5,v)}else for(let x=0;x<10;x++){let v=d-5+x+N.truncDivision(x,5);u.get(x)&&s.set(v,d-7),u.get(x+10)&&s.set(d+7,v),u.get(29-x)&&s.set(v,d+7),u.get(39-x)&&s.set(d-7,v)}}static generateCheckWords(s,i,c){let u=s.getSize()/c,d=new jc(Tt.getGF(c)),x=N.truncDivision(i,c),v=Tt.bitsToWords(s,c,x);d.encode(v,x-u);let y=i%c,b=new F;b.appendBits(0,y);for(const I of Array.from(v))b.appendBits(I,c);return b}static bitsToWords(s,i,c){let u=new Int32Array(c),d,x;for(d=0,x=s.getSize()/i;d<x;d++){let v=0;for(let y=0;y<i;y++)v|=s.get(d*i+y)?1<<i-y-1:0;u[d]=v}return u}static getGF(s){switch(s){case 4:return Ge.AZTEC_PARAM;case 6:return Ge.AZTEC_DATA_6;case 8:return Ge.AZTEC_DATA_8;case 10:return Ge.AZTEC_DATA_10;case 12:return Ge.AZTEC_DATA_12;default:throw new w("Unsupported word size "+s)}}static stuffBits(s,i){let c=new F,u=s.getSize(),d=(1<<i)-2;for(let x=0;x<u;x+=i){let v=0;for(let y=0;y<i;y++)(x+y>=u||s.get(x+y))&&(v|=1<<i-1-y);(v&d)===d?(c.appendBits(v&d,i),x--):v&d?c.appendBits(v,i):(c.appendBits(v|1,i),x--)}return c}static totalBitsInLayer(s,i){return((i?88:112)+16*s)*s}}Tt.DEFAULT_EC_PERCENT=33,Tt.DEFAULT_AZTEC_LAYERS=0,Tt.MAX_NB_BITS=32,Tt.MAX_NB_BITS_COMPACT=4,Tt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class yo{encode(s,i,c,u){return this.encodeWithHints(s,i,c,u,null)}encodeWithHints(s,i,c,u,d){let x=Bc.ISO_8859_1,v=Tt.DEFAULT_EC_PERCENT,y=Tt.DEFAULT_AZTEC_LAYERS;return d!=null&&(d.has(Ar.CHARACTER_SET)&&(x=eu.forName(d.get(Ar.CHARACTER_SET).toString())),d.has(Ar.ERROR_CORRECTION)&&(v=N.parseInt(d.get(Ar.ERROR_CORRECTION).toString())),d.has(Ar.AZTEC_LAYERS)&&(y=N.parseInt(d.get(Ar.AZTEC_LAYERS).toString()))),yo.encodeLayers(s,i,c,u,x,v,y)}static encodeLayers(s,i,c,u,d,x,v){if(i!==ce.AZTEC)throw new w("Can only encode AZTEC, but got "+i);let y=Tt.encode(V.getBytes(s,d),x,v);return yo.renderResult(y,c,u)}static renderResult(s,i,c){let u=s.getMatrix();if(u==null)throw new _t;let d=u.getWidth(),x=u.getHeight(),v=Math.max(i,d),y=Math.max(c,x),b=Math.min(v/d,y/x),I=(v-d*b)/2,O=(y-x*b)/2,j=new me(v,y);for(let q=0,re=O;q<x;q++,re+=b)for(let ae=0,ue=I;ae<d;ae++,ue+=b)u.get(ae,q)&&j.setRegion(ue,re,b,b);return j}}r.AbstractExpandedDecoder=G,r.ArgumentException=p,r.ArithmeticException=ee,r.AztecCode=tu,r.AztecCodeReader=zt,r.AztecCodeWriter=yo,r.AztecDecoder=rt,r.AztecDetector=dt,r.AztecDetectorResult=Wn,r.AztecEncoder=Tt,r.AztecHighLevelEncoder=wi,r.AztecPoint=Ut,r.BarcodeFormat=ce,r.Binarizer=T,r.BinaryBitmap=E,r.BitArray=F,r.BitMatrix=me,r.BitSource=Fc,r.BrowserAztecCodeReader=an,r.BrowserBarcodeReader=as,r.BrowserCodeReader=oe,r.BrowserDatamatrixCodeReader=Lx,r.BrowserMultiFormatReader=Yx,r.BrowserPDF417Reader=Zx,r.BrowserQRCodeReader=$x,r.BrowserQRCodeSvgWriter=os,r.CharacterSetECI=U,r.ChecksumException=A,r.Code128Reader=Pe,r.Code39Reader=sr,r.DataMatrixDecodedBitStreamParser=ka,r.DataMatrixReader=Fa,r.DecodeHintType=B,r.DecoderResult=Se,r.DefaultGridSampler=Ta,r.DetectorResult=Jn,r.EAN13Reader=ha,r.EncodeHintType=Ar,r.Exception=m,r.FormatException=R,r.GenericGF=Ge,r.GenericGFPoly=Ye,r.GlobalHistogramBinarizer=Ce,r.GridSampler=xn,r.GridSamplerInstance=qt,r.HTMLCanvasElementLuminanceSource=Ve,r.HybridBinarizer=Ae,r.ITFReader=Ft,r.IllegalArgumentException=w,r.IllegalStateException=_t,r.InvertedLuminanceSource=he,r.LuminanceSource=at,r.MathUtils=it,r.MultiFormatOneDReader=Nn,r.MultiFormatReader=J0,r.MultiFormatWriter=Kx,r.NotFoundException=J,r.OneDReader=xt,r.PDF417DecodedBitStreamParser=ve,r.PDF417DecoderErrorCorrection=Y0,r.PDF417Reader=jr,r.PDF417ResultMetadata=$0,r.PerspectiveTransform=vr,r.PlanarYUVLuminanceSource=ea,r.QRCodeByteMatrix=vo,r.QRCodeDataMask=In,r.QRCodeDecodedBitStreamParser=er,r.QRCodeDecoderErrorCorrectionLevel=Ht,r.QRCodeDecoderFormatInformation=Vr,r.QRCodeEncoder=Gt,r.QRCodeEncoderQRCode=is,r.QRCodeMaskUtil=ir,r.QRCodeMatrixUtil=Qe,r.QRCodeMode=qe,r.QRCodeReader=Da,r.QRCodeVersion=Ze,r.QRCodeWriter=Rs,r.RGBLuminanceSource=Pc,r.RSS14Reader=gt,r.RSSExpandedReader=_e,r.ReaderException=po,r.ReedSolomonDecoder=ot,r.ReedSolomonEncoder=jc,r.ReedSolomonException=ft,r.Result=te,r.ResultMetadataType=ye,r.ResultPoint=He,r.StringUtils=V,r.UnsupportedOperationException=fe,r.VideoInputDevice=Xe,r.WhiteRectangleDetector=Jt,r.WriterException=Pt,r.ZXingArrays=k,r.ZXingCharset=eu,r.ZXingInteger=N,r.ZXingStandardCharsets=Bc,r.ZXingStringBuilder=ne,r.ZXingStringEncoding=M,r.ZXingSystem=_,r.createAbstractExpandedDecoder=Le,Object.defineProperty(r,"__esModule",{value:!0})})})(Pl,Pl.exports);var Xt=Pl.exports;const wI=cm(Xt),yI=Fm({__proto__:null,default:wI},[Xt]);var rd=function(){function e(t,r,n){if(this.formatMap=new Map([[We.QR_CODE,Xt.BarcodeFormat.QR_CODE],[We.AZTEC,Xt.BarcodeFormat.AZTEC],[We.CODABAR,Xt.BarcodeFormat.CODABAR],[We.CODE_39,Xt.BarcodeFormat.CODE_39],[We.CODE_93,Xt.BarcodeFormat.CODE_93],[We.CODE_128,Xt.BarcodeFormat.CODE_128],[We.DATA_MATRIX,Xt.BarcodeFormat.DATA_MATRIX],[We.MAXICODE,Xt.BarcodeFormat.MAXICODE],[We.ITF,Xt.BarcodeFormat.ITF],[We.EAN_13,Xt.BarcodeFormat.EAN_13],[We.EAN_8,Xt.BarcodeFormat.EAN_8],[We.PDF_417,Xt.BarcodeFormat.PDF_417],[We.RSS_14,Xt.BarcodeFormat.RSS_14],[We.RSS_EXPANDED,Xt.BarcodeFormat.RSS_EXPANDED],[We.UPC_A,Xt.BarcodeFormat.UPC_A],[We.UPC_E,Xt.BarcodeFormat.UPC_E],[We.UPC_EAN_EXTENSION,Xt.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!yI)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=n;var a=this.createZXingFormats(t),o=new Map;o.set(Xt.DecodeHintType.POSSIBLE_FORMATS,a),o.set(Xt.DecodeHintType.TRY_HARDER,!1),this.hints=o}return e.prototype.decodeAsync=function(t){var r=this;return new Promise(function(n,a){try{n(r.decode(t))}catch(o){a(o)}})},e.prototype.decode=function(t){var r=new Xt.MultiFormatReader(this.verbose,this.hints),n=new Xt.HTMLCanvasElementLuminanceSource(t),a=new Xt.BinaryBitmap(new Xt.HybridBinarizer(n)),o=r.decode(a);return{text:o.text,format:Nx.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,n,a){t.set(r,n)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var r=[],n=0,a=t;n<a.length;n++){var o=a[n];this.formatMap.has(o)?r.push(this.formatMap.get(o)):this.logger.logError("".concat(o," is not supported by")+"ZXingHtml5QrcodeShim")}return r},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),_I=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},bI=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},nd=function(){function e(t,r,n){if(this.formatMap=new Map([[We.QR_CODE,"qr_code"],[We.AZTEC,"aztec"],[We.CODABAR,"codabar"],[We.CODE_39,"code_39"],[We.CODE_93,"code_93"],[We.CODE_128,"code_128"],[We.DATA_MATRIX,"data_matrix"],[We.ITF,"itf"],[We.EAN_13,"ean_13"],[We.EAN_8,"ean_8"],[We.PDF_417,"pdf417"],[We.UPC_A,"upc_a"],[We.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=n;var a=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return _I(this,void 0,void 0,function(){var r,n;return bI(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(t)];case 1:if(r=a.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(r),[2,{text:n.rawValue,format:Nx.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var r=null,n=0,a=0,o=t;a<o.length;a++){var l=o[a],h=l.boundingBox.width*l.boundingBox.height;h>n&&(n=h,r=l)}if(!r)throw"No largest barcode found";return r},e.prototype.createBarcodeDetectorFormats=function(t){for(var r=[],n=0,a=t;n<a.length;n++){var o=a[n];this.formatMap.has(o)?r.push(this.formatMap.get(o)):this.logger.warn("".concat(o," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,n,a){t.set(r,n)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),ad=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},sd=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},EI=function(){function e(t,r,n,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,r&&nd.isSupported()?(this.primaryDecoder=new nd(t,n,a),this.secondaryDecoder=new rd(t,n,a)):this.primaryDecoder=new rd(t,n,a)}return e.prototype.decodeAsync=function(t){return ad(this,void 0,void 0,function(){var r;return sd(this,function(n){switch(n.label){case 0:r=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return ad(this,void 0,void 0,function(){var r,n;return sd(this,function(a){switch(a.label){case 0:r=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,a.sent()];case 3:if(n=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw n;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var r=performance.now()-t;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,r=0,n=this.executionResults;r<n.length;r++){var a=n[r];t+=a}var o=t/this.executionResults.length;console.log("".concat(o," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),W0=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sc=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},ic=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},Dx=function(){function e(t,r){this.name=t,this.track=r}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var r={};r[this.name]=t;var n={advanced:[r]};return this.track.applyConstraints(n)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var r=t[this.name];return r}return null},e}(),AI=function(e){W0(t,e);function t(r,n){return e.call(this,r,n)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(r){var n={};n[this.name]=r;var a={advanced:[n]};return this.track.applyConstraints(a)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),n=r[this.name];return{min:n.min,max:n.max,step:n.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(Dx),CI=function(e){W0(t,e);function t(r){return e.call(this,"zoom",r)||this}return t}(AI),SI=function(e){W0(t,e);function t(r){return e.call(this,"torch",r)||this}return t}(Dx),TI=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new CI(this.track)},e.prototype.torchFeature=function(){return new SI(this.track)},e}(),NI=function(){function e(t,r,n){this.isClosed=!1,this.parentElement=t,this.mediaStream=r,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var r=document.createElement("video");return r.style.width="".concat(t,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var n=t.surface.clientWidth,a=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(n,a),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,n,a){return sc(this,void 0,void 0,function(){var o,l;return ic(this,function(h){switch(h.label){case 0:return o=new e(t,r,a),n.aspectRatio?(l={aspectRatio:n.aspectRatio},[4,o.getFirstTrackOrFail().applyConstraints(l)]):[3,2];case 1:h.sent(),h.label=2;case 2:return o.setupSurface(),[2,o]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var r=this,n=function(){setTimeout(t,200),r.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return sc(this,void 0,void 0,function(){return ic(this,function(r){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(r,n){var a=t.mediaStream.getVideoTracks(),o=a.length,l=0;t.mediaStream.getVideoTracks().forEach(function(h){t.mediaStream.removeTrack(h),h.stop(),++l,l>=o&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),r())})})},e.prototype.getCapabilities=function(){return new TI(this.getFirstTrackOrFail())},e}(),II=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,r,n){return sc(this,void 0,void 0,function(){return ic(this,function(a){return[2,NI.create(t,this.mediaStream,r,n)]})})},e.create=function(t){return sc(this,void 0,void 0,function(){var r,n;return ic(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return n=a.sent(),[2,new e(n)]}})})},e}(),id=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},od=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},kI=function(){function e(){}return e.failIfNotSupported=function(){return id(this,void 0,void 0,function(){return od(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return id(this,void 0,void 0,function(){return od(this,function(r){return[2,II.create(t)]})})},e}(),FI=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},DI=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},OI=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Gs.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Gs.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return FI(this,void 0,void 0,function(){var t,r,n,a,o,l,h;return DI(this,function(g){switch(g.label){case 0:return t=function(m){for(var p=m.getVideoTracks(),w=0,E=p;w<E.length;w++){var A=E[w];A.enabled=!1,A.stop(),m.removeTrack(A)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=g.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=g.sent(),a=[],o=0,l=n;o<l.length;o++)h=l[o],h.kind==="videoinput"&&a.push({id:h.deviceId,label:h.label});return t(r),[2,a]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,r){var n=function(o){for(var l=[],h=0,g=o;h<g.length;h++){var m=g[h];m.kind==="video"&&l.push({id:m.id,label:m.label})}t(l)},a=MediaStreamTrack;a.getSources(n)})},e}(),or;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(or||(or={}));var RI=function(){function e(){this.state=or.NOT_STARTED,this.onGoingTransactionNewState=or.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===or.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=or.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===or.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=or.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==or.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case or.UNKNOWN:throw"Transition from unknown is not allowed";case or.NOT_STARTED:this.failIfNewStateIs(t,[or.PAUSED]);break;case or.SCANNING:break;case or.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,r){for(var n=0,a=r;n<a.length;n++){var o=a[n];if(t===o)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),MI=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===or.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==or.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===or.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===or.PAUSED},e}(),LI=function(){function e(){}return e.create=function(){return new MI(new RI)},e}(),jI=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wn=function(e){jI(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(Yn),PI=function(){function e(t,r){this.logger=r,this.fps=wn.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=wn.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Fx.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!ia(this.qrbox)},e.create=function(t,r){return new e(t,r)},e}(),cd=function(){function e(t,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var n;typeof r=="boolean"?this.verbose=r===!0:r&&(n=r,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new kx(this.verbose),this.qrcode=new EI(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=LI.create()}return e.prototype.start=function(t,r,n,a){var o=this;if(!t)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var l;a?l=a:l=this.verbose?this.logger.log:function(){};var h=PI.create(r,this.logger);this.clearElement();var g=!1;h.videoConstraints&&(h.isMediaStreamConstraintsValid()?g=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var m=g,p=document.getElementById(this.elementId);p.clientWidth?p.clientWidth:wn.DEFAULT_WIDTH,p.style.position="relative",this.shouldScan=!0,this.element=p;var w=this,E=this.stateManagerProxy.startTransition(or.SCANNING);return new Promise(function(A,T){var _=m?h.videoConstraints:w.createVideoConstraints(t);if(!_){E.cancel(),T("videoConstraints should be defined");return}var C={};(!m||h.aspectRatio)&&(C.aspectRatio=h.aspectRatio);var S={onRenderSurfaceReady:function(k,N){w.setupUi(k,N,h),w.isScanning=!0,w.foreverScan(h,n,l)}};kI.failIfNotSupported().then(function(k){k.create(_).then(function(N){return N.render(o.element,C,S).then(function(F){w.renderedCamera=F,E.execute(),A(null)}).catch(function(F){E.cancel(),T(F)})}).catch(function(N){E.cancel(),T(Gs.errorGettingUserMedia(N))})}).catch(function(k){E.cancel(),T(Gs.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(or.PAUSED),this.showPausedState(),(ia(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,r=function(){t.stateManagerProxy.directTransition(or.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(or.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(t.element){var o=document.getElementById(wn.SHADED_REGION_ELEMENT_ID);o&&t.element.removeChild(o)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),n(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),r.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,r){return this.scanFileV2(t,r).then(function(n){return n.decodedText})},e.prototype.scanFileV2=function(t,r){var n=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(ia(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,o){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(t);var l=new Image;l.onload=function(){var h=l.width,g=l.height,m=document.getElementById(n.elementId),p=m.clientWidth?m.clientWidth:wn.DEFAULT_WIDTH,w=Math.max(m.clientHeight?m.clientHeight:g,wn.FILE_SCAN_MIN_HEIGHT),E=n.computeCanvasDrawConfig(h,g,p,w);if(r){var A=n.createCanvasElement(p,w,"qr-canvas-visible");A.style.display="inline-block",m.appendChild(A);var T=A.getContext("2d");if(!T)throw"Unable to get 2d context from canvas";T.canvas.width=p,T.canvas.height=w,T.drawImage(l,0,0,h,g,E.x,E.y,E.width,E.height)}var _=wn.FILE_SCAN_HIDDEN_CANVAS_PADDING,C=Math.max(l.width,E.width),S=Math.max(l.height,E.height),k=C+2*_,N=S+2*_,F=n.createCanvasElement(k,N);m.appendChild(F);var W=F.getContext("2d");if(!W)throw"Unable to get 2d context from canvas";W.canvas.width=k,W.canvas.height=N,W.drawImage(l,0,0,h,g,_,_,C,S);try{n.qrcode.decodeRobustlyAsync(F).then(function(B){a(ed.createFromQrcodeResult(B))}).catch(o)}catch(B){o("QR code parse error, error = ".concat(B))}},l.onerror=o,l.onabort=o,l.onstalled=o,l.onsuspend=o,l.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return OI.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!Fx.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var r=[We.QR_CODE,We.AZTEC,We.CODABAR,We.CODE_39,We.CODE_93,We.CODE_128,We.DATA_MATRIX,We.MAXICODE,We.ITF,We.EAN_13,We.EAN_8,We.PDF_417,We.RSS_14,We.RSS_EXPANDED,We.UPC_A,We.UPC_E,We.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return r;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],a=0,o=t.formatsToSupport;a<o.length;a++){var l=o[a];pI(l)?n.push(l):this.logger.warn("Invalid format: ".concat(l," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(ia(t))return!0;if(!ia(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(ia(t.experimentalFeatures))return!0;var r=t.experimentalFeatures;return ia(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,r,n){var a=this,o=n.qrbox;this.validateQrboxConfig(o);var l=this.toQrdimensions(t,r,o),h=function(m){if(m<wn.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(wn.MIN_QR_BOX_SIZE,"px.")},g=function(m){return m>t&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),m=t),m};h(l.width),h(l.height),l.width=g(l.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,r,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(t,r)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return n},e.prototype.setupUi=function(t,r,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(t,r,n);var a=ia(n.qrbox)?{width:t,height:r}:n.qrbox;this.validateQrboxConfig(a);var o=this.toQrdimensions(t,r,a);o.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var l=n.isShadedBoxEnabled()&&o.height<=r,h={x:0,y:0,width:t,height:r},g=l?this.getShadedRegionBounds(t,r,o):h,m=this.createCanvasElement(g.width,g.height),p={willReadFrequently:!0},w=m.getContext("2d",p);w.canvas.width=g.width,w.canvas.height=g.height,this.element.append(m),l&&this.possiblyInsertShadingElement(this.element,t,r,o),this.createScannerPausedUiElement(this.element),this.qrRegion=g,this.context=w,this.canvasElement=m},e.prototype.createScannerPausedUiElement=function(t){var r=document.createElement("div");r.innerText=Gs.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",t.appendChild(r),this.scannerPausedUiElement=r},e.prototype.scanContext=function(t,r){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return t(a.text,ed.createFromQrcodeResult(a)),n.possiblyUpdateShaders(!0),!0}).catch(function(a){n.possiblyUpdateShaders(!1);var o=Gs.codeParseError(a);return r(o,Ix.createFrom(o)),!1})},e.prototype.foreverScan=function(t,r,n){var a=this;if(this.shouldScan&&this.renderedCamera){var o=this.renderedCamera.getSurface(),l=o.videoWidth/o.clientWidth,h=o.videoHeight/o.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var g=this.qrRegion.width*l,m=this.qrRegion.height*h,p=this.qrRegion.x*l,w=this.qrRegion.y*h;this.context.drawImage(o,p,w,g,m,0,0,this.qrRegion.width,this.qrRegion.height);var E=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(t,r,n)},a.getTimeoutFps(t.fps))};this.scanContext(r,n).then(function(A){!A&&t.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(r,n).finally(function(){E()})):E()}).catch(function(A){a.logger.logError("Error happend while scanning context",A),E()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var r="facingMode",n="deviceId",a={user:!0,environment:!0},o="exact",l=function(T){if(T in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(T,"'")},h=Object.keys(t);if(h.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(h.length," keys");var g=Object.keys(t)[0];if(g!==r&&g!==n)throw"Only '".concat(r,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(g===r){var m=t.facingMode;if(typeof m=="string"){if(l(m))return{facingMode:m}}else if(typeof m=="object")if(o in m){if(l(m["".concat(o)]))return{facingMode:{exact:m["".concat(o)]}}}else throw"'facingMode' should be string or object with"+" ".concat(o," as key.");else{var p=typeof m;throw"Invalid type of 'facingMode' = ".concat(p)}}else{var w=t.deviceId;if(typeof w=="string")return{deviceId:w};if(typeof w=="object"){if(o in w)return{deviceId:{exact:w["".concat(o)]}};throw"'deviceId' should be string or object with"+" ".concat(o," as key.")}else{var E=typeof w;throw"Invalid type of 'deviceId' = ".concat(E)}}}var A=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(A)},e.prototype.computeCanvasDrawConfig=function(t,r,n,a){if(t<=n&&r<=a){var o=(n-t)/2,l=(a-r)/2;return{x:o,y:l,width:t,height:r}}else{var h=t,g=r;return t>n&&(r=n/t*r,t=n),r>a&&(t=a/r*t,r=a),this.logger.log("Image downsampled from "+"".concat(h,"X").concat(g)+" to ".concat(t,"X").concat(r,".")),this.computeCanvasDrawConfig(t,r,n,a)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=t?wn.BORDER_SHADER_MATCH_COLOR:wn.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,r,n){var a=t,o=r,l=document.createElement("canvas");return l.style.width="".concat(a,"px"),l.style.height="".concat(o,"px"),l.style.display="none",l.id=ia(n)?"qr-canvas":n,l},e.prototype.getShadedRegionBounds=function(t,r,n){if(n.width>t||n.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-n.width)/2,y:(r-n.height)/2,width:n.width,height:n.height}},e.prototype.possiblyInsertShadingElement=function(t,r,n,a){if(!(r-a.width<1||n-a.height<1)){var o=document.createElement("div");o.style.position="absolute";var l=(r-a.width)/2,h=(n-a.height)/2;if(o.style.borderLeft="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderRight="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderTop="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),o.style.borderBottom="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),o.style.boxSizing="border-box",o.style.top="0px",o.style.bottom="0px",o.style.left="0px",o.style.right="0px",o.id="".concat(wn.SHADED_REGION_ELEMENT_ID),r-a.width<11||n-a.height<11)this.hasBorderShaders=!1;else{var g=5,m=40;this.insertShaderBorders(o,m,g,-g,null,0,!0),this.insertShaderBorders(o,m,g,-g,null,0,!1),this.insertShaderBorders(o,m,g,null,-g,0,!0),this.insertShaderBorders(o,m,g,null,-g,0,!1),this.insertShaderBorders(o,g,m+g,-g,null,-g,!0),this.insertShaderBorders(o,g,m+g,null,-g,-g,!0),this.insertShaderBorders(o,g,m+g,-g,null,-g,!1),this.insertShaderBorders(o,g,m+g,null,-g,-g,!1),this.hasBorderShaders=!0}t.append(o)}},e.prototype.insertShaderBorders=function(t,r,n,a,o,l,h){var g=document.createElement("div");g.style.position="absolute",g.style.backgroundColor=wn.BORDER_SHADER_DEFAULT_COLOR,g.style.width="".concat(r,"px"),g.style.height="".concat(n,"px"),a!==null&&(g.style.top="".concat(a,"px")),o!==null&&(g.style.bottom="".concat(o,"px")),h?g.style.left="".concat(l,"px"):g.style.right="".concat(l,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(g),t.appendChild(g)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),V0="data:image/svg+xml;base64,",BI=V0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",UI=V0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",ld=V0+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",zI="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",ud=function(){function e(){}return e.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},e}(),HI=function(){function e(){this.data=ud.createDefault();var t=localStorage.getItem(e.LOCAL_STORAGE_KEY);t?this.data=JSON.parse(t):this.reset()}return e.prototype.hasCameraPermissions=function(){return this.data.hasPermission},e.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},e.prototype.setHasPermission=function(t){this.data.hasPermission=t,this.flush()},e.prototype.setLastUsedCameraId=function(t){this.data.lastUsedCameraId=t,this.flush()},e.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},e.prototype.reset=function(){this.data=ud.createDefault(),this.flush()},e.prototype.flush=function(){localStorage.setItem(e.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},e.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",e}(),WI=function(){function e(){this.infoDiv=document.createElement("div")}return e.prototype.renderInto=function(t){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=td.poweredBy();var r=document.createElement("a");r.innerText="ScanApp",r.href="https://scanapp.org",r.target="new",r.style.color="white",this.infoDiv.appendChild(r);var n=document.createElement("br"),a=document.createElement("br");this.infoDiv.appendChild(n),this.infoDiv.appendChild(a);var o=document.createElement("a");o.innerText=td.reportIssues(),o.href="https://github.com/mebjas/html5-qrcode/issues",o.target="new",o.style.color="white",this.infoDiv.appendChild(o),t.appendChild(this.infoDiv)},e.prototype.show=function(){this.infoDiv.style.display="block"},e.prototype.hide=function(){this.infoDiv.style.display="none"},e}(),VI=function(){function e(t,r){this.isShowingInfoIcon=!0,this.onTapIn=t,this.onTapOut=r,this.infoIcon=document.createElement("img")}return e.prototype.renderInto=function(t){var r=this;this.infoIcon.alt="Info icon",this.infoIcon.src=ld,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(n){return r.onHoverIn()},this.infoIcon.onmouseout=function(n){return r.onHoverOut()},this.infoIcon.onclick=function(n){return r.onClick()},t.appendChild(this.infoIcon)},e.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},e.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},e.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=zI,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=ld,this.infoIcon.style.opacity="0.6")},e}(),GI=function(){function e(){var t=this;this.infoDiv=new WI,this.infoIcon=new VI(function(){t.infoDiv.show()},function(){t.infoDiv.hide()})}return e.prototype.renderInto=function(t){this.infoDiv.renderInto(t),this.infoIcon.renderInto(t)},e}(),XI=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},YI=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},fd=function(){function e(){}return e.hasPermissions=function(){return XI(this,void 0,void 0,function(){var t,r,n,a;return YI(this,function(o){switch(o.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(t=o.sent(),r=0,n=t;r<n.length;r++)if(a=n[r],a.kind==="videoinput"&&a.label)return[2,!0];return[2,!1]}})})},e}(),La=function(){function e(t){this.supportedScanTypes=this.validateAndReturnScanTypes(t)}return e.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},e.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},e.prototype.isCameraScanRequired=function(){for(var t=0,r=this.supportedScanTypes;t<r.length;t++){var n=r[t];if(e.isCameraScanType(n))return!0}return!1},e.isCameraScanType=function(t){return t===qa.SCAN_TYPE_CAMERA},e.isFileScanType=function(t){return t===qa.SCAN_TYPE_FILE},e.prototype.validateAndReturnScanTypes=function(t){if(!t||t.length===0)return Yn.DEFAULT_SUPPORTED_SCAN_TYPE;var r=Yn.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(t.length>r)throw"Max ".concat(r," values expected for ")+"supportedScanTypes";for(var n=0,a=t;n<a.length;n++){var o=a[n];if(!Yn.DEFAULT_SUPPORTED_SCAN_TYPE.includes(o))throw"Unsupported scan type ".concat(o)}return t},e}(),Cn=function(){function e(){}return e.ALL_ELEMENT_CLASS="html5-qrcode-element",e.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",e.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",e.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",e.TORCH_BUTTON_ID="html5-qrcode-button-torch",e.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",e.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",e.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",e.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",e.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",e.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",e}(),pa=function(){function e(){}return e.createElement=function(t,r){var n=document.createElement(t);return n.id=r,n.classList.add(Cn.ALL_ELEMENT_CLASS),t==="button"&&n.setAttribute("type","button"),n},e}(),Ox=function(e,t,r,n){function a(o){return o instanceof r?o:new r(function(l){l(o)})}return new(r||(r=Promise))(function(o,l){function h(p){try{m(n.next(p))}catch(w){l(w)}}function g(p){try{m(n.throw(p))}catch(w){l(w)}}function m(p){p.done?o(p.value):a(p.value).then(h,g)}m((n=n.apply(e,t||[])).next())})},Rx=function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,a,o,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(m){return function(p){return g([m,p])}}function g(m){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,m[0]&&(r=0)),r;)try{if(n=1,a&&(o=m[0]&2?a.return:m[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,m[1])).done)return o;switch(a=0,o&&(m=[m[0]&2,o.value]),m[0]){case 0:case 1:o=m;break;case 4:return r.label++,{value:m[1],done:!1};case 5:r.label++,a=m[1],m=[0];continue;case 7:m=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(m[0]===6||m[0]===2)){r=0;continue}if(m[0]===3&&(!o||m[1]>o[0]&&m[1]<o[3])){r.label=m[1];break}if(m[0]===6&&r.label<o[1]){r.label=o[1],o=m;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(m);break}o[2]&&r.ops.pop(),r.trys.pop();continue}m=t.call(e,r)}catch(p){m=[6,p],a=0}finally{n=o=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}},dd=function(){function e(t,r,n){this.isTorchOn=!1,this.torchCapability=t,this.buttonController=r,this.onTorchActionFailureCallback=n}return e.prototype.isTorchEnabled=function(){return this.isTorchOn},e.prototype.flipState=function(){return Ox(this,void 0,void 0,function(){var t,r;return Rx(this,function(n){switch(n.label){case 0:this.buttonController.disable(),t=!this.isTorchOn,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.torchCapability.apply(t)];case 2:return n.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),t),[3,4];case 3:return r=n.sent(),this.propagateFailure(t,r),this.buttonController.enable(),[3,4];case 4:return[2]}})})},e.prototype.updateUiBasedOnLatestSettings=function(t,r){t===r?(this.buttonController.setText(r?Rt.torchOffButton():Rt.torchOnButton()),this.isTorchOn=r):this.propagateFailure(r),this.buttonController.enable()},e.prototype.propagateFailure=function(t,r){var n=t?Rt.torchOnFailedMessage():Rt.torchOffFailedMessage();r&&(n+="; Error = "+r),this.onTorchActionFailureCallback(n)},e.prototype.reset=function(){this.isTorchOn=!1},e}(),ZI=function(){function e(t,r){this.onTorchActionFailureCallback=r,this.torchButton=pa.createElement("button",Cn.TORCH_BUTTON_ID),this.torchController=new dd(t,this,r)}return e.prototype.render=function(t,r){var n=this;this.torchButton.innerText=Rt.torchOnButton(),this.torchButton.style.display=r.display,this.torchButton.style.marginLeft=r.marginLeft;var a=this;this.torchButton.addEventListener("click",function(o){return Ox(n,void 0,void 0,function(){return Rx(this,function(l){switch(l.label){case 0:return[4,a.torchController.flipState()];case 1:return l.sent(),a.torchController.isTorchEnabled()?(a.torchButton.classList.remove(Cn.TORCH_BUTTON_CLASS_TORCH_OFF),a.torchButton.classList.add(Cn.TORCH_BUTTON_CLASS_TORCH_ON)):(a.torchButton.classList.remove(Cn.TORCH_BUTTON_CLASS_TORCH_ON),a.torchButton.classList.add(Cn.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),t.appendChild(this.torchButton)},e.prototype.updateTorchCapability=function(t){this.torchController=new dd(t,this,this.onTorchActionFailureCallback)},e.prototype.getTorchButton=function(){return this.torchButton},e.prototype.hide=function(){this.torchButton.style.display="none"},e.prototype.show=function(){this.torchButton.style.display="inline-block"},e.prototype.disable=function(){this.torchButton.disabled=!0},e.prototype.enable=function(){this.torchButton.disabled=!1},e.prototype.setText=function(t){this.torchButton.innerText=t},e.prototype.reset=function(){this.torchButton.innerText=Rt.torchOnButton(),this.torchController.reset()},e.create=function(t,r,n,a){var o=new e(r,a);return o.render(t,n),o},e}(),$I=function(){function e(t,r,n){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=r?"block":"none",t.appendChild(this.fileBasedScanRegion);var a=document.createElement("label");a.setAttribute("for",this.getFileScanInputId()),a.style.display="inline-block",this.fileBasedScanRegion.appendChild(a),this.fileSelectionButton=pa.createElement("button",Cn.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(h){a.click()}),a.append(this.fileSelectionButton),this.fileScanInput=pa.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",a.appendChild(this.fileScanInput);var o=this;this.fileScanInput.addEventListener("change",function(h){if(!(h==null||h.target==null)){var g=h.target;if(!(g.files&&g.files.length===0)){var m=g.files,p=m[0],w=p.name;o.setImageNameToButton(w),n(p)}}});var l=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(l),this.fileBasedScanRegion.addEventListener("dragenter",function(h){o.fileBasedScanRegion.style.border=o.fileBasedScanRegionActiveBorder(),h.stopPropagation(),h.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(h){o.fileBasedScanRegion.style.border=o.fileBasedScanRegionDefaultBorder(),h.stopPropagation(),h.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(h){o.fileBasedScanRegion.style.border=o.fileBasedScanRegionActiveBorder(),h.stopPropagation(),h.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(h){h.stopPropagation(),h.preventDefault(),o.fileBasedScanRegion.style.border=o.fileBasedScanRegionDefaultBorder();var g=h.dataTransfer;if(g){var m=g.files;if(!m||m.length===0)return;for(var p=!1,w=0;w<m.length;++w){var E=m.item(w);if(E){var A=/image.*/;if(E.type.match(A)){p=!0;var T=E.name;o.setImageNameToButton(T),n(E),l.innerText=Rt.dragAndDropMessage();break}}}p||(l.innerText=Rt.dragAndDropMessageOnlyImages())}})}return e.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},e.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},e.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},e.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},e.prototype.createFileBasedScanRegion=function(){var t=document.createElement("div");return t.style.textAlign="center",t.style.margin="auto",t.style.width="80%",t.style.maxWidth="600px",t.style.border=this.fileBasedScanRegionDefaultBorder(),t.style.padding="10px",t.style.marginBottom="10px",t},e.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},e.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},e.prototype.createDragAndDropMessage=function(){var t=document.createElement("div");return t.innerText=Rt.dragAndDropMessage(),t.style.fontWeight="400",t},e.prototype.setImageNameToButton=function(t){var r=20;if(t.length>r){var n=t.substring(0,8),a=t.length,o=t.substring(a-8,a);t="".concat(n,"....").concat(o)}var l=Rt.fileSelectionChooseAnother()+" - "+t;this.fileSelectionButton.innerText=l},e.prototype.setInitialValueToButton=function(){var t=Rt.fileSelectionChooseImage()+" - "+Rt.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=t},e.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},e.create=function(t,r,n){var a=new e(t,r,n);return a},e}(),qI=function(){function e(t){this.selectElement=pa.createElement("select",Cn.CAMERA_SELECTION_SELECT_ID),this.cameras=t,this.options=[]}return e.prototype.render=function(t){var r=document.createElement("span");r.style.marginRight="10px";var n=this.cameras.length;if(n===0)throw new Error("No cameras found");if(n===1)r.style.display="none";else{var a=Rt.selectCamera();r.innerText="".concat(a," (").concat(this.cameras.length,")  ")}for(var o=1,l=0,h=this.cameras;l<h.length;l++){var g=h[l],m=g.id,p=g.label==null?m:g.label;(!p||p==="")&&(p=[Rt.anonymousCameraPrefix(),o++].join(" "));var w=document.createElement("option");w.value=m,w.innerText=p,this.options.push(w),this.selectElement.appendChild(w)}r.appendChild(this.selectElement),t.appendChild(r)},e.prototype.disable=function(){this.selectElement.disabled=!0},e.prototype.isDisabled=function(){return this.selectElement.disabled===!0},e.prototype.enable=function(){this.selectElement.disabled=!1},e.prototype.getValue=function(){return this.selectElement.value},e.prototype.hasValue=function(t){for(var r=0,n=this.options;r<n.length;r++){var a=n[r];if(a.value===t)return!0}return!1},e.prototype.setValue=function(t){if(!this.hasValue(t))throw new Error("".concat(t," is not present in the camera list."));this.selectElement.value=t},e.prototype.hasSingleItem=function(){return this.cameras.length===1},e.prototype.numCameras=function(){return this.cameras.length},e.create=function(t,r){var n=new e(r);return n.render(t),n},e}(),KI=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=pa.createElement("input",Cn.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(t,r){this.zoomElementContainer.style.display=r?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",t.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var n=Rt.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(n),this.rangeText.style.marginRight="10px";var a=this;this.rangeInput.addEventListener("input",function(){return a.onValueChange()}),this.rangeInput.addEventListener("change",function(){return a.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){var t=Rt.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(t),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(t,r,n,a){this.rangeInput.min=t.toString(),this.rangeInput.max=r.toString(),this.rangeInput.step=a.toString(),this.rangeInput.value=n.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.style.display="block"},e.prototype.hide=function(){this.zoomElementContainer.style.display="none"},e.prototype.setOnCameraZoomValueChangeCallback=function(t){this.onChangeCallback=t},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t,r){var n=new e;return n.render(t,r),n},e}(),yn;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(yn||(yn={}));function QI(e){return{fps:e.fps,qrbox:e.qrbox,aspectRatio:e.aspectRatio,disableFlip:e.disableFlip,videoConstraints:e.videoConstraints}}function JI(e,t){return{formatsToSupport:e.formatsToSupport,useBarCodeDetectorIfSupported:e.useBarCodeDetectorIfSupported,experimentalFeatures:e.experimentalFeatures,verbose:t}}var ek=function(){function e(t,r,n){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=t,this.config=this.createConfig(r),this.verbose=n===!0,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.scanTypeSelector=new La(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new kx(this.verbose),this.persistedDataManager=new HI,r.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return e.prototype.render=function(t,r){var n=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(o,l){if(t)t(o,l);else{if(n.lastMatchFound===o)return;n.lastMatchFound=o,n.setHeaderMessage(Rt.lastMatch(o),yn.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(o,l){r&&r(o,l)};var a=document.getElementById(this.elementId);if(!a)throw"HTML Element with id=".concat(this.elementId," not found");a.innerHTML="",this.createBasicLayout(a),this.html5Qrcode=new cd(this.getScanRegionId(),JI(this.config,this.verbose))},e.prototype.pause=function(t){(ia(t)||t!==!0)&&(t=!1),this.getHtml5QrcodeOrFail().pause(t)},e.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},e.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},e.prototype.clear=function(){var t=this,r=function(){var n=document.getElementById(t.elementId);n&&(n.innerHTML="",t.resetBasicLayout(n))};return this.html5Qrcode?new Promise(function(n,a){if(!t.html5Qrcode){n();return}t.html5Qrcode.isScanning?t.html5Qrcode.stop().then(function(o){if(!t.html5Qrcode){n();return}t.html5Qrcode.clear(),r(),n()}).catch(function(o){t.verbose&&t.logger.logError("Unable to stop qrcode scanner",o),a(o)}):(t.html5Qrcode.clear(),r(),n())}):Promise.resolve()},e.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},e.prototype.applyVideoConstraints=function(t){return this.getHtml5QrcodeOrFail().applyVideoConstraints(t)},e.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},e.prototype.createConfig=function(t){return t?(t.fps||(t.fps=Yn.SCAN_DEFAULT_FPS),t.rememberLastUsedCamera!==!Yn.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(t.rememberLastUsedCamera=Yn.DEFAULT_REMEMBER_LAST_CAMERA_USED),t.supportedScanTypes||(t.supportedScanTypes=Yn.DEFAULT_SUPPORTED_SCAN_TYPE),t):{fps:Yn.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Yn.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Yn.DEFAULT_SUPPORTED_SCAN_TYPE}},e.prototype.createBasicLayout=function(t){t.style.position="relative",t.style.padding="0px",t.style.border="1px solid silver",this.createHeader(t);var r=document.createElement("div"),n=this.getScanRegionId();r.id=n,r.style.width="100%",r.style.minHeight="100px",r.style.textAlign="center",t.appendChild(r),La.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var a=document.createElement("div"),o=this.getDashboardId();a.id=o,a.style.width="100%",t.appendChild(a),this.setupInitialDashboard(a)},e.prototype.resetBasicLayout=function(t){t.style.border="none"},e.prototype.setupInitialDashboard=function(t){this.createSection(t),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},e.prototype.createHeader=function(t){var r=document.createElement("div");r.style.textAlign="left",r.style.margin="0px",t.appendChild(r);var n=new GI;n.renderInto(r);var a=document.createElement("div");a.id=this.getHeaderMessageContainerId(),a.style.display="none",a.style.textAlign="center",a.style.fontSize="14px",a.style.padding="2px 10px",a.style.margin="4px",a.style.borderTop="1px solid #f6f6f6",r.appendChild(a)},e.prototype.createSection=function(t){var r=document.createElement("div");r.id=this.getDashboardSectionId(),r.style.width="100%",r.style.padding="10px 0px 10px 0px",r.style.textAlign="left",t.appendChild(r)},e.prototype.createCameraListUi=function(t,r,n){var a=this;a.showHideScanTypeSwapLink(!1),a.setHeaderMessage(Rt.cameraPermissionRequesting());var o=function(){n||a.createPermissionButton(t,r)};cd.getCameras().then(function(l){a.persistedDataManager.setHasPermission(!0),a.showHideScanTypeSwapLink(!0),a.resetHeaderMessage(),l&&l.length>0?(t.removeChild(r),a.renderCameraSelection(l)):(a.setHeaderMessage(Rt.noCameraFound(),yn.STATUS_WARNING),o())}).catch(function(l){a.persistedDataManager.setHasPermission(!1),n?n.disabled=!1:o(),a.setHeaderMessage(l,yn.STATUS_WARNING),a.showHideScanTypeSwapLink(!0)})},e.prototype.createPermissionButton=function(t,r){var n=this,a=pa.createElement("button",this.getCameraPermissionButtonId());a.innerText=Rt.cameraPermissionTitle(),a.addEventListener("click",function(){a.disabled=!0,n.createCameraListUi(t,r,a)}),r.appendChild(a)},e.prototype.createPermissionsUi=function(t,r){var n=this;if(La.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){fd.hasPermissions().then(function(a){a?n.createCameraListUi(t,r):(n.persistedDataManager.setHasPermission(!1),n.createPermissionButton(t,r))}).catch(function(a){n.persistedDataManager.setHasPermission(!1),n.createPermissionButton(t,r)});return}this.createPermissionButton(t,r)},e.prototype.createSectionControlPanel=function(){var t=document.getElementById(this.getDashboardSectionId()),r=document.createElement("div");t.appendChild(r);var n=document.createElement("div");n.id=this.getDashboardSectionCameraScanRegionId(),n.style.display=La.isCameraScanType(this.currentScanType)?"block":"none",r.appendChild(n);var a=document.createElement("div");a.style.textAlign="center",n.appendChild(a),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(n,a),this.renderFileScanUi(r)},e.prototype.renderFileScanUi=function(t){var r=La.isFileScanType(this.currentScanType),n=this,a=function(o){if(!n.html5Qrcode)throw"html5Qrcode not defined";La.isFileScanType(n.currentScanType)&&(n.setHeaderMessage(Rt.loadingImage()),n.html5Qrcode.scanFileV2(o,!0).then(function(l){n.resetHeaderMessage(),n.qrCodeSuccessCallback(l.decodedText,l)}).catch(function(l){n.setHeaderMessage(l,yn.STATUS_WARNING),n.qrCodeErrorCallback(l,Ix.createFrom(l))}))};this.fileSelectionUi=$I.create(t,r,a)},e.prototype.renderCameraSelection=function(t){var r=this,n=this,a=document.getElementById(this.getDashboardSectionCameraScanRegionId());a.style.textAlign="center";var o=KI.create(a,!1),l=function(_){var C=_.zoomFeature();if(C.isSupported()){o.setOnCameraZoomValueChangeCallback(function(k){C.apply(k)});var S=1;r.config.defaultZoomValueIfSupported&&(S=r.config.defaultZoomValueIfSupported),S=vI(S,C.min(),C.max()),o.setValues(C.min(),C.max(),S,C.step()),o.show()}},h=qI.create(a,t),g=document.createElement("span"),m=pa.createElement("button",Cn.CAMERA_START_BUTTON_ID);m.innerText=Rt.scanButtonStartScanningText(),g.appendChild(m);var p=pa.createElement("button",Cn.CAMERA_STOP_BUTTON_ID);p.innerText=Rt.scanButtonStopScanningText(),p.style.display="none",p.disabled=!0,g.appendChild(p);var w,E=function(_){if(!_.torchFeature().isSupported()){w&&w.hide();return}w?w.updateTorchCapability(_.torchFeature()):w=ZI.create(g,_.torchFeature(),{display:"none",marginLeft:"5px"},function(C){n.setHeaderMessage(C,yn.STATUS_WARNING)}),w.show()};a.appendChild(g);var A=function(_){_||(m.style.display="none"),m.innerText=Rt.scanButtonStartScanningText(),m.style.opacity="1",m.disabled=!1,_&&(m.style.display="inline-block")};if(m.addEventListener("click",function(_){m.innerText=Rt.scanButtonScanningStarting(),h.disable(),m.disabled=!0,m.style.opacity="0.5",r.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(!1),n.resetHeaderMessage();var C=h.getValue();n.persistedDataManager.setLastUsedCameraId(C),n.html5Qrcode.start(C,QI(n.config),n.qrCodeSuccessCallback,n.qrCodeErrorCallback).then(function(S){p.disabled=!1,p.style.display="inline-block",A(!1);var k=n.html5Qrcode.getRunningTrackCameraCapabilities();r.config.showTorchButtonIfSupported===!0&&E(k),r.config.showZoomSliderIfSupported===!0&&l(k)}).catch(function(S){n.showHideScanTypeSwapLink(!0),h.enable(),A(!0),n.setHeaderMessage(S,yn.STATUS_WARNING)})}),h.hasSingleItem()&&m.click(),p.addEventListener("click",function(_){if(!n.html5Qrcode)throw"html5Qrcode not defined";p.disabled=!0,n.html5Qrcode.stop().then(function(C){r.scanTypeSelector.hasMoreThanOneScanType()&&n.showHideScanTypeSwapLink(!0),h.enable(),m.disabled=!1,p.style.display="none",m.style.display="inline-block",w&&(w.reset(),w.hide()),o.removeOnCameraZoomValueChangeCallback(),o.hide(),n.insertCameraScanImageToScanRegion()}).catch(function(C){p.disabled=!1,n.setHeaderMessage(C,yn.STATUS_WARNING)})}),n.persistedDataManager.getLastUsedCameraId()){var T=n.persistedDataManager.getLastUsedCameraId();h.hasValue(T)?(h.setValue(T),m.click()):n.persistedDataManager.resetLastUsedCameraId()}},e.prototype.createSectionSwap=function(){var t=this,r=Rt.textIfCameraScanSelected(),n=Rt.textIfFileScanSelected(),a=document.getElementById(this.getDashboardSectionId()),o=document.createElement("div");o.style.textAlign="center";var l=pa.createElement("span",this.getDashboardSectionSwapLinkId());l.style.textDecoration="underline",l.style.cursor="pointer",l.innerText=La.isCameraScanType(this.currentScanType)?r:n,l.addEventListener("click",function(){if(!t.sectionSwapAllowed){t.verbose&&t.logger.logError("Section swap called when not allowed");return}t.resetHeaderMessage(),t.fileSelectionUi.resetValue(),t.sectionSwapAllowed=!1,La.isCameraScanType(t.currentScanType)?(t.clearScanRegion(),t.getCameraScanRegion().style.display="none",t.fileSelectionUi.show(),l.innerText=n,t.currentScanType=qa.SCAN_TYPE_FILE,t.insertFileScanImageToScanRegion()):(t.clearScanRegion(),t.getCameraScanRegion().style.display="block",t.fileSelectionUi.hide(),l.innerText=r,t.currentScanType=qa.SCAN_TYPE_CAMERA,t.insertCameraScanImageToScanRegion(),t.startCameraScanIfPermissionExistsOnSwap()),t.sectionSwapAllowed=!0}),o.appendChild(l),a.appendChild(o)},e.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var t=this,r=this;if(this.persistedDataManager.hasCameraPermissions()){fd.hasPermissions().then(function(n){if(n){var a=document.getElementById(r.getCameraPermissionButtonId());if(!a)throw t.logger.logError("Permission button not found, fail;"),"Permission button not found";a.click()}else r.persistedDataManager.setHasPermission(!1)}).catch(function(n){r.persistedDataManager.setHasPermission(!1)});return}},e.prototype.resetHeaderMessage=function(){var t=document.getElementById(this.getHeaderMessageContainerId());t.style.display="none"},e.prototype.setHeaderMessage=function(t,r){r||(r=yn.STATUS_DEFAULT);var n=this.getHeaderMessageDiv();switch(n.innerText=t,n.style.display="block",r){case yn.STATUS_SUCCESS:n.style.background="rgba(106, 175, 80, 0.26)",n.style.color="#477735";break;case yn.STATUS_WARNING:n.style.background="rgba(203, 36, 49, 0.14)",n.style.color="#cb2431";break;case yn.STATUS_DEFAULT:default:n.style.background="rgba(0, 0, 0, 0)",n.style.color="rgb(17, 17, 17)";break}},e.prototype.showHideScanTypeSwapLink=function(t){this.scanTypeSelector.hasMoreThanOneScanType()&&(t!==!0&&(t=!1),this.sectionSwapAllowed=t,this.getDashboardSectionSwapLink().style.display=t?"inline-block":"none")},e.prototype.insertCameraScanImageToScanRegion=function(){var t=this,r=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){r.innerHTML="<br>",r.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(n){r.innerHTML="<br>",r.appendChild(t.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=BI,this.cameraScanImage.alt=Rt.cameraScanAltText()},e.prototype.insertFileScanImageToScanRegion=function(){var t=this,r=document.getElementById(this.getScanRegionId());if(this.fileScanImage){r.innerHTML="<br>",r.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(n){r.innerHTML="<br>",r.appendChild(t.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=UI,this.fileScanImage.alt=Rt.fileScanAltText()},e.prototype.clearScanRegion=function(){var t=document.getElementById(this.getScanRegionId());t.innerHTML=""},e.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},e.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},e.prototype.getDashboardSectionSwapLinkId=function(){return Cn.SCAN_TYPE_CHANGE_ANCHOR_ID},e.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},e.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},e.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},e.prototype.getCameraPermissionButtonId=function(){return Cn.CAMERA_PERMISSION_BUTTON_ID},e.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},e.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},e.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},e}();function tk({isOpen:e,onClose:t,onScan:r}){const n=Y.useRef(null),[a,o]=Y.useState(null);Y.useEffect(()=>{if(e&&!n.current){const h=new ek("qr-reader",{fps:10,qrbox:{width:250,height:250},aspectRatio:1},!1);h.render(g=>{r(g),l()},g=>{console.warn("QR Code scan error:",g),o("Unable to scan. Please try again or check camera permissions.")}),n.current=h}return()=>{l()}},[e,r]);const l=()=>{n.current&&(n.current.clear().catch(console.error),n.current=null),o(null)};return e?f.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:f.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[f.jsx("div",{className:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:t}),f.jsxs("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(yd,{className:"h-6 w-6 text-green-600 mr-2"}),f.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Scan Item"})]}),f.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-500",children:f.jsx(ua,{className:"h-6 w-6"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Position the QR code or barcode within the camera view to scan."}),a&&f.jsxs("div",{className:"flex items-center p-3 text-sm text-red-700 bg-red-100 rounded-lg",children:[f.jsx(to,{className:"h-4 w-4 mr-2"}),a]}),f.jsx("div",{id:"qr-reader",className:"w-full"}),f.jsx("div",{className:"flex gap-2",children:f.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200",children:"Cancel"})})]})]})]})}):null}function rk(){const{items:e,loading:t,create:r,update:n,delete:a,refresh:o}=ca("inventory_items"),[l,h]=Y.useState(""),[g,m]=Y.useState("all"),[p,w]=Y.useState(!1),[E,A]=Y.useState(!1),[T,_]=Y.useState(!1),[C,S]=Y.useState(null);Y.useEffect(()=>{o()},[o]);const k=e.filter(V=>{const ne=V.name.toLowerCase().includes(l.toLowerCase())||V.sku.toLowerCase().includes(l.toLowerCase()),me=g==="all"||V.category===g;return ne&&me}),N=["all",...Array.from(new Set(e.map(V=>V.category)))],F=async V=>{if(C)await n(C.id,V);else{const ne=V.current_stock===0?"out_of_stock":V.current_stock<=V.min_stock?"low_stock":"in_stock";await r({...V,supplier:V.supplier||null,unit_cost:V.unit_cost??null,status:ne,last_updated:new Date().toISOString()})}await o()},W=V=>{S(V),A(!0)},B=async V=>{confirm("Are you sure you want to delete this item?")&&await a(V)},R=()=>{A(!1),S(null)},z=async V=>{for(const ne of V)await r({...ne,supplier:ne.supplier||null,unit_cost:ne.unit_cost??null});await o()},U=()=>{sT(e)},fe=V=>{switch(V){case"in_stock":return"text-green-600 bg-green-100";case"low_stock":return"text-yellow-600 bg-yellow-100";case"out_of_stock":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},M=V=>{switch(V){case"in_stock":return f.jsx(Ga,{className:"h-4 w-4"});case"low_stock":return f.jsx(cc,{className:"h-4 w-4"});case"out_of_stock":return f.jsx(Ha,{className:"h-4 w-4"});default:return f.jsx(Ha,{className:"h-4 w-4"})}};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search inventory...",value:l,onChange:V=>h(V.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("div",{className:"flex gap-2 flex-wrap",children:[f.jsxs("button",{onClick:U,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[f.jsx(Li,{className:"h-5 w-5 mr-2"}),"Export"]}),f.jsxs("button",{onClick:()=>_(!0),className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[f.jsx(Mi,{className:"h-5 w-5 mr-2"}),"Bulk Upload"]}),f.jsxs("button",{onClick:()=>w(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[f.jsx(bm,{className:"h-5 w-5 mr-2"}),"Scan Item"]}),f.jsxs("button",{onClick:()=>A(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"Add Item"]})]})]}),f.jsxs("div",{className:"flex items-center gap-4",children:[f.jsx(pd,{className:"h-5 w-5 text-gray-400"}),f.jsx("select",{value:g,onChange:V=>m(V.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:N.map(V=>f.jsx("option",{value:V,children:V==="all"?"All Categories":V},V))})]}),t?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"Loading inventory..."})]})}):k.length===0?f.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[f.jsx(Ha,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500 text-lg",children:"No inventory items found"}),f.jsx("p",{className:"text-gray-400 text-sm mt-2",children:l||g!=="all"?"Try adjusting your filters":"Add your first inventory item to get started"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:k.map((V,ne)=>f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ne*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[f.jsxs("div",{className:"flex justify-between items-start mb-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:V.name}),f.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",V.sku]})]}),f.jsxs("div",{className:`flex items-center px-2 py-1 rounded-full text-xs font-medium ${fe(V.status)}`,children:[M(V.status),f.jsx("span",{className:"ml-1 capitalize",children:V.status.replace("_"," ")})]})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Current Stock:"}),f.jsxs("span",{className:"text-sm font-medium",children:[V.current_stock," ",V.unit]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Min Stock:"}),f.jsxs("span",{className:"text-sm font-medium",children:[V.min_stock," ",V.unit]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Location:"}),f.jsx("span",{className:"text-sm font-medium",children:V.location})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${V.current_stock===0?"bg-red-500":V.current_stock<=V.min_stock?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(V.current_stock/V.max_stock*100,100)}%`}})})]}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 flex gap-2",children:[f.jsx("button",{onClick:()=>W(V),className:"flex-1 text-blue-600 hover:text-blue-700 text-sm font-medium",children:"Edit"}),f.jsx("button",{onClick:()=>{B(V.id)},className:"flex-1 text-red-600 hover:text-red-700 text-sm font-medium",children:"Delete"})]})]},V.id))}),p&&f.jsx(tk,{isOpen:p,onClose:()=>w(!1),onScan:V=>{console.log("Scanned:",V),w(!1)}}),f.jsx(gI,{isOpen:E,onClose:R,onSubmit:F,item:C,loading:t}),f.jsx(iT,{isOpen:T,onClose:()=>_(!1),onUpload:z})]})}function nk({jobs:e,columns:t}){const r=o=>{switch(o){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},n=o=>new Date(o)<new Date,a=o=>e.filter(l=>l.status===o);return f.jsx("div",{className:"flex gap-6 overflow-x-auto pb-4",children:t.map((o,l)=>{const h=a(o.id);return f.jsx(nr.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:l*.1},className:"flex-shrink-0 w-80",children:f.jsxs("div",{className:`rounded-lg p-4 ${o.color}`,children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h3",{className:"font-semibold text-gray-900",children:o.title}),f.jsx("span",{className:"px-2 py-1 bg-white bg-opacity-70 text-gray-700 text-sm rounded-full",children:h.length})]}),f.jsxs("div",{className:"space-y-3",children:[h.map((g,m)=>f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1+m*.05},className:"bg-white rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsx("h4",{className:"font-medium text-gray-900 text-sm leading-tight",children:g.title}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${r(g.priority)}`,children:g.priority}),n(g.dueDate)&&g.status!=="completed"&&f.jsx("div",{className:"flex items-center px-1 py-1 bg-red-100 text-red-800 rounded-full",children:f.jsx(cc,{className:"h-3 w-3"})})]})]}),f.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:g.description}),f.jsxs("div",{className:"space-y-2 mb-3",children:[f.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[f.jsx(_d,{className:"h-3 w-3 mr-1"}),g.assignedTo]}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[f.jsx(lc,{className:"h-3 w-3 mr-1"}),g.location]}),f.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[f.jsx(xs,{className:"h-3 w-3 mr-1"}),g.estimatedHours,"h â¢ Due ",new Date(g.dueDate).toLocaleDateString()]})]}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.tags.slice(0,2).map(p=>f.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:p},p)),g.tags.length>2&&f.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",g.tags.length-2]})]})]},g.id)),h.length===0&&f.jsx("div",{className:"text-center py-8 text-gray-500",children:f.jsx("p",{className:"text-sm",children:"No jobs in this column"})})]})]})},o.id)})})}function G0({label:e,name:t,value:r="",onChange:n,placeholder:a,required:o=!1,error:l,rows:h=3,maxLength:g,autoResize:m=!1,className:p=""}){const w=Y.useRef(null),E=A=>{n?.(A.target.value)};return Y.useEffect(()=>{if(m&&w.current){const A=w.current;A.style.height="auto",A.style.height=`${A.scrollHeight}px`}},[r,m]),f.jsxs("div",{className:`space-y-1 ${p}`,children:[f.jsxs("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700",children:[e,o&&f.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),f.jsx("textarea",{ref:w,id:t,name:t,value:r,onChange:E,placeholder:a,required:o,rows:m?1:h,maxLength:g,className:`w-full px-3 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors resize-none ${l?"border-red-300 focus:ring-red-500":"border-gray-300 hover:border-gray-400"}`,style:m?{minHeight:`${h*1.5}rem`}:{}}),f.jsxs("div",{className:"flex justify-between items-center",children:[l&&f.jsx("p",{className:"text-sm text-red-600",children:l}),g&&f.jsxs("p",{className:"text-sm text-gray-500 ml-auto",children:[r.length,"/",g]})]})]})}const ak=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];function sk({isOpen:e,onClose:t,onSubmit:r,item:n,loading:a=!1}){const[o,l]=Y.useState({title:"",description:"",priority:"medium",assigned_to:"",location:"",estimated_hours:1,due_date:"",tags:[],asset_id:"",hour_meter_reading:void 0}),[h,g]=Y.useState({}),[m,p]=Y.useState(""),[w,E]=Y.useState([]),[A,T]=Y.useState(!0);Y.useEffect(()=>{l(n?{title:n.title,description:n.description,priority:n.priority,assigned_to:n.assigned_to,location:n.location,estimated_hours:n.estimated_hours,due_date:n.due_date?.split("T")[0]||"",tags:n.tags||[],asset_id:n.asset_id||"",hour_meter_reading:n.hour_meter_reading||void 0}:{title:"",description:"",priority:"medium",assigned_to:"",location:"",estimated_hours:1,due_date:"",tags:[],asset_id:"",hour_meter_reading:void 0}),g({}),p("")},[n,e]),Y.useEffect(()=>{e&&(async()=>{T(!0);const{data:F,error:W}=await Ct.from("assets").select("*").order("name");!W&&F&&E(F),T(!1)})()},[e]);const _=F=>{F.preventDefault();const W=H0(dI,{...o,due_date:o.due_date+"T23:59:59Z"});if(!W.success){g(W.errors||{});return}r(W.data).then(()=>t()).catch(B=>{console.error("Failed to submit form:",B)})},C=(F,W)=>{l(B=>({...B,[F]:W})),h[F]&&g(B=>({...B,[F]:""}))},S=()=>{m.trim()&&!o.tags?.includes(m.trim())&&(C("tags",[...o.tags||[],m.trim()]),p(""))},k=F=>{C("tags",o.tags?.filter(W=>W!==F)||[])},N=F=>{F.key==="Enter"&&(F.preventDefault(),S())};return f.jsx(fo,{isOpen:e,onClose:t,title:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Em,{className:"h-6 w-6 text-blue-600 mr-2"}),n?"Edit Job Card":"Add New Job Card"]}),size:"lg",children:f.jsxs("form",{onSubmit:_,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsx("div",{className:"md:col-span-2",children:f.jsx(xr,{label:"Job Title",name:"title",value:o.title,onChange:F=>C("title",F),placeholder:"e.g., Replace hydraulic pump",required:!0,error:h.title})}),f.jsx(un,{label:"Priority",name:"priority",value:o.priority,onChange:F=>C("priority",F),options:ak,required:!0,error:h.priority}),f.jsx(xr,{label:"Assigned To",name:"assigned_to",value:o.assigned_to,onChange:F=>C("assigned_to",F),placeholder:"e.g., John Smith",required:!0,error:h.assigned_to}),f.jsx(xr,{label:"Location",name:"location",value:o.location,onChange:F=>C("location",F),placeholder:"e.g., Field A, Workshop",required:!0,error:h.location}),f.jsx(xr,{label:"Estimated Hours",name:"estimated_hours",type:"number",value:o.estimated_hours,onChange:F=>C("estimated_hours",F),required:!0,error:h.estimated_hours}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx(un,{label:"Asset (Optional)",name:"asset_id",value:o.asset_id||"",onChange:F=>C("asset_id",F),options:[{value:"",label:"No asset selected"},...w.map(F=>({value:F.id,label:F.name}))],disabled:A,error:h.asset_id}),o.asset_id&&w.length>0&&f.jsx("div",{className:"mt-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:(()=>{const F=w.find(W=>W.id===o.asset_id);return F?f.jsxs("div",{className:"text-sm text-gray-700",children:[f.jsx("span",{className:"font-medium",children:"Type:"})," ",F.type," â¢",f.jsx("span",{className:"font-medium ml-2",children:"Current Hours:"})," ",F.current_hours||0,"h"]}):null})()})]}),o.asset_id&&f.jsxs("div",{className:"md:col-span-2",children:[f.jsx(xr,{label:"Hour Meter Reading (Optional)",name:"hour_meter_reading",type:"number",step:"0.1",value:o.hour_meter_reading??"",onChange:F=>C("hour_meter_reading",F?parseFloat(String(F)):void 0),placeholder:"Current hour meter reading",error:h.hour_meter_reading}),o.hour_meter_reading&&(()=>{const F=w.find(R=>R.id===o.asset_id);if(!F)return null;const W=F.current_hours||0,B=o.hour_meter_reading-W;return B>0?f.jsxs("div",{className:"mt-2 text-sm text-green-700 bg-green-50 p-2 rounded border border-green-200",children:["Hours since last record: ",B.toFixed(1),"h"]}):null})()]}),f.jsx("div",{className:"md:col-span-2",children:f.jsx(xr,{label:"Due Date",name:"due_date",type:"date",value:o.due_date,onChange:F=>C("due_date",F),required:!0,error:h.due_date})})]}),f.jsx(G0,{label:"Description",name:"description",value:o.description,onChange:F=>C("description",F),placeholder:"Describe the job requirements and steps...",required:!0,rows:4,maxLength:1e3,error:h.description||void 0}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tags (Optional)"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("input",{type:"text",value:m,onChange:F=>p(F.target.value),onKeyPress:N,placeholder:"Add a tag...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),f.jsx("button",{type:"button",onClick:S,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add"})]}),o.tags&&o.tags.length>0&&f.jsx("div",{className:"flex flex-wrap gap-2",children:o.tags.map((F,W)=>f.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[F,f.jsx("button",{type:"button",onClick:()=>k(F),className:"ml-1 text-blue-600 hover:text-blue-800",children:f.jsx(ua,{className:"h-3 w-3"})})]},W))})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),f.jsxs("button",{type:"submit",disabled:a,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[a&&f.jsx(Nc,{size:"sm",color:"white",className:"mr-2"}),n?"Update Job":"Create Job"]})]})]})})}const ik=[{id:"todo",title:"To Do",color:"bg-gray-100"},{id:"in_progress",title:"In Progress",color:"bg-blue-100"},{id:"review",title:"Review",color:"bg-yellow-100"},{id:"completed",title:"Completed",color:"bg-green-100"}];function ok(){const{items:e,loading:t,create:r,update:n,delete:a,refresh:o}=ca("job_cards"),[l,h]=Y.useState(""),[g,m]=Y.useState("all"),[p,w]=Y.useState("all"),[E,A]=Y.useState("kanban"),[T,_]=Y.useState(!1),[C,S]=Y.useState(null);Y.useEffect(()=>{o()},[o]);const k=e.filter(M=>{const V=M.title.toLowerCase().includes(l.toLowerCase())||M.description.toLowerCase().includes(l.toLowerCase())||M.location.toLowerCase().includes(l.toLowerCase()),ne=g==="all"||M.priority===g,me=p==="all"||M.assigned_to===p;return V&&ne&&me}),N=Array.from(new Set(e.map(M=>M.assigned_to))),F=async M=>{confirm("Are you sure you want to delete this job?")&&await a(M)},W=async(M,V)=>{await n(M,{status:V})},B=async M=>{C?await n(C.id,{...M,asset_id:M.asset_id??null,hour_meter_reading:M.hour_meter_reading??null}):await r({...M,status:"todo",actual_hours:M.actual_hours??null,notes:M.notes??null,completed_date:null,asset_id:M.asset_id??null,hour_meter_reading:M.hour_meter_reading??null}),await o()},R=M=>{S(M),_(!0)},z=()=>{_(!1),S(null)},U=M=>{switch(M){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},fe=M=>new Date(M)<new Date;return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search jobs...",value:l,onChange:M=>h(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[f.jsx("button",{onClick:()=>A("kanban"),className:`px-4 py-2 text-sm font-medium ${E==="kanban"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Kanban"}),f.jsx("button",{onClick:()=>A("list"),className:`px-4 py-2 text-sm font-medium ${E==="list"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"List"})]}),f.jsxs("button",{onClick:()=>_(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"New Job"]})]})]}),f.jsxs("div",{className:"flex flex-wrap gap-4",children:[f.jsxs("select",{value:g,onChange:M=>m(M.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Priorities"}),f.jsx("option",{value:"low",children:"Low Priority"}),f.jsx("option",{value:"medium",children:"Medium Priority"}),f.jsx("option",{value:"high",children:"High Priority"})]}),f.jsxs("select",{value:p,onChange:M=>w(M.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Assignees"}),N.map(M=>f.jsx("option",{value:M,children:M},M))]})]}),t?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"Loading jobs..."})]})}):k.length===0?f.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[f.jsx("p",{className:"text-gray-500 text-lg",children:"No jobs found"}),f.jsx("p",{className:"text-gray-400 text-sm mt-2",children:l||g!=="all"||p!=="all"?"Try adjusting your filters":"Create your first job to get started"})]}):E==="kanban"?f.jsx(nk,{jobs:k.map(M=>({id:M.id,title:M.title,description:M.description,priority:M.priority,status:M.status,assignedTo:M.assigned_to,location:M.location,estimatedHours:M.estimated_hours,dueDate:M.due_date,tags:M.tags})),columns:ik}):f.jsx("div",{className:"space-y-4",children:k.map((M,V)=>f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:V*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[f.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-4",children:f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:M.title}),f.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${U(M.priority)}`,children:M.priority}),fe(M.due_date)&&M.status!=="completed"&&f.jsxs("div",{className:"flex items-center px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs",children:[f.jsx(cc,{className:"h-3 w-3 mr-1"}),"Overdue"]})]}),f.jsx("p",{className:"text-gray-600 mb-3",children:M.description})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(_d,{className:"h-4 w-4 text-gray-400 mr-2"}),f.jsx("span",{className:"text-sm text-gray-600",children:M.assigned_to})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(lc,{className:"h-4 w-4 text-gray-400 mr-2"}),f.jsx("span",{className:"text-sm text-gray-600",children:M.location})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(xs,{className:"h-4 w-4 text-gray-400 mr-2"}),f.jsxs("span",{className:"text-sm text-gray-600",children:[M.estimated_hours,"h estimated"]})]}),f.jsx("div",{className:"flex items-center",children:f.jsxs("span",{className:"text-sm text-gray-600",children:["Due: ",new Date(M.due_date).toLocaleDateString()]})})]}),f.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:M.tags.map(ne=>f.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:ne},ne))}),f.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[f.jsxs("div",{className:"text-sm text-gray-500",children:["Status: ",f.jsx("span",{className:"font-medium capitalize",children:M.status.replace("_"," ")})]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>R(M),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Edit"}),f.jsx("button",{onClick:()=>{const ne=M.status==="todo"?"in_progress":M.status==="in_progress"?"review":M.status==="review"?"completed":"todo";W(M.id,ne)},className:"px-3 py-1 text-sm text-green-600 hover:text-green-700 font-medium",children:"Update Status"}),f.jsx("button",{onClick:()=>{F(M.id)},className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 font-medium",children:"Delete"})]})]})]},M.id))}),f.jsx(sk,{isOpen:T,onClose:z,onSubmit:B,item:C,loading:t})]})}function ck({maintenanceItems:e}){const[t,r]=Y.useState(new Date),n=_=>new Date(_.getFullYear(),_.getMonth()+1,0).getDate(),a=_=>new Date(_.getFullYear(),_.getMonth(),1).getDay(),o=_=>{const C=new Date(t.getFullYear(),t.getMonth(),_);return e.filter(S=>new Date(S.scheduledDate).toDateString()===C.toDateString())},l=_=>{const C=new Date(t);_==="prev"?C.setMonth(t.getMonth()-1):C.setMonth(t.getMonth()+1),r(C)},h=_=>{switch(_){case"low":return"bg-green-500";case"medium":return"bg-yellow-500";case"high":return"bg-red-500";default:return"bg-gray-500"}},g=_=>{switch(_){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"upcoming":return"bg-orange-100 text-orange-800";default:return"bg-blue-100 text-blue-800"}},m=n(t),p=a(t),w=Array.from({length:m},(_,C)=>C+1),E=Array.from({length:p},(_,C)=>C),A=["January","February","March","April","May","June","July","August","September","October","November","December"],T=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[f.jsx(qn,{className:"h-6 w-6 mr-2 text-green-600"}),A[t.getMonth()]," ",t.getFullYear()]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>l("prev"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:f.jsx(Am,{className:"h-5 w-5"})}),f.jsx("button",{onClick:()=>l("next"),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:f.jsx(Cm,{className:"h-5 w-5"})})]})]}),f.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[T.map(_=>f.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:_},_)),E.map(_=>f.jsx("div",{className:"p-2 h-24"},`empty-${_}`)),w.map(_=>{const C=o(_),S=new Date().toDateString()===new Date(t.getFullYear(),t.getMonth(),_).toDateString();return f.jsxs(nr.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:_*.01},className:`p-2 h-24 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors ${S?"bg-green-50 border-green-200":""}`,children:[f.jsx("div",{className:`text-sm font-medium mb-1 ${S?"text-green-600":"text-gray-900"}`,children:_}),f.jsxs("div",{className:"space-y-1",children:[C.slice(0,2).map(k=>f.jsx("div",{className:`text-xs p-1 rounded text-center truncate ${g(k.status)}`,title:`${k.equipmentName} - ${k.maintenanceType}`,children:f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:`w-2 h-2 rounded-full mr-1 ${h(k.priority)}`}),f.jsx("span",{className:"truncate",children:k.maintenanceType})]})},k.id)),C.length>2&&f.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",C.length-2," more"]})]})]},_)})]}),f.jsxs("div",{className:"mt-6 flex flex-wrap gap-4 text-sm",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-2"}),f.jsx("span",{className:"text-gray-600",children:"High Priority"})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-2"}),f.jsx("span",{className:"text-gray-600",children:"Medium Priority"})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),f.jsx("span",{className:"text-gray-600",children:"Low Priority"})]})]})]})}const lk=[{value:"preventive",label:"Preventive"},{value:"predictive",label:"Predictive"},{value:"corrective",label:"Corrective"},{value:"routine",label:"Routine"},{value:"emergency",label:"Emergency"}],uk=[{value:"hours",label:"Hours"},{value:"calendar",label:"Calendar"}],fk=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}];function dk({isOpen:e,onClose:t,onSubmit:r,item:n,loading:a=!1}){const[o,l]=Y.useState({equipment_name:"",maintenance_type:"preventive",interval_type:"hours",interval_value:100,current_hours:void 0,next_due_date:"",priority:"medium",assigned_technician:"",estimated_cost:void 0,notes:void 0}),[h,g]=Y.useState({}),[m,p]=Y.useState([]),[w,E]=Y.useState(!0);Y.useEffect(()=>{e&&(async()=>{E(!0);const{data:_,error:C}=await Ct.from("assets").select("*").order("name");!C&&_?(p(_),console.log("MaintenanceModal: Loaded assets:",_.length)):C&&console.error("MaintenanceModal: Failed to load assets:",C),E(!1)})()},[e]),Y.useEffect(()=>{l(n?{equipment_name:n.equipment_name,maintenance_type:n.maintenance_type,interval_type:n.interval_type,interval_value:n.interval_value,current_hours:n.current_hours!==null?n.current_hours:void 0,next_due_date:n.next_due_date?.split("T")[0]||"",priority:n.priority,assigned_technician:n.assigned_technician,estimated_cost:n.estimated_cost!==null?n.estimated_cost:void 0,notes:n.notes!==null?n.notes:void 0}:{equipment_name:"",maintenance_type:"preventive",interval_type:"hours",interval_value:100,current_hours:void 0,next_due_date:"",priority:"medium",assigned_technician:"",estimated_cost:void 0,notes:void 0}),g({})},[n,e]);const A=_=>{_.preventDefault(),(async()=>{const C={};if(o.equipment_name.trim()||(C.equipment_name="Equipment name is required"),o.assigned_technician.trim()||(C.assigned_technician="Assigned technician is required"),o.next_due_date||(C.next_due_date="Next due date is required"),o.interval_value<=0&&(C.interval_value="Interval value must be greater than 0"),Object.keys(C).length>0){g(C);return}try{await r({...o,next_due_date:o.next_due_date+"T00:00:00Z"}),t()}catch(S){console.error("Failed to submit form:",S)}})()},T=(_,C)=>{l(S=>({...S,[_]:C})),h[_]&&g(S=>({...S,[_]:""}))};return f.jsx(fo,{isOpen:e,onClose:t,title:f.jsxs("div",{className:"flex items-center",children:[f.jsx(qn,{className:"h-6 w-6 text-green-600 mr-2"}),n?"Edit Maintenance Schedule":"Schedule New Maintenance"]}),size:"lg",children:f.jsxs("form",{onSubmit:A,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"md:col-span-2",children:[f.jsx(un,{label:"Equipment/Asset",name:"equipment_name",value:o.equipment_name,onChange:_=>{T("equipment_name",_);const C=m.find(S=>S.id===_);C&&C.current_hours&&T("current_hours",C.current_hours)},options:[{value:"",label:"Select Equipment..."},...m.map(_=>({value:_.id,label:_.name}))],required:!0,error:h.equipment_name,disabled:w}),w&&f.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Loading equipment list..."}),o.equipment_name&&f.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:f.jsxs("p",{className:"text-sm text-green-700",children:["Selected: ",m.find(_=>_.id===o.equipment_name)?.name||"Unknown"]})})]}),f.jsx(un,{label:"Maintenance Type",name:"maintenance_type",value:o.maintenance_type,onChange:_=>T("maintenance_type",_),options:lk,required:!0,error:h.maintenance_type}),f.jsx(un,{label:"Priority",name:"priority",value:o.priority,onChange:_=>T("priority",_),options:fk,required:!0,error:h.priority}),f.jsx(un,{label:"Interval Type",name:"interval_type",value:o.interval_type,onChange:_=>T("interval_type",_),options:uk,required:!0,error:h.interval_type}),f.jsx(xr,{label:"Interval Value",name:"interval_value",type:"number",value:o.interval_value,onChange:_=>T("interval_value",_),placeholder:"e.g., 250",required:!0,error:h.interval_value}),o.interval_type==="hours"&&f.jsx(xr,{label:"Current Hours",name:"current_hours",type:"number",value:o.current_hours||0,onChange:_=>T("current_hours",_),placeholder:"e.g., 240",error:h.current_hours}),f.jsx(xr,{label:"Next Due Date",name:"next_due_date",type:"date",value:o.next_due_date,onChange:_=>T("next_due_date",_),required:!0,error:h.next_due_date}),f.jsx(xr,{label:"Assigned Technician",name:"assigned_technician",value:o.assigned_technician,onChange:_=>T("assigned_technician",_),placeholder:"e.g., Mike Johnson",required:!0,error:h.assigned_technician}),f.jsx(xr,{label:"Estimated Cost",name:"estimated_cost",type:"number",value:o.estimated_cost||0,onChange:_=>T("estimated_cost",_),placeholder:"e.g., 500",error:h.estimated_cost})]}),f.jsx(G0,{label:"Notes (Optional)",name:"notes",value:o.notes||"",onChange:_=>T("notes",_),placeholder:"Additional maintenance notes...",rows:3,error:h.notes}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),f.jsxs("button",{type:"submit",disabled:a,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:opacity-50",children:[a&&f.jsx(Nc,{size:"sm",color:"white",className:"mr-2"}),n?"Update Schedule":"Create Schedule"]})]})]})})}function hk(){const{items:e,loading:t,create:r,update:n,delete:a,refresh:o}=ca("maintenance_schedules"),[l,h]=Y.useState(""),[g,m]=Y.useState("all"),[p,w]=Y.useState("list"),[E,A]=Y.useState(!1),[T,_]=Y.useState(null);Y.useEffect(()=>{o()},[o]);const C=e.filter(M=>{const V=M.equipment_name.toLowerCase().includes(l.toLowerCase())||M.maintenance_type.toLowerCase().includes(l.toLowerCase()),ne=g==="all"||M.status===g;return V&&ne}),S=e.filter(M=>M.failure_probability&&M.failure_probability>=40).map(M=>({equipmentId:M.id,equipmentName:M.equipment_name,component:M.maintenance_type,failureProbability:M.failure_probability/100,predictedFailureDate:M.next_due_date,recommendedAction:M.failure_probability>=70?"Schedule preventive maintenance":"Monitor closely",confidenceLevel:.85})),k=async M=>{T?await n(T.id,M):await r({...M,status:"scheduled",failure_probability:0}),await o()},N=async M=>{await k({...M,current_hours:M.current_hours!==void 0?M.current_hours:null,estimated_cost:M.estimated_cost!==void 0?M.estimated_cost:null,notes:M.notes!==void 0?M.notes:null})},F=M=>{_(M),A(!0)},W=async M=>{confirm("Are you sure you want to delete this maintenance schedule?")&&await a(M)},B=async M=>{await n(M.id,{status:"completed"})},R=()=>{A(!1),_(null)},z=M=>{switch(M){case"scheduled":return"text-blue-600 bg-blue-100";case"upcoming":return"text-orange-600 bg-orange-100";case"in_progress":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"overdue":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},U=M=>{switch(M){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},fe=M=>M>=.7?"text-red-600 bg-red-100":M>=.4?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100";return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search maintenance...",value:l,onChange:M=>h(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs("div",{className:"flex rounded-lg border border-gray-300 overflow-hidden",children:[f.jsx("button",{onClick:()=>w("list"),className:`px-4 py-2 text-sm font-medium ${p==="list"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"List"}),f.jsx("button",{onClick:()=>w("calendar"),className:`px-4 py-2 text-sm font-medium ${p==="calendar"?"bg-green-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Calendar"})]}),f.jsxs("button",{onClick:()=>A(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"Schedule Maintenance"]})]})]}),f.jsx("div",{className:"flex gap-4",children:f.jsxs("select",{value:g,onChange:M=>m(M.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Statuses"}),f.jsx("option",{value:"scheduled",children:"Scheduled"}),f.jsx("option",{value:"upcoming",children:"Upcoming"}),f.jsx("option",{value:"in_progress",children:"In Progress"}),f.jsx("option",{value:"completed",children:"Completed"}),f.jsx("option",{value:"overdue",children:"Overdue"})]})}),t?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"Loading maintenance schedules..."})]})}):C.length===0?f.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[f.jsx("p",{className:"text-gray-500 text-lg",children:"No maintenance schedules found"}),f.jsx("p",{className:"text-gray-400 text-sm mt-2",children:l||g!=="all"?"Try adjusting your filters":"Schedule your first maintenance to get started"})]}):p==="calendar"?f.jsx(ck,{maintenanceItems:C.map(M=>({id:M.id,equipmentName:M.equipment_name,maintenanceType:M.maintenance_type,scheduledDate:M.next_due_date,priority:M.priority,status:M.status}))}):f.jsxs("div",{className:"space-y-6",children:[S.length>0&&f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[f.jsx(oc,{className:"h-5 w-5 mr-2 text-blue-600"}),"Predictive Maintenance Alerts"]}),f.jsx("div",{className:"space-y-4",children:S.map((M,V)=>f.jsxs(nr.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:V*.1},className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"font-medium text-gray-900",children:M.equipmentName}),f.jsx("p",{className:"text-sm text-gray-600",children:M.component}),f.jsx("p",{className:"text-sm text-gray-500",children:M.recommendedAction})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${fe(M.failureProbability)}`,children:[Math.round(M.failureProbability*100),"% Risk"]}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Predicted: ",new Date(M.predictedFailureDate).toLocaleDateString()]})]})]},M.equipmentId))})]}),f.jsx("div",{className:"space-y-4",children:C.map((M,V)=>f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:V*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[f.jsx("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-4",children:f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:M.maintenance_type}),f.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${z(M.status)}`,children:M.status.replace("_"," ").charAt(0).toUpperCase()+M.status.replace("_"," ").slice(1)}),f.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${U(M.priority)}`,children:M.priority})]}),f.jsx("p",{className:"text-gray-600",children:M.equipment_name})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Next Due:"}),f.jsx("p",{className:"font-medium",children:new Date(M.next_due_date).toLocaleDateString()})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Assigned To:"}),f.jsx("p",{className:"font-medium",children:M.assigned_technician})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Interval:"}),f.jsxs("p",{className:"font-medium",children:[M.interval_value," ",M.interval_type]})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:M.interval_type==="hours"?"Current Hours:":"Type:"}),f.jsx("p",{className:"font-medium",children:M.interval_type==="hours"?M.current_hours||0:M.interval_type})]})]}),M.interval_type==="hours"&&M.current_hours!==void 0&&f.jsxs("div",{className:"mb-4",children:[f.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[f.jsx("span",{children:"Progress to next service"}),f.jsxs("span",{children:[M.current_hours??0,"/",M.interval_value," hours"]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${(M.current_hours??0)/M.interval_value>=.9?"bg-red-500":(M.current_hours??0)/M.interval_value>=.7?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min((M.current_hours??0)/M.interval_value*100,100)}%`}})})]}),f.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[f.jsxs("div",{className:"text-sm text-gray-500",children:["Status: ",M.status.replace("_"," ")]}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>F(M),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Edit"}),M.status!=="completed"&&f.jsx("button",{onClick:()=>{B(M)},className:"px-3 py-1 text-sm text-green-600 hover:text-green-700 font-medium",children:"Mark Complete"}),f.jsx("button",{onClick:()=>{W(M.id)},className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 font-medium",children:"Delete"})]})]})]},M.id))})]}),f.jsx(dk,{isOpen:E,onClose:R,onSubmit:N,item:T,loading:t})]})}const xk=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],mk=[{value:"in_warranty",label:"In Warranty"},{value:"out_of_warranty",label:"Out of Warranty"},{value:"extended",label:"Extended Warranty"}];function gk({isOpen:e,onClose:t,onSubmit:r,item:n,loading:a=!1,assets:o}){const[l,h]=Y.useState({asset_id:"",equipment_name:"",defect_tag:"",priority:"medium",description:"",estimated_cost:0,assigned_technician:"",warranty_status:"out_of_warranty",estimated_completion:""}),[g,m]=Y.useState({});Y.useEffect(()=>{h(n?{asset_id:n.asset_id||"",equipment_name:n.equipment_name,defect_tag:n.defect_tag,priority:n.priority,description:n.description,estimated_cost:n.estimated_cost,assigned_technician:n.assigned_technician,warranty_status:n.warranty_status,estimated_completion:n.estimated_completion?.split("T")[0]??""}:{asset_id:"",equipment_name:"",defect_tag:"",priority:"medium",description:"",estimated_cost:0,assigned_technician:"",warranty_status:"out_of_warranty",estimated_completion:""}),m({})},[n,e]);const p=A=>{A.preventDefault(),(async()=>{const T=H0(hI,{...l,estimated_completion:l.estimated_completion+"T00:00:00Z"});if(!T.success){m(T.errors||{});return}try{await r(T.data),t()}catch(_){console.error("Failed to submit form:",_)}})()},w=(A,T)=>{h(_=>{const C={..._,[A]:T};if(A==="asset_id"&&typeof T=="string"){const S=o.find(k=>k.id===T);S&&(C.equipment_name=S.name)}return C}),g[A]&&m(_=>{const C={..._};return delete C[A],C})},E=o.map(A=>({value:A.id,label:A.name}));return f.jsx(fo,{isOpen:e,onClose:t,title:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Xs,{className:"h-6 w-6 text-orange-600 mr-2"}),n?"Edit Repair Item":"Add New Repair Item"]}),size:"lg",children:f.jsxs("form",{onSubmit:p,className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsx(un,{label:"Equipment Name",name:"asset_id",value:l.asset_id,onChange:A=>w("asset_id",A),options:E,required:!0,error:g.asset_id}),f.jsx(xr,{label:"Defect Tag",name:"defect_tag",value:l.defect_tag,onChange:A=>w("defect_tag",A),placeholder:"e.g., DEF-001",required:!0,error:g.defect_tag}),f.jsx(un,{label:"Priority",name:"priority",value:l.priority,onChange:A=>w("priority",A),options:xk,required:!0,error:g.priority}),f.jsx(xr,{label:"Assigned Technician",name:"assigned_technician",value:l.assigned_technician,onChange:A=>w("assigned_technician",A),placeholder:"e.g., John Smith",required:!0,error:g.assigned_technician}),f.jsx(xr,{label:"Estimated Cost",name:"estimated_cost",type:"number",value:l.estimated_cost,onChange:A=>w("estimated_cost",A),required:!0,error:g.estimated_cost}),f.jsx(un,{label:"Warranty Status",name:"warranty_status",value:l.warranty_status,onChange:A=>w("warranty_status",A),options:mk,required:!0,error:g.warranty_status}),f.jsx("div",{className:"md:col-span-2",children:f.jsx(xr,{label:"Estimated Completion",name:"estimated_completion",type:"date",value:l.estimated_completion,onChange:A=>w("estimated_completion",A),required:!0,error:g.estimated_completion})})]}),f.jsx(G0,{label:"Description",name:"description",value:l.description,onChange:A=>w("description",A),placeholder:"Describe the issue and required repairs...",required:!0,rows:4,maxLength:500,error:g.description}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[f.jsx("button",{type:"button",onClick:t,disabled:a,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),f.jsxs("button",{type:"submit",disabled:a,className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-orange-600 rounded-lg hover:bg-orange-700 disabled:opacity-50",children:[a&&f.jsx(Nc,{size:"sm",color:"white",className:"mr-2"}),n?"Update Repair":"Create Repair"]})]})]})})}function pk(){const{items:e,loading:t,create:r,update:n,delete:a,refresh:o}=ca("repair_items"),{items:l,loading:h}=ca("assets"),[g,m]=Y.useState(""),[p,w]=Y.useState("all"),[E,A]=Y.useState("all"),[T,_]=Y.useState(!1),[C,S]=Y.useState(null);Y.useEffect(()=>{o()},[o]);const k=e.filter(M=>{const V=M.equipment_name.toLowerCase().includes(g.toLowerCase())||M.defect_tag.toLowerCase().includes(g.toLowerCase())||M.description.toLowerCase().includes(g.toLowerCase()),ne=p==="all"||M.status===p,me=E==="all"||M.priority===E;return V&&ne&&me}),N=async M=>{if(C)await n(C.id,M);else{const V={asset_id:M.asset_id||null,equipment_name:M.equipment_name,defect_tag:M.defect_tag,priority:M.priority,status:"pending",description:M.description,estimated_cost:M.estimated_cost,actual_cost:M.actual_cost??null,assigned_technician:M.assigned_technician,photo_urls:[],warranty_status:M.warranty_status,estimated_completion:M.estimated_completion||new Date().toISOString(),completed_date:null};await r(V)}await o()},F=async M=>{confirm("Are you sure you want to delete this repair?")&&await a(M)},W=async(M,V)=>{await n(M,{status:V})},B=M=>{S(M),_(!0)},R=()=>{_(!1),S(null)},z=M=>{switch(M){case"pending":return"text-yellow-600 bg-yellow-100";case"in_progress":return"text-blue-600 bg-blue-100";case"completed":return"text-green-600 bg-green-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},U=M=>{switch(M){case"low":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"high":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},fe=M=>{switch(M){case"pending":return f.jsx(xs,{className:"h-4 w-4"});case"in_progress":return f.jsx(Xs,{className:"h-4 w-4"});case"completed":return f.jsx(Ga,{className:"h-4 w-4"});case"cancelled":return f.jsx(to,{className:"h-4 w-4"});default:return f.jsx(xs,{className:"h-4 w-4"})}};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[f.jsx("div",{className:"flex-1 max-w-lg",children:f.jsxs("div",{className:"relative",children:[f.jsx(Wa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search repairs...",value:g,onChange:M=>m(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]})}),f.jsxs("button",{onClick:()=>_(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-5 w-5 mr-2"}),"New Repair"]})]}),f.jsxs("div",{className:"flex flex-wrap gap-4",children:[f.jsxs("select",{value:p,onChange:M=>w(M.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Statuses"}),f.jsx("option",{value:"pending",children:"Pending"}),f.jsx("option",{value:"in_progress",children:"In Progress"}),f.jsx("option",{value:"completed",children:"Completed"}),f.jsx("option",{value:"cancelled",children:"Cancelled"})]}),f.jsxs("select",{value:E,onChange:M=>A(M.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"all",children:"All Priorities"}),f.jsx("option",{value:"low",children:"Low Priority"}),f.jsx("option",{value:"medium",children:"Medium Priority"}),f.jsx("option",{value:"high",children:"High Priority"})]})]}),f.jsx("div",{className:"space-y-4",children:t?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),f.jsx("p",{className:"mt-4 text-gray-600",children:"Loading repairs..."})]})}):k.length===0?f.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-md",children:[f.jsx("p",{className:"text-gray-500 text-lg",children:"No repairs found"}),f.jsx("p",{className:"text-gray-400 text-sm mt-2",children:g||p!=="all"||E!=="all"?"Try adjusting your filters":"Create your first repair to get started"})]}):k.map((M,V)=>f.jsxs(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:V*.1},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[f.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:M.equipment_name}),f.jsxs("span",{className:"text-sm text-gray-500",children:["#",M.defect_tag]}),M.warranty_status==="in_warranty"&&f.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Under Warranty"})]}),f.jsx("p",{className:"text-gray-600 mb-3",children:M.description})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${z(M.status)}`,children:[fe(M.status),f.jsx("span",{className:"ml-1 capitalize",children:M.status.replace("_"," ")})]}),f.jsx("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${U(M.priority)}`,children:f.jsx("span",{className:"capitalize",children:M.priority})})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Assigned To:"}),f.jsx("p",{className:"font-medium",children:M.assigned_technician||"Unassigned"})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Created:"}),f.jsx("p",{className:"font-medium",children:new Date(M.created_at).toLocaleDateString()})]}),f.jsxs("div",{children:[f.jsx("span",{className:"text-sm text-gray-500",children:"Est. Completion:"}),f.jsx("p",{className:"font-medium",children:M.estimated_completion?new Date(M.estimated_completion).toLocaleDateString():"TBD"})]})]}),M.photo_urls&&M.photo_urls.length>0&&f.jsxs("div",{className:"mb-4",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Photos:"}),f.jsxs("div",{className:"flex gap-2",children:[M.photo_urls.map((ne,me)=>f.jsx("img",{src:ne,alt:`Repair photo ${me+1}`,className:"h-16 w-16 object-cover rounded-lg border border-gray-200"},me)),f.jsx("button",{className:"h-16 w-16 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center hover:border-gray-400 transition-colors",children:f.jsx(yd,{className:"h-6 w-6 text-gray-400"})})]})]}),f.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[f.jsx("div",{className:"text-sm text-gray-500",children:M.estimated_cost>0&&f.jsxs("span",{children:["Estimated Cost: ",f.jsxs("span",{className:"font-medium text-gray-900",children:["$",M.estimated_cost.toFixed(2)]})]})}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>B(M),className:"px-3 py-1 text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Edit"}),f.jsx("button",{onClick:()=>{const ne=M.status==="pending"?"in_progress":M.status==="in_progress"?"completed":"pending";W(M.id,ne)},className:"px-3 py-1 text-sm text-green-600 hover:text-green-700 font-medium",children:"Update Status"}),f.jsx("button",{onClick:()=>{F(M.id)},className:"px-3 py-1 text-sm text-red-600 hover:text-red-700 font-medium",children:"Delete"})]})]})]},M.id))}),f.jsx(gk,{isOpen:T,onClose:R,onSubmit:N,item:C,assets:l,loading:t||h})]})}function vk(){const[e,t]=Y.useState([]),[r,n]=Y.useState(!0),[a,o]=Y.useState(null),[l,h]=Y.useState(!1),g=Vd(),m={name:"",location:"",description:"",area_hectares:"",manager_name:"",contact_phone:"",contact_email:"",status:"active"},[p,w]=Y.useState(m),E=Y.useCallback(async()=>{try{const{data:S,error:k}=await Ct.from("farms").select("*").order("name");if(k)throw k;t(S||[])}catch(S){const k=S instanceof Error?S.message:"Unknown error";g.error("Failed to load farms",k)}finally{n(!1)}},[g]);Y.useEffect(()=>{E()},[E]);const A=async S=>{S.preventDefault();try{const k={name:p.name,location:p.location||null,description:p.description||null,area_hectares:p.area_hectares?parseFloat(p.area_hectares):null,manager_name:p.manager_name||null,contact_phone:p.contact_phone||null,contact_email:p.contact_email||null,status:p.status};if(a){const{error:N}=await Ct.from("farms").update(k).eq("id",a);if(N)throw N;g.success("Farm updated successfully")}else{const{error:N}=await Ct.from("farms").insert([k]);if(N)throw N;g.success("Farm added successfully")}w(m),o(null),h(!1),E()}catch(k){const N=k instanceof Error?k.message:"Unknown error";g.error("Failed to save farm",N)}},T=S=>{w({name:S.name,location:S.location||"",description:S.description||"",area_hectares:S.area_hectares?.toString()||"",manager_name:S.manager_name||"",contact_phone:S.contact_phone||"",contact_email:S.contact_email||"",status:S.status}),o(S.id),h(!0)},_=async S=>{if(confirm("Are you sure you want to delete this farm? Assets linked to this farm will be unassigned."))try{const{error:k}=await Ct.from("farms").delete().eq("id",S);if(k)throw k;g.success("Farm deleted successfully"),E()}catch(k){const N=k instanceof Error?k.message:"Unknown error";g.error("Failed to delete farm",N)}},C=()=>{w(m),o(null),h(!1)};return r?f.jsx("div",{className:"text-center py-8",children:"Loading farms..."}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Manage farm locations and assign assets to specific farms"}),f.jsxs("button",{onClick:()=>h(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Pn,{className:"h-4 w-4 mr-2"}),"Add Farm"]})]}),l&&f.jsxs(nr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-gray-50 rounded-lg p-6 border-2 border-green-200",children:[f.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:a?"Edit Farm":"Add New Farm"}),f.jsxs("form",{onSubmit:S=>void A(S),className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Farm Name *"}),f.jsx("input",{type:"text",required:!0,value:p.name,onChange:S=>w({...p,name:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., BURMA VALLEY FARM"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),f.jsx("input",{type:"text",value:p.location,onChange:S=>w({...p,location:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., District, Region"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Area (Hectares)"}),f.jsx("input",{type:"number",step:"0.01",value:p.area_hectares,onChange:S=>w({...p,area_hectares:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., 150.50"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),f.jsxs("select",{value:p.status,onChange:S=>w({...p,status:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"active",children:"Active"}),f.jsx("option",{value:"inactive",children:"Inactive"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manager Name"}),f.jsx("input",{type:"text",value:p.manager_name,onChange:S=>w({...p,manager_name:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., John Smith"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),f.jsx("input",{type:"tel",value:p.contact_phone,onChange:S=>w({...p,contact_phone:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., +1234567890"})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Email"}),f.jsx("input",{type:"email",value:p.contact_email,onChange:S=>w({...p,contact_email:S.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., manager@farm.com"})]}),f.jsxs("div",{className:"md:col-span-2",children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),f.jsx("textarea",{value:p.description,onChange:S=>w({...p,description:S.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Additional information about the farm"})]})]}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsxs("button",{type:"button",onClick:C,className:"flex items-center px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300 transition-colors",children:[f.jsx(ua,{className:"h-4 w-4 mr-2"}),"Cancel"]}),f.jsxs("button",{type:"submit",className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(Sm,{className:"h-4 w-4 mr-2"}),a?"Update":"Add"," Farm"]})]})]})]}),f.jsx("div",{className:"grid gap-4",children:e.length===0?f.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[f.jsx(lc,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),f.jsx("p",{className:"text-gray-600",children:"No farms found"}),f.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add your first farm to get started"})]}):e.map((S,k)=>f.jsx(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:k*.05},className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:f.jsxs("div",{className:"flex justify-between items-start",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[f.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:S.name}),f.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${S.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:S.status})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[S.location&&f.jsxs("div",{className:"text-gray-600",children:[f.jsx("span",{className:"font-medium",children:"Location:"})," ",S.location]}),S.area_hectares&&f.jsxs("div",{className:"text-gray-600",children:[f.jsx("span",{className:"font-medium",children:"Area:"})," ",S.area_hectares," ha"]}),S.manager_name&&f.jsxs("div",{className:"text-gray-600",children:[f.jsx("span",{className:"font-medium",children:"Manager:"})," ",S.manager_name]}),S.contact_phone&&f.jsxs("div",{className:"text-gray-600",children:[f.jsx("span",{className:"font-medium",children:"Phone:"})," ",S.contact_phone]}),S.contact_email&&f.jsxs("div",{className:"text-gray-600 md:col-span-2",children:[f.jsx("span",{className:"font-medium",children:"Email:"})," ",S.contact_email]})]}),S.description&&f.jsx("p",{className:"text-sm text-gray-600 mt-2",children:S.description})]}),f.jsxs("div",{className:"flex gap-2 ml-4",children:[f.jsx("button",{onClick:()=>T(S),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:f.jsx(Tm,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>void _(S.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:f.jsx(gl,{className:"h-4 w-4"})})]})]})},S.id))})]})}const hd=[{id:"general",title:"General Settings",icon:xd,description:"Basic application settings and preferences"},{id:"farms",title:"Farms",icon:lc,description:"Manage farm locations and assignments"},{id:"notifications",title:"Notifications",icon:Nm,description:"Configure alerts and notification preferences"},{id:"security",title:"Security",icon:Bl,description:"Security settings and access controls"},{id:"data",title:"Data Management",icon:Im,description:"Data backup and synchronization settings"},{id:"users",title:"User Management",icon:Ul,description:"Manage users and permissions"}];function wk(){const[e,t]=Y.useState("general"),[r,n]=Y.useState({general:{farmName:"Green Valley Farm",timezone:"America/New_York",language:"en",theme:"light",autoSave:!0},notifications:{emailNotifications:!0,pushNotifications:!0,maintenanceAlerts:!0,inventoryAlerts:!0,jobReminders:!0,inspectionReminders:!0},security:{twoFactorAuth:!1,sessionTimeout:30,passwordExpiry:90,loginAttempts:5},data:{autoBackup:!0,backupFrequency:"daily",offlineSync:!0,dataRetention:365}}),a=(w,E,A)=>{n(T=>({...T,[w]:{...T[w],[E]:A}}))},o=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Farm Name"}),f.jsx("input",{type:"text",value:r.general.farmName,onChange:w=>a("general","farmName",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Timezone"}),f.jsxs("select",{value:r.general.timezone,onChange:w=>a("general","timezone",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"America/New_York",children:"Eastern Time"}),f.jsx("option",{value:"America/Chicago",children:"Central Time"}),f.jsx("option",{value:"America/Denver",children:"Mountain Time"}),f.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language"}),f.jsxs("select",{value:r.general.language,onChange:w=>a("general","language",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"en",children:"English"}),f.jsx("option",{value:"es",children:"Spanish"}),f.jsx("option",{value:"fr",children:"French"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Theme"}),f.jsxs("select",{value:r.general.theme,onChange:w=>a("general","theme",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[f.jsx("option",{value:"light",children:"Light"}),f.jsx("option",{value:"dark",children:"Dark"}),f.jsx("option",{value:"auto",children:"Auto"})]})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx("input",{type:"checkbox",id:"autoSave",checked:r.general.autoSave,onChange:w=>a("general","autoSave",w.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),f.jsx("label",{htmlFor:"autoSave",className:"ml-2 block text-sm text-gray-700",children:"Enable auto-save"})]})]}),l=()=>f.jsx("div",{className:"space-y-6",children:Object.entries(r.notifications).map(([w,E])=>f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700",children:w.replace(/([A-Z])/g," $1").replace(/^./,A=>A.toUpperCase())}),f.jsxs("p",{className:"text-sm text-gray-500",children:[w==="emailNotifications"&&"Receive notifications via email",w==="pushNotifications"&&"Receive push notifications in browser",w==="maintenanceAlerts"&&"Get alerts for upcoming maintenance",w==="inventoryAlerts"&&"Get alerts for low stock items",w==="jobReminders"&&"Receive reminders for scheduled jobs",w==="inspectionReminders"&&"Receive inspection reminders"]})]}),f.jsx("input",{type:"checkbox",checked:E,onChange:A=>a("notifications",w,A.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]},w))}),h=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Two-Factor Authentication"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Add an extra layer of security to your account"})]}),f.jsx("input",{type:"checkbox",checked:r.security.twoFactorAuth,onChange:w=>a("security","twoFactorAuth",w.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (minutes)"}),f.jsx("input",{type:"number",value:r.security.sessionTimeout,onChange:w=>a("security","sessionTimeout",parseInt(w.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"5",max:"480"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Expiry (days)"}),f.jsx("input",{type:"number",value:r.security.passwordExpiry,onChange:w=>a("security","passwordExpiry",parseInt(w.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"30",max:"365"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Login Attempts"}),f.jsx("input",{type:"number",value:r.security.loginAttempts,onChange:w=>a("security","loginAttempts",parseInt(w.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"3",max:"10"})]})]}),g=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Automatic Backup"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Automatically backup your data to cloud storage"})]}),f.jsx("input",{type:"checkbox",checked:r.data.autoBackup,onChange:w=>a("data","autoBackup",w.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Backup Frequency"}),f.jsxs("select",{value:r.data.backupFrequency,onChange:w=>a("data","backupFrequency",w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:!r.data.autoBackup,children:[f.jsx("option",{value:"hourly",children:"Hourly"}),f.jsx("option",{value:"daily",children:"Daily"}),f.jsx("option",{value:"weekly",children:"Weekly"})]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Offline Sync"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Sync data when connection is restored"})]}),f.jsx("input",{type:"checkbox",checked:r.data.offlineSync,onChange:w=>a("data","offlineSync",w.target.checked),className:"h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data Retention (days)"}),f.jsx("input",{type:"number",value:r.data.dataRetention,onChange:w=>a("data","dataRetention",parseInt(w.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",min:"30",max:"3650"})]})]}),m=()=>f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current User"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Name: Farm Manager"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Role: Administrator"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Email: manager@greenvaleyfarm.com"})]})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"User Roles"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-200 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"Administrator"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Full system access"})]}),f.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:"Active"})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-200 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"Supervisor"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Can manage jobs and inspections"})]}),f.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"Available"})]}),f.jsxs("div",{className:"flex justify-between items-center p-3 border border-gray-200 rounded-lg",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-900",children:"Operator"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Can view and update assigned tasks"})]}),f.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full",children:"Available"})]})]})]})]}),p=()=>{switch(e){case"general":return o();case"farms":return f.jsx(vk,{});case"notifications":return l();case"security":return h();case"data":return g();case"users":return m();default:return o()}};return f.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[f.jsx("div",{className:"lg:w-1/3",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Settings"}),f.jsx("nav",{className:"space-y-2",children:hd.map((w,E)=>{const A=w.icon;return f.jsx(nr.button,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:E*.1},onClick:()=>t(w.id),className:`w-full text-left p-3 rounded-lg transition-colors ${e===w.id?"bg-green-100 text-green-900":"hover:bg-gray-50 text-gray-700"}`,children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(A,{className:`h-5 w-5 mr-3 ${e===w.id?"text-green-600":"text-gray-400"}`}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium",children:w.title}),f.jsx("p",{className:"text-sm opacity-75",children:w.description})]})]})},w.id)})})]})}),f.jsx("div",{className:"lg:w-2/3",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[f.jsxs("div",{className:"flex justify-between items-center mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:hd.find(w=>w.id===e)?.title}),f.jsxs("button",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[f.jsx(km,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]}),f.jsx(nr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:p()},e)]})})]})}function yk(){const e=Bp();return f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e&&f.jsx("div",{className:"bg-red-500 text-white text-center py-2 text-sm",children:"You're currently offline. Data will sync when connection is restored."}),f.jsx(wp,{children:f.jsxs(vn,{path:"/",element:f.jsx(Pp,{}),children:[f.jsx(vn,{index:!0,element:f.jsx(Gc,{to:"/dashboard",replace:!0})}),f.jsx(vn,{path:"dashboard",element:f.jsx(Up,{})}),f.jsx(vn,{path:"inventory",element:f.jsx(rk,{})}),f.jsx(vn,{path:"repairs",element:f.jsx(pk,{})}),f.jsx(vn,{path:"jobs",element:f.jsx(ok,{})}),f.jsx(vn,{path:"inspections",element:f.jsx(rT,{})}),f.jsx(vn,{path:"maintenance",element:f.jsx(hk,{})}),f.jsx(vn,{path:"fuel-management",element:f.jsx(JS,{})}),f.jsx(vn,{path:"settings",element:f.jsx(wk,{})}),f.jsx(vn,{path:"stock-items",element:f.jsx(Gc,{to:"/inventory",replace:!0})}),f.jsx(vn,{path:"*",element:f.jsx(Gc,{to:"/dashboard",replace:!0})})]})}),f.jsx(Cg,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})}function _k(){return f.jsx(Sp,{children:f.jsx(Mp,{children:f.jsx(yk,{})})})}const bk=new fm({defaultOptions:{queries:{staleTime:1e3*60*5,retry:(e,t)=>t instanceof Error&&"status"in t&&typeof t.status=="number"&&t.status>=400&&t.status<500?!1:e<3}}});pl.createRoot(document.getElementById("root")).render(f.jsx(lm.StrictMode,{children:f.jsx(dm,{client:bk,children:f.jsx(_k,{})})}));
